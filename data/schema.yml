version: 2

seeds:
  - name: cp_metropole
    description: "Correspondance codes postaux vers métropoles"
    columns:
      - name: Code_Postal
        description: "Code postal (5 chiffres)"
        tests:
          - not_null
      - name: Metropole
        description: "Nom de la métropole"

  - name: dpt_metropole
    description: "Correspondance départements vers métropoles"
    columns:
      - name: Departement
        description: "Numéro de département"
        tests:
          - not_null
      - name: Metropole
        description: "Nom de la métropole"

  - name: machines_clean
    description: "Mapping noms machines bruts vers standardisés"
    columns:
      - name: Machine_Brut
        description: "Nom machine tel qu'en source"
        tests:
          - not_null
      - name: MACHINE
        description: "Nom machine standardisé"

  - name: marque_clean
    description: "Correspondance technicien vers marque"
    columns:
      - name: NOM_DU_TECHNICIEN
        description: "Nom du technicien"
      - name: MARQUE
        description: "Marque associée"

  - name: techniciens_clean
    description: "Référentiel des techniciens et équipes"
    columns:
      - name: TECHNICIEN
        description: "Format 'prénom nom'"
        tests:
          - not_null
      - name: EQUIPE
        description: "Équipe d'affectation"
        tests:
          - not_null

  - name: type_inter_clean
    description: "Mapping types d'interventions"
    columns:
      - name: Type_intervention_Brut
        description: "Type intervention source"
      - name: TYPE_INTER
        description: "Type intervention standardisé"

  - name: tarification_ref_clean
    description: "Grille tarifaire complète"
    columns:
      - name: KEY
        description: "Clé de tarification composite"
        tests:
          - not_null
      - name: Montant
        description: "Montant en euros"
        tests:
          - not_null
      - name: PROD
        description: "Indicateur production"

  - name: valo_parc_machine
    description: "Fichier de référence (machine -> valorisation unitaire)."
    columns:
      - name: machine_modele
        description: "Identifiant / libellé du modèle de machine."
      - name: montant_inv
        description: "Valorisation unitaire (format texte ou numérique selon l'import)."

  - name: cps_tech
    description: "Correspondance codes postaux et regions pour les techniciens"
    columns:
      - name: cp_depart_int
        description: "code postal de départ (cedex) - integer"
        tests:
          - not_null
          - unique
      - name: cp_depart_texte
        description: "code postal de départ (cedex) - texte"
        tests:
          - not_null
          - unique
      - name: cp_final_int
        description: "code postal de fin (simplifié) - integer"
        tests:
          - not_null
      - name: cp_final_texte
        description: "code postal de fin (simplifié) - texte"
        tests:
          - not_null
      - name: libelle_cp
        description: "libellé du code postal de fin"
        tests:
          - not_null
      - name: num_departement_texte
        description: "numéro du département - texte (2 chiffres)"
        tests:
          - not_null
      - name: nom_departement
        description: "Nom du département"
        tests:
          - not_null
      - name: region_tech
        description: "Région correspondante pour la sectorisation des techniciens"
        tests:
          - not_null


  - name: tech_piece_agence_mapping
    description: "Mapping entre tech et agence stock"
    columns:
      - name: nom
        description: "nom tech"
        tests:
          - not_null
      - name: prenom
        description: "prénom du tech"
        tests:
          - not_null
      - name: agence
        description: "agence rattaché pour le stock"
        tests:
          - not_null
      - name: equipe
        description: "équipe du technicien"
        tests:
          - not_null

  - name: mapping_code_analytique__bu
    description: "Mapping code analytique vers description"
    columns:
      - name: code_analytique
        description: "Code de la section analytique"
        tests:
          - not_null
      - name: code_analytique_bu
        description: "BU associé au code analytique"
        tests:
          - not_null

  - name: mapping_code_comptable__bu
    description: "Mapping compte comptable vers BU"
    config:
      column_types:
        code_comptable: string
    columns:
      - name: code_comptable
        description: "Numéro de compte général"
        tests:
          - not_null
          - unique
      - name: designation_compte
        description: "Désignation du compte comptable"
        tests:
          - not_null
      - name: macro_categorie_pnl_bu
        description: "Macro catégorie P&L BU associée au compte comptable"
        tests:
          - not_null
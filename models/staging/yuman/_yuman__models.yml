# models/staging/_yuman__models.yml
version: 2

models:
  - name: stg_yuman__clients
    description: "Clients transformés et nettoyés depuis l'API Yuman"
    columns:
      - name: client_id
        description: "Identifiant unique du client"
        tests:
          - unique
          - not_null

  - name: stg_yuman__sites
    description: "Sites transformés et nettoyés depuis l'API Yuman"
    columns:
      - name: site_id
        description: "Identifiant unique du site"
        tests:
          - unique
          - not_null
      - name: client_id
        description: "Référence vers le client propriétaire"
        tests:
          - not_null
          - relationships:
              to: ref('stg_yuman__clients')
              field: client_id

  - name: stg_yuman__materials
    description: "Matériaux transformés et nettoyés depuis l'API Yuman"
    columns:
      - name: material_id
        description: "Identifiant unique du matériau"
        tests:
          - unique
          - not_null
      - name: site_id
        description: "Référence vers le site propriétaire"
        tests:
          - not_null
          - relationships:
              to: ref('stg_yuman__sites')
              field: site_id
      - name: category_id
        description: "Référence vers la catégorie du matériau"
        tests:
          - relationships:
              to: ref('stg_yuman__materials_categories')
              field: category_id

  - name: stg_yuman__products
    description: "Produits transformés et nettoyés depuis l'API Yuman"
    columns:
      - name: product_id
        description: "Identifiant unique du produit"
        tests:
          - unique
          - not_null

  - name: stg_yuman__users
    description: "Utilisateurs transformés et nettoyés depuis l'API Yuman"
    columns:
      - name: user_id
        description: "Identifiant unique de l'utilisateur"
        tests:
          - unique
          - not_null

  - name: stg_yuman__workorder_demands_categories
    description: "Catégories de demandes d'intervention transformées et nettoyées depuis l'API Yuman"
    columns:
      - name: demand_category_id
        description: "Identifiant unique de la catégorie de demande d'intervention"
        tests:
          - unique
          - not_null

  - name: stg_yuman__workorder_demands
    description: "Demande d'intervention transformés et nettoyés depuis l'API Yuman"
    columns:
      - name: demand_id
        description: "Identifiant unique de la demande d'intervention"
        tests:
          - unique
          - not_null
      - name: client_id
        description: "Référence vers le client propriétaire"
        tests:
          - relationships:
              to: ref('stg_yuman__clients')
              field: client_id
      - name: workorder_id
        description: "Référence vers l'intervention"
        tests:
          - relationships:
              to: ref('stg_yuman__workorders')
              field: workorder_id
      - name: site_id
        description: "Référence vers le site propriétaire"
        tests:
          - relationships:
              to: ref('stg_yuman__sites')
              field: site_id
      - name: material_id
        description: "Référence vers la machine propriétaire"
        tests:
          - relationships:
              to: ref('stg_yuman__materials')
              field: material_id
      - name: user_id
        description: "Référence vers l'utilisateur qui a créé la demande"
        tests:
          - relationships:
              to: ref('stg_yuman__users')
              field: user_id
      - name: category_id
        description: "Référence vers la catégorie de la demande"
        tests:
          - relationships:
              to: ref('stg_yuman__materials_categories')
              field: category_id
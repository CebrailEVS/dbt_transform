version: 2

models:
  - name: int_oracle_neshu__telemetry_tasks
    description: >
      Table intermédiaire des tâches de télémétrie.
      Filtrée sur les tâches de type télémétrie (idtask_type=3) 
      avec statut FAIT/VALIDE et label TELEM_SOURCE.
      
    config:
      materialized: incremental
      
    columns:
      - name: task_product_id
        description: "Clé primaire de task_has_product - Identifiant unique de la relation task-produit"
        data_type: int64
        tests:
          - unique
          - not_null
          
      - name: task_id
        description: "ID de la tâche (référence vers EVS.TASK)"
        data_type: int64
        tests:
          - not_null
          
      - name: device_id
        description: "ID du device associé à la tâche"
        data_type: int64
        
      - name: company_id
        description: "ID de l'entreprise cliente (peer company)"
        data_type: int64
          
      - name: product_id
        description: "ID du produit télémétrique"
        data_type: int64
        tests:
          - not_null
          
      - name: location_id
        description: "ID de la localisation de la tâche"
        data_type: int64
        
      - name: device_code
        description: "Code métier du device (numéro de série)"
        data_type: string
        
      - name: product_code
        description: "Code métier du produit"
        data_type: string
        
      - name: company_code
        description: "Code client de l'entreprise"
        data_type: string
        
      - name: company_name
        description: "Nom de l'entreprise cliente"
        data_type: string
        
      - name: task_location_info
        description: "Informations d'accès de la localisation de la tâche"
        data_type: string
        
      - name: task_start_date
        description: "Date et heure réelle de la tâche télémétrique"
        data_type: timestamp
        tests:
          - not_null
        
      - name: telemetry_quantity
        description: "Quantité télémétrique (toujours 1 par convention métier)"
        data_type: int64
        tests:
          - accepted_values:
              values: [1]
        
      - name: updated_at
        description: "Timestamp de dernière modification (pour incrément)"
        data_type: timestamp
        tests:
          - not_null
          
      - name: created_at
        description: "Timestamp de création"
        data_type: timestamp
        tests:
          - not_null
          
      - name: extracted_at
        description: "Timestamp d'extraction depuis Oracle"
        data_type: timestamp
        tests:
          - not_null
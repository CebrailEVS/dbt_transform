{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.0rc3", "generated_at": "2025-12-12T11:33:29.902645Z", "invocation_id": "2595904a-aec3-41ec-a1e9-f19d18d6d7af", "invocation_started_at": "2025-12-12T11:33:18.891790Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:22.908760Z", "completed_at": "2025-12-12T11:33:22.945237Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:22.988864Z", "completed_at": "2025-12-12T11:33:22.988884Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.129441499710083, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_gac__sinistres_sg", "compiled": true, "compiled_code": "-- TEST SELECTIVE RUN, test de fdp\n\n\n\nwith source as (\n    select * from `evs-datastack-prod`.`prod_raw`.`gac_suivi_sinistres_sg`\n),\n\ncleaned as (\n    select\n        -- Nettoyage des cha\u00eenes vides en NULL\n        nullif(trim(n_de_sinistre), '') as n_de_sinistre,\n        nullif(trim(type), '') as type_sinistre,\n        nullif(trim(r_f_rence_gac), '') as reference_gac,\n        nullif(trim(immat_), '') as immat,\n        nullif(trim(circonstance), '') as circonstance,\n        nullif(trim(cl_tur_), '') as cloture,\n        nullif(trim(description), '') as description,\n        nullif(trim(tiers), '') as tiers,\n        nullif(trim(resp_), '') as resp,\n        nullif(trim(matricule), '') as matricule,\n        nullif(trim(nom), '') as nom,\n        nullif(trim(pr_nom), '') as prenom,\n        nullif(trim(centre_de_co_ts), '') as centre_de_couts,\n        nullif(trim(genre_fiscal), '') as genre_fiscal,\n        nullif(trim(statut_actuel), '') as statut_actuel,\n        nullif(trim(remboursement), '') as remboursement,\n        nullif(trim(constat_envoy_l_assureur), '') as constat_envoye_assureur,\n        nullif(trim(franchise_sup_rieure_la_r_paration), '') as franchise_superieure_reparation,\n        nullif(trim(trajet_domicile_travail), '') as trajet_domicile_travail,\n        nullif(trim(accident_de_week_end), '') as accident_de_week_end,\n        nullif(trim(lieu_du_sinistre), '') as lieu_du_sinistre,\n        nullif(trim(entit_entit_1), '') as entite_entite_1,\n        nullif(trim(entit_entit_2), '') as entite_entite_2,\n        nullif(trim(entit_entit_3), '') as entite_entite_3,\n        nullif(trim(entit_entit_4), '') as entite_entite_4,\n\n        -- Mesure\n        CAST(co_t_assureur AS FLOAT64) AS cout_assureur,\n        CAST(auto_assurance AS FLOAT64) AS auto_assurance,\n        CAST(franchise AS FLOAT64) AS franchise,\n        CAST(co_t_global AS FLOAT64) AS cout_global,\n        CAST(co_t_client AS FLOAT64) AS cout_client,\n\n        -- Date\n        SAFE.PARSE_TIMESTAMP('%d/%m/%Y %H:%M:%S', NULLIF(TRIM(date), '')) AS date_sinistre,\n        SAFE.PARSE_TIMESTAMP('%d/%m/%Y %H:%M:%S', NULLIF(TRIM(date_de_cr_ation), '')) AS date_de_creation,\n\n        -- Date annexe\n        SAFE.PARSE_DATE('%d/%m/%Y', NULLIF(TRIM(date_de_passage_de_l_expert), '')) AS date_passage_expert,\n        SAFE.PARSE_DATE('%d/%m/%Y', NULLIF(TRIM(date_de_r_ception_du_constat), '')) AS date_reception_constat,\n        SAFE.PARSE_DATE('%d/%m/%Y', NULLIF(TRIM(date_d_envoi_du_constat_l_assureur), '')) AS date_envoie_constat_assureur,\n        SAFE.PARSE_DATE('%d/%m/%Y', NULLIF(TRIM(date_de_d_but_de_r_paration), '')) AS date_debut_reparation,\n        SAFE.PARSE_DATE('%d/%m/%Y', NULLIF(TRIM(date_de_fin_de_r_paration), '')) AS date_fin_reparation,\n        SAFE.PARSE_DATE('%d/%m/%Y', NULLIF(TRIM(date_de_remise_du_v_hicule_au_collaborateur_apr_s_r_paration), '')) AS date_remise_vehicule_collaborateur,\n        SAFE.PARSE_DATE('%d/%m/%Y', NULLIF(TRIM(date_de_cl_ture_du_sinistre), '')) AS date_cloture_sinistre,\n\n        -- M\u00e9tadonn\u00e9es Meltano\n        _sdc_source_file,\n        _sdc_source_lineno,\n        _sdc_received_at,\n        _sdc_batched_at,\n        _sdc_sequence\n        \n    from source\n)\n\nselect * from cleaned", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_gac__sinistres_sg`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:22.926020Z", "completed_at": "2025-12-12T11:33:22.963376Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.008197Z", "completed_at": "2025-12-12T11:33:23.008213Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.13360834121704102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_mssql_sage__f_collaborateur", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n    SELECT *\n    FROM `evs-datastack-prod`.`prod_raw`.`dbo_f_collaborateur`\n),\n\ncleaned_data AS (\n    SELECT\n        -- Champs principaux\n        CAST(JSON_VALUE(data, '$.CO_No') as INT64) AS co_no,\n        JSON_VALUE(data, '$.CO_Nom') AS co_nom,\n        JSON_VALUE(data, '$.CO_Prenom') AS co_prenom,\n        JSON_VALUE(data, '$.CO_Fonction') AS co_fonction,\n\n        -- Metadata\n        TIMESTAMP(JSON_VALUE(data, '$.cbCreation')) AS created_at,\n        TIMESTAMP(JSON_VALUE(data, '$.cbModification')) AS updated_at,\n        _sdc_extracted_at AS extracted_at\n\n    FROM source_data\n)\n\nSELECT *\nFROM cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_collaborateur`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:22.933680Z", "completed_at": "2025-12-12T11:33:22.988038Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.016397Z", "completed_at": "2025-12-12T11:33:23.016413Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.13722515106201172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_mssql_sage__f_comptet", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n    SELECT *\n    FROM `evs-datastack-prod`.`prod_raw`.`dbo_f_comptet`\n),\n\ncleaned_data AS (\n    SELECT\n        -- Champs principaux\n        JSON_VALUE(data, '$.CT_Num') AS ct_num,\n        JSON_VALUE(data, '$.CT_Intitule') AS ct_intitule,\n        CAST(JSON_VALUE(data, '$.CT_Type') AS INT64) AS ct_type,\n        JSON_VALUE(data, '$.CT_Contact') AS ct_contact,\n        JSON_VALUE(data, '$.CT_Adresse') AS ct_adresse,\n        JSON_VALUE(data, '$.CT_Complement') AS ct_complement,\n        JSON_VALUE(data, '$.CT_CodePostal') AS ct_codepostal,\n        JSON_VALUE(data, '$.CT_Ville') AS ct_ville,\n        JSON_VALUE(data, '$.CT_Pays') AS ct_pays,\n        JSON_VALUE(data, '$.CT_Siret') AS ct_siret,\n        JSON_VALUE(data, '$.CT_NumPayeur') AS ct_numpayeur,\n        CAST(JSON_VALUE(data, '$.CO_No') AS INT64) AS co_no,\n        JSON_VALUE(data, '$.CT_Telephone') AS ct_telephone,\n        JSON_VALUE(data, '$.CT_EMail') AS ct_email,\n\n        -- Champs avec espaces\n        JSON_VALUE(data, '$.\"CATEGORISATION NIV 1\"') AS categorisation_niv_1,\n        JSON_VALUE(data, '$.\"CATEGORISATION NIV 2\"') AS categorisation_niv_2,\n        JSON_VALUE(data, '$.\"CATEGORISATION NIV 3\"') AS categorisation_niv_3,\n        JSON_VALUE(data, '$.\"LIGNE DE SERVICE\"') AS ligne_de_service,\n        JSON_VALUE(data, '$.\"ANNEE ORIGINE\"') AS annee_origine,\n        JSON_VALUE(data, '$.\"CLIENT PERDU\"') AS client_perdu,\n\n        -- Champs divers\n        JSON_VALUE(data, '$.TYPOLOGIE') AS typologie,\n\n        -- Metadata\n        TIMESTAMP(JSON_VALUE(data, '$.cbCreation')) AS created_at,\n        TIMESTAMP(JSON_VALUE(data, '$.cbModification')) AS updated_at,\n        _sdc_extracted_at AS extracted_at\n\n    FROM source_data\n)\n\nSELECT *\nFROM cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_comptet`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:22.940138Z", "completed_at": "2025-12-12T11:33:22.997758Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.021977Z", "completed_at": "2025-12-12T11:33:23.021989Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.13917922973632812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_mssql_sage__f_docligne", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n    SELECT *\n    FROM `evs-datastack-prod`.`prod_raw`.`dbo_f_docligne`\n),\n\ncleaned_data AS (\n    SELECT\n        -- Identifiant unique de la ligne\n        CAST(JSON_VALUE(data, '$.DL_No') AS INT64) AS dl_no, -- PK\n        CAST(JSON_VALUE(data, '$.cbCO_No') AS INT64) AS cbco_no, -- FK pour table collaborateur\n\n        -- Champs principaux\n        JSON_VALUE(data, '$.CT_Num') AS ct_num,\n        JSON_VALUE(data, '$.DO_Piece') AS do_piece,\n        JSON_VALUE(data, '$.DL_Design') AS dl_design,\n        JSON_VALUE(data, '$.AR_Ref') AS ar_ref,\n\n        -- Dates & montants\n        TIMESTAMP(JSON_VALUE(data, '$.DO_Date')) AS do_date,\n        CAST(JSON_VALUE(data, '$.DL_Qte') AS FLOAT64) AS dl_qte,\n        CAST(JSON_VALUE(data, '$.DL_MontantHT') AS FLOAT64) AS dl_montant_ht,\n        CAST(JSON_VALUE(data, '$.DL_MontantTTC') AS FLOAT64) AS dl_montant_ttc,\n        CAST(JSON_VALUE(data, '$.DL_PrixUnitaire') AS FLOAT64) AS dl_prix_unitaire,\n\n        -- Metadata\n        TIMESTAMP(JSON_VALUE(data, '$.cbCreation')) AS created_at,\n        TIMESTAMP(JSON_VALUE(data, '$.cbModification')) AS updated_at,\n        _sdc_extracted_at AS extracted_at\n    FROM source_data\n)\n\nSELECT *\nFROM cleaned_data\n\n\n", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_docligne`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:22.952182Z", "completed_at": "2025-12-12T11:33:23.007299Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.024196Z", "completed_at": "2025-12-12T11:33:23.024211Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.14071369171142578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_mssql_sage__f_ecriturea", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`dbo_f_ecriturea`\n),\n\ncleaned_data as (\n    select\n        -- IDs et num\u00e9ro convertis en BIGINT\n        cast(cb_marq as int64) as cb_marq,\n        cast(ec_no as int64) as ec_no,\n        cast(n_analytique as int64) as n_analytique,\n        cast(ea_ligne as int64) as ea_ligne,\n\n        -- Colonnes texte\n        ca_num,\n        cb_createur,\n        cb_creation_user,\n\n        -- Colonnes num\u00e9riques avec gestion des valeurs nulles\n        ea_montant,\n        ea_quantite,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(cb_creation) as created_at,\n        timestamp(coalesce(cb_modification, cb_creation)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect *\nfrom cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturea`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:22.958533Z", "completed_at": "2025-12-12T11:33:23.008928Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.028451Z", "completed_at": "2025-12-12T11:33:23.028463Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.14181089401245117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_mssql_sage__f_ecriturec", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`dbo_f_ecriturec`\n),\n\ncleaned_data as (\n    select\n        -- Identifiants\n        cast(ec_no as int64) as ec_no,\n        cast(ec_no_link as int64) as ec_no_link,\n        cast(cb_marq as int64) as cb_marq,\n\n        -- Journal et comptes\n        jo_num,\n        cg_num,\n        ct_num,\n        ec_intitule,\n\n        -- Montants et sens\n        coalesce(ec_sens, 0) as ec_sens,\n        coalesce(ec_montant, 0.0) as ec_montant,\n        coalesce(ec_montant_regle, 0.0) as ec_montant_regle,\n        ec_devise,\n        n_devise,\n\n        -- Dates\n        timestamp(ec_date) as ec_date,\n        timestamp(jm_date) as jm_date,\n        ec_jour,\n        case when ec_echeance = '1753-01-01' then NULL else timestamp(ec_echeance) end as ec_echeance,\n        case when ec_date_rappro = '1753-01-01' then NULL else timestamp(ec_date_rappro) end as ec_date_rappro,\n        case when ec_date_regle = '1753-01-01' then NULL else timestamp(ec_date_regle) end as ec_date_regle,\n\n        -- M\u00e9tadonn\u00e9es\n        cb_createur,\n        cb_creation_user,\n        timestamp(cb_creation) as created_at,\n        timestamp(coalesce(cb_modification, cb_creation)) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nselect *\nfrom cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturec`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:22.968995Z", "completed_at": "2025-12-12T11:33:23.014575Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.029241Z", "completed_at": "2025-12-12T11:33:23.029253Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.1418144702911377, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_nesp_co__client", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`nespresso_base_client`\n    where third is not null\n),\n\nbase_client as (\n    select\n        -- IDs convertis en BIGINT\n        cast(third as int64) as third,\n\n        -- Colonnes texte\n        third_name,\n        third_adr_ln1,\n        third_adr_ln2,\n        third_post_code,\n        third_city,\n        third_status_descr, \n        segmentation_hypercare,\n        categorie_client,\n        region,\n        secteur,\n        code_lmb,\n        mb_descr,\n        code_mb,\n        siret,\n        nb_salaries,\n        order_placer_name,\n        order_placer_adr_ln1,\n        order_placer_post_code,\n        order_placer_city,\n        order_placer_phone,\n\n        -- Dates\n        safe_cast(club_dt_disp as timestamp) as club_dt_disp,\n        safe_cast(last_caps_ord_dt_disp as timestamp) as last_caps_ord_dt_disp,\n\n        -- Mesures\n        ns,\n        ns_n1,\n        ns_n_ytd,\n        ns_n1_ytd,\n        cast(caps as int64) as caps,\n        cast(caps_n1 as int64) as caps_n1,\n        cast(_caps_n_ytd as int64) as caps_n_ytd,\n        cast(caps_n1_ytd as int64) as caps_n1_ytd,\n        cast(caps_b2b as int64) as caps_b2b,\n        cast(caps_b2c as int64) as caps_b2c,\n        cast(caps_b2c_ytd_ as int64) as caps_b2c_ytd,\n        cast(ez as int64) as ez,\n        cast(ez_n_ytd as int64) as ez_n_ytd,\n        cast(ez_n1 as int64) as ez_n1,\n\n        -- Metadata\n        _smart_source_bucket,\n        _smart_source_file,\n        _smart_source_lineno,\n        _sdc_batched_at,\n        _sdc_received_at\n\n    from source_data\n)\n\nselect * from base_client", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_nesp_co__client`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:22.964835Z", "completed_at": "2025-12-12T11:33:23.015479Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.030514Z", "completed_at": "2025-12-12T11:33:23.030525Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.14539599418640137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_nesp_co__activite", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`nespresso_commerce_activite`\n),\n\nbase_activite as (\n    select\n        -- IDs convertis en BIGINT\n        cast(nullif(activity_id, '#') as int64) as activity_id,\n\n        -- ID STRING\n        nullif(unnamed_1, '#') as c4c_id_commercial,\n        cast(nullif(unnamed_12, '#') as int64) as c4c_id_main_account,\n        nullif(nessoft_id_main_account, '#') as nessoft_id_main_account,\n        cast(nullif(unnamed_22, '#') as int64) as c4c_id_campaign,\n        nullif(campaign_id_preceding_lead, '#') as campaign_id_preceding_lead,\n\n        -- Colonnes texte\n        nullif(employee_responsible, '#') as employee_responsible,\n        nullif(activity_type, '#') as activity_type,\n        nullif(phone_call, '#') as phone_call,\n        nullif(created_by_phone_call, '#') as created_by_phone_call,\n        nullif(appointment, '#') as appointment,\n        nullif(created_by_appointment, '#') as created_by_appointment,\n        nullif(activity_category, '#') as activity_category,\n        nullif(main_account, '#') as main_account,\n        nullif(role, '#') as role,\n        nullif(activity_unit, '#') as activity_unit,\n        nullif(activity_life_cycle_status, '#') as activity_life_cycle_status,\n        nullif(notes, '#') as notes,\n\n        -- Dates harmonis\u00e9es (converties en TIMESTAMP)\n        timestamp(nullif(start_date_phone_call, '#')) as start_date_phone_call,\n        timestamp(nullif(start_date_appointment, '#')) as start_date_appointment,\n        timestamp(nullif(start_date_task, '#')) as start_date_task,\n        nullif(calendar_month, '#') as calendar_month,\n\n        -- Metadata\n        timestamp(extracted_at) as extracted_at,\n        timestamp(file_date) as file_date,\n        source_file\n\n    from source_data\n)\n\nselect *\nfrom base_activite", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_nesp_co__activite`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:22.978727Z", "completed_at": "2025-12-12T11:33:23.017059Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.031263Z", "completed_at": "2025-12-12T11:33:23.031274Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.1452786922454834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_nesp_tech__articles", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`nespresso_technique_articles`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT (avec traitement des nan)\n        case \n            when lower(trim(cast(n_planning as string))) = 'nan' then null\n            else cast(n_planning as int64)\n        end as n_planning,\n        case \n            when lower(trim(cast(n_client as string))) = 'nan' then null\n            else cast(n_client as int64)\n        end as n_client,\n        case \n            when lower(trim(cast(n_site as string))) = 'nan' then null\n            else CAST(CAST(n_site AS FLOAT64) AS INT64)\n        end as n_site,\n\n        -- Colonnes texte (avec traitement \"nan\" -> NULL)\n        nullif(lower(trim(n_tech)), 'nan') as n_tech,\n        nullif(lower(trim(nom_tech)), 'nan') as nom_tech,\n        nullif(lower(trim(prenom_tech)), 'nan') as prenom_tech,\n        nullif(lower(trim(raison_sociale_client)), 'nan') as raison_sociale_client,\n        nullif(lower(trim(nom_site)), 'nan') as nom_site,\n        nullif(lower(trim(code_machine)), 'nan') as code_machine,\n        nullif(lower(trim(nom_machine)), 'nan') as nom_machine,\n        nullif(lower(trim(n_serie_machine)), 'nan') as num_serie_machine,\n        nullif(lower(trim(code_article)), 'nan') as code_article,\n        nullif(lower(trim(nom_article)), 'nan') as nom_article,\n\n        -- Mesure\n        cast(quantite as float64) as quantite_article,\n\n        -- Dates harmonis\u00e9es (converties en DATES, avec traitement \"NaT\" -> NULL)\n        case \n            when lower(trim(date)) in ('nat', 'nan') then null\n            else PARSE_DATE('%d/%m/%Y', date)\n        end as date_intervention,\n\n        -- Metadata\n        timestamp(extracted_at) as extracted_at,\n        source_file\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_nesp_tech__articles`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:22.973272Z", "completed_at": "2025-12-12T11:33:23.017799Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.034105Z", "completed_at": "2025-12-12T11:33:23.034121Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.1484386920928955, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_nesp_co__opportunite", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`nespresso_commerce_opportunite`\n),\n\nbase_opportunite as (\n    select\n        -- IDs convertis en BIGINT\n        cast(\n                case\n                    when opportunity = '#' then null\n                    when opportunity = 'Result' then null\n                    else opportunity\n                end\n            as int64) as opportunity_id,\n\n        -- ID STRING\n        nullif(unnamed_2, '#') as c4c_id_commercial,\n        cast(regexp_replace(nullif(unnamed_13, '#'), r'\\.0$', '') as int64) as c4c_id_account,\n        nullif(nessoft_id, '#') as nessoft_id_account,\n        cast(nullif(unnamed_8, '#') as int64) as c4c_id_campaign,\n\n        -- Colonnes texte\n        nullif(employee_responsible, '#') as employee_responsible,\n        nullif(created_by, '#') as created_by,\n        nullif(unnamed_6, '#') as opportunity_name,\n        nullif(campaign, '#') as campaign_name,\n        nullif(source, '#') as source,\n        nullif(account, '#') as account_name,\n        nullif(reason_for_status, '#') as reason_for_status,\n        nullif(sales_unit, '#') as sales_unit,\n        nullif(role_account, '#') as role_account,\n        nullif(lifecycle_status, '#') as lifecycle_status,\n\n        -- Mesures num\u00e9riques\n        cast(nullif(first_coffee_order, '#') as float64) as first_coffee_order,\n        cast(nullif(expected_value, '#') as float64) as expected_value,\n        cast(nullif(zeq_zenius_equivalent, '#') as float64) as zeq_zenius_equivalent,\n        cast(replace(replace(trim(nullif(chance_of_success, '#')), '%', ''), ',', '.') as float64) as chance_of_success,\n        cast(nullif(machines, '#') as int64) as machines_opportunity,\n\n        -- Dates harmonis\u00e9es (converties en TIMESTAMP)\n        timestamp(nullif(created_on, '#')) as created_on,\n        timestamp(nullif(close_date, '#')) as close_date,\n\n        -- Metadata\n        timestamp(extracted_at) as extracted_at,\n        timestamp(file_date) as file_date,\n        source_file\n\n    from source_data\n)\n\nselect *\nfrom base_opportunite\nwhere opportunity_id is not null", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_nesp_co__opportunite`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:22.983265Z", "completed_at": "2025-12-12T11:33:23.020950Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.035629Z", "completed_at": "2025-12-12T11:33:23.035642Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.13806533813476562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_nesp_tech__interventions", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`nespresso_technique_interventions`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT (avec traitement des nan)\n        case \n            when lower(trim(cast(n_planning as string))) = 'nan' then null\n            else cast(n_planning as int64)\n        end as n_planning,\n        case \n            when lower(trim(cast(n_client as string))) = 'nan' then null\n            else cast(n_client as int64)\n        end as n_client,\n        case \n            when lower(trim(cast(n_site as string))) = 'nan' then null\n            else CAST(CAST(n_site AS FLOAT64) AS INT64)\n        end as n_site,\n\n        -- Colonnes texte (avec traitement \"nan\" -> NULL)\n        nullif(lower(trim(n_tech)), 'nan') as n_tech,\n        nullif(lower(trim(nom_tech)), 'nan') as nom_tech,\n        nullif(lower(trim(prenom_tech)), 'nan') as prenom_tech,\n        nullif(lower(trim(raison_sociale_client)), 'nan') as raison_sociale_client,\n        nullif(lower(trim(adresse_client)), 'nan') as adresse_client,\n        nullif(lower(trim(code_postal_client)), 'nan') as code_postal_client,\n        nullif(lower(trim(ville_client)), 'nan') as ville_client,\n        nullif(lower(trim(nom_site)), 'nan') as nom_site,\n        nullif(lower(trim(adresse_site)), 'nan') as adresse_site,\n        nullif(lower(trim(code_postal_site)), 'nan') as code_postal_site,\n        nullif(lower(trim(ville_site)), 'nan') as ville_site,\n        nullif(lower(trim(code_machine)), 'nan') as code_machine,\n        nullif(lower(trim(nom_machine)), 'nan') as nom_machine,\n        nullif(lower(trim(n_serie_machine)), 'nan') as num_serie_machine,\n        nullif(lower(trim(type)), 'nan') as type,\n        nullif(lower(trim(etat_inter)), 'nan') as etat_intervention,\n        nullif(lower(trim(observations)), 'nan') as observations,\n        nullif(lower(trim(agency)), 'nan') as agency,\n        nullif(lower(trim(repair_code_1)), 'nan') as repair_code_1,\n        nullif(lower(trim(repair_code_2)), 'nan') as repair_code_2,\n        nullif(lower(trim(repair_code_3)), 'nan') as repair_code_3,\n        nullif(lower(trim(failure_code)), 'nan') as failure_code,\n        nullif(lower(trim(consignes)), 'nan') as consignes,\n\n        -- Dates harmonis\u00e9es (converties en TIMESTAMP, avec traitement \"NaT\" et dates invalides -> NULL)\n        case \n            when lower(trim(date_heure_debut)) in ('nat', 'nan') then null\n            when date_heure_debut like '01/01/0001%' then null\n            else TIMESTAMP(date_heure_debut)\n        end as date_heure_debut,\n        case \n            when lower(trim(date_heure_fin)) in ('nat', 'nan') then null\n            when date_heure_fin like '01/01/0001%' then null\n            else TIMESTAMP(date_heure_fin)\n        end as date_heure_fin,\n        case \n            when lower(trim(creation_date)) in ('nat', 'nan') then null\n            when creation_date like '01/01/0001%' then null\n            else TIMESTAMP(creation_date)\n        end as creation_date,\n        case \n            when lower(trim(pickup_date)) in ('nat', 'nan') then null\n            when pickup_date like '01/01/0001%' then null\n            else TIMESTAMP(pickup_date)\n        end as pickup_date,\n        case \n            when lower(trim(date_planning_nomadrepair)) in ('nat', 'nan') then null\n            when date_planning_nomadrepair like '01/01/0001%' then null\n            else TIMESTAMP(date_planning_nomadrepair)\n        end as date_planning_nomadrepair,\n\n        -- Metadata\n        timestamp(extracted_at) as extracted_at,\n        source_file\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_nesp_tech__interventions`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:22.989681Z", "completed_at": "2025-12-12T11:33:23.023237Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.039265Z", "completed_at": "2025-12-12T11:33:23.039276Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.13851261138916016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__company", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_company`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idcompany as int64) as idcompany,\n        cast(company_idcompany as int64) as company_idcompany,\n        cast(idcompany_type as int64) as idcompany_type,\n        cast(idcontact_creation as int64) as idcontact_creation,\n        cast(idcontact_modification as int64) as idcontact_modification,\n        \n        -- Colonnes texte\n        code,\n        code_status_record,\n        name,\n        siret,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:22.993717Z", "completed_at": "2025-12-12T11:33:23.022621Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.036528Z", "completed_at": "2025-12-12T11:33:23.036539Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.13991403579711914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__company_has_location", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_company_has_location`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlocation as int64) as idlocation,\n        cast(idcompany as int64) as idcompany,\n        cast(idlocation_type as int64) as idlocation_type,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_has_location`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:22.998488Z", "completed_at": "2025-12-12T11:33:23.024945Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.040034Z", "completed_at": "2025-12-12T11:33:23.040045Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.14092397689819336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__company_type", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_company_type`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idcompany_type as int64) as idcompany_type,\n        \n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_type`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.003461Z", "completed_at": "2025-12-12T11:33:23.027823Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.043399Z", "completed_at": "2025-12-12T11:33:23.043416Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.14046001434326172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__contact", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_contact`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idcontact as int64) as idcontact,\n        cast(idcompany as int64) as idcompany,\n        \n        -- Colonnes texte\n        code,\n        first_name,\n        last_name,\n        email,\n        name,\n        mobile,\n        phone,\n        qualite,\n        code_status_record,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contact`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.009542Z", "completed_at": "2025-12-12T11:33:23.029929Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.048534Z", "completed_at": "2025-12-12T11:33:23.048550Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.14214873313903809, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__contract", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select\n        cast(idcontract as int64) as idcontract,\n        idcontract_type,\n        idcompany_self,\n        idcompany_financial,\n        idcompany_peer,\n        idcontact_creation,\n        idcontact_modification,\n        code,\n        name,\n        code_status_record,\n        xml,\n        original_start_date,\n        original_end_date,\n        current_end_date,\n        termination_date,\n        creation_date,\n        modification_date,\n        _sdc_extracted_at,\n        _sdc_deleted_at\n    from `evs-datastack-prod`.`prod_raw`.`evs_contract`\n),\n\n\nparsed_data as (\n    select\n        cast(idcontract as int64) as idcontract,\n        \n        -- nombre_collab \u2192 conversion en entier\n        cast(nullif(trim(nombre_collab), '') as int64) as nombre_collab,\n\n        -- garder la valeur brute telle quelle\n        trim(engagement) as engagement_raw,\n\n        -- version nettoy\u00e9e num\u00e9rique\n        case\n            when upper(trim(engagement)) = 'AUCUN' then 0\n            else cast(\n                regexp_replace(regexp_extract(engagement, r'[\\d\\s]+'), r'\\s+', '') as int64\n            )\n        end as engagement_clean,\n\n        timestamp(extracted_at) as parsed_extracted_at\n    from `evs-datastack-prod`.`prod_raw`.`evs_contract_parsed`\n),\n\ncleaned_data as (\n    select\n        -- Colonnes de evs_contract\n        cast(c.idcontract as int64) as idcontract,\n        cast(c.idcontract_type as int64) as idcontract_type,\n        cast(c.idcompany_self as int64) as idcompany_self,\n        cast(c.idcompany_financial as int64) as idcompany_financial,\n        cast(c.idcompany_peer as int64) as idcompany_peer,\n        cast(c.idcontact_creation as int64) as idcontact_creation,\n        cast(c.idcontact_modification as int64) as idcontact_modification,\n        \n        c.code,\n        c.name,\n        c.code_status_record,\n        -- Colonnes enrichies depuis evs_contract_parsed\n        p.nombre_collab,\n        p.engagement_raw,\n        p.engagement_clean,\n\n        timestamp(c.original_start_date) as original_start_date,\n        timestamp(c.original_end_date) as original_end_date,\n        timestamp(c.current_end_date) as current_end_date,\n        timestamp(c.termination_date) as termination_date,\n\n        timestamp(p.parsed_extracted_at) as parsed_extracted_at,\n        timestamp(c.creation_date) as created_at,\n        timestamp(coalesce(c.modification_date, c.creation_date)) as updated_at,\n        timestamp(c._sdc_extracted_at) as extracted_at,\n        timestamp(c._sdc_deleted_at) as deleted_at,\n\n    from source_data c\n    left join parsed_data p using (idcontract)\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contract`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.089939Z", "completed_at": "2025-12-12T11:33:23.117376Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.151602Z", "completed_at": "2025-12-12T11:33:23.151623Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12900876998901367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__device", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_device`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(iddevice as int64) as iddevice,\n        cast(device_iddevice as int64) as device_iddevice,\n        cast(iddevice_type as int64) as iddevice_type,\n        cast(idmodel as int64) as idmodel,\n        cast(idcompany_customer as int64) as idcompany_customer,\n        cast(idcompany_supplier as int64) as idcompany_supplier,\n        cast(idcompany_owner as int64) as idcompany_owner,\n        cast(idcontact_creation as int64) as idcontact_creation,\n        cast(idcontact_modification as int64) as idcontact_modification,\n        cast(idlocation as int64) as idlocation,\n        \n        -- Colonnes texte\n        code,\n        name,\n        serial,\n        code_status_record,\n\n        -- Date li\u00e9e \u00e0 la machine\n        timestamp(last_installation_date) as last_installation_date,\n        timestamp(purchase_date) as purchase_date,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.098438Z", "completed_at": "2025-12-12T11:33:23.128629Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.174457Z", "completed_at": "2025-12-12T11:33:23.174473Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.12392187118530273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idlabel_family as int64) as idlabel_family,\n        \n        -- Colonnes texte\n        code,\n\n        -- Bolean\n        cast(system as boolean) as is_system,\n        cast(enabled as boolean) as is_enabled,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.107440Z", "completed_at": "2025-12-12T11:33:23.143029Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.182325Z", "completed_at": "2025-12-12T11:33:23.182339Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.12403750419616699, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label_family", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label_family`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel_family as int64) as idlabel_family,\n        \n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.112752Z", "completed_at": "2025-12-12T11:33:23.152334Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.187097Z", "completed_at": "2025-12-12T11:33:23.187109Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.12439560890197754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label_has_company", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label_has_company`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idcompany as int64) as idcompany,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_company`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.119888Z", "completed_at": "2025-12-12T11:33:23.175265Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.193394Z", "completed_at": "2025-12-12T11:33:23.193407Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.12603998184204102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label_has_contract", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label_has_contract`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idcontract as int64) as idcontract,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_contract`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.123840Z", "completed_at": "2025-12-12T11:33:23.175916Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.194114Z", "completed_at": "2025-12-12T11:33:23.194125Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.12735414505004883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label_has_device", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label_has_device`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(iddevice as int64) as iddevice,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_device`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.129350Z", "completed_at": "2025-12-12T11:33:23.180749Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.195461Z", "completed_at": "2025-12-12T11:33:23.195473Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.12799715995788574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label_has_product", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label_has_product`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idproduct as int64) as idproduct,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.139064Z", "completed_at": "2025-12-12T11:33:23.182996Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.197507Z", "completed_at": "2025-12-12T11:33:23.197523Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.12792587280273438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label_has_task", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label_has_task`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idtask as int64) as idtask,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.135121Z", "completed_at": "2025-12-12T11:33:23.181686Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.196169Z", "completed_at": "2025-12-12T11:33:23.196180Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.1319582462310791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label_has_resources", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label_has_resources`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idresources as int64) as idresources,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_resources`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.147736Z", "completed_at": "2025-12-12T11:33:23.186394Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.201160Z", "completed_at": "2025-12-12T11:33:23.201171Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.1271193027496338, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__product", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_product`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idproduct as int64) as idproduct,\n        cast(idproduct_type as int64) as idproduct_type,\n        cast(idcompany_supplier as int64) as idcompany_supplier,\n        cast(idcontact_creation as int64) as idcontact_creation,\n        cast(idcontact_modification as int64) as idcontact_modification,\n        \n        -- Colonnes texte\n        code,\n        name,\n        commercial_name,\n        code_status_record,\n\n        -- Colonnes num\u00e9riques\n        cast(purchase_unit_price as float64) as purchase_unit_price,\n        cast(average_purchase_price as float64) as average_purchase_price,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.143643Z", "completed_at": "2025-12-12T11:33:23.188191Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.204024Z", "completed_at": "2025-12-12T11:33:23.204036Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.1359117031097412, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__location", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_location`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlocation as int64) as idlocation,\n        \n        -- Colonnes texte\n        name,\n        access_info,\n        address1,\n        address2,\n        address3,\n        postal,\n        city,\n        country,\n        code,\n        code_status_record,\n        longitude,\n        latitude,\n        altitude,\n\n        -- Dates et timestamps\n        timestamp(localisation_date) as localisation_date,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.162104Z", "completed_at": "2025-12-12T11:33:23.189983Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.205307Z", "completed_at": "2025-12-12T11:33:23.205318Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.13127422332763672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__resources_type", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_resources_type`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idresources_type as int64) as idresources_type,\n        \n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources_type`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.152990Z", "completed_at": "2025-12-12T11:33:23.188980Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.204648Z", "completed_at": "2025-12-12T11:33:23.204683Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.13453435897827148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__product_type", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_product_type`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idproduct_type as int64) as idproduct_type,\n        \n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at, \n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product_type`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.156754Z", "completed_at": "2025-12-12T11:33:23.192751Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.206682Z", "completed_at": "2025-12-12T11:33:23.206693Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.136993408203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__resources", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_resources`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idresources as int64) as idresources,\n        cast(idresources_type as int64) as idresources_type,\n        cast(resources_idresources as int64) as resources_idresources,\n        cast(idcompany as int64) as idcompany,\n        cast(idcompany_storehouse as int64) as idcompany_storehouse,\n        cast(idlocation as int64) as idlocation,\n        cast(idcontact as int64) as idcontact,\n        cast(idcontact_creation as int64) as idcontact_creation,\n        cast(idcontact_modification as int64) as idcontact_modification,\n        \n        -- Colonnes texte\n        code,\n        name,\n        code_status_record,\n\n        -- Colonnes num\u00e9riques\n        cast(cost as float64) as cost,\n    \n        -- Timestamps harmonis\u00e9s\n        timestamp(arrival) as arrival,\n        timestamp(departure) as departure,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.166449Z", "completed_at": "2025-12-12T11:33:23.194700Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.209761Z", "completed_at": "2025-12-12T11:33:23.209772Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.13239526748657227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__task", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_task`\n),\n\ncleaned_data as (\n    select\n        -- IDs (cl\u00e9s primaires et \u00e9trang\u00e8res)\n        cast(idtask as int64) as idtask,\n        cast(task_idtask as int64) as task_idtask,\n        cast(idtask_type as int64) as idtask_type,\n        cast(idtask_status as int64) as idtask_status,\n        cast(iddevice as int64) as iddevice,\n        cast(idcompany_peer as int64) as idcompany_peer,\n        cast(idlocation as int64) as idlocation,\n        cast(idcontact as int64) as idcontact,\n        cast(idproduct_source as int64) as idproduct_source,\n        cast(idproduct_destination as int64) as idproduct_destination,\n\n        -- Colonnes texte et types\n        type_product_source,\n        type_product_destination,\n\n        -- Colonne num\u00e9rique\n        spantime as spantime, -- dur\u00e9e de la t\u00e2che en minute\n        CAST(code_status_record AS STRING) as code_status_record, -- status record (1 = valid\u00e9, 0 ou -1 possiblement inactif/desactiv\u00e9 : \u00e0 confirmer)\n        \n        -- Date de la tache\n        timestamp(real_start_date) as real_start_date,\n        timestamp(real_end_date) as real_end_date,\n        timestamp(planed_start_date) as planed_start_date,\n        timestamp(planed_end_date) as planed_end_date,\n        \n        -- Timestamps harmonis\u00e9s\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nSELECT * FROM cleaned_data\n\nWHERE\n    (\n        updated_at > (\n            SELECT MAX(updated_at)\n            FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n        )\n        OR updated_at >= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 7 DAY)\n    )\n", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.176728Z", "completed_at": "2025-12-12T11:33:23.196823Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.214492Z", "completed_at": "2025-12-12T11:33:23.214508Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.13347816467285156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__task_status", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_task_status`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idtask_status as int64) as idtask_status,\n\n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.256625Z", "completed_at": "2025-12-12T11:33:23.282984Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.315594Z", "completed_at": "2025-12-12T11:33:23.315615Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.13122153282165527, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__task_type", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_task_type`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idtask_type as int64) as idtask_type,\n\n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_type`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.263143Z", "completed_at": "2025-12-12T11:33:23.285765Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.330021Z", "completed_at": "2025-12-12T11:33:23.330040Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.13127517700195312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu_gcs__stock_theorique", "compiled": true, "compiled_code": "\n\nSELECT\n    CAST(id_entity AS INT64) AS id_entity,  \n    entity_name,\n    entity_type,\n    CAST(DATE_SYSTEM AS TIMESTAMP) AS date_system,\n    resources_code,\n    code_source AS product_code,\n    code_name AS product_name,\n    SAFE.PARSE_TIMESTAMP('%d/%m/%Y %H:%M', DATE_INVENTAIRE) AS date_inventaire,\n    CAST(STOCK_INVENTAIRE AS NUMERIC) AS stock_inventaire,\n    CAST(PLUS AS NUMERIC) AS plus,\n    CAST(MOINS AS NUMERIC) AS moins,\n    CAST(STOCK_AT_DATE AS NUMERIC) AS stock_at_date,\n    CAST(DPA AS NUMERIC) AS dpa,\n    CAST(PUMP AS NUMERIC) AS pump,\n    CAST(PURCHASE_PRICE AS NUMERIC) AS purchase_price,\n    CAST(extracted_at AS TIMESTAMP) AS extracted_at,\n    row_count,\n    PARSE_DATETIME('%Y_%m_%d_%H%M', REGEXP_EXTRACT(_FILE_NAME, r'(\\d{4}_\\d{2}_\\d{2}_\\d{4})')) AS file_datetime\nFROM `evs-datastack-prod`.`prod_raw`.`ext_gcs_oracle_neshu__stock_theorique`", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu_gcs__stock_theorique`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.273562Z", "completed_at": "2025-12-12T11:33:23.310947Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.347728Z", "completed_at": "2025-12-12T11:33:23.347743Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.12285208702087402, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__clients", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`yuman_clients`\n),\n\nbase_clients as (\n    select\n        id as client_id,\n        partner_id, \n        code as client_code,\n        name as client_name,\n        address as client_address,       \n        active as is_active,\n        SAFE.PARSE_JSON(_embed_fields) as embed_fields,\n        TIMESTAMP(created_at) as created_at,\n        TIMESTAMP(updated_at) as updated_at,\n        TIMESTAMP(_sdc_extracted_at) as extracted_at,\n        TIMESTAMP(_sdc_deleted_at) as deleted_at\n    from source_data\n    where id is not null\n),\n\njson_parsed as (\n    select\n        client_id,\n        client_code,\n        client_name,\n        updated_at,\n        JSON_EXTRACT_SCALAR(item, '$.name') as field_name,\n        JSON_EXTRACT_SCALAR(item, '$.value') as field_value\n    from base_clients,\n    UNNEST(JSON_EXTRACT_ARRAY(embed_fields)) as item\n),\n\nextracted_fields as (\n    select\n        client_id,\n        client_code,\n        client_name,\n        updated_at,\n        field_name,\n        field_value\n    from json_parsed\n    where field_name is not null\n),\n\npivoted as (\n    select\n        bc.client_id,\n        bc.partner_id,\n        bc.client_code,\n        bc.client_name,\n        MAX(IF(ef.field_name = 'CATEGORIE CLIENT EVS', ef.field_value, NULL)) as client_category,\n        bc.client_address,\n        bc.is_active,\n        bc.created_at,\n        bc.updated_at,\n        bc.extracted_at,\n        bc.deleted_at\n    from base_clients bc\n    left join extracted_fields ef on ef.client_id = bc.client_id\n    group by \n        bc.client_id, bc.client_code, bc.client_name, bc.client_address,\n        bc.partner_id, bc.is_active,\n        bc.created_at, bc.updated_at, bc.extracted_at, bc.deleted_at\n),\n\n-- Ajout du nom du partenaire via self join\nwith_partner_name as (\n    select \n        p.*,\n        partner.client_name as partner_name\n    from pivoted p\n    left join pivoted partner on p.partner_id = partner.client_id\n),\n\nfinal as (\n    select * from with_partner_name\n    where client_id is not null\n)\n--Titre chang\u00e9\nselect \n    client_id,\n    partner_id,\n    partner_name,\n    client_code,\n    client_name,\n    client_category,\n    client_address,\n    is_active,\n    created_at,\n    updated_at,\n    extracted_at,\n    deleted_at\nfrom final", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__clients`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.279192Z", "completed_at": "2025-12-12T11:33:23.316322Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.349309Z", "completed_at": "2025-12-12T11:33:23.349322Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.12160921096801758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__materials", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`yuman_materials`\n),\n\ncleaned_materials as (\n    select\n        id as material_id,\n        site_id,\n        category_id, \n        name as material_name,\n        serial_number as material_serial_number,\n        brand as material_brand,\n        description as material_description,\n        in_service_date as material_in_service_date,\n\n        (\n          select JSON_VALUE(elem, '$.value')\n          from UNNEST(JSON_QUERY_ARRAY(_embed_fields)) elem\n          where JSON_VALUE(elem, '$.name') = 'LOCALISATION'\n        ) as material_localisation,\n\n        timestamp(created_at) as created_at,\n        timestamp(updated_at) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n    where id is not null\n)\n\nselect * from cleaned_materials", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.286406Z", "completed_at": "2025-12-12T11:33:23.335529Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.355409Z", "completed_at": "2025-12-12T11:33:23.355421Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.12244153022766113, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__materials_categories", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`yuman_material_categories`\n),\n\ncleaned_material_categories as (\n    select\n        id as category_id,\n        name as category_name,   \n        TIMESTAMP(created_at) as created_at,\n        TIMESTAMP(updated_at) as updated_at,\n        TIMESTAMP(_sdc_extracted_at) as extracted_at,\n        TIMESTAMP(_sdc_deleted_at) as deleted_at\n    from source_data\n    where id is not null\n)\n\nselect * from cleaned_material_categories", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__materials_categories`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.296142Z", "completed_at": "2025-12-12T11:33:23.340397Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.359409Z", "completed_at": "2025-12-12T11:33:23.359420Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.12459540367126465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__purchase_orders", "compiled": true, "compiled_code": "\n\nwith src as (\n  select * from `evs-datastack-prod`.`prod_raw`.`yuman_purchase_orders`\n),\n\n-- Normalisation / typage des champs ent\u00eate\npo_base as (\n  select\n    SAFE_CAST(id AS INT64)                            as purchase_order_id,\n    number                                           as purchase_order_number,\n    status                                           as purchase_order_satus,\n    invoice_status                              as purchase_order_invoice_status,\n    title                                           as purchase_order_title,\n    description                                      as order_description,\n    TIMESTAMP(creation_date)                         as creation_date,\n    TIMESTAMP(expected_delivery_date)                as expected_delivery_date,\n    TIMESTAMP(created_at)                             as order_created_at,\n    TIMESTAMP(updated_at)                             as order_updated_at,\n    SAFE_CAST(vat AS FLOAT64)                        as order_vat,\n    SAFE_CAST(subtotal AS FLOAT64)                   as order_subtotal,\n    SAFE_CAST(total AS FLOAT64)                      as order_total,\n    SAFE_CAST(manager_id AS INT64)                   as manager_id,\n    SAFE_CAST(quote_id AS INT64)                     as quote_id,\n    SAFE_CAST(supplier_id AS INT64)                  as supplier_id,\n    delivery_address,\n    TIMESTAMP(_sdc_extracted_at)                     as extracted_at,\n    SAFE_CAST(_sdc_sequence AS INT64)                as sdc_sequence,\n    lines\n  from src\n  where id is not null\n),\n\n-- Explode JSON array 'lines' : chaque item devient une ligne\nlines_exploded as (\n  select\n    pb.*,\n    item\n  from po_base pb,\n  unnest(\n    -- JSON_EXTRACT_ARRAY ne supporte pas nulls ; SAFE.PARSE_JSON \u00e9vite les erreurs\n    COALESCE(JSON_EXTRACT_ARRAY(SAFE.PARSE_JSON(lines)), []) \n  ) as item\n),\n\n-- Extraction des champs de chaque item JSON\nline_parsed as (\n  select\n    purchase_order_id,\n    purchase_order_number,\n    purchase_order_satus,\n    purchase_order_invoice_status,\n    purchase_order_title,\n    order_description,\n    creation_date,\n    expected_delivery_date,\n    order_created_at,\n    order_updated_at,\n    order_vat,\n    order_subtotal,\n    order_total,\n    manager_id,\n    quote_id,\n    supplier_id,\n    delivery_address,\n    extracted_at,\n    sdc_sequence,\n\n    -- champs ligne\n    SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.id') AS INT64)                 as purchase_order_line_id,\n    JSON_EXTRACT_SCALAR(item, '$.reference')                             as line_reference,\n    JSON_EXTRACT_SCALAR(item, '$.description')                           as line_description,\n    SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.quantity') AS FLOAT64)        as quantity,\n    JSON_EXTRACT_SCALAR(item, '$.unit')                                  as unit,\n    SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.quantity_received') AS FLOAT64) as quantity_received,\n    SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.unit_price') AS FLOAT64)      as unit_price,\n    SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.vat') AS FLOAT64)             as line_vat,\n    SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.subtotal') AS FLOAT64)        as line_subtotal,\n    SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.product_id') AS INT64)        as product_id,\n    SAFE_DIVIDE(\n      SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.subtotal_received.cents') AS INT64), \n      100\n    ) as subtotal_received_eur,\n    JSON_EXTRACT_SCALAR(item, '$.subtotal_received.currency_iso')        as subtotal_received_currency,\n    TIMESTAMP(JSON_EXTRACT_SCALAR(item, '$.created_at'))                 as line_created_at,\n    TIMESTAMP(JSON_EXTRACT_SCALAR(item, '$.updated_at'))                 as line_updated_at\n  from lines_exploded\n)\n\nselect\n  -- ent\u00eate commande (utile pour jointures et analyses)\n  purchase_order_id,\n  purchase_order_number,\n  purchase_order_satus,\n  purchase_order_invoice_status,\n  purchase_order_title,\n  order_description,\n  creation_date,\n  expected_delivery_date,\n  order_created_at,\n  order_updated_at,\n  order_vat,\n  order_subtotal,\n  order_total,\n  manager_id,\n  quote_id,\n  supplier_id,\n  delivery_address,\n\n  -- champs ligne (une ligne par item)\n  purchase_order_line_id,\n  line_reference,\n  line_description,\n  quantity,\n  unit,\n  quantity_received,\n  unit_price,\n  line_vat,\n  line_subtotal,\n  product_id,\n  subtotal_received_eur,\n  subtotal_received_currency,\n  line_created_at,\n  line_updated_at,\n\n  -- m\u00e9tadatas\n  extracted_at,\n  sdc_sequence\n\nfrom line_parsed\n-- si certaines commandes ont lines null on peut garder une ligne (optionnel) :\nwhere purchase_order_line_id is not null", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__purchase_orders`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.302031Z", "completed_at": "2025-12-12T11:33:23.346366Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.360832Z", "completed_at": "2025-12-12T11:33:23.360848Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.12419605255126953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__sites", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * from `evs-datastack-prod`.`prod_raw`.`yuman_sites`\n),\n\nextracted_postal_code as (\n    select\n        *,\n        (\n            select JSON_EXTRACT_SCALAR(value, '$.value')\n            from unnest(JSON_EXTRACT_ARRAY(_embed_fields)) as value\n            where JSON_EXTRACT_SCALAR(value, '$.name') = 'CODE POSTAL'\n            limit 1\n        ) as raw_code_postal\n    from source_data\n),\n\ncleaned as (\n    select\n        id as site_id,\n        client_id,\n        agency_id,\n        code as site_code,\n        name as site_name,\n        address as site_address,\n        -- Nettoyage du code postal : suppression du \".0\", puis cast en texte\n        regexp_replace(raw_code_postal, r'\\.0$', '') as site_postal_code,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at,\n        cast(_sdc_extracted_at as timestamp) as extracted_at,\n        cast(_sdc_deleted_at as timestamp) as deleted_at\n    from extracted_postal_code\n)\n\nselect * from cleaned", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.290980Z", "completed_at": "2025-12-12T11:33:23.347014Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.361498Z", "completed_at": "2025-12-12T11:33:23.361513Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.13017058372497559, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__products", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`yuman_products`\n),\n\ncleaned_products as (\n    select\n        id as product_id,\n        reference as product_code,\n        designation as product_name,\n        product_type as product_type,\n        brand as product_brand,\n        unit as product_unit,\n        purchase_price as product_purchase_price,\n        sale_price as product_sale_price,    \n        active as is_active,\n        TIMESTAMP(created_at) as created_at,\n        TIMESTAMP(updated_at) as updated_at,\n        TIMESTAMP(_sdc_extracted_at) as extracted_at,\n        TIMESTAMP(_sdc_deleted_at) as deleted_at\n    from source_data\n    where id is not null\n)\n\nselect * from cleaned_products", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__products`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.305972Z", "completed_at": "2025-12-12T11:33:23.348388Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.364790Z", "completed_at": "2025-12-12T11:33:23.364801Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.12926673889160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__storehouses", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`yuman_storehouses`\n),\n\ncleaned_storehouses as (\n    select\n        id as storehouses_id,\n        name as storehouses_name,\n        address as storehouses_address,\n        cast(_sdc_extracted_at as timestamp) as extracted_at,\n        cast(null as timestamp) as deleted_at\n    from source_data\n)\n\nselect *\nfrom cleaned_storehouses\n\n\n\nunion all\n\n-- lignes supprim\u00e9es depuis la source\nselect\n    s.storehouses_id,\n    s.storehouses_name,\n    s.storehouses_address,\n    s.extracted_at,\n    current_timestamp() as deleted_at\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__storehouses` s\nleft join cleaned_storehouses c\non s.storehouses_id = c.storehouses_id\nwhere c.storehouses_id is null\n\n", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__storehouses`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.311644Z", "completed_at": "2025-12-12T11:33:23.352353Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.368432Z", "completed_at": "2025-12-12T11:33:23.368447Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.12720775604248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__users", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * from `evs-datastack-prod`.`prod_raw`.`yuman_users`\n),\n\ncleaned_users as (\n    select\n        id as user_id,\n        manager_id, -- ID du manager de l'utilisateur\n        name as user_name,\n        email as user_email,\n        user_type as user_type,\n        phone as user_phone,\n        manager_as_technician as is_manager_as_technician,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at,\n        cast(_sdc_extracted_at as timestamp) as extracted_at,\n        cast(_sdc_deleted_at as timestamp) as deleted_at\n    from source_data\n)\n\nselect * from cleaned_users", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__users`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.326166Z", "completed_at": "2025-12-12T11:33:23.353901Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.369264Z", "completed_at": "2025-12-12T11:33:23.369276Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.12215542793273926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__workorder_products", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`yuman_workorders`\n),\n\nworkorder_products_unnested as (\n    select\n        wo.id as workorder_id,\n        cast(json_extract_scalar(product, '$.id') as int64) as workorder_product_id,\n        cast(json_extract_scalar(product, '$.product_id') as int64) as product_id,\n        json_extract_scalar(product, '$.product_reference') as product_reference,\n        json_extract_scalar(product, '$.product_designation') as product_designation,\n        cast(json_extract_scalar(product, '$.quantity') as float64) as product_quantity,\n        timestamp(json_extract_scalar(product, '$.created_at')) as product_created_at,\n        timestamp(json_extract_scalar(product, '$.updated_at')) as product_updated_at\n    from source_data wo,\n    unnest(json_extract_array(wo._embed_products)) as product\n),\n\nfinal as (\n    select\n        workorder_product_id,\n        workorder_id,\n        product_id,\n        product_reference,\n        product_designation,\n        product_quantity,\n        product_created_at,\n        product_updated_at\n    from workorder_products_unnested\n)\n\nselect * from final", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.316994Z", "completed_at": "2025-12-12T11:33:23.356086Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.370748Z", "completed_at": "2025-12-12T11:33:23.370759Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.13019275665283203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__workorder_demands", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`yuman_workorder_demands`\n),\n\ncleaned_workorder_demdands as (\n    select\n        id as demand_id,\n        workorder_id,\n        material_id,\n        site_id,\n        client_id,\n        user_id,\n        cast(contact_id as int64) as contact_id,\n        category_id as demand_category_id,\n        description as demand_description,\n        status as demand_status,\n        reject_comment as demand_reject_comment,\n        TIMESTAMP(created_at) as created_at,\n        TIMESTAMP(updated_at) as updated_at,\n        TIMESTAMP(_sdc_extracted_at) as extracted_at,\n        TIMESTAMP(_sdc_deleted_at) as deleted_at\n    from source_data\n    where id is not null\n)\n\nselect * from cleaned_workorder_demdands", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.322153Z", "completed_at": "2025-12-12T11:33:23.354708Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.369979Z", "completed_at": "2025-12-12T11:33:23.369989Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.12795448303222656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__workorder_demands_categories", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * from `evs-datastack-prod`.`prod_raw`.`yuman_workorder_demands_categories`\n),\n\ncleaned_categories as (\n    select\n        id as demand_category_id,\n        name as demand_category_name,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at,\n        cast(_sdc_extracted_at as timestamp) as extracted_at,\n        cast(_sdc_deleted_at as timestamp) as deleted_at\n    from source_data\n)\n\nselect * from cleaned_categories", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands_categories`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.330866Z", "completed_at": "2025-12-12T11:33:23.358783Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.374125Z", "completed_at": "2025-12-12T11:33:23.374136Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.12900233268737793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__workorders", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`yuman_workorders`\n),\n\nbase_workorders as (\n    select\n    -- IDs and foreign keys\n        id as workorder_id,\n        site_id,\n        client_id,\n        technician_id,\n        manager_id,\n        category_id,\n        contact_id,\n    -- Workorder details\n        number as workorder_number,\n        workorder_type,\n        _embed_category_name as workorder_category,\n        status as workorder_status,\n        title as workorder_title,\n        description as workorder_description,\n        report as workorder_report,\n        _embed_technician_name as workorder_technician_name,\n        time_taken as workorder_time_taken,\n    -- JSON\n        SAFE.PARSE_JSON(_embed_fields) as embed_fields,\n    -- Dates\n        TIMESTAMP(date_planned) as date_planned,\n        TIMESTAMP(date_started) as date_started,\n        TIMESTAMP(date_done) as date_done,\n        TIMESTAMP(created_at) as created_at,\n        TIMESTAMP(updated_at) as updated_at,\n        TIMESTAMP(_sdc_extracted_at) as extracted_at,\n        TIMESTAMP(_sdc_deleted_at) as deleted_at\n    from source_data\n),\n\njson_parsed as (\n    select\n        *,\n        -- Extraction des champs sp\u00e9cifiques depuis le JSON array\n        (\n            select field\n            from unnest(json_extract_array(embed_fields)) as field\n            where json_extract_scalar(field, '$.name') = 'DATE DE CREATION'\n        ) as date_creation_field,\n        \n        (\n            select field\n            from unnest(json_extract_array(embed_fields)) as field\n            where json_extract_scalar(field, '$.name') = 'MOTIF DE NON INTERVENTION'\n        ) as motif_non_intervention_field,\n        \n        (\n            select field\n            from unnest(json_extract_array(embed_fields)) as field\n            where json_extract_scalar(field, '$.name') = 'NON INTERVENTION : DETAIL/AUTRE MOTIF'\n        ) as detail_non_intervention_field,\n        \n        (\n            select field\n            from unnest(json_extract_array(embed_fields)) as field\n            where json_extract_scalar(field, '$.name') = 'RAISON MISE EN PAUSE'\n        ) as raison_pause_field,\n        \n        (\n            select field\n            from unnest(json_extract_array(embed_fields)) as field\n            where json_extract_scalar(field, '$.name') = 'EXPLICATION MISE EN PAUSE'\n        ) as explication_pause_field,\n        \n        (\n            select field\n            from unnest(json_extract_array(embed_fields)) as field\n            where json_extract_scalar(field, '$.name') = \"NECESSITE D\\'INTERVENIR\"\n        ) as necessite_intervenir_field,\n        \n        (\n            select field\n            from unnest(json_extract_array(embed_fields)) as field\n            where json_extract_scalar(field, '$.name') = 'SI NON POURQUOI ?'\n        ) as si_non_pourquoi_field\n        \n    from base_workorders\n),\n\nfinal as (\n    select\n        -- Colonnes de base\n        workorder_id,\n        site_id,\n        client_id,\n        technician_id,\n        manager_id,\n        category_id,\n        contact_id,\n        workorder_number,\n        workorder_type,\n        workorder_category,\n        workorder_status,\n        workorder_title,\n        workorder_description,\n        workorder_report,\n        workorder_technician_name,\n        workorder_time_taken,\n\n        -- Champs extraits du JSON avec nettoyage\n        case \n            when json_extract_scalar(date_creation_field, '$.value') is not null\n            then safe.parse_date('%d/%m/%Y', json_extract_scalar(date_creation_field, '$.value'))\n        end as workorder_date_creation,\n        \n        json_extract_scalar(motif_non_intervention_field, '$.value') as workorder_motif_non_intervention,\n        json_extract_scalar(detail_non_intervention_field, '$.value') as workorder_detail_non_intervention,\n        json_extract_scalar(raison_pause_field, '$.value') as workorder_raison_mise_en_pause,\n        json_extract_scalar(explication_pause_field, '$.value') as workorder_explication_mise_en_pause,\n        json_extract_scalar(necessite_intervenir_field, '$.value') as workorder_necessite_intervenir,\n        json_extract_scalar(si_non_pourquoi_field, '$.value') as workorder_si_non_pourquoi,\n        \n        -- Dates\n        date_planned,\n        date_started,\n        date_done,\n        created_at,\n        updated_at,\n        extracted_at,\n        deleted_at\n        \n    from json_parsed\n)\n\nselect * from final", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.336414Z", "completed_at": "2025-12-12T11:33:23.360076Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.375041Z", "completed_at": "2025-12-12T11:33:23.375053Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.12898874282836914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__workorders_categories", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * from `evs-datastack-prod`.`prod_raw`.`yuman_workorder_categories`\n),\n\ncleaned_categories as (\n    select\n        id as category_id,\n        name as category_name,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at,\n        cast(_sdc_extracted_at as timestamp) as extracted_at,\n        cast(_sdc_deleted_at as timestamp) as deleted_at\n    from source_data\n)\n\nselect * from cleaned_categories", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders_categories`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.341038Z", "completed_at": "2025-12-12T11:33:23.362131Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.379780Z", "completed_at": "2025-12-12T11:33:23.379791Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.1321260929107666, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman_gcs__stock_theorique", "compiled": true, "compiled_code": "\n\nwith source as (\n    select \n        *\n    from `evs-datastack-prod`.`prod_raw`.`ext_gcs_yuman__stock_theorique`\n),\n\ncleaned as (\n    select\n        -- Clean and normalize fields\n        trim(r_f_rence) as reference,\n        trim(d_signation) as designation,\n        \n        -- Convert quantity to float, handling decimal commas\n        cast(replace(quantit_, ',', '.') as float64) as quantite,\n        \n        NULLIF(trim(nom_du_stock), '') as nom_du_stock,\n        \n        -- Metadata fields\n        export_date,\n        _sdc_source_file,\n        _sdc_source_lineno\n        \n    from source\n)\n\nselect * from cleaned", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman_gcs__stock_theorique`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.419541Z", "completed_at": "2025-12-12T11:33:23.421925Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.436872Z", "completed_at": "2025-12-12T11:33:23.436894Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08147120475769043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_general__feries_metropole", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.427336Z", "completed_at": "2025-12-12T11:33:23.429326Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.447419Z", "completed_at": "2025-12-12T11:33:23.447432Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0815424919128418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_mssql_sage__code_analytique_bu", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.434252Z", "completed_at": "2025-12-12T11:33:23.436202Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.457957Z", "completed_at": "2025-12-12T11:33:23.457970Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.08655858039855957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_mssql_sage__code_comptable_bu", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.438268Z", "completed_at": "2025-12-12T11:33:23.441465Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.461399Z", "completed_at": "2025-12-12T11:33:23.461419Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.08738541603088379, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_oracle_neshu__groupement_machine", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.444056Z", "completed_at": "2025-12-12T11:33:23.446021Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.473357Z", "completed_at": "2025-12-12T11:33:23.473373Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.08896923065185547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_oracle_neshu__roadman_gea", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.449303Z", "completed_at": "2025-12-12T11:33:23.451201Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.486416Z", "completed_at": "2025-12-12T11:33:23.486429Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.08932375907897949, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_oracle_neshu__valo_machine_capacite", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.455315Z", "completed_at": "2025-12-12T11:33:23.457299Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.490267Z", "completed_at": "2025-12-12T11:33:23.490284Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.08987045288085938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_yuman__cp_metropole", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.451849Z", "completed_at": "2025-12-12T11:33:23.453887Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.487090Z", "completed_at": "2025-12-12T11:33:23.487102Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.09333109855651855, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_oracle_neshu__valo_parc_machine", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.458756Z", "completed_at": "2025-12-12T11:33:23.460705Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.491057Z", "completed_at": "2025-12-12T11:33:23.491070Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.08950567245483398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_yuman__cp_tech", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.465775Z", "completed_at": "2025-12-12T11:33:23.467579Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.497029Z", "completed_at": "2025-12-12T11:33:23.497044Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.09260869026184082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_yuman__dpt_metropole", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.468306Z", "completed_at": "2025-12-12T11:33:23.470183Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.497724Z", "completed_at": "2025-12-12T11:33:23.497738Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.09422063827514648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_yuman__machine_clean", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.474067Z", "completed_at": "2025-12-12T11:33:23.475946Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.499108Z", "completed_at": "2025-12-12T11:33:23.499119Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.0944211483001709, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_yuman__tarification_clean", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.470836Z", "completed_at": "2025-12-12T11:33:23.472715Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.498354Z", "completed_at": "2025-12-12T11:33:23.498364Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.10015988349914551, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_yuman__marque_clean", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.478891Z", "completed_at": "2025-12-12T11:33:23.481745Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.502492Z", "completed_at": "2025-12-12T11:33:23.502510Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.09840011596679688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_yuman__tech_agence", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.482523Z", "completed_at": "2025-12-12T11:33:23.485768Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.503312Z", "completed_at": "2025-12-12T11:33:23.503327Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.10030102729797363, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_yuman__tech_nomad", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.487747Z", "completed_at": "2025-12-12T11:33:23.489603Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.506169Z", "completed_at": "2025-12-12T11:33:23.506185Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.10126519203186035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_yuman__technicien_clean", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.549773Z", "completed_at": "2025-12-12T11:33:23.551911Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.584785Z", "completed_at": "2025-12-12T11:33:23.584801Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12425661087036133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_yuman__type_inter_clean", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.556490Z", "completed_at": "2025-12-12T11:33:23.617206Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.674859Z", "completed_at": "2025-12-12T11:33:23.674879Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.16637229919433594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_source_expression_is_true_marts_oracle_neshu_external_fct_oracle_neshu__passages_appro_passage_duration_min___0_OR_passage_duration_min_IS_NULL.62641ce8d8", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__passages_appro`\n\nwhere not(passage_duration_min >= 0 OR passage_duration_min IS NULL)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.577218Z", "completed_at": "2025-12-12T11:33:23.644133Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.684330Z", "completed_at": "2025-12-12T11:33:23.684346Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.16316866874694824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_source_expression_is_true_marts_oracle_neshu_external_fct_oracle_neshu__passages_appro_passage_start_datetime___passage_end_datetime.dfc7811618", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__passages_appro`\n\nwhere not(passage_start_datetime <= passage_end_datetime)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.585546Z", "completed_at": "2025-12-12T11:33:23.655472Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.686466Z", "completed_at": "2025-12-12T11:33:23.686478Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.1641690731048584, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_source_unique_combination_of_columns_marts_oracle_neshu_external_fct_oracle_neshu__passages_appro_task_id__roadman_code.f180dd15c6", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        task_id, roadman_code\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__passages_appro`\n    group by task_id, roadman_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.599502Z", "completed_at": "2025-12-12T11:33:23.668840Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.688283Z", "completed_at": "2025-12-12T11:33:23.688295Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.1634681224822998, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_source_unique_combination_of_columns_mssql_sage_dbo_f_ecriturea_ec_no__n_analytique__ea_ligne.d6b0f7b301", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        ec_no, n_analytique, ea_ligne\n    from `evs-datastack-prod`.`prod_raw`.`dbo_f_ecriturea`\n    group by ec_no, n_analytique, ea_ligne\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.608186Z", "completed_at": "2025-12-12T11:33:23.675737Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.690813Z", "completed_at": "2025-12-12T11:33:23.690826Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.1647047996520996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_marts_oracle_neshu_external_fct_oracle_neshu__passages_appro_loaded_at_utc.c33d26b383", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect loaded_at_utc\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__passages_appro`\nwhere loaded_at_utc is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.617899Z", "completed_at": "2025-12-12T11:33:23.681977Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.694547Z", "completed_at": "2025-12-12T11:33:23.694562Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.1659069061279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_marts_oracle_neshu_external_fct_oracle_neshu__passages_appro_passage_start_datetime.b0a2c77abe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect passage_start_datetime\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__passages_appro`\nwhere passage_start_datetime is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.624130Z", "completed_at": "2025-12-12T11:33:23.683320Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.696649Z", "completed_at": "2025-12-12T11:33:23.696683Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.16858601570129395, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_marts_oracle_neshu_external_fct_oracle_neshu__passages_appro_task_id.3aadab2139", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__passages_appro`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.630943Z", "completed_at": "2025-12-12T11:33:23.685047Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.698191Z", "completed_at": "2025-12-12T11:33:23.698206Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.16991853713989258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_mssql_sage_dbo_f_ecriturea_cb_marq.7d3e1176b7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cb_marq\nfrom `evs-datastack-prod`.`prod_raw`.`dbo_f_ecriturea`\nwhere cb_marq is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.638756Z", "completed_at": "2025-12-12T11:33:23.685739Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.700800Z", "completed_at": "2025-12-12T11:33:23.700811Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.16800498962402344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_mssql_sage_dbo_f_ecriturec_ec_no.714fd67ceb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ec_no\nfrom `evs-datastack-prod`.`prod_raw`.`dbo_f_ecriturec`\nwhere ec_no is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.645023Z", "completed_at": "2025-12-12T11:33:23.687255Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.703449Z", "completed_at": "2025-12-12T11:33:23.703460Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.17077207565307617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_company_has_location_idcompany.d2e7a813ca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_raw`.`evs_company_has_location`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.663562Z", "completed_at": "2025-12-12T11:33:23.689123Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.706078Z", "completed_at": "2025-12-12T11:33:23.706093Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.1651930809020996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_company_idcompany.c223201709", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_raw`.`evs_company`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.650395Z", "completed_at": "2025-12-12T11:33:23.689768Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.706711Z", "completed_at": "2025-12-12T11:33:23.706726Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.17507028579711914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_company_has_location_idlocation.e1aaef8e8b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation\nfrom `evs-datastack-prod`.`prod_raw`.`evs_company_has_location`\nwhere idlocation is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.656797Z", "completed_at": "2025-12-12T11:33:23.693832Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.710200Z", "completed_at": "2025-12-12T11:33:23.710211Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.17721223831176758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_company_has_location_idlocation_type.b7ffe23a12", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation_type\nfrom `evs-datastack-prod`.`prod_raw`.`evs_company_has_location`\nwhere idlocation_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.676399Z", "completed_at": "2025-12-12T11:33:23.695243Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.712968Z", "completed_at": "2025-12-12T11:33:23.712980Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.16524910926818848, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_contact_idcontact.d426a1c13e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontact\nfrom `evs-datastack-prod`.`prod_raw`.`evs_contact`\nwhere idcontact is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.669633Z", "completed_at": "2025-12-12T11:33:23.697415Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.714402Z", "completed_at": "2025-12-12T11:33:23.714413Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.17133617401123047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_company_type_idcompany_type.11fcffba5d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany_type\nfrom `evs-datastack-prod`.`prod_raw`.`evs_company_type`\nwhere idcompany_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.734076Z", "completed_at": "2025-12-12T11:33:23.756930Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.772114Z", "completed_at": "2025-12-12T11:33:23.772126Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11672472953796387, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_contract_idcontract.f730c61b9d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontract\nfrom `evs-datastack-prod`.`prod_raw`.`evs_contract`\nwhere idcontract is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.762233Z", "completed_at": "2025-12-12T11:33:23.797043Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.843281Z", "completed_at": "2025-12-12T11:33:23.843297Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.14465665817260742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_contract_parsed_idcontract.34a4825dee", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontract\nfrom `evs-datastack-prod`.`prod_raw`.`evs_contract_parsed`\nwhere idcontract is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.773380Z", "completed_at": "2025-12-12T11:33:23.824096Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.865835Z", "completed_at": "2025-12-12T11:33:23.865853Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.13383054733276367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_device_iddevice.d62f2bee11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect iddevice\nfrom `evs-datastack-prod`.`prod_raw`.`evs_device`\nwhere iddevice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.779346Z", "completed_at": "2025-12-12T11:33:23.835475Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.867109Z", "completed_at": "2025-12-12T11:33:23.867125Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.13523316383361816, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_family_idlabel_family.76e2fc3d22", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel_family\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_family`\nwhere idlabel_family is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.784426Z", "completed_at": "2025-12-12T11:33:23.842608Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.869482Z", "completed_at": "2025-12-12T11:33:23.869494Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.13797950744628906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_company_idcompany.9fb5a691bb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_company`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.791888Z", "completed_at": "2025-12-12T11:33:23.860581Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.873483Z", "completed_at": "2025-12-12T11:33:23.873495Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.1372673511505127, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_company_idlabel.84c84e0808", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_company`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.799043Z", "completed_at": "2025-12-12T11:33:23.861458Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.874847Z", "completed_at": "2025-12-12T11:33:23.874859Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.13991546630859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_contract_idcontract.34f534407d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontract\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_contract`\nwhere idcontract is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.805415Z", "completed_at": "2025-12-12T11:33:23.864405Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.877569Z", "completed_at": "2025-12-12T11:33:23.877580Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.14141130447387695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_contract_idlabel.1500ee3c29", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_contract`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.818872Z", "completed_at": "2025-12-12T11:33:23.866444Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.878997Z", "completed_at": "2025-12-12T11:33:23.879009Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.13992071151733398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_device_idlabel.7913e12518", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_device`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.813514Z", "completed_at": "2025-12-12T11:33:23.865125Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.878221Z", "completed_at": "2025-12-12T11:33:23.878235Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.1433563232421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_device_iddevice.67fa8a09c3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect iddevice\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_device`\nwhere iddevice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.825107Z", "completed_at": "2025-12-12T11:33:23.868087Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.881770Z", "completed_at": "2025-12-12T11:33:23.881782Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.14286398887634277, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_product_idlabel.5191f399c0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_product`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.830415Z", "completed_at": "2025-12-12T11:33:23.868811Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.884389Z", "completed_at": "2025-12-12T11:33:23.884399Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.1449565887451172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_product_idproduct.6048527bb0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_product`\nwhere idproduct is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.837577Z", "completed_at": "2025-12-12T11:33:23.870334Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.885123Z", "completed_at": "2025-12-12T11:33:23.885134Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.14112234115600586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_resources_idlabel.eabdfa7bbf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_resources`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.849891Z", "completed_at": "2025-12-12T11:33:23.875444Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.891496Z", "completed_at": "2025-12-12T11:33:23.891507Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.14294004440307617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_task_idlabel.9722fba510", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_task`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.844272Z", "completed_at": "2025-12-12T11:33:23.874143Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.890746Z", "completed_at": "2025-12-12T11:33:23.890758Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.14556121826171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_resources_idresources.701adf32da", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.855434Z", "completed_at": "2025-12-12T11:33:23.876954Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.894739Z", "completed_at": "2025-12-12T11:33:23.894751Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.15321111679077148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_task_idtask.407d48dbcb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_task`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.916566Z", "completed_at": "2025-12-12T11:33:23.936914Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:23.952498Z", "completed_at": "2025-12-12T11:33:23.952515Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1289353370666504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_idlabel.725504fd88", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.942223Z", "completed_at": "2025-12-12T11:33:23.979645Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.030969Z", "completed_at": "2025-12-12T11:33:24.030984Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1429600715637207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_location_idlocation.252e77f735", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation\nfrom `evs-datastack-prod`.`prod_raw`.`evs_location`\nwhere idlocation is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.953847Z", "completed_at": "2025-12-12T11:33:24.016826Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.047433Z", "completed_at": "2025-12-12T11:33:24.047446Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.13543200492858887, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_product_idproduct.0e5cc2ab70", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct\nfrom `evs-datastack-prod`.`prod_raw`.`evs_product`\nwhere idproduct is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.960136Z", "completed_at": "2025-12-12T11:33:24.022882Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.049550Z", "completed_at": "2025-12-12T11:33:24.049561Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.13767290115356445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_product_type_idproduct_type.2e7c2d534c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct_type\nfrom `evs-datastack-prod`.`prod_raw`.`evs_product_type`\nwhere idproduct_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.967993Z", "completed_at": "2025-12-12T11:33:24.030302Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.051023Z", "completed_at": "2025-12-12T11:33:24.051040Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.13768506050109863, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_resources_idresources.04add56fa5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_raw`.`evs_resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.973332Z", "completed_at": "2025-12-12T11:33:24.031615Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.054111Z", "completed_at": "2025-12-12T11:33:24.054122Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.13986706733703613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_resources_type_idresources_type.c0ade33349", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources_type\nfrom `evs-datastack-prod`.`prod_raw`.`evs_resources_type`\nwhere idresources_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.980972Z", "completed_at": "2025-12-12T11:33:24.037795Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.055489Z", "completed_at": "2025-12-12T11:33:24.055505Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.1404743194580078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_task_has_product_idtask_has_product.52f463d476", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_has_product\nfrom `evs-datastack-prod`.`prod_raw`.`evs_task_has_product`\nwhere idtask_has_product is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.986134Z", "completed_at": "2025-12-12T11:33:24.044045Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.056978Z", "completed_at": "2025-12-12T11:33:24.056990Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.14260601997375488, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_task_has_resources_idresources.6896d0d7f1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_raw`.`evs_task_has_resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.992311Z", "completed_at": "2025-12-12T11:33:24.046650Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.059657Z", "completed_at": "2025-12-12T11:33:24.059683Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.14397978782653809, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_task_has_resources_idtask.3c6bbcc3c8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_raw`.`evs_task_has_resources`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:23.998794Z", "completed_at": "2025-12-12T11:33:24.045433Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.059043Z", "completed_at": "2025-12-12T11:33:24.059054Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.14495396614074707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_task_idtask.d1aa0b27a5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_raw`.`evs_task`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.006167Z", "completed_at": "2025-12-12T11:33:24.048110Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.060388Z", "completed_at": "2025-12-12T11:33:24.060399Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.14628982543945312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_task_status_idtask_status.2b475b6b56", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_status\nfrom `evs-datastack-prod`.`prod_raw`.`evs_task_status`\nwhere idtask_status is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.011650Z", "completed_at": "2025-12-12T11:33:24.048780Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.063393Z", "completed_at": "2025-12-12T11:33:24.063409Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.1470794677734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_task_type_idtask_type.d7f9ba800f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_type\nfrom `evs-datastack-prod`.`prod_raw`.`evs_task_type`\nwhere idtask_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.017622Z", "completed_at": "2025-12-12T11:33:24.050329Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.064187Z", "completed_at": "2025-12-12T11:33:24.064206Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.14932513236999512, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_clients_id.94442bf14b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_clients`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.023508Z", "completed_at": "2025-12-12T11:33:24.054701Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.070013Z", "completed_at": "2025-12-12T11:33:24.070035Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.14587163925170898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_material_categories_id.4ef54c952f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_material_categories`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.032269Z", "completed_at": "2025-12-12T11:33:24.056216Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.072766Z", "completed_at": "2025-12-12T11:33:24.072779Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.14733028411865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_materials_id.ef8e1020be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_materials`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.038428Z", "completed_at": "2025-12-12T11:33:24.057640Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.075487Z", "completed_at": "2025-12-12T11:33:24.075503Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.14823436737060547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_materials_site_id.f462c1646e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect site_id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_materials`\nwhere site_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.101035Z", "completed_at": "2025-12-12T11:33:24.119834Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.141530Z", "completed_at": "2025-12-12T11:33:24.141554Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12892961502075195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_products_id.9d76ec0f24", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_products`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.123747Z", "completed_at": "2025-12-12T11:33:24.161174Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.216859Z", "completed_at": "2025-12-12T11:33:24.216877Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.14766979217529297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_purchase_orders_id.3eb709d1c8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_purchase_orders`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.136227Z", "completed_at": "2025-12-12T11:33:24.208340Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.232885Z", "completed_at": "2025-12-12T11:33:24.232900Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.13950848579406738, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_sites_client_id.6e84614dea", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect client_id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_sites`\nwhere client_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.143579Z", "completed_at": "2025-12-12T11:33:24.209756Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.235107Z", "completed_at": "2025-12-12T11:33:24.235126Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.14083099365234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_sites_id.cc7391839c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_sites`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.149644Z", "completed_at": "2025-12-12T11:33:24.215596Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.236481Z", "completed_at": "2025-12-12T11:33:24.236493Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.14219093322753906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_storehouses_id.bb31da2576", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_storehouses`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.155042Z", "completed_at": "2025-12-12T11:33:24.217527Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.240535Z", "completed_at": "2025-12-12T11:33:24.240547Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.1443171501159668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_users_id.d5dd93c383", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_users`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.162475Z", "completed_at": "2025-12-12T11:33:24.229263Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.242155Z", "completed_at": "2025-12-12T11:33:24.242168Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.14504098892211914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_workorder_categories_id.481d28172c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_workorder_categories`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.169654Z", "completed_at": "2025-12-12T11:33:24.231449Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.244871Z", "completed_at": "2025-12-12T11:33:24.244882Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.14693856239318848, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_workorder_demands_categories_id.a8a4d3d9e4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_workorder_demands_categories`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.174895Z", "completed_at": "2025-12-12T11:33:24.232138Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.245490Z", "completed_at": "2025-12-12T11:33:24.245501Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.14824342727661133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_workorder_demands_id.2951fa446c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_workorder_demands`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.188180Z", "completed_at": "2025-12-12T11:33:24.233529Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.246221Z", "completed_at": "2025-12-12T11:33:24.246230Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.14826202392578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_marts_oracle_neshu_external_fct_oracle_neshu__passages_appro_task_id.6808d3b688", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__passages_appro`\n  where task_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.180049Z", "completed_at": "2025-12-12T11:33:24.234354Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.248876Z", "completed_at": "2025-12-12T11:33:24.248892Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.15230679512023926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_workorders_id.e6c047d2a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_workorders`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.196243Z", "completed_at": "2025-12-12T11:33:24.235814Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.249606Z", "completed_at": "2025-12-12T11:33:24.249618Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.15351295471191406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_mssql_sage_dbo_f_ecriturea_cb_marq.ce4c2c11f4", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select cb_marq as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`dbo_f_ecriturea`\n  where cb_marq is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.203272Z", "completed_at": "2025-12-12T11:33:24.237124Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.252421Z", "completed_at": "2025-12-12T11:33:24.252435Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.15570902824401855, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_mssql_sage_dbo_f_ecriturec_ec_no.6925cf7be5", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select ec_no as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`dbo_f_ecriturec`\n  where ec_no is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.210513Z", "completed_at": "2025-12-12T11:33:24.241156Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.256106Z", "completed_at": "2025-12-12T11:33:24.256119Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.14929556846618652, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_company_idcompany.6df2f6792e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcompany as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_company`\n  where idcompany is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.218193Z", "completed_at": "2025-12-12T11:33:24.243603Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.261515Z", "completed_at": "2025-12-12T11:33:24.261527Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.15781092643737793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_company_type_idcompany_type.56f35aae37", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcompany_type as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_company_type`\n  where idcompany_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.223528Z", "completed_at": "2025-12-12T11:33:24.244212Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.262182Z", "completed_at": "2025-12-12T11:33:24.262192Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.15936565399169922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_contact_idcontact.d870dc347d", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcontact as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_contact`\n  where idcontact is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.282508Z", "completed_at": "2025-12-12T11:33:24.303160Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.318551Z", "completed_at": "2025-12-12T11:33:24.318564Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1117699146270752, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_contract_idcontract.00683b26ea", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcontract as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_contract`\n  where idcontract is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.310361Z", "completed_at": "2025-12-12T11:33:24.351840Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.398541Z", "completed_at": "2025-12-12T11:33:24.398559Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.14523077011108398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_contract_parsed_idcontract.88000e1326", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcontract as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_contract_parsed`\n  where idcontract is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.321136Z", "completed_at": "2025-12-12T11:33:24.379251Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.416042Z", "completed_at": "2025-12-12T11:33:24.416059Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1363821029663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_device_iddevice.397252bea8", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select iddevice as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_device`\n  where iddevice is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.333473Z", "completed_at": "2025-12-12T11:33:24.396607Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.419312Z", "completed_at": "2025-12-12T11:33:24.419326Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.13746070861816406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_label_idlabel.f4f4d52728", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlabel as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_label`\n  where idlabel is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.328423Z", "completed_at": "2025-12-12T11:33:24.397753Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.421359Z", "completed_at": "2025-12-12T11:33:24.421372Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.14082598686218262, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_label_family_idlabel_family.52acfecf7e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlabel_family as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_label_family`\n  where idlabel_family is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.341592Z", "completed_at": "2025-12-12T11:33:24.404694Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.425140Z", "completed_at": "2025-12-12T11:33:24.425152Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.14083552360534668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_location_idlocation.e07de44c8b", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlocation as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_location`\n  where idlocation is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.346750Z", "completed_at": "2025-12-12T11:33:24.406627Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.426759Z", "completed_at": "2025-12-12T11:33:24.426770Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.14282584190368652, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_product_idproduct.56c841c209", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idproduct as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_product`\n  where idproduct is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.355555Z", "completed_at": "2025-12-12T11:33:24.414985Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.427586Z", "completed_at": "2025-12-12T11:33:24.427597Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.14275360107421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_product_type_idproduct_type.f77e407933", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idproduct_type as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_product_type`\n  where idproduct_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.361524Z", "completed_at": "2025-12-12T11:33:24.416724Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.431970Z", "completed_at": "2025-12-12T11:33:24.431987Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.1458721160888672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_resources_idresources.65588abfd8", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idresources as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_resources`\n  where idresources is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.367413Z", "completed_at": "2025-12-12T11:33:24.417685Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.432600Z", "completed_at": "2025-12-12T11:33:24.432611Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.14655041694641113, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_resources_type_idresources_type.94e4b1617f", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idresources_type as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_resources_type`\n  where idresources_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.380406Z", "completed_at": "2025-12-12T11:33:24.419959Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.433962Z", "completed_at": "2025-12-12T11:33:24.433973Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.14747214317321777, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_task_idtask.e261c356e9", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_task`\n  where idtask is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.374158Z", "completed_at": "2025-12-12T11:33:24.418550Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.433246Z", "completed_at": "2025-12-12T11:33:24.433256Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.15097808837890625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_task_has_product_idtask_has_product.b9af110684", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_has_product as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_task_has_product`\n  where idtask_has_product is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.385916Z", "completed_at": "2025-12-12T11:33:24.420559Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.436584Z", "completed_at": "2025-12-12T11:33:24.436601Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.15118670463562012, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_task_status_idtask_status.b176cc0c5b", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_status as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_task_status`\n  where idtask_status is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.391552Z", "completed_at": "2025-12-12T11:33:24.422143Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.439269Z", "completed_at": "2025-12-12T11:33:24.439280Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.14712738990783691, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_task_type_idtask_type.3b8b3b9ff6", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_type as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_task_type`\n  where idtask_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.399516Z", "completed_at": "2025-12-12T11:33:24.428326Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.447475Z", "completed_at": "2025-12-12T11:33:24.447487Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.15651488304138184, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_clients_id.ac9ad6b2fc", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_clients`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.407366Z", "completed_at": "2025-12-12T11:33:24.429167Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.448162Z", "completed_at": "2025-12-12T11:33:24.448181Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.15677833557128906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_material_categories_id.8e8a025d0a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_material_categories`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.465387Z", "completed_at": "2025-12-12T11:33:24.488098Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.503793Z", "completed_at": "2025-12-12T11:33:24.503808Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1191551685333252, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_materials_id.627fc0bbcf", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_materials`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.494858Z", "completed_at": "2025-12-12T11:33:24.541300Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.581916Z", "completed_at": "2025-12-12T11:33:24.581937Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.13997864723205566, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_products_id.0797f24444", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_products`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.504432Z", "completed_at": "2025-12-12T11:33:24.562114Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.596273Z", "completed_at": "2025-12-12T11:33:24.596290Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.13350653648376465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_purchase_orders_id.1a3a583089", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_purchase_orders`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.511696Z", "completed_at": "2025-12-12T11:33:24.573599Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.599328Z", "completed_at": "2025-12-12T11:33:24.599340Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.13546204566955566, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_sites_id.c7e2661f2f", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_sites`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.519213Z", "completed_at": "2025-12-12T11:33:24.581211Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.600929Z", "completed_at": "2025-12-12T11:33:24.600945Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.13671088218688965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_storehouses_id.00c2ccf09c", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_storehouses`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.525849Z", "completed_at": "2025-12-12T11:33:24.582606Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.604739Z", "completed_at": "2025-12-12T11:33:24.604753Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.1368401050567627, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_users_id.9323495945", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_users`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.531059Z", "completed_at": "2025-12-12T11:33:24.583362Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.606184Z", "completed_at": "2025-12-12T11:33:24.606200Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.14015793800354004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_workorder_categories_id.ae2a36c8ed", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_workorder_categories`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.536198Z", "completed_at": "2025-12-12T11:33:24.595032Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.609132Z", "completed_at": "2025-12-12T11:33:24.609144Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.14276981353759766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_workorder_demands_categories_id.d7d762a90b", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_workorder_demands_categories`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.545940Z", "completed_at": "2025-12-12T11:33:24.597101Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.611801Z", "completed_at": "2025-12-12T11:33:24.611813Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.141693115234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_workorder_demands_id.61272d2b5b", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_workorder_demands`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.552597Z", "completed_at": "2025-12-12T11:33:24.597774Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.612410Z", "completed_at": "2025-12-12T11:33:24.612425Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.14308762550354004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_workorders_id.cf3a021d13", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_workorders`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.568377Z", "completed_at": "2025-12-12T11:33:24.600148Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.613807Z", "completed_at": "2025-12-12T11:33:24.613824Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.14198780059814453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_mssql_sage__f_collaborateur_co_no.086b5b6003", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select co_no as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_collaborateur`\n  where co_no is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.557735Z", "completed_at": "2025-12-12T11:33:24.598575Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.613071Z", "completed_at": "2025-12-12T11:33:24.613087Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.1472606658935547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_gac__sinistres_sg", "compiled": true, "compiled_code": "\n-- ============================================================================\n-- MODEL: fct_gac__sinistres_sg\n-- PURPOSE: Table de faits sur les sinistres vehicules\n-- AUTHOR: Etienne BOULINIER\n-- ============================================================================\nSELECT \n-- Infos Sinistre\nn_de_sinistre,\nDATE(date_sinistre) as date_sinistre,\ndate_de_creation,\ncirconstance,\ntiers,\nresp,\ncloture,\n-- Infos Vehicule\nimmat,\nnom,\nprenom,\nstatut_actuel,\ngenre_fiscal,\nreference_gac,\nentite_entite_2,\nentite_entite_3,\n--Couts\ncentre_de_couts,\ncout_assureur,\nauto_assurance,\nfranchise,\ncout_global,\ncout_client,\n-- M\u00e9tadonn\u00e9es dbt\nCURRENT_TIMESTAMP() as dbt_updated_at,\n'2595904a-aec3-41ec-a1e9-f19d18d6d7af' as dbt_invocation_id\n FROM `evs-datastack-prod`.`prod_staging`.`stg_gac__sinistres_sg`", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_gac__sinistres_sg`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.563037Z", "completed_at": "2025-12-12T11:33:24.601592Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.616746Z", "completed_at": "2025-12-12T11:33:24.616758Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.14801931381225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_mssql_sage__f_collaborateur_co_no.8fe666d6a9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect co_no\nfrom `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_collaborateur`\nwhere co_no is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.574422Z", "completed_at": "2025-12-12T11:33:24.605449Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.622216Z", "completed_at": "2025-12-12T11:33:24.622227Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.14996051788330078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_mssql_sage__f_comptet_ct_intitule.8b30e5ed44", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ct_intitule\nfrom `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_comptet`\nwhere ct_intitule is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.584038Z", "completed_at": "2025-12-12T11:33:24.607903Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.623627Z", "completed_at": "2025-12-12T11:33:24.623639Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.14937543869018555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_mssql_sage__f_comptet_ct_num.e1aafeeaf3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ct_num\nfrom `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_comptet`\nwhere ct_num is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.589189Z", "completed_at": "2025-12-12T11:33:24.608515Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.626221Z", "completed_at": "2025-12-12T11:33:24.626233Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.15161395072937012, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_mssql_sage__f_comptet_ct_num.dd74c728b2", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select ct_num as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_comptet`\n  where ct_num is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.644995Z", "completed_at": "2025-12-12T11:33:24.665491Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.895295Z", "completed_at": "2025-12-12T11:33:24.895315Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3243446350097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_mssql_sage__f_docligne_dl_no.fdbc1a884d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dl_no\nfrom `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_docligne`\nwhere dl_no is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.672829Z", "completed_at": "2025-12-12T11:33:24.922330Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.983847Z", "completed_at": "2025-12-12T11:33:24.983870Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.36298584938049316, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_mssql_sage__f_docligne_dl_no.bbe213a3d0", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select dl_no as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_docligne`\n  where dl_no is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.896682Z", "completed_at": "2025-12-12T11:33:24.951915Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.994071Z", "completed_at": "2025-12-12T11:33:24.994088Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.35335588455200195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_mssql_sage__f_ecriturea_cb_marq.2b7821a339", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cb_marq\nfrom `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturea`\nwhere cb_marq is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.904512Z", "completed_at": "2025-12-12T11:33:24.971886Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:24.998129Z", "completed_at": "2025-12-12T11:33:24.998144Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3547325134277344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_mssql_sage__f_ecriturea_ec_no.e9561d3019", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ec_no\nfrom `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturea`\nwhere ec_no is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.915975Z", "completed_at": "2025-12-12T11:33:24.978003Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.000196Z", "completed_at": "2025-12-12T11:33:25.000209Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.3553287982940674, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_mssql_sage__f_ecriturec_cb_marq.3bd93c8d9a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cb_marq\nfrom `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturec`\nwhere cb_marq is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.910935Z", "completed_at": "2025-12-12T11:33:24.984475Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.001836Z", "completed_at": "2025-12-12T11:33:25.001852Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.35935378074645996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_mssql_sage__f_ecriturea_cb_marq.4564af1e9a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select cb_marq as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturea`\n  where cb_marq is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.923019Z", "completed_at": "2025-12-12T11:33:24.992521Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.006303Z", "completed_at": "2025-12-12T11:33:25.006321Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.35993456840515137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_mssql_sage__f_ecriturec_ec_no.72ebe5dc6d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ec_no\nfrom `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturec`\nwhere ec_no is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.932412Z", "completed_at": "2025-12-12T11:33:24.995691Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.010385Z", "completed_at": "2025-12-12T11:33:25.010401Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.36017680168151855, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_mssql_sage__f_ecriturea_ec_no__ec_no__ref_stg_mssql_sage__f_ecriturec_.de8056a230", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select ec_no as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturea`\n    where ec_no is not null\n),\n\nparent as (\n    select ec_no as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturec`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.952640Z", "completed_at": "2025-12-12T11:33:24.996451Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.011063Z", "completed_at": "2025-12-12T11:33:25.011077Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.3604302406311035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_nesp_co__client_third.99e6484872", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select third as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_nesp_co__client`\n  where third is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.946908Z", "completed_at": "2025-12-12T11:33:24.994808Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.009753Z", "completed_at": "2025-12-12T11:33:25.009765Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.36301517486572266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_nesp_co__client_third.d883c825bf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect third\nfrom `evs-datastack-prod`.`prod_staging`.`stg_nesp_co__client`\nwhere third is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.937622Z", "completed_at": "2025-12-12T11:33:24.997458Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.011762Z", "completed_at": "2025-12-12T11:33:25.011773Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.36631345748901367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_mssql_sage__f_ecriturec_ec_no.dfbf7515df", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select ec_no as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturec`\n  where ec_no is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.966488Z", "completed_at": "2025-12-12T11:33:24.998909Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.014601Z", "completed_at": "2025-12-12T11:33:25.014617Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.36527037620544434, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_nesp_co__activite_activity_id.ed7ee09b3c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_nesp_co__activite`\nwhere activity_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.957811Z", "completed_at": "2025-12-12T11:33:24.999526Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.015258Z", "completed_at": "2025-12-12T11:33:25.015269Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.3679211139678955, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_unique_combination_of_columns_stg_nesp_co__activite_activity_id__employee_responsible__activity_type.3141a808e6", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        activity_id, employee_responsible, activity_type\n    from `evs-datastack-prod`.`prod_staging`.`stg_nesp_co__activite`\n    group by activity_id, employee_responsible, activity_type\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.972774Z", "completed_at": "2025-12-12T11:33:25.000964Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.016058Z", "completed_at": "2025-12-12T11:33:25.016072Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.14968442916870117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_nesp_co__activite_activity_type.6269f4d592", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_nesp_co__activite`\nwhere activity_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.978773Z", "completed_at": "2025-12-12T11:33:25.002411Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.018816Z", "completed_at": "2025-12-12T11:33:25.018828Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.15168023109436035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_nesp_co__activite_employee_responsible.d3ecc8807d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect employee_responsible\nfrom `evs-datastack-prod`.`prod_staging`.`stg_nesp_co__activite`\nwhere employee_responsible is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:24.985260Z", "completed_at": "2025-12-12T11:33:25.007027Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.023003Z", "completed_at": "2025-12-12T11:33:25.023015Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.16083693504333496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_unique_combination_of_columns_stg_nesp_co__opportunite_opportunity_id__employee_responsible__created_by.6f803e112e", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        opportunity_id, employee_responsible, created_by\n    from `evs-datastack-prod`.`prod_staging`.`stg_nesp_co__opportunite`\n    group by opportunity_id, employee_responsible, created_by\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.047261Z", "completed_at": "2025-12-12T11:33:25.068510Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.083590Z", "completed_at": "2025-12-12T11:33:25.083606Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.11524677276611328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_unique_combination_of_columns_stg_nesp_tech__articles_n_planning__code_article__date_intervention.c99ba416cb", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        n_planning, code_article, date_intervention\n    from `evs-datastack-prod`.`prod_staging`.`stg_nesp_tech__articles`\n    group by n_planning, code_article, date_intervention\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.076948Z", "completed_at": "2025-12-12T11:33:25.118455Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.177913Z", "completed_at": "2025-12-12T11:33:25.177933Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.14438199996948242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_nesp_co__opportunite_created_by.e087b6981a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_by\nfrom `evs-datastack-prod`.`prod_staging`.`stg_nesp_co__opportunite`\nwhere created_by is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.084254Z", "completed_at": "2025-12-12T11:33:25.138951Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.181334Z", "completed_at": "2025-12-12T11:33:25.181351Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.13791441917419434, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_nesp_co__opportunite_employee_responsible.76da6c5062", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect employee_responsible\nfrom `evs-datastack-prod`.`prod_staging`.`stg_nesp_co__opportunite`\nwhere employee_responsible is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.091410Z", "completed_at": "2025-12-12T11:33:25.151603Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.183563Z", "completed_at": "2025-12-12T11:33:25.183575Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.13887810707092285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_nesp_co__opportunite_opportunity_id.0a9bc53265", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect opportunity_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_nesp_co__opportunite`\nwhere opportunity_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.098293Z", "completed_at": "2025-12-12T11:33:25.162625Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.185950Z", "completed_at": "2025-12-12T11:33:25.185963Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.13919687271118164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_nesp_tech__articles_n_planning.91c4d84500", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect n_planning\nfrom `evs-datastack-prod`.`prod_staging`.`stg_nesp_tech__articles`\nwhere n_planning is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.105347Z", "completed_at": "2025-12-12T11:33:25.175631Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.188018Z", "completed_at": "2025-12-12T11:33:25.188034Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.14123010635375977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_unique_combination_of_columns_stg_nesp_tech__interventions_n_planning__etat_intervention__date_heure_fin.2996dd747c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        n_planning, etat_intervention, date_heure_fin\n    from `evs-datastack-prod`.`prod_staging`.`stg_nesp_tech__interventions`\n    group by n_planning, etat_intervention, date_heure_fin\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.112478Z", "completed_at": "2025-12-12T11:33:25.178564Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.191841Z", "completed_at": "2025-12-12T11:33:25.191853Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.14334702491760254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_nesp_tech__interventions_n_planning.2e2f201deb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect n_planning\nfrom `evs-datastack-prod`.`prod_staging`.`stg_nesp_tech__interventions`\nwhere n_planning is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.132275Z", "completed_at": "2025-12-12T11:33:25.182040Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.196454Z", "completed_at": "2025-12-12T11:33:25.196465Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.14237093925476074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__company_has_location_idlocation_type.9d6f83a35c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_has_location`\nwhere idlocation_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.126918Z", "completed_at": "2025-12-12T11:33:25.180608Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.193753Z", "completed_at": "2025-12-12T11:33:25.193763Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.14495325088500977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__company_has_location_idlocation.a2b189f3f3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_has_location`\nwhere idlocation is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.121450Z", "completed_at": "2025-12-12T11:33:25.182770Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.197113Z", "completed_at": "2025-12-12T11:33:25.197125Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.14783954620361328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__company_has_location_idcompany.ed01157bcd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_has_location`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.139772Z", "completed_at": "2025-12-12T11:33:25.184427Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.197870Z", "completed_at": "2025-12-12T11:33:25.197886Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.14792585372924805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__company_idcompany.a1f4fb5739", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.144783Z", "completed_at": "2025-12-12T11:33:25.185219Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.200414Z", "completed_at": "2025-12-12T11:33:25.200424Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.1494908332824707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__company_has_location_idcompany__idcompany__ref_stg_oracle_neshu__company_.801bad8c2d", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_has_location`\n    where idcompany is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.152245Z", "completed_at": "2025-12-12T11:33:25.186588Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.201120Z", "completed_at": "2025-12-12T11:33:25.201130Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.15084218978881836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__company_idcompany.f25c2833cc", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcompany as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n  where idcompany is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.157497Z", "completed_at": "2025-12-12T11:33:25.187250Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.203685Z", "completed_at": "2025-12-12T11:33:25.203698Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.1523735523223877, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__company_type_idcompany_type.7432808513", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_type`\nwhere idcompany_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.163577Z", "completed_at": "2025-12-12T11:33:25.188657Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.204396Z", "completed_at": "2025-12-12T11:33:25.204406Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.15387868881225586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__company_idcompany_type__idcompany_type__ref_stg_oracle_neshu__company_type_.945a4fb37c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_type as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n    where idcompany_type is not null\n),\n\nparent as (\n    select idcompany_type as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_type`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.170555Z", "completed_at": "2025-12-12T11:33:25.192407Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.208043Z", "completed_at": "2025-12-12T11:33:25.208058Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.15530943870544434, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__company_type_idcompany_type.d5392ad073", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcompany_type as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_type`\n  where idcompany_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.231905Z", "completed_at": "2025-12-12T11:33:25.251967Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.274706Z", "completed_at": "2025-12-12T11:33:25.274721Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12306046485900879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__contact_idcontact.257cd1bcbe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontact\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contact`\nwhere idcontact is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.259821Z", "completed_at": "2025-12-12T11:33:25.303317Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.362504Z", "completed_at": "2025-12-12T11:33:25.362521Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1440572738647461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__contact_idcompany__idcompany__ref_stg_oracle_neshu__company_.2dd653d1ee", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contact`\n    where idcompany is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.268079Z", "completed_at": "2025-12-12T11:33:25.316973Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.364682Z", "completed_at": "2025-12-12T11:33:25.364693Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.13957428932189941, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__contact_idcontact.fc71eec394", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcontact as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contact`\n  where idcontact is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.277442Z", "completed_at": "2025-12-12T11:33:25.337593Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.367912Z", "completed_at": "2025-12-12T11:33:25.367924Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.14083528518676758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__contract_idcontract.fd3fe25c02", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontract\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contract`\nwhere idcontract is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.284517Z", "completed_at": "2025-12-12T11:33:25.350792Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.369822Z", "completed_at": "2025-12-12T11:33:25.369833Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.14160728454589844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__contract_idcompany_peer__idcompany__ref_stg_oracle_neshu__company_.8ccff45442", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_peer as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contract`\n    where idcompany_peer is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.291286Z", "completed_at": "2025-12-12T11:33:25.361727Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.372836Z", "completed_at": "2025-12-12T11:33:25.372852Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.1441941261291504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__contract_idcontract.7b7904e17e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcontract as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contract`\n  where idcontract is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.298051Z", "completed_at": "2025-12-12T11:33:25.363252Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.376155Z", "completed_at": "2025-12-12T11:33:25.376171Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.14470410346984863, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__device_iddevice.27e0db8158", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect iddevice\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\nwhere iddevice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.304211Z", "completed_at": "2025-12-12T11:33:25.365838Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.380956Z", "completed_at": "2025-12-12T11:33:25.380967Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.14626407623291016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__device_idcompany_customer__idcompany__ref_stg_oracle_neshu__company_.b388815945", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_customer as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\n    where idcompany_customer is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.309412Z", "completed_at": "2025-12-12T11:33:25.366489Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.381592Z", "completed_at": "2025-12-12T11:33:25.381611Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.14764857292175293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__device_idcompany_owner__idcompany__ref_stg_oracle_neshu__company_.e812fc7be1", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_owner as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\n    where idcompany_owner is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.317694Z", "completed_at": "2025-12-12T11:33:25.367127Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.382394Z", "completed_at": "2025-12-12T11:33:25.382406Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.1499176025390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__device_idcompany_supplier__idcompany__ref_stg_oracle_neshu__company_.44ccca01df", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_supplier as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\n    where idcompany_supplier is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.327431Z", "completed_at": "2025-12-12T11:33:25.368897Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.385102Z", "completed_at": "2025-12-12T11:33:25.385114Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.15079379081726074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__device_iddevice.0ca29b8e9a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select iddevice as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\n  where iddevice is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.332471Z", "completed_at": "2025-12-12T11:33:25.370487Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.385903Z", "completed_at": "2025-12-12T11:33:25.385916Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.15219902992248535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_idlabel.f0d32bb28d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.338451Z", "completed_at": "2025-12-12T11:33:25.371194Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.388721Z", "completed_at": "2025-12-12T11:33:25.388733Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.15460777282714844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__label_idlabel.9ab3749a9c", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlabel as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\n  where idlabel is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.343757Z", "completed_at": "2025-12-12T11:33:25.371998Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.389346Z", "completed_at": "2025-12-12T11:33:25.389357Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.15524744987487793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_family_idlabel_family.da97b662a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel_family\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family`\nwhere idlabel_family is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.356580Z", "completed_at": "2025-12-12T11:33:25.376781Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.392895Z", "completed_at": "2025-12-12T11:33:25.392910Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.15007638931274414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_company_idcompany.b2f23ed472", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_company`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.351440Z", "completed_at": "2025-12-12T11:33:25.377540Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.393546Z", "completed_at": "2025-12-12T11:33:25.393557Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.1604142189025879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__label_family_idlabel_family.bcaa4d9c71", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlabel_family as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family`\n  where idlabel_family is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.420413Z", "completed_at": "2025-12-12T11:33:25.438287Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.462950Z", "completed_at": "2025-12-12T11:33:25.462970Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12392377853393555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_company_idlabel.1abe8b79c5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_company`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.446242Z", "completed_at": "2025-12-12T11:33:25.483653Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.546914Z", "completed_at": "2025-12-12T11:33:25.546932Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1525425910949707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_company_idcompany__idcompany__ref_stg_oracle_neshu__company_.66c4f4fc27", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_company`\n    where idcompany is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.455396Z", "completed_at": "2025-12-12T11:33:25.500023Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.555214Z", "completed_at": "2025-12-12T11:33:25.555232Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.14499855041503906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_company_idlabel__idlabel__ref_stg_oracle_neshu__label_.4081c7be89", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_company`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.464253Z", "completed_at": "2025-12-12T11:33:25.525898Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.558105Z", "completed_at": "2025-12-12T11:33:25.558121Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.14624714851379395, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_oracle_neshu__contract", "compiled": true, "compiled_code": "\n\nWITH contract_labels AS (\n  SELECT \n    c.idcontract as contract_id,\n    c.idcompany_peer as company_id,\n    c.code AS contract_code,\n    c.engagement_raw,\n    c.engagement_clean,\n    c.nombre_collab,\n    l.code AS label_code,\n    lf.code AS label_family_code,\n    c.original_start_date,\n    c.original_end_date,\n    c.current_end_date,\n    c.termination_date,\n    c.created_at,\n    c.updated_at\n  FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contract` c\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_contract` lhc \n    ON lhc.idcontract = c.idcontract AND lhc.idlabel IS NOT NULL\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` l \n    ON l.idlabel = lhc.idlabel\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf \n    ON lf.idlabel_family = l.idlabel_family\n),\n\naggregated_labels AS ( \n  SELECT\n    contract_id,\n    company_id,\n    contract_code,\n    engagement_raw,\n    engagement_clean,\n    nombre_collab,\n    original_start_date,\n    original_end_date,\n    current_end_date,\n    termination_date,\n    created_at,\n    updated_at,\n\n    -- pivot des familles de labels\n    MAX(CASE WHEN label_family_code = 'TRANCHE_COLLAB' THEN label_code END) AS employee_range,\n    MAX(CASE WHEN label_family_code = 'PROADMAN' THEN label_code END) AS proadman,\n    MAX(CASE WHEN label_family_code = 'REGION' THEN label_code END) AS region,\n    MAX(CASE WHEN label_family_code = 'TELETRAVAIL' THEN label_code END) AS teletravail,\n    MAX(CASE WHEN label_family_code = 'ISACTIVE' THEN label_code END) AS is_active\n\n  FROM contract_labels\n  GROUP BY\n    contract_id,\n    company_id,\n    contract_code,\n    engagement_raw,\n    engagement_clean,\n    nombre_collab,\n    original_start_date,\n    original_end_date,\n    current_end_date,\n    termination_date,\n    created_at,\n    updated_at\n),\n\naggreated_contract as (\n  SELECT\n    contract_id,\n    company_id,\n    contract_code,\n    engagement_raw,\n    engagement_clean,\n    nombre_collab,\n    CASE\n      WHEN LOWER(is_active) = 'yes' THEN TRUE\n      ELSE FALSE\n    END AS is_active,\n    original_start_date,\n    original_end_date,\n    current_end_date,\n    termination_date,\n    created_at,\n    updated_at\n  FROM aggregated_labels\n)\n\nSELECT\n  contract_id,\n  company_id,\n  contract_code,\n  engagement_raw,\n  engagement_clean,\n  nombre_collab,\n  is_active,\n  original_start_date,\n  original_end_date,\n  current_end_date,\n  termination_date,\n  created_at,\n  updated_at\nFROM (\n    SELECT *,\n           ROW_NUMBER() OVER (\n               PARTITION BY company_id\n               ORDER BY current_end_date DESC, original_start_date DESC, contract_id\n           ) as rn\n    FROM aggreated_contract\n    WHERE is_active = TRUE\n) subq\nWHERE rn = 1", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__contract`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.471332Z", "completed_at": "2025-12-12T11:33:25.547562Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.563840Z", "completed_at": "2025-12-12T11:33:25.563852Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.14986538887023926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_contract_idcontract.dbb35a2666", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontract\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_contract`\nwhere idcontract is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.478028Z", "completed_at": "2025-12-12T11:33:25.548373Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.567349Z", "completed_at": "2025-12-12T11:33:25.567362Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.15178680419921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_contract_idlabel.6c3946bf93", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_contract`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.484338Z", "completed_at": "2025-12-12T11:33:25.554402Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.568116Z", "completed_at": "2025-12-12T11:33:25.568128Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.15256118774414062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_contract_idcontract__idcontract__ref_stg_oracle_neshu__contract_.e5b8eb3f0a", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcontract as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_contract`\n    where idcontract is not null\n),\n\nparent as (\n    select idcontract as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contract`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.493636Z", "completed_at": "2025-12-12T11:33:25.556770Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.572872Z", "completed_at": "2025-12-12T11:33:25.572884Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.15567731857299805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_contract_idlabel__idlabel__ref_stg_oracle_neshu__label_.d7a7c60364", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_contract`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.502966Z", "completed_at": "2025-12-12T11:33:25.558730Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.575514Z", "completed_at": "2025-12-12T11:33:25.575524Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.1565570831298828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_device_iddevice.c9592a7b37", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect iddevice\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_device`\nwhere iddevice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.508199Z", "completed_at": "2025-12-12T11:33:25.559335Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.576163Z", "completed_at": "2025-12-12T11:33:25.576174Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.15725278854370117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_device_idlabel.2efbd34860", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_device`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.520765Z", "completed_at": "2025-12-12T11:33:25.561473Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.577407Z", "completed_at": "2025-12-12T11:33:25.577422Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.15848088264465332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_device_idlabel__idlabel__ref_stg_oracle_neshu__label_.9d728f2f84", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_device`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.513396Z", "completed_at": "2025-12-12T11:33:25.560032Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.576807Z", "completed_at": "2025-12-12T11:33:25.576818Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.1611182689666748, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_device_iddevice__iddevice__ref_stg_oracle_neshu__device_.3c06d4671c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select iddevice as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_device`\n    where iddevice is not null\n),\n\nparent as (\n    select iddevice as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.534907Z", "completed_at": "2025-12-12T11:33:25.562254Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.578065Z", "completed_at": "2025-12-12T11:33:25.578076Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.1587200164794922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_product_idproduct.48b2a5d583", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_product`\nwhere idproduct is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.540334Z", "completed_at": "2025-12-12T11:33:25.562952Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.578695Z", "completed_at": "2025-12-12T11:33:25.578706Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.15271425247192383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_product_idlabel__idlabel__ref_stg_oracle_neshu__label_.5b4fd68430", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_product`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.529453Z", "completed_at": "2025-12-12T11:33:25.564427Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.579378Z", "completed_at": "2025-12-12T11:33:25.579388Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.1661853790283203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_product_idlabel.c10c951091", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_product`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.549064Z", "completed_at": "2025-12-12T11:33:25.568912Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.588857Z", "completed_at": "2025-12-12T11:33:25.588874Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.1593456268310547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_task_idlabel.231c8d8c24", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.614947Z", "completed_at": "2025-12-12T11:33:25.632728Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.659089Z", "completed_at": "2025-12-12T11:33:25.659108Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12143087387084961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_task_idtask.dd0526ea2b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.638514Z", "completed_at": "2025-12-12T11:33:25.684189Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.739516Z", "completed_at": "2025-12-12T11:33:25.739533Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.14781618118286133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_resources_idlabel.03938ed9d6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_resources`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.651790Z", "completed_at": "2025-12-12T11:33:25.691522Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.746020Z", "completed_at": "2025-12-12T11:33:25.746033Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.140580415725708, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_resources_idlabel__idlabel__ref_stg_oracle_neshu__label_.e6142d2b42", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_resources`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.645704Z", "completed_at": "2025-12-12T11:33:25.700403Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.748172Z", "completed_at": "2025-12-12T11:33:25.748184Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.15325427055358887, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_resources_idresources.c45dd6d64e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.663722Z", "completed_at": "2025-12-12T11:33:25.738113Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.752857Z", "completed_at": "2025-12-12T11:33:25.752871Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.14305710792541504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_oracle_neshu__product", "compiled": true, "compiled_code": "\n\nWITH product_labels AS (\n  SELECT \n    p.idproduct as product_id,\n    p.idproduct_type as product_type_id,\n    p.code AS product_code,\n    p.name AS product_name,\n    p.purchase_unit_price AS purchase_unit_price,\n    -- Correction de created_at si idproduct = 1\n    CASE \n      WHEN p.idproduct = 1 AND p.created_at IS NULL THEN p.updated_at\n      ELSE p.created_at\n    END AS created_at,\n    p.updated_at,\n    l.code AS label_code,\n    lf.code AS label_family_code\n  FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_product` lhp \n    ON lhp.idproduct = p.idproduct\n    AND lhp.idlabel IS NOT NULL\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` l \n    ON l.idlabel = lhp.idlabel\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf \n    ON lf.idlabel_family = l.idlabel_family\n  WHERE p.idproduct_type IN (1, 5)\n    AND (\n      CASE \n        WHEN p.idproduct = 1 AND p.created_at IS NULL THEN p.updated_at\n        ELSE p.created_at\n      END\n    ) IS NOT NULL\n),\n\npivoted AS (\n  SELECT *\n  FROM product_labels\n  PIVOT (\n    MAX(label_code)\n    FOR label_family_code IN (\n      'MARQUEP' AS product_brand,\n      'PROPRIETAIRE' AS product_owner,\n      'FAMILLE' AS product_family, \n      'BIO' AS product_bio,\n      'PLANOETE' AS product_planoete,\n      'PLANOHIVER' AS product_planohiver,\n      'HPALME' AS product_hpalme,\n      'CLASSABC' AS product_classabc,\n      'GROUPE' AS product_group,\n      'LPTYPE' AS product_type_raw,\n      'ISACTIVE' AS isactive\n    )\n  )\n),\n\nfinal AS (\n  SELECT\n    product_id,\n    product_type_id,\n    product_code,\n    product_name,\n    purchase_unit_price,\n    product_brand,\n    product_owner,\n    product_family,\n    product_bio,\n    product_planoete,\n    product_planohiver,\n    product_hpalme,\n    product_classabc,\n    product_group,\n    product_type_raw,\n    -- convert isactive from string to boolean\n    CASE\n      WHEN LOWER(isactive) = 'yes' THEN TRUE\n      ELSE FALSE\n    END AS is_active,\n    created_at,\n    updated_at,\n    -- logique de typologie standardis\u00e9e\n    COALESCE(\n      CASE\n        WHEN product_id = 1 THEN 'INDEFINI'\n        WHEN product_family IN ('CAFE CAPSULES', 'CAFE CAPSULES PREMIUM') THEN 'CAFE CAPS'\n        WHEN product_family IN ('THE') THEN 'THE'\n        WHEN product_group = 'ACCESSOIRES' THEN 'ACCESSOIRES'\n        WHEN product_group = 'BOISSONS FRAICHES' THEN 'BOISSONS FRAICHES'\n        WHEN product_group = 'SNACKING' THEN 'SNACKING'\n        WHEN product_brand = 'VAN HOUTEN' AND product_code = 'VANHCHOC23' THEN 'CHOCOLATS VAN HOUTEN'\n        WHEN product_type_raw = 'BGOURMANDE' THEN 'BOISSONS GOURMANDES'\n        ELSE NULL\n      END,\n      NULLIF(TRIM(product_type_raw), ''),\n      'Non renseign\u00e9'\n    ) AS product_type\n  FROM pivoted\n),\n\nstandardized AS (\n  SELECT\n    product_id,\n    product_type_id,\n    product_code,\n    product_name,\n    purchase_unit_price,\n\n    -- FORCING champs \u00e0 'INDEFINI' si product_type est 'INDEFINI'\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_brand END AS product_brand,\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_owner END AS product_owner,\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_family END AS product_family,\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_bio END AS product_bio,\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_planoete END AS product_planoete,\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_planohiver END AS product_planohiver,\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_hpalme END AS product_hpalme,\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_classabc END AS product_classabc,\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_group END AS product_group,\n\n    product_type_raw,\n    is_active,\n    created_at,\n    updated_at,\n    product_type\n  FROM final\n)\n\nSELECT  \n  product_id,\n  product_type_id,\n  product_code,\n  product_name,\n  purchase_unit_price,\n  product_brand,\n  product_owner,\n  product_family,\n  product_bio,\n  product_planoete,\n  product_planohiver,\n  product_hpalme,\n  product_classabc,\n  product_group,\n  product_type,\n  is_active,\n  created_at,\n  updated_at\nFROM standardized", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.671786Z", "completed_at": "2025-12-12T11:33:25.738866Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.754165Z", "completed_at": "2025-12-12T11:33:25.754182Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.14431262016296387, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__product_idproduct.2c91d8d9c3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product`\nwhere idproduct is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.677189Z", "completed_at": "2025-12-12T11:33:25.745220Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.758595Z", "completed_at": "2025-12-12T11:33:25.758607Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.14725685119628906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_product_idproduct__idproduct__ref_stg_oracle_neshu__product_.f60b56a60c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idproduct as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_product`\n    where idproduct is not null\n),\n\nparent as (\n    select idproduct as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.685881Z", "completed_at": "2025-12-12T11:33:25.747363Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.762854Z", "completed_at": "2025-12-12T11:33:25.762866Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.14862298965454102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__product_idproduct.ecd2622966", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idproduct as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product`\n  where idproduct is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.694526Z", "completed_at": "2025-12-12T11:33:25.749073Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.763644Z", "completed_at": "2025-12-12T11:33:25.763658Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.14938759803771973, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_oracle_neshu__company", "compiled": true, "compiled_code": "\n\nWITH company_labels AS (\n  SELECT \n    c.idcompany as company_id,\n    c.code AS company_code,\n    c.idcompany_type as company_type_id,\n    c.name AS company_name,\n    c.created_at,\n    c.updated_at,\n    l.code AS label_code,\n    lf.code AS label_family_code,\n    loc.address1,\n    loc.address2,\n    loc.city,\n    loc.postal AS postal_code,\n    loc.country\n  FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` c\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_company` lhc \n    ON lhc.idcompany = c.idcompany AND lhc.idlabel IS NOT NULL\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` l \n    ON l.idlabel = lhc.idlabel\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf \n    ON lf.idlabel_family = l.idlabel_family\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_has_location` chl\n    ON chl.idcompany = c.idcompany AND chl.idlocation_type = 1\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location` loc\n    ON loc.idlocation = chl.idlocation\n  WHERE ((c.idcompany_type IN (1,2,4,6))\n)),\naggregated_labels AS (\n  SELECT\n    company_id,\n    company_type_id,\n    company_code,\n    company_name,\n    created_at,\n    updated_at,\n    address1,\n    address2,\n    city,\n    postal_code,\n    country,\n    MAX(CASE WHEN label_family_code = 'TRANCHE_COLLAB' THEN label_code END) AS employee_range,\n    MAX(CASE WHEN label_family_code = 'PROADMAN' THEN label_code END) AS proadman,\n    MAX(CASE WHEN label_family_code = 'REGION' THEN label_code END) AS region,\n    MAX(CASE WHEN label_family_code = 'TELETRAVAIL' THEN label_code END) AS remote_work,\n    MAX(CASE WHEN label_family_code = 'SECTEUR_ACTVITE' THEN label_code END) AS sector,\n    MAX(CASE WHEN label_family_code = 'SECTEUR_DACTIVITE' THEN label_code END) AS activity_sector,\n    MAX(CASE WHEN label_family_code = 'RCOMM' THEN label_code END) AS commercial_rep,\n    MAX(CASE WHEN label_family_code = 'HORECA' THEN label_code END) AS horeca,\n    MAX(CASE WHEN label_family_code = 'GSM_TERRAIN' THEN label_code END) AS gsm,\n    MAX(CASE WHEN label_family_code = 'KATIERS' THEN label_code END) AS katiers,\n    MAX(CASE WHEN label_family_code = 'ISACTIVE' THEN label_code END) AS is_active,\n    MAX(CASE WHEN label_family_code = 'CODE_SECTEUR' THEN label_code END) AS sector_code,\n    MAX(CASE WHEN label_family_code = 'STATUT_CLIENT' THEN label_code END) AS client_status,\n    MAX(CASE WHEN label_family_code = 'Gestion reliquat' THEN label_code END) AS remainder_management,\n    MAX(CASE WHEN label_family_code = 'MODEENVOIFACTURE' THEN label_code END) AS invoice_delivery_mode,\n    MAX(CASE WHEN label_family_code = 'BADGE' THEN label_code END) AS badge,\n    MAX(CASE WHEN label_family_code = 'RECYCLAGE' THEN label_code END) AS recycling,\n    MAX(CASE WHEN label_family_code = 'TYPECOMPAGNIE' THEN label_code END) AS company_type,\n    MAX(CASE WHEN label_family_code = 'MODELEECOCLIENT' THEN label_code END) AS company_economic_model,\n    MAX(CASE WHEN label_family_code = 'BL_GRP' THEN label_code END) AS bl_group,\n    MAX(CASE WHEN label_family_code = 'KA' THEN label_code END) AS key_account\n  FROM company_labels\n  GROUP BY\n    company_id,\n    company_type_id,\n    company_code,\n    company_name,\n    created_at,\n    updated_at,\n    address1,\n    address2,\n    city,\n    postal_code,\n    country\n)\n\nSELECT\n  -- \ud83d\udd11 Identifiants\n  company_id,\n  company_type_id,\n\n  -- \ud83d\udcc7 Codes et noms\n  company_code,\n  company_name,\n\n  -- \ud83c\udfe2 Caract\u00e9ristiques entreprise\n  region,\n  sector,\n  sector_code,\n  activity_sector,\n  employee_range,\n  company_type,\n  company_economic_model,\n  client_status,\n  \n  CASE\n    WHEN LOWER(is_active) = 'yes' THEN TRUE\n    ELSE FALSE\n  END AS is_active,\n\n  -- \ud83d\udc65 Gestion commerciale\n  key_account,\n  katiers,\n\n  -- \ud83c\udfe8 Sp\u00e9cificit\u00e9s m\u00e9tier  \n  remote_work,\n\n  -- \ud83d\udd27 Services et options\n  proadman,\n  gsm,\n  badge,\n  recycling,\n\n  -- \ud83d\udccd Adresse\n  address1,\n  address2,\n  city,\n  postal_code,\n  country,\n\n  -- \ud83d\udd52 Dates\n  created_at,\n  updated_at\n\nFROM aggregated_labels", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.713179Z", "completed_at": "2025-12-12T11:33:25.751033Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.766951Z", "completed_at": "2025-12-12T11:33:25.766962Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.15037012100219727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__company_has_location_idlocation__idlocation__ref_stg_oracle_neshu__location_.a32b27875e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlocation as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_has_location`\n    where idlocation is not null\n),\n\nparent as (\n    select idlocation as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.701057Z", "completed_at": "2025-12-12T11:33:25.750303Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.766295Z", "completed_at": "2025-12-12T11:33:25.766306Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.1537158489227295, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_oracle_neshu__device", "compiled": true, "compiled_code": "\n\nWITH device_labels AS (\n  SELECT \n    d.iddevice as device_id,\n    d.device_iddevice,\n    d.iddevice_type as device_type_id,\n    d.code AS device_code,\n    d.name AS device_name,\n    d.last_installation_date,\n    d.created_at,\n    d.updated_at,\n    d.idlocation as location_id,\n    d.idcompany_customer as company_id,\n    c.code AS company_code,\n    c.name AS company_name,\n    lo.access_info,\n    l.code AS label_code,\n    lf.code AS label_family_code\n  FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device` d\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_device` lhd \n    ON lhd.iddevice = d.iddevice AND lhd.idlabel IS NOT NULL\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` l \n    ON l.idlabel = lhd.idlabel\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf \n    ON lf.idlabel_family = l.idlabel_family\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` c \n    ON c.idcompany = d.idcompany_customer\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location` lo\n    ON lo.idlocation = d.idlocation\n  WHERE d.idcompany_customer IS NOT NULL\n),\naggregated_labels AS (\n  SELECT\n    device_id,\n    device_type_id,\n    device_iddevice,\n    company_id,\n    location_id,\n    device_code,\n    device_name,\n    company_code,\n    company_name,\n    access_info,\n    last_installation_date,\n    created_at,\n    updated_at,\n    MAX(CASE WHEN label_family_code = 'ETAT_MACHINE' THEN label_code END) AS device_state,\n    MAX(CASE WHEN label_family_code = 'STATUT_MATERIEL' THEN label_code END) AS device_material_status,\n    MAX(CASE WHEN label_family_code = 'ISACTIVE' THEN label_code END) AS is_active,\n    MAX(CASE WHEN label_family_code = 'GAMME' THEN label_code END) AS device_gamme,\n    MAX(CASE WHEN label_family_code = 'CATEGORIE' THEN label_code END) AS device_category,\n    MAX(CASE WHEN label_family_code = 'MARQUE' THEN label_code END) AS device_brand,\n    MAX(CASE WHEN label_family_code = 'MODECOMA' THEN label_code END) AS device_economic_model\n  FROM device_labels\n  GROUP BY\n    device_id,\n    device_type_id,\n    device_iddevice,\n    company_id,\n    location_id,\n    device_code,\n    device_name,\n    company_code,\n    company_name,\n    access_info,\n    last_installation_date,\n    created_at,\n    updated_at\n)\n\nSELECT\n  -- \ud83d\udd11 Identifiants\n  device_id,\n  device_iddevice,\n  device_type_id,\n  company_id,\n  location_id,\n\n  -- \ud83d\udcc7 Codes et noms\n  device_code,\n  device_name,\n  company_code,\n  company_name,\n\n  -- \ud83c\udff7\ufe0f Caract\u00e9ristiques machine\n  device_brand,\n  device_gamme,\n  device_category,\n  device_economic_model,\n\n  -- \ud83d\udccd Localisation\n  access_info as device_location,\n\n  -- \ud83c\udff7\ufe0f \u00c9tat et statu\n  CASE\n    WHEN LOWER(is_active) = 'yes' THEN TRUE\n    ELSE FALSE\n  END AS is_active,\n\n  -- \ud83d\udd52 Dates\n  last_installation_date,\n  created_at,\n  updated_at\nFROM aggregated_labels", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.708144Z", "completed_at": "2025-12-12T11:33:25.751788Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.767570Z", "completed_at": "2025-12-12T11:33:25.767584Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.15591907501220703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__location_idlocation.fc8389056b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location`\nwhere idlocation is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.731418Z", "completed_at": "2025-12-12T11:33:25.753446Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.770326Z", "completed_at": "2025-12-12T11:33:25.770337Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.15497136116027832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__resources_type_idresources_type.9e5d062342", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources_type`\nwhere idresources_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.719867Z", "completed_at": "2025-12-12T11:33:25.754757Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.771055Z", "completed_at": "2025-12-12T11:33:25.771065Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.15976786613464355, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__device_idlocation__idlocation__ref_stg_oracle_neshu__location_.4b2426f16b", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlocation as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\n    where idlocation is not null\n),\n\nparent as (\n    select idlocation as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.726302Z", "completed_at": "2025-12-12T11:33:25.755371Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.773627Z", "completed_at": "2025-12-12T11:33:25.773638Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.16123342514038086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__location_idlocation.1903e54c83", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlocation as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location`\n  where idlocation is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.740267Z", "completed_at": "2025-12-12T11:33:25.759415Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.777329Z", "completed_at": "2025-12-12T11:33:25.777340Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.15038776397705078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__resources_type_idresources_type.60d0042392", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idresources_type as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources_type`\n  where idresources_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.802776Z", "completed_at": "2025-12-12T11:33:25.820800Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.843672Z", "completed_at": "2025-12-12T11:33:25.843687Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.12804055213928223, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__product_type_idproduct_type.99ebe48fd1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product_type`\nwhere idproduct_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.835604Z", "completed_at": "2025-12-12T11:33:25.887190Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.937166Z", "completed_at": "2025-12-12T11:33:25.937187Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.14922285079956055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__product_type_idproduct_type.9bdaa55835", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idproduct_type as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product_type`\n  where idproduct_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.827206Z", "completed_at": "2025-12-12T11:33:25.887955Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.938486Z", "completed_at": "2025-12-12T11:33:25.938499Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.15568923950195312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__product_idproduct_type__idproduct_type__ref_stg_oracle_neshu__product_type_.6fbc9b03a0", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idproduct_type as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product`\n    where idproduct_type is not null\n),\n\nparent as (\n    select idproduct_type as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product_type`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.844309Z", "completed_at": "2025-12-12T11:33:25.903655Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.940214Z", "completed_at": "2025-12-12T11:33:25.940230Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.14722490310668945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__resources_idresources.eb8d9bd2ca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.850935Z", "completed_at": "2025-12-12T11:33:25.920851Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.944119Z", "completed_at": "2025-12-12T11:33:25.944131Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.14977216720581055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_resources_idresources__idresources__ref_stg_oracle_neshu__resources_.400dad49ad", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idresources as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_resources`\n    where idresources is not null\n),\n\nparent as (\n    select idresources as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.859169Z", "completed_at": "2025-12-12T11:33:25.921472Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.945412Z", "completed_at": "2025-12-12T11:33:25.945424Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.14998388290405273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__resources_idcompany__idcompany__ref_stg_oracle_neshu__company_.a03aed6b41", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`\n    where idcompany is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.866812Z", "completed_at": "2025-12-12T11:33:25.936430Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.947063Z", "completed_at": "2025-12-12T11:33:25.947076Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.14946413040161133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__resources_idlocation__idlocation__ref_stg_oracle_neshu__location_.763e5415e9", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlocation as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`\n    where idlocation is not null\n),\n\nparent as (\n    select idlocation as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.879195Z", "completed_at": "2025-12-12T11:33:25.935785Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.946326Z", "completed_at": "2025-12-12T11:33:25.946342Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.14929914474487305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__resources_idresources.20bf66b8cb", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idresources as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`\n  where idresources is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.873919Z", "completed_at": "2025-12-12T11:33:25.937859Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.948643Z", "completed_at": "2025-12-12T11:33:25.948682Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.1521451473236084, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__resources_idresources_type__idresources_type__ref_stg_oracle_neshu__resources_type_.0a90a13b3c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idresources_type as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`\n    where idresources_type is not null\n),\n\nparent as (\n    select idresources_type as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources_type`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.891169Z", "completed_at": "2025-12-12T11:33:25.940960Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.955222Z", "completed_at": "2025-12-12T11:33:25.955235Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.15528559684753418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__appro_tasks", "compiled": true, "compiled_code": "\n\nwith passage_appro_base as (\n\n    select\n        -- Identifiants\n        t.idtask as task_id,\n        t.iddevice as device_id,\n        t.idcompany_peer as company_id,\n        t.idproduct_source as product_source_id,\n        t.type_product_source as product_source_type,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_destination as product_destination_type,\n\n        -- Codes\n        c.code as company_code,\n\n        -- Infos m\u00e9tier\n        l.access_info as task_location_info,\n        t.real_start_date as task_start_date,\n        t.real_end_date as task_end_date,\n\n        -- Status\n        ts.code as task_status_code,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` c on c.idcompany = t.idcompany_peer\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts on t.idtask_status = ts.idtask_status\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location` l on l.idlocation = t.idlocation\n\n    where 1=1\n        and t.idtask_type = 32 -- PASSAGE APPROVISIONNEURS\n        and t.code_status_record = '1'\n        and t.real_start_date is not null\n\n    group by\n        t.idtask, t.iddevice, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source,\n        t.idproduct_destination, t.type_product_destination,\n        ts.code, c.code, l.access_info,\n        t.real_start_date, t.real_end_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_id,\n    device_id,\n    company_id,\n    product_source_id,\n    product_destination_id,\n\n    -- Codes\n    company_code,\n\n    -- Infos m\u00e9tier\n    product_source_type,\n    product_destination_type,\n    task_location_info,\n    task_status_code,\n    task_start_date,\n    task_end_date,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom passage_appro_base\n\n\n  where updated_at >= (\n      select max(updated_at) - interval 1 day\n      from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`\n  )\n", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.904327Z", "completed_at": "2025-12-12T11:33:25.942104Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.958073Z", "completed_at": "2025-12-12T11:33:25.958087Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.15549755096435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__task_has_resources", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_task_has_resources`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idtask as int64) as idtask,\n        cast(idresources as int64) as idresources,\n        cast(task_status as int64) as task_status,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n),\n\n-- Synchro avec la table des t\u00e2ches pour \u00e9viter les orphelins\nfiltered_data as (\n    select cr.*\n    from cleaned_data cr\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n      on cr.idtask = t.idtask\n)\n\nselect * from filtered_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.897556Z", "completed_at": "2025-12-12T11:33:25.943441Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.959638Z", "completed_at": "2025-12-12T11:33:25.959650Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.15914654731750488, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__task_has_product", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_task_has_product`\n),\n\ncleaned_data as (\n    select\n        -- IDs (cl\u00e9s primaires et \u00e9trang\u00e8res)\n        cast(idtask_has_product as int64) as idtask_has_product,\n        cast(idtask as int64) as idtask,\n        cast(idproduct as int64) as idproduct,\n        cast(idproduct_source as int64) as idproduct_source,\n        cast(idproduct_destination as int64) as idproduct_destination,\n        cast(idtax as int64) as idtax,\n        cast(idtask_has_product_associed as int64) as idtask_has_product_associed,\n        cast(iddevice as int64) as iddevice,\n        cast(idcompany_peer as int64) as idcompany_peer,\n        cast(idlocation as int64) as idlocation,\n\n        -- Colonnes texte et types\n        type_product_source,\n        type_product_destination,\n        code,\n        name,\n        cast(priceline_number as int64) as priceline_number,\n\n        -- Colonnes num\u00e9riques\n        cast(real_quantity as float64) as real_quantity,\n        cast(average_purchase_price as float64) as average_purchase_price,\n        cast(tax_rate as float64) as tax_rate,\n        cast(tax_amount as float64) as tax_amount,\n        cast(global_discount_amount as float64) as global_discount_amount,\n        cast(net_price as float64) as net_price,\n        cast(sale_amount_net_tax as float64) as sale_amount_net_tax,\n        cast(sale_amount_net as float64) as sale_amount_net,\n        cast(sale_unit_price as float64) as sale_unit_price,\n        cast(purchase_unit_price as float64) as purchase_unit_price,\n        cast(sale_amount_brut as float64) as sale_amount_brut,\n        cast(unit_coeff_multi as float64) as unit_coeff_multi,\n        cast(sale_unit_price_tax as float64) as sale_unit_price_tax,\n        cast(unit_coeff_div as float64) as unit_coeff_div,\n\n        -- Timestamps harmonis\u00e9s (standard DBT)\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n),\n\n-- \u26a0\ufe0f S\u00e9curit\u00e9 de jointure pour \u00e9viter les orphelins\nfiltered_data as (\n    select c.*\n    from cleaned_data c\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n        on c.idtask = t.idtask\n)\n\nSELECT * FROM filtered_data\n\nWHERE\n    (\n        updated_at > (\n            SELECT MAX(updated_at)\n            FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product`\n        )\n        OR updated_at >= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 7 DAY)\n    )\n", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.908562Z", "completed_at": "2025-12-12T11:33:25.942823Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.958832Z", "completed_at": "2025-12-12T11:33:25.958843Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.15921688079833984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__task_idtask.2b9ac7a02d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.915524Z", "completed_at": "2025-12-12T11:33:25.944788Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.960406Z", "completed_at": "2025-12-12T11:33:25.960418Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.16005730628967285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__task_status_idtask_status.fb3f3fc34e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_status\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status`\nwhere idtask_status is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.922140Z", "completed_at": "2025-12-12T11:33:25.947742Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.967612Z", "completed_at": "2025-12-12T11:33:25.967626Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.16440582275390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_idcompany_peer__idcompany__ref_stg_oracle_neshu__company_.9ee5ef13e5", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_peer as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n    where idcompany_peer is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.928683Z", "completed_at": "2025-12-12T11:33:25.949258Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:25.972436Z", "completed_at": "2025-12-12T11:33:25.972449Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.15883660316467285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_idcontact__idcontact__ref_stg_oracle_neshu__contact_.ded621d0d6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcontact as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n    where idcontact is not null\n),\n\nparent as (\n    select idcontact as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contact`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:25.995332Z", "completed_at": "2025-12-12T11:33:26.016701Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.044622Z", "completed_at": "2025-12-12T11:33:26.044646Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.13340520858764648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_iddevice__iddevice__ref_stg_oracle_neshu__device_.03aef0389f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select iddevice as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n    where iddevice is not null\n),\n\nparent as (\n    select iddevice as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.025100Z", "completed_at": "2025-12-12T11:33:26.082023Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.129199Z", "completed_at": "2025-12-12T11:33:26.129220Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.14789891242980957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_idlocation__idlocation__ref_stg_oracle_neshu__location_.8b4be19759", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlocation as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n    where idlocation is not null\n),\n\nparent as (\n    select idlocation as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.032062Z", "completed_at": "2025-12-12T11:33:26.082750Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.130553Z", "completed_at": "2025-12-12T11:33:26.130565Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.14149761199951172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_idtask_status__idtask_status__ref_stg_oracle_neshu__task_status_.8e6c31af0d", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idtask_status as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n    where idtask_status is not null\n),\n\nparent as (\n    select idtask_status as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.039303Z", "completed_at": "2025-12-12T11:33:26.083531Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.131203Z", "completed_at": "2025-12-12T11:33:26.131218Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.142869234085083, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__task_idtask.d1f0e7ba99", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n  where idtask is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.048789Z", "completed_at": "2025-12-12T11:33:26.114406Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.135539Z", "completed_at": "2025-12-12T11:33:26.135551Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.14281749725341797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__task_status_idtask_status.6822490986", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_status as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status`\n  where idtask_status is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.054111Z", "completed_at": "2025-12-12T11:33:26.115840Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.138074Z", "completed_at": "2025-12-12T11:33:26.138084Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.14495515823364258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__task_type_idtask_type.30b55370e2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_type`\nwhere idtask_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.061371Z", "completed_at": "2025-12-12T11:33:26.115153Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.137427Z", "completed_at": "2025-12-12T11:33:26.137439Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.14629244804382324, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_idtask_type__idtask_type__ref_stg_oracle_neshu__task_type_.b77e854b8e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idtask_type as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n    where idtask_type is not null\n),\n\nparent as (\n    select idtask_type as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_type`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.068556Z", "completed_at": "2025-12-12T11:33:26.116481Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.138697Z", "completed_at": "2025-12-12T11:33:26.138708Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.14784574508666992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__task_type_idtask_type.6a67987299", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_type as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_type`\n  where idtask_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.074823Z", "completed_at": "2025-12-12T11:33:26.129909Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.139850Z", "completed_at": "2025-12-12T11:33:26.139862Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.14836478233337402, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_oracle_neshu_gcs__stock_products", "compiled": true, "compiled_code": "\n\nWITH resources_labels AS (\n    SELECT\n        r.idresources,\n        r.idresources_type,\n        r.code AS resources_code,\n        r.name AS resources_name,\n        lh.idlabel,\n        l.code AS label_code,\n        lf.code AS label_family_code\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` r\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_resources` lh\n        ON lh.idresources = r.idresources\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` l\n        ON l.idlabel = lh.idlabel\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf\n        ON lf.idlabel_family = l.idlabel_family\n),\n\naggregated_labels AS (\n    SELECT\n        idresources,\n        idresources_type,\n        resources_code,\n        resources_name,\n        MAX(CASE WHEN label_family_code = 'ISACTIVE' THEN label_code END) AS is_active\n    FROM resources_labels\n    WHERE idresources_type = 3  -- TYPE VEHICULE\n    GROUP BY 1,2,3,4\n),\n\nfiltered_stock AS (\n    SELECT\n        st.id_entity,\n        st.entity_type,\n        st.resources_code AS entity_code,\n        st.entity_name,\n        st.product_code,\n        st.product_name,\n        st.stock_at_date,\n        CASE WHEN st.stock_at_date = 0 THEN TRUE ELSE FALSE END AS is_out_of_stock,\n        st.date_inventaire,\n        st.stock_inventaire,\n        st.plus,\n        st.moins,\n        COALESCE(st.dpa, st.purchase_price) AS dpa,\n        st.purchase_price,\n        st.date_system,\n        st.extracted_at,\n        st.file_datetime\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu_gcs__stock_theorique` st\n    LEFT JOIN aggregated_labels al\n        ON st.id_entity = al.idresources\n        AND st.entity_type = 'RESOURCE'\n    WHERE \n        (\n            st.entity_type = 'COMPANY'\n            AND st.entity_name IN (\n                '01 - RUNGIS DEPOT PRODUITS',\n                '02 - LYON DEPOT PRODUITS',\n                '03 - BORDEAUX DEPOT PRODUITS',\n                '04 - STRASBOURG DEPOT PRODUITS',\n                '05 - PERIMES DEPOT',\n                '10 - REBUS DEPOT',\n                '13 - MARSEILLE DEPOT PRODUITS'\n            )\n        )\n        OR\n        (\n            st.entity_type = 'RESOURCE'\n            AND al.is_active = 'YES'\n        )\n)\n\nSELECT *\nFROM filtered_stock", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu_gcs__stock_products`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.086549Z", "completed_at": "2025-12-12T11:33:26.133057Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.148805Z", "completed_at": "2025-12-12T11:33:26.148820Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.15039539337158203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu_gcs__stock_theorique_date_system.4726062962", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_system\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu_gcs__stock_theorique`\nwhere date_system is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.099116Z", "completed_at": "2025-12-12T11:33:26.133996Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.149427Z", "completed_at": "2025-12-12T11:33:26.149437Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.15136432647705078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu_gcs__stock_theorique_id_entity.fc4ff33db7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id_entity\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu_gcs__stock_theorique`\nwhere id_entity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.104470Z", "completed_at": "2025-12-12T11:33:26.134811Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.150060Z", "completed_at": "2025-12-12T11:33:26.150071Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.15271520614624023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu_gcs__stock_theorique_product_code.4c3ae6f9c8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_code\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu_gcs__stock_theorique`\nwhere product_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.092140Z", "completed_at": "2025-12-12T11:33:26.136141Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.150766Z", "completed_at": "2025-12-12T11:33:26.150776Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.15697836875915527, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu_gcs__stock_theorique_file_datetime.79c559191e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect file_datetime\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu_gcs__stock_theorique`\nwhere file_datetime is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.109709Z", "completed_at": "2025-12-12T11:33:26.136836Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.153466Z", "completed_at": "2025-12-12T11:33:26.153478Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.15784001350402832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_yuman__clients", "compiled": true, "compiled_code": "\n\nSELECT \n-- Informations Client \nclient_id,\npartner_name\nclient_code,\nclient_name,\nclient_category,\nclient_address,\nis_active as client_is_active,\ncreated_at,\nupdated_at\n\nFROM `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients` ym", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_yuman__clients`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.122544Z", "completed_at": "2025-12-12T11:33:26.143366Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.163695Z", "completed_at": "2025-12-12T11:33:26.163707Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.15884613990783691, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__clients_client_id.f44f6dd39f", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select client_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients`\n  where client_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.117123Z", "completed_at": "2025-12-12T11:33:26.140498Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.162361Z", "completed_at": "2025-12-12T11:33:26.162374Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.16208219528198242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__clients_client_id.2396172faf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect client_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients`\nwhere client_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.187514Z", "completed_at": "2025-12-12T11:33:26.205816Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.231809Z", "completed_at": "2025-12-12T11:33:26.231830Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.13547682762145996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__materials_material_id.ebfe5a9c25", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect material_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`\nwhere material_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.211774Z", "completed_at": "2025-12-12T11:33:26.265372Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.315596Z", "completed_at": "2025-12-12T11:33:26.315614Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.14767909049987793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__materials_site_id.e77c7f24c2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect site_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`\nwhere site_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.224359Z", "completed_at": "2025-12-12T11:33:26.275260Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.317331Z", "completed_at": "2025-12-12T11:33:26.317348Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1455838680267334, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_yuman__materials", "compiled": true, "compiled_code": "\n\nSELECT \n-- Informations Machine\nym.material_id,\nym.site_id,\nym.material_description,\nym.material_name,\nym.material_brand,\nym.material_serial_number,\nycat.category_name,\nym.material_in_service_date,\nym.created_at,\nym.updated_at\nFROM `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials` ym\nleft join `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials_categories` ycat on ycat.category_id = ym.category_id", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_yuman__materials`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.219076Z", "completed_at": "2025-12-12T11:33:26.276009Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.319305Z", "completed_at": "2025-12-12T11:33:26.319320Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1491687297821045, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__materials_material_id.0de6595c40", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select material_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`\n  where material_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.233131Z", "completed_at": "2025-12-12T11:33:26.289854Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.320863Z", "completed_at": "2025-12-12T11:33:26.320875Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.14238929748535156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__materials_category_id__category_id__ref_stg_yuman__materials_categories_.14b0abe07f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select category_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`\n    where category_id is not null\n),\n\nparent as (\n    select category_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials_categories`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.241034Z", "completed_at": "2025-12-12T11:33:26.301993Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.322497Z", "completed_at": "2025-12-12T11:33:26.322510Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.14357209205627441, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__purchase_orders_purchase_order_id.668459bb5c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect purchase_order_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__purchase_orders`\nwhere purchase_order_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.252382Z", "completed_at": "2025-12-12T11:33:26.308394Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.324479Z", "completed_at": "2025-12-12T11:33:26.324491Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.14534282684326172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__purchase_orders_purchase_order_line_id.6a52ee22dc", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select purchase_order_line_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__purchase_orders`\n  where purchase_order_line_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.257483Z", "completed_at": "2025-12-12T11:33:26.314890Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.326116Z", "completed_at": "2025-12-12T11:33:26.326131Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.14670252799987793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_yuman__materials_clients", "compiled": true, "compiled_code": "\n\nSELECT \n-- Informations Machine\nym.material_id,\nym.material_description,\nym.material_name,\nym.material_brand,\nym.material_serial_number,\nycat.category_name,\nym.material_in_service_date,\n-- Informations Client \nyc.client_id,\nyc.client_code,\nyc.client_address,\nyc.client_name,\nyc.partner_name,\n-- Informations Site\nys.site_id,\nys.site_address,\nys.site_name, \nys.site_postal_code\nFROM `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials` ym\nleft join `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites` ys on ym.site_id=ys.site_id\nleft join `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients` yc on ys.client_id= yc.client_id\nleft join `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials_categories` ycat on ycat.category_id = ym.category_id", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_yuman__materials_clients`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.270198Z", "completed_at": "2025-12-12T11:33:26.318068Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.330543Z", "completed_at": "2025-12-12T11:33:26.330553Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.14533329010009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__sites_client_id.a2a87aa602", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect client_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\nwhere client_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.247165Z", "completed_at": "2025-12-12T11:33:26.316250Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.329820Z", "completed_at": "2025-12-12T11:33:26.329832Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.15493488311767578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__purchase_orders_purchase_order_line_id.d6eed878cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect purchase_order_line_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__purchase_orders`\nwhere purchase_order_line_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.266326Z", "completed_at": "2025-12-12T11:33:26.318645Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.333309Z", "completed_at": "2025-12-12T11:33:26.333321Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.15131473541259766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_yuman__sites", "compiled": true, "compiled_code": "\n\nSELECT \n-- Informations Client \nsite_id,\nclient_id,\nagency_id,\nsite_code,\nsite_name,\nsite_address,\nsite_postal_code,\ncreated_at,\nupdated_at\n\nFROM `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites` ym", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.276811Z", "completed_at": "2025-12-12T11:33:26.321642Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.338956Z", "completed_at": "2025-12-12T11:33:26.338968Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.1535475254058838, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__sites_site_id.7b80b04fc4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect site_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\nwhere site_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.284756Z", "completed_at": "2025-12-12T11:33:26.323143Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.341583Z", "completed_at": "2025-12-12T11:33:26.341594Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.15511751174926758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__materials_site_id__site_id__ref_stg_yuman__sites_.074fc55183", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select site_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`\n    where site_id is not null\n),\n\nparent as (\n    select site_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.292599Z", "completed_at": "2025-12-12T11:33:26.323851Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.342237Z", "completed_at": "2025-12-12T11:33:26.342248Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.15587186813354492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__sites_client_id__client_id__ref_stg_yuman__clients_.ab91ca52c3", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select client_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\n    where client_id is not null\n),\n\nparent as (\n    select client_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.309175Z", "completed_at": "2025-12-12T11:33:26.325465Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.342967Z", "completed_at": "2025-12-12T11:33:26.342977Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.14878153800964355, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__products_product_id.4e68e010db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__products`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.303079Z", "completed_at": "2025-12-12T11:33:26.326779Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.347748Z", "completed_at": "2025-12-12T11:33:26.347760Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.15403461456298828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__sites_site_id.c2fdd1abc3", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select site_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\n  where site_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.376419Z", "completed_at": "2025-12-12T11:33:26.396205Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.427458Z", "completed_at": "2025-12-12T11:33:26.427474Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1400434970855713, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__purchase_orders_product_id__product_id__ref_stg_yuman__products_.ff6ab86020", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__purchase_orders`\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__products`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.400848Z", "completed_at": "2025-12-12T11:33:26.453510Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.504032Z", "completed_at": "2025-12-12T11:33:26.504048Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.14747881889343262, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__products_product_id.da6f1079d3", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select product_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__products`\n  where product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.409711Z", "completed_at": "2025-12-12T11:33:26.460824Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.506404Z", "completed_at": "2025-12-12T11:33:26.506418Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.14780521392822266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__storehouses_storehouses_id.9995b08d83", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect storehouses_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__storehouses`\nwhere storehouses_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.416231Z", "completed_at": "2025-12-12T11:33:26.473789Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.508842Z", "completed_at": "2025-12-12T11:33:26.508855Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.14934897422790527, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__storehouses_storehouses_id.1b6953f5b9", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select storehouses_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__storehouses`\n  where storehouses_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.428156Z", "completed_at": "2025-12-12T11:33:26.496690Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.512788Z", "completed_at": "2025-12-12T11:33:26.512803Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.14326715469360352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorder_products_product_id.92e35e7cb0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.421330Z", "completed_at": "2025-12-12T11:33:26.487724Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.511690Z", "completed_at": "2025-12-12T11:33:26.511702Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.14815926551818848, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__users_user_id.9881abfe99", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__users`\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.435350Z", "completed_at": "2025-12-12T11:33:26.504645Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.518035Z", "completed_at": "2025-12-12T11:33:26.518047Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.1473231315612793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorder_products_product_quantity.9f9bbee75c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_quantity\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`\nwhere product_quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.442065Z", "completed_at": "2025-12-12T11:33:26.505572Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.519273Z", "completed_at": "2025-12-12T11:33:26.519285Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.1492629051208496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorder_products_workorder_id.a954e8ba15", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect workorder_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`\nwhere workorder_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.454514Z", "completed_at": "2025-12-12T11:33:26.508025Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.522715Z", "completed_at": "2025-12-12T11:33:26.522727Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.14897942543029785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorder_products_product_id__product_id__ref_stg_yuman__products_.ed6480bad9", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__products`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.448331Z", "completed_at": "2025-12-12T11:33:26.507239Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.522058Z", "completed_at": "2025-12-12T11:33:26.522070Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.1530296802520752, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorder_products_workorder_product_id.f12c8d1634", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect workorder_product_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`\nwhere workorder_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.461486Z", "completed_at": "2025-12-12T11:33:26.510123Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.526294Z", "completed_at": "2025-12-12T11:33:26.526305Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.15340304374694824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__users_user_id.e4b2c79cf4", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select user_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__users`\n  where user_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.466987Z", "completed_at": "2025-12-12T11:33:26.509468Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.525642Z", "completed_at": "2025-12-12T11:33:26.525653Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.15307903289794922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__workorder_products_workorder_product_id.1591ef7ef7", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select workorder_product_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`\n  where workorder_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.489801Z", "completed_at": "2025-12-12T11:33:26.514279Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.530506Z", "completed_at": "2025-12-12T11:33:26.530517Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.1533195972442627, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorder_demands_material_id__material_id__ref_stg_yuman__materials_.0624c21af4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select material_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\n    where material_id is not null\n),\n\nparent as (\n    select material_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.477151Z", "completed_at": "2025-12-12T11:33:26.513381Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.529852Z", "completed_at": "2025-12-12T11:33:26.529868Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.15868139266967773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorder_demands_demand_id.12776f5dd4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect demand_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\nwhere demand_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.497721Z", "completed_at": "2025-12-12T11:33:26.514990Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.533097Z", "completed_at": "2025-12-12T11:33:26.533108Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.1505577564239502, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorder_demands_site_id__site_id__ref_stg_yuman__sites_.207aca79ff", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select site_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\n    where site_id is not null\n),\n\nparent as (\n    select site_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.482656Z", "completed_at": "2025-12-12T11:33:26.518617Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.536617Z", "completed_at": "2025-12-12T11:33:26.536629Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.16422390937805176, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorder_demands_client_id__client_id__ref_stg_yuman__clients_.71d22ac8fd", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select client_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\n    where client_id is not null\n),\n\nparent as (\n    select client_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.568327Z", "completed_at": "2025-12-12T11:33:26.588249Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.620734Z", "completed_at": "2025-12-12T11:33:26.620749Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.15443730354309082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorder_demands_user_id__user_id__ref_stg_yuman__users_.605074afbf", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select user_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\n    where user_id is not null\n),\n\nparent as (\n    select user_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__users`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.590197Z", "completed_at": "2025-12-12T11:33:26.633132Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.695595Z", "completed_at": "2025-12-12T11:33:26.695614Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.15010738372802734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__workorder_demands_demand_id.adbb788cb2", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select demand_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\n  where demand_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.597492Z", "completed_at": "2025-12-12T11:33:26.647235Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.697348Z", "completed_at": "2025-12-12T11:33:26.697364Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.14881420135498047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorder_demands_categories_demand_category_id.5e8aa9b42e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect demand_category_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands_categories`\nwhere demand_category_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.603604Z", "completed_at": "2025-12-12T11:33:26.661091Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.699396Z", "completed_at": "2025-12-12T11:33:26.699407Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1501610279083252, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorder_demands_demand_category_id__demand_category_id__ref_stg_yuman__workorder_demands_categories_.871194aaa2", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select demand_category_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\n    where demand_category_id is not null\n),\n\nparent as (\n    select demand_category_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands_categories`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.612510Z", "completed_at": "2025-12-12T11:33:26.679218Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.701476Z", "completed_at": "2025-12-12T11:33:26.701489Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.1427454948425293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__workorder_demands_categories_demand_category_id.36d7a5e24e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select demand_category_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands_categories`\n  where demand_category_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.621383Z", "completed_at": "2025-12-12T11:33:26.694777Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.705957Z", "completed_at": "2025-12-12T11:33:26.705969Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.1466374397277832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorders_created_at.0aad14f863", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.627226Z", "completed_at": "2025-12-12T11:33:26.696413Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.707987Z", "completed_at": "2025-12-12T11:33:26.707998Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.14813637733459473, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorders_workorder_id.7745d31fcf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect workorder_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\nwhere workorder_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.633948Z", "completed_at": "2025-12-12T11:33:26.698011Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.710967Z", "completed_at": "2025-12-12T11:33:26.710985Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.1495373249053955, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorder_products_workorder_id__workorder_id__ref_stg_yuman__workorders_.c56a733e8f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select workorder_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`\n    where workorder_id is not null\n),\n\nparent as (\n    select workorder_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.640850Z", "completed_at": "2025-12-12T11:33:26.698616Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.713731Z", "completed_at": "2025-12-12T11:33:26.713743Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.15125346183776855, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorders_client_id__client_id__ref_stg_yuman__clients_.2696f7708f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select client_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\n    where client_id is not null\n),\n\nparent as (\n    select client_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.647901Z", "completed_at": "2025-12-12T11:33:26.700217Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.716491Z", "completed_at": "2025-12-12T11:33:26.716504Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.15171265602111816, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorders_site_id__site_id__ref_stg_yuman__sites_.966845c1c7", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select site_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\n    where site_id is not null\n),\n\nparent as (\n    select site_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.661948Z", "completed_at": "2025-12-12T11:33:26.702208Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.719263Z", "completed_at": "2025-12-12T11:33:26.719275Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.15364551544189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorders_category_id__category_id__ref_stg_yuman__workorders_categories_.c014c83acd", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select category_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\n    where category_id is not null\n),\n\nparent as (\n    select category_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders_categories`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.656012Z", "completed_at": "2025-12-12T11:33:26.702874Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.719915Z", "completed_at": "2025-12-12T11:33:26.719930Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.15633416175842285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__workorders_workorder_id.38a2d26084", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select workorder_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\n  where workorder_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.668148Z", "completed_at": "2025-12-12T11:33:26.703586Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.720536Z", "completed_at": "2025-12-12T11:33:26.720547Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.1560959815979004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_yuman_gcs__stock_articles", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- MODEL: fct_yuman__stocks\n-- PURPOSE: Suivis des stocks pi\u00e8ces Yuman par stock technicien et d\u00e9p\u00f4t journaliers\n-- AUTHOR: Cebrail AKSOY\n-- ============================================================================\n\nWITH \n-- ============================================================================\n-- 1. BASE DATA EXTRACTION\n-- ============================================================================\nfiltered_stocks as (\n\nSELECT\n    -- Attributs m\u00e9tier \n    reference, \n    designation, \n    nom_du_stock as stock,\n\n    -- Mesure\n    quantite, \n\n    -- Date\n    DATE(export_date) as stock_date,\n\n    -- M\u00e9tadonn\u00e9es d'ex\u00e9cution\n    CURRENT_TIMESTAMP() as dbt_updated_at,\n    '2595904a-aec3-41ec-a1e9-f19d18d6d7af' as dbt_invocation_id\n\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_yuman_gcs__stock_theorique`\n    WHERE reference is not null and nom_du_stock is not null\n)\n\nSELECT * \nFROM filtered_stocks", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_yuman_gcs__stock_articles`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.672301Z", "completed_at": "2025-12-12T11:33:26.704923Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.721878Z", "completed_at": "2025-12-12T11:33:26.721889Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.15809345245361328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_unique_combination_of_columns_stg_yuman_gcs__stock_theorique_export_date___sdc_source_lineno.6cb5813f4f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        export_date, _sdc_source_lineno\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman_gcs__stock_theorique`\n    group by export_date, _sdc_source_lineno\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.682420Z", "completed_at": "2025-12-12T11:33:26.706558Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.722603Z", "completed_at": "2025-12-12T11:33:26.722614Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.15809917449951172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_general__feries_metropole_annee.8bddc6a4ab", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect annee\nfrom `evs-datastack-prod`.`prod_reference`.`ref_general__feries_metropole`\nwhere annee is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.687719Z", "completed_at": "2025-12-12T11:33:26.707242Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.725331Z", "completed_at": "2025-12-12T11:33:26.725343Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.15454697608947754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_general__feries_metropole_date_ferie.4127e8fff9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_ferie\nfrom `evs-datastack-prod`.`prod_reference`.`ref_general__feries_metropole`\nwhere date_ferie is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.759658Z", "completed_at": "2025-12-12T11:33:26.777965Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.814268Z", "completed_at": "2025-12-12T11:33:26.814286Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.15592384338378906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_general__feries_metropole_mois.465a60af3b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mois\nfrom `evs-datastack-prod`.`prod_reference`.`ref_general__feries_metropole`\nwhere mois is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.779292Z", "completed_at": "2025-12-12T11:33:26.821454Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.878367Z", "completed_at": "2025-12-12T11:33:26.878382Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.1396961212158203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_general__feries_metropole_nom_jour_ferie.cd4b7e3874", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nom_jour_ferie\nfrom `evs-datastack-prod`.`prod_reference`.`ref_general__feries_metropole`\nwhere nom_jour_ferie is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.785444Z", "completed_at": "2025-12-12T11:33:26.828013Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.880616Z", "completed_at": "2025-12-12T11:33:26.880629Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.14348173141479492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_mssql_sage__code_analytique_bu_code_analytique.ef2bcb0ae7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect code_analytique\nfrom `evs-datastack-prod`.`prod_reference`.`ref_mssql_sage__code_analytique_bu`\nwhere code_analytique is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.792993Z", "completed_at": "2025-12-12T11:33:26.846570Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.882508Z", "completed_at": "2025-12-12T11:33:26.882525Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.14546656608581543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_mssql_sage__pnl_bu", "compiled": true, "compiled_code": "\n\nWITH ecritures_comptables AS (\n  SELECT\n    ec_no AS numero_ecriture_comptable,\n    cg_num AS numero_compte_general,\n    ec_intitule AS libelle_ecriture,\n    ec_sens as sens_ecriture,\n    ec_date AS date_ecriture_comptable,\n    jm_date AS date_periode_facturation,\n    ec_jour AS jour_facturation,\n    timestamp(DATE_ADD(jm_date, INTERVAL (ec_jour - 1) DAY)) AS date_facturation,\n    created_at,\n    updated_at\n  FROM `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturec`\n  WHERE LEFT(CAST(cg_num AS STRING), 1) IN ('6', '7')\n),\n\nhistoric_mapping AS (\n    SELECT *\n    FROM `evs-datastack-prod`.`historic`.`update_mssql_sage__analytique_2024`\n),\n\necritures_analytiques AS (\n  SELECT\n    ec_no AS numero_ecriture_comptable,\n    n_analytique AS numero_plan_analytique,\n    ea_ligne AS numero_ligne_analytique,\n    ca_num AS code_analytique,\n    ea_montant AS montant_analytique,\n    created_at,\n    updated_at\n  FROM `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturea`\n),\n\nmapping_code_comptable__bu AS (\n  SELECT * FROM `evs-datastack-prod`.`prod_reference`.`ref_mssql_sage__code_comptable_bu`\n),\n\nmapping_code_analytique__bu AS (\n  SELECT * FROM `evs-datastack-prod`.`prod_reference`.`ref_mssql_sage__code_analytique_bu`\n),\n\n-- \ud83e\udde9 Jointure principale + fallback BU analytique\nmapped_with_fallback AS (\n  SELECT\n    c.numero_ecriture_comptable,\n    a.numero_plan_analytique,\n    a.numero_ligne_analytique,\n\n    a.code_analytique,\n    -- Fallback logique pour le code BU analytique\n    CASE\n      WHEN bu.code_analytique_bu IS NOT NULL THEN bu.code_analytique_bu\n      WHEN a.code_analytique LIKE 'NUN%' THEN 'NUNSHEN'\n      WHEN a.code_analytique LIKE 'HOR%' THEN 'COMMERCE'\n      WHEN a.code_analytique LIKE 'OFF%' THEN 'COMMERCE'\n      WHEN a.code_analytique LIKE 'NES%' THEN 'NESHU'\n      WHEN a.code_analytique LIKE 'SAV%' THEN 'TECHNIQUE'\n      WHEN a.code_analytique LIKE 'COM%' THEN 'COMMERCE'\n      WHEN a.code_analytique LIKE 'PDET%' THEN 'PIECES DET'\n      ELSE NULL\n    END AS code_analytique_bu,\n\n    c.numero_compte_general,\n    c.libelle_ecriture,\n    cbu.macro_categorie_pnl_bu,\n\n    c.sens_ecriture,\n\n    a.montant_analytique,\n\n    c.date_facturation,\n    c.date_ecriture_comptable,\n    c.date_periode_facturation,\n    c.jour_facturation,\n\n    -- Indicateur qualit\u00e9 : \u00e9criture sans ligne analytique\n    CASE \n      WHEN a.numero_ecriture_comptable IS NULL THEN TRUE \n      ELSE FALSE \n    END AS is_missing_analytical,\n\n    -- M\u00e9tadonn\u00e9es\n    COALESCE(a.created_at, c.created_at) AS created_at,\n    COALESCE(a.updated_at, c.updated_at) AS updated_at\n\n  FROM ecritures_comptables c\n  LEFT JOIN ecritures_analytiques a\n    ON c.numero_ecriture_comptable = a.numero_ecriture_comptable\n  LEFT JOIN mapping_code_analytique__bu bu\n    ON a.code_analytique = bu.code_analytique\n  LEFT JOIN mapping_code_comptable__bu cbu\n    ON CAST(c.numero_compte_general AS STRING) = cbu.code_comptable\n),\n\nupdated_2024 AS (\n  SELECT \n    f.numero_ecriture_comptable,\n    f.numero_plan_analytique,\n    f.numero_ligne_analytique,\n    f.code_analytique,\n    -- Remplace par le code_analytique_bu de la table de r\u00e9f\u00e9rence si disponible\n    COALESCE(u.code_analytique_bu, f.code_analytique_bu) AS code_analytique_bu,\n    f.numero_compte_general,\n    f.libelle_ecriture,\n    f.macro_categorie_pnl_bu,\n    f.sens_ecriture,\n    f.montant_analytique,\n    f.date_facturation,\n    f.date_ecriture_comptable,\n    f.date_periode_facturation,\n    f.jour_facturation,\n    f.is_missing_analytical,\n    f.created_at,\n    f.updated_at\n  FROM \n    mapped_with_fallback f  -- \u26a0\ufe0f Remplace par le nom de ta derni\u00e8re CTE avant le SELECT final\n  LEFT JOIN\n    historic_mapping u\n    ON f.numero_ecriture_comptable = u.numero_ecriture_comptable\n    AND (\n      -- Cas 1: Jointure compl\u00e8te sur les 3 cl\u00e9s quand elles sont renseign\u00e9es\n      (f.numero_plan_analytique IS NOT NULL \n       AND f.numero_ligne_analytique IS NOT NULL\n       AND f.numero_plan_analytique = u.numero_plan_analytique\n       AND f.numero_ligne_analytique = u.numero_ligne_analytique)\n      OR\n      -- Cas 2: Jointure uniquement sur numero_ecriture_comptable si les autres sont vides\n      (f.numero_plan_analytique IS NULL OR f.numero_ligne_analytique IS NULL)\n    )\n    AND EXTRACT(YEAR FROM f.date_facturation) = 2024  -- \u26a0\ufe0f Filtre uniquement l'ann\u00e9e 2024\n)\n\n-- \u2705 SELECT final (modifi\u00e9 pour utiliser updated_2024 au lieu de mapped_with_fallback)\nSELECT\n  numero_ecriture_comptable,\n  numero_plan_analytique,\n  numero_ligne_analytique,\n  code_analytique,\n  code_analytique_bu,\n  numero_compte_general,\n  libelle_ecriture,\n  macro_categorie_pnl_bu,\n  sens_ecriture,\n  montant_analytique,\n\n  CASE\n    WHEN LEFT(CAST(numero_compte_general AS STRING), 1) = '6' AND sens_ecriture = 0 THEN -ABS(montant_analytique)\n    WHEN LEFT(CAST(numero_compte_general AS STRING), 1) = '6' AND sens_ecriture = 1 THEN ABS(montant_analytique)\n    WHEN LEFT(CAST(numero_compte_general AS STRING), 1) = '7' AND sens_ecriture = 0 THEN -ABS(montant_analytique)\n    WHEN LEFT(CAST(numero_compte_general AS STRING), 1) = '7' AND sens_ecriture = 1 THEN ABS(montant_analytique)\n    ELSE montant_analytique\n  END AS montant_analytique_signe,\n\n  date_facturation,\n  date_ecriture_comptable,\n  date_periode_facturation,\n  jour_facturation,\n  is_missing_analytical,\n  \n  CASE\n    WHEN code_analytique_bu IS NULL AND is_missing_analytical = FALSE THEN TRUE\n    ELSE FALSE\n  END AS is_missing_bu_mapping,\n\n  CASE\n    WHEN macro_categorie_pnl_bu IS NULL THEN TRUE\n    ELSE FALSE\n  END AS is_missing_comptable_mapping,\n\n  created_at,\n  updated_at\n  \nFROM updated_2024  -- \u26a0\ufe0f Chang\u00e9 de mapped_with_fallback \u00e0 updated_2024", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_mssql_sage__pnl_bu`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.800523Z", "completed_at": "2025-12-12T11:33:26.852379Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.884752Z", "completed_at": "2025-12-12T11:33:26.884768Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.146193265914917, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_mssql_sage__code_comptable_bu_code_comptable.00794e5ede", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect code_comptable\nfrom `evs-datastack-prod`.`prod_reference`.`ref_mssql_sage__code_comptable_bu`\nwhere code_comptable is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.809111Z", "completed_at": "2025-12-12T11:33:26.879005Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.892775Z", "completed_at": "2025-12-12T11:33:26.892788Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.14228558540344238, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_mssql_sage__code_comptable_bu_designation_compte.97015b9642", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect designation_compte\nfrom `evs-datastack-prod`.`prod_reference`.`ref_mssql_sage__code_comptable_bu`\nwhere designation_compte is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.822874Z", "completed_at": "2025-12-12T11:33:26.881510Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.894779Z", "completed_at": "2025-12-12T11:33:26.894790Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.14124250411987305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_oracle_neshu__groupement_machine_device_group.b7ccc7bacb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_group\nfrom `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__groupement_machine`\nwhere device_group is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.816111Z", "completed_at": "2025-12-12T11:33:26.879979Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.894029Z", "completed_at": "2025-12-12T11:33:26.894045Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.14451289176940918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_ref_mssql_sage__code_comptable_bu_code_comptable.91b63969c2", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select code_comptable as unique_field\n  from `evs-datastack-prod`.`prod_reference`.`ref_mssql_sage__code_comptable_bu`\n  where code_comptable is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.828774Z", "completed_at": "2025-12-12T11:33:26.883222Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.897528Z", "completed_at": "2025-12-12T11:33:26.897543Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.14472198486328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_oracle_neshu__groupement_machine_device_name.d7b80898ca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_name\nfrom `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__groupement_machine`\nwhere device_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.835685Z", "completed_at": "2025-12-12T11:33:26.885409Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.900889Z", "completed_at": "2025-12-12T11:33:26.900906Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.1471872329711914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_oracle_neshu__roadman_gea_gea_code.486a4f1e6c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect gea_code\nfrom `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__roadman_gea`\nwhere gea_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.841155Z", "completed_at": "2025-12-12T11:33:26.884059Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.898208Z", "completed_at": "2025-12-12T11:33:26.898224Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.14782452583312988, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_oracle_neshu__roadman_gea_roadman_code.821eb0e0f4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect roadman_code\nfrom `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__roadman_gea`\nwhere roadman_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.847270Z", "completed_at": "2025-12-12T11:33:26.886491Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.903617Z", "completed_at": "2025-12-12T11:33:26.903628Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.15051746368408203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_oracle_neshu__valo_machine_capacite_device_group.2c5ceeae33", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_group\nfrom `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__valo_machine_capacite`\nwhere device_group is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.853026Z", "completed_at": "2025-12-12T11:33:26.887110Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.904289Z", "completed_at": "2025-12-12T11:33:26.904305Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.1519298553466797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_oracle_neshu__valo_machine_capacite_product_code.1333e96e14", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_code\nfrom `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__valo_machine_capacite`\nwhere product_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.858266Z", "completed_at": "2025-12-12T11:33:26.887764Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.904966Z", "completed_at": "2025-12-12T11:33:26.904977Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.1531829833984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_oracle_neshu__valo_machine_capacite_quantite.4f86698dfa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantite\nfrom `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__valo_machine_capacite`\nwhere quantite is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.864837Z", "completed_at": "2025-12-12T11:33:26.892075Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.907017Z", "completed_at": "2025-12-12T11:33:26.907028Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.15579819679260254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__valo_parc_machine", "compiled": true, "compiled_code": "\n\nwith machine_infos as (\n\n  select\n    d.iddevice,\n    d.idcompany_customer,\n    p.name as product_name\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device` d\n  left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p\n    on d.idmodel = p.idproduct\n  left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location` l\n    on d.idlocation = l.idlocation\n  where d.iddevice_type = 1\n\n),\n\ncompanies as (\n\n  select\n    idcompany,\n    code as company_code,\n    name as company_name\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n\n),\n\nfiltered_machines as (\n\n  select\n    lower(trim(mi.product_name)) as machine_modele\n  from machine_infos mi\n  left join companies c\n    on mi.idcompany_customer = c.idcompany\n  where c.company_name not in (\n    '06 - ATELIER RUNGIS DEPOT',\n    '07 - ATELIER LYON DEPOT',\n    '08 - ATELIER BORDEAUX DEPOT',\n    '10 - REBUS DEPOT',\n    '11 - REMISE EN ETAT - RUNGIS',\n    '12 - REMISE EN ETAT - LYON'\n  )\n\n),\n\ncounts as (\n\n  select\n    machine_modele,\n    count(*) as count_machine\n  from filtered_machines\n  group by machine_modele\n\n),\n\nref_valo as (\n\n  select\n    lower(trim(machine_modele)) as machine_modele,\n    montant_inv as montant_unitaire\n  from `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__valo_parc_machine`\n\n),\n\n-- Changement principal : utiliser FULL OUTER JOIN\njoined as (\n\n  select\n    coalesce(c.machine_modele, v.machine_modele) as machine_modele,\n    v.montant_unitaire,\n    coalesce(c.count_machine, 0) as count_machine,\n    case\n      when v.montant_unitaire is null then null\n      else v.montant_unitaire * coalesce(c.count_machine, 0)\n    end as montant_inv_total\n  from counts c\n  full outer join ref_valo v  -- Changement ici\n    on c.machine_modele = v.machine_modele\n\n)\n\nselect\n  machine_modele,\n  montant_unitaire,\n  count_machine,\n  montant_inv_total\nfrom joined", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__valo_parc_machine`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.870305Z", "completed_at": "2025-12-12T11:33:26.893380Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.907768Z", "completed_at": "2025-12-12T11:33:26.907780Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.15662622451782227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__cp_metropole_Code_Postal.0356e1fc65", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Code_Postal\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_metropole`\nwhere Code_Postal is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.944147Z", "completed_at": "2025-12-12T11:33:26.969460Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:26.998553Z", "completed_at": "2025-12-12T11:33:26.998570Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1487407684326172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__cp_tech_cp_depart_int.1b4b77c02d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cp_depart_int\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_tech`\nwhere cp_depart_int is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.960383Z", "completed_at": "2025-12-12T11:33:26.997895Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.051832Z", "completed_at": "2025-12-12T11:33:27.051853Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.14156126976013184, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__cp_tech_cp_depart_texte.00a98e1658", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cp_depart_texte\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_tech`\nwhere cp_depart_texte is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.972015Z", "completed_at": "2025-12-12T11:33:27.016830Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.062517Z", "completed_at": "2025-12-12T11:33:27.062538Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.13968586921691895, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__cp_tech_cp_final_int.288a2ba1f4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cp_final_int\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_tech`\nwhere cp_final_int is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.978030Z", "completed_at": "2025-12-12T11:33:27.027706Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.064862Z", "completed_at": "2025-12-12T11:33:27.064879Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1432180404663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__cp_tech_cp_final_texte.d6b7d11241", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cp_final_texte\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_tech`\nwhere cp_final_texte is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.984515Z", "completed_at": "2025-12-12T11:33:27.040491Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.067352Z", "completed_at": "2025-12-12T11:33:27.067365Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.14381742477416992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__cp_tech_libelle_cp.c4aa5a2041", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect libelle_cp\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_tech`\nwhere libelle_cp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.992685Z", "completed_at": "2025-12-12T11:33:27.055169Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.073088Z", "completed_at": "2025-12-12T11:33:27.073102Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.13865423202514648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__cp_tech_nom_departement.ef0dca4aed", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nom_departement\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_tech`\nwhere nom_departement is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:26.999886Z", "completed_at": "2025-12-12T11:33:27.061721Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.075173Z", "completed_at": "2025-12-12T11:33:27.075185Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.14051270484924316, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__cp_tech_num_departement_texte.751d020def", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect num_departement_texte\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_tech`\nwhere num_departement_texte is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.006514Z", "completed_at": "2025-12-12T11:33:27.063441Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.078704Z", "completed_at": "2025-12-12T11:33:27.078719Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.14345955848693848, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__cp_tech_region_tech.7a4ee11a21", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect region_tech\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_tech`\nwhere region_tech is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.011813Z", "completed_at": "2025-12-12T11:33:27.064092Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.079473Z", "completed_at": "2025-12-12T11:33:27.079489Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.14410018920898438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_ref_yuman__cp_tech_cp_depart_int.d6a5969a3a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select cp_depart_int as unique_field\n  from `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_tech`\n  where cp_depart_int is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.017697Z", "completed_at": "2025-12-12T11:33:27.065614Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.080224Z", "completed_at": "2025-12-12T11:33:27.080239Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.14761710166931152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_ref_yuman__cp_tech_cp_depart_texte.561497fd6a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select cp_depart_texte as unique_field\n  from `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_tech`\n  where cp_depart_texte is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.022642Z", "completed_at": "2025-12-12T11:33:27.066616Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.083137Z", "completed_at": "2025-12-12T11:33:27.083149Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.15015292167663574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__dpt_metropole_Departement.3c351e6222", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Departement\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__dpt_metropole`\nwhere Departement is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.035473Z", "completed_at": "2025-12-12T11:33:27.068784Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.086624Z", "completed_at": "2025-12-12T11:33:27.086635Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.15034270286560059, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__machine_clean_famille_neshu.0a22381e35", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect famille_neshu\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__machine_clean`\nwhere famille_neshu is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.028653Z", "completed_at": "2025-12-12T11:33:27.068076Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.085996Z", "completed_at": "2025-12-12T11:33:27.086008Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.1536579132080078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__machine_clean_Machine_Brut.ceef954725", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Machine_Brut\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__machine_clean`\nwhere Machine_Brut is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.046337Z", "completed_at": "2025-12-12T11:33:27.073689Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.090866Z", "completed_at": "2025-12-12T11:33:27.090878Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.14742732048034668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__tarification_clean_KEY.2b49d3a4de", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect KEY\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__tarification_clean`\nwhere KEY is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.041299Z", "completed_at": "2025-12-12T11:33:27.074322Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.091492Z", "completed_at": "2025-12-12T11:33:27.091505Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.15874481201171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_ref_yuman__machine_clean_Machine_Brut.033bf2c401", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select Machine_Brut as unique_field\n  from `evs-datastack-prod`.`prod_reference`.`ref_yuman__machine_clean`\n  where Machine_Brut is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.055967Z", "completed_at": "2025-12-12T11:33:27.078093Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.094960Z", "completed_at": "2025-12-12T11:33:27.094971Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.15171027183532715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__tarification_clean_Montant.f1c516c949", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Montant\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__tarification_clean`\nwhere Montant is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.126913Z", "completed_at": "2025-12-12T11:33:27.151875Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.177743Z", "completed_at": "2025-12-12T11:33:27.177763Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1443476676940918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_yuman__demands_workorders_enriched", "compiled": true, "compiled_code": "\n\n-- =====================================================================\n-- Model: int_yuman__demands_workorders_enriched\n-- Description:\n--   Vue unifi\u00e9e des demandes d'intervention et des interventions\n--   enrichie avec les informations clients, sites, mat\u00e9riels et utilisateurs.\n--   Ce mod\u00e8le sert de base interm\u00e9diaire (int) entre les donn\u00e9es staging\n--   et les mod\u00e8les marts m\u00e9tier.\n-- =====================================================================\n\n-- =======================\n-- CTE 1 : Demandes d'intervention\n-- =======================\nwith workorder_demands as (\n    select\n        demand_id,\n        workorder_id,\n        material_id,\n        site_id,\n        client_id,\n        user_id,\n        demand_description,\n        demand_status,\n        demand_reject_comment,\n        created_at as demand_created_at,\n        updated_at as demand_updated_at,\n        demand_category_id\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\n),\n\n-- =======================\n-- CTE 2 : Cat\u00e9gories de demandes\n-- =======================\nworkorder_demands_categories as (\n    select\n        demand_category_id,\n        demand_category_name\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands_categories`\n),\n\n-- =======================\n-- CTE 3 : Interventions (workorders)\n-- =======================\nworkorders as (\n    select\n        workorder_id,\n        technician_id,\n        workorder_number,\n        workorder_category,\n        workorder_type,\n        workorder_status,\n        workorder_title,\n        workorder_description,\n        workorder_report,\n        workorder_technician_name,\n        workorder_date_creation,\n        workorder_motif_non_intervention,\n        workorder_detail_non_intervention,\n        workorder_raison_mise_en_pause,\n        workorder_explication_mise_en_pause,\n        workorder_necessite_intervenir,\n        workorder_si_non_pourquoi,\n        date_planned,\n        date_started,\n        date_done\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\n),\n\n-- =======================\n-- CTE 4 : Clients\n-- =======================\nclients as (\n    select\n        client_id,\n        partner_name,\n        client_code,\n        client_name,\n        client_category,\n        is_active as client_is_active\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients`\n),\n\n-- =======================\n-- CTE 5 : Sites\n-- =======================\nsites as (\n    select\n        site_id,\n        site_code,\n        site_name,\n        site_address,\n        site_postal_code\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\n),\n\n-- =======================\n-- CTE 6 : Mat\u00e9riels\n-- =======================\nmaterials as (\n    select\n        material_id,\n        material_name,\n        material_serial_number,\n        material_brand,\n        material_description,\n        material_in_service_date,\n        category_id\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`\n),\n\n-- =======================\n-- CTE 7 : Cat\u00e9gories de mat\u00e9riels\n-- =======================\nmaterials_categories as (\n    select\n        category_id,\n        category_name as material_category\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials_categories`\n),\n\n-- =======================\n-- CTE 8 : Utilisateurs\n-- =======================\nusers as (\n    select\n        user_id,\n        manager_id,\n        user_name,\n        user_type,\n        is_manager_as_technician\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__users`\n),\n\n-- =======================\n-- CTE 9 : Mapping techniciens - agences\n-- =======================\ntech_agence_mapping as (\n    select\n        nom,\n        prenom,\n        agence,\n        equipe\n    from `evs-datastack-prod`.`prod_reference`.`ref_yuman__tech_agence`\n)\n\n-- =======================\n-- FINAL SELECT : Assemblage des donn\u00e9es\n-- =======================\nselect\n    -- === Demandes d'intervention ===\n    wd.demand_id,\n    wd.workorder_id,\n    wd.material_id,\n    wd.site_id,\n    wd.client_id,\n    wd.user_id,\n    wd.demand_description,\n    wd.demand_status,\n    wd.demand_reject_comment,\n    wd.demand_created_at,\n    wd.demand_updated_at,\n\n    -- === Cat\u00e9gorie demande ===\n    wdc.demand_category_name,\n\n    -- === Interventions ===\n    wo.technician_id,\n    wo.workorder_number,\n    wo.workorder_category,\n    wo.workorder_type,\n    wo.workorder_status,\n    wo.workorder_title,\n    wo.workorder_description,\n    wo.workorder_report,\n    wo.workorder_technician_name,\n    wo.workorder_date_creation,\n    wo.workorder_motif_non_intervention,\n    wo.workorder_detail_non_intervention,\n    wo.workorder_raison_mise_en_pause,\n    wo.workorder_explication_mise_en_pause,\n    wo.workorder_necessite_intervenir,\n    wo.workorder_si_non_pourquoi,\n    wo.date_planned,\n    wo.date_started,\n    wo.date_done,\n\n    -- === Clients ===\n    cl.partner_name,\n    cl.client_code,\n    cl.client_name,\n    cl.client_category,\n    cl.client_is_active,\n\n    -- === Sites ===\n    s.site_code,\n    s.site_name,\n    s.site_address,\n    s.site_postal_code,\n\n    -- === Mat\u00e9riels ===\n    m.material_name,\n    m.material_serial_number,\n    m.material_brand,\n    m.material_description,\n    m.material_in_service_date,\n\n    -- === Cat\u00e9gories de mat\u00e9riels ===\n    mc.material_category,\n\n    -- === Utilisateurs ===\n    u.manager_id,\n    u.user_name,\n    u.user_type,\n    u.is_manager_as_technician,\n\n    -- === Agence du technicien (via mapping) ===\n    tam.agence as technician_agency_stock,\n    tam.equipe as technician_equipe\n\nfrom workorder_demands wd\nleft join workorder_demands_categories wdc\n    on wd.demand_category_id = wdc.demand_category_id\n\nfull join workorders wo\n    on wd.workorder_id = wo.workorder_id\n\nleft join clients cl\n    on wd.client_id = cl.client_id\n\nleft join sites s\n    on wd.site_id = s.site_id\n\nleft join materials m\n    on wd.material_id = m.material_id\n\nleft join materials_categories mc\n    on m.category_id = mc.category_id\n\nleft join users u\n    on wd.user_id = u.user_id\n\nleft join tech_agence_mapping tam\n    on UPPER(TRIM(REGEXP_REPLACE(wo.workorder_technician_name, r'\\[INACTIF\\]\\s*', ''))) = \n       UPPER(TRIM(tam.nom || ' ' || tam.prenom))", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_yuman__demands_workorders_enriched`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.146261Z", "completed_at": "2025-12-12T11:33:27.183565Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.229476Z", "completed_at": "2025-12-12T11:33:27.229498Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.14641714096069336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__tech_agence_agence.8dfdfc78fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect agence\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__tech_agence`\nwhere agence is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.155216Z", "completed_at": "2025-12-12T11:33:27.197502Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.252779Z", "completed_at": "2025-12-12T11:33:27.252799Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1489858627319336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__tech_agence_equipe.7d6b2c4631", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect equipe\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__tech_agence`\nwhere equipe is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.162627Z", "completed_at": "2025-12-12T11:33:27.211975Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.253788Z", "completed_at": "2025-12-12T11:33:27.253801Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.14752864837646484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__tech_agence_nom.7412555376", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nom\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__tech_agence`\nwhere nom is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.168558Z", "completed_at": "2025-12-12T11:33:27.218075Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.255886Z", "completed_at": "2025-12-12T11:33:27.255899Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.14885592460632324, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__tech_agence_prenom.e1a98e0826", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect prenom\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__tech_agence`\nwhere prenom is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.178475Z", "completed_at": "2025-12-12T11:33:27.245293Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.262460Z", "completed_at": "2025-12-12T11:33:27.262472Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.14281916618347168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__technicien_clean_EQUIPE.ca1bade4fe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect EQUIPE\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__technicien_clean`\nwhere EQUIPE is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.185394Z", "completed_at": "2025-12-12T11:33:27.251408Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.264081Z", "completed_at": "2025-12-12T11:33:27.264094Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.14493536949157715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__technicien_clean_TECHNICIEN.95ff6d83a2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect TECHNICIEN\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__technicien_clean`\nwhere TECHNICIEN is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.191476Z", "completed_at": "2025-12-12T11:33:27.252048Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.265424Z", "completed_at": "2025-12-12T11:33:27.265436Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.14555621147155762, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_fct_gac__sinistres_sg_n_de_sinistre.ad92ef022c", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select n_de_sinistre as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`fct_gac__sinistres_sg`\n  where n_de_sinistre is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.203508Z", "completed_at": "2025-12-12T11:33:27.255100Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.271742Z", "completed_at": "2025-12-12T11:33:27.271755Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.14668011665344238, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_unique_combination_of_columns_dim_oracle_neshu__contract_company_id.73a6310d39", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        company_id\n    from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__contract`\n    group by company_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.198153Z", "completed_at": "2025-12-12T11:33:27.254441Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.269099Z", "completed_at": "2025-12-12T11:33:27.269112Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.14995908737182617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_fct_gac__sinistres_sg_reference_gac.73868576b1", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select reference_gac as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`fct_gac__sinistres_sg`\n  where reference_gac is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.212837Z", "completed_at": "2025-12-12T11:33:27.256519Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.274497Z", "completed_at": "2025-12-12T11:33:27.274513Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.15094828605651855, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__contract_contract_id.28d4af45b3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contract_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__contract`\nwhere contract_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.218832Z", "completed_at": "2025-12-12T11:33:27.259995Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.275956Z", "completed_at": "2025-12-12T11:33:27.275967Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.15248537063598633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__contract_created_at.5dc61f7cd8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__contract`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.223941Z", "completed_at": "2025-12-12T11:33:27.260576Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.276580Z", "completed_at": "2025-12-12T11:33:27.276596Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.15439963340759277, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__contract_is_active.9600c93d58", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect is_active\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__contract`\nwhere is_active is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.232679Z", "completed_at": "2025-12-12T11:33:27.263349Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.280094Z", "completed_at": "2025-12-12T11:33:27.280106Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.14966320991516113, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__contract_updated_at.f826ba71d3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__contract`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.238344Z", "completed_at": "2025-12-12T11:33:27.264763Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.280852Z", "completed_at": "2025-12-12T11:33:27.280863Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.15033411979675293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_oracle_neshu__contract_contract_id.2498b48ad2", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select contract_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__contract`\n  where contract_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.246081Z", "completed_at": "2025-12-12T11:33:27.266233Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.283769Z", "completed_at": "2025-12-12T11:33:27.283782Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.14721941947937012, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__product_product_id.d69a3b14d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.315154Z", "completed_at": "2025-12-12T11:33:27.337197Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.365367Z", "completed_at": "2025-12-12T11:33:27.365386Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.13994836807250977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_oracle_neshu__product_product_id.ba747134a3", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select product_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product`\n  where product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.329564Z", "completed_at": "2025-12-12T11:33:27.364082Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.409852Z", "completed_at": "2025-12-12T11:33:27.409876Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.15121030807495117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__company_company_id.2286b3d824", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company`\nwhere company_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.366073Z", "completed_at": "2025-12-12T11:33:27.370309Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.418068Z", "completed_at": "2025-12-12T11:33:27.418085Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.12706208229064941, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbt_warehouse.snap_oracle_neshu__device", "compiled": true, "compiled_code": "\n\n\n\nWITH source_table AS (\n  SELECT *\n  FROM `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`\n)\nSELECT\n    device_id,\n    device_iddevice,\n    device_type_id,\n    company_id,\n    location_id,\n    device_code,\n    device_name,\n    company_code,              -- \u2713 TRACKED for changes\n    company_name,\n    device_brand,              -- \u2713 TRACKED for changes\n    device_gamme,\n    device_category,\n    device_economic_model,      -- \u2713 TRACKED for changes\n    device_location,            -- \u2713 TRACKED for changes\n    is_active,\n    last_installation_date,\n    created_at,\n    updated_at\nFROM source_table\n", "relation_name": "`evs-datastack-prod`.`snapshots`.`snap_oracle_neshu__device`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.341828Z", "completed_at": "2025-12-12T11:33:27.392046Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.437605Z", "completed_at": "2025-12-12T11:33:27.437620Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1441965103149414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_oracle_neshu__company_company_id.d6aabe0e95", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select company_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company`\n  where company_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.346992Z", "completed_at": "2025-12-12T11:33:27.392765Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.439536Z", "completed_at": "2025-12-12T11:33:27.439551Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.14759588241577148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__machines_yuman_maintenance_base", "compiled": true, "compiled_code": "-- int_oracle_neshu__machines_yuman_maintenance_base.sql\n\n\n\n-- LISTE MACHINE DLOG filtr\u00e9 & clean\nWITH liste_machine_oracle AS (\n    SELECT\n      d.device_id,\n      CONCAT('NESH_', d.device_code) AS device_code,\n      d.device_name,\n      CONCAT('NESH_', company_code) AS company_code,\n      d.company_name,\n      d.last_installation_date,\n      d.created_at as device_created_at,\n      d.updated_at as device_updated_at\n    FROM `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device` d\n    WHERE is_active\n      AND device_type_id IN (1, 2)\n      AND REGEXP_CONTAINS(company_code, r'^CN[0-9]{4}$')\n      AND device_name in ('MOMENTO 100', 'GEMINI 200', 'MOMENTO 200', 'MINITOWER GEMINI', 'MINITOWER MOMENTO',\n        'SBS MOMENTO 100', 'TOWER GEMINI', 'TOWER MOMENTO', 'MILANO LYO FTS120',\n        'MILANO GRAIN FTS60E', 'MILANO GRAIN FTS60E + MODULO', 'BLUSODA', 'BLUSODA GAZ',\n        'TOWER BLUSODA', 'TOWER BLUSODA GAZ', 'MILANO LYO FTS120 + MODULO',\n        'BLUSODA', 'TOWER ONE GAZ', 'OPTIBEANX12 + MODULO', 'OPTIBEAN X 12', 'OPTIBEAN X 12 TS','OPTIBEANX12TS + MODULO','OPTIBEANX12TS + MODULO','OPTIBEAN 12')\n),\n-- LISTE MACHINE YUMAN ENRICHI CLIENT / SITE filtr\u00e9 & clean\nyuman_materials_clean  AS (\n    SELECT \n        ym.material_id,\n        ym.material_description,\n        ym.material_name,\n        ym.material_brand,\n        ym.material_serial_number,\n        ycat.category_name,\n        ym.material_in_service_date,\n        ym.created_at,\n        ym.updated_at,\n        yc.client_id,\n        yc.client_code,\n        yc.client_name,\n        yc.client_category,\n        yc.partner_name,\n        ys.site_id,\n        ys.site_code,\n        ys.site_postal_code\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials` ym\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites` ys \n        ON ym.site_id = ys.site_id\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients` yc \n        ON ys.client_id = yc.client_id\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials_categories` ycat \n        ON ycat.category_id = ym.category_id\n    WHERE partner_name = 'NESHU'\n      AND site_code NOT IN (\n            \"NESH_DEPOTATELIERBORDEAUX\", \"NESH_DEPOTATELIERLYON\", \"NESH_DEPOTATELIERMARSEILLE\",\n            \"NESH_DEPOTATELIERRUNGIS\", \"NESH_DEPOTATELIERSTRASBOURG\", \"NESH_DEPOTBORDEAUX\",\n            \"NESH_DEPOTLYON\", \"NESH_DEPOTMARSEILLE\", \"NESH_DEPOTPERIMES\", \"NESH_DEPOTREBUS\",\n            \"NESH_DEPOTRUNGIS\", \"NESH_DEPOTSTRASBOURG\", \"NESH_RELYON\", \"NESH_RERUNGIS\", \"NESH_STOCKNUNSHEN\"\n        )\n      AND material_name NOT LIKE '%GENERIQUE NESHU%'\n      AND material_serial_number not in \n      ('NESH_MA00226', 'NESH_MA00227', 'NESH_MA00247', 'NESH_MA00248', 'NESH_MA00249',\n      'NESH_MA00250', 'NESH_MA00251', 'NESH_MA00252', 'NESH_MA00253', 'NESH_MA00254',\n      'NESH_MA00193', 'NESH_MA00194', 'NESH_MA00195', 'NESH_MA00196', 'NESH_MA00197',\n      'NESH_MA00198', 'NESH_MA00199', 'NESH_MA00200', 'NESH_MA00201', 'NESH_MA00202',\n      'NESH_MA00203', 'NESH_MA00204', 'NESH_MA00205', 'NESH_MA00206', 'NESH_MA00207',\n      'NESH_MA00208', 'NESH_MA00209', 'NESH_MA00210', 'NESH_MA00211', 'NESH_MA00212',\n      'NESH_MA00213', 'NESH_MA00214', 'NESH_MA00215', 'NESH_MA00228', 'NESH_MA00229',\n      'NESH_MA00230', 'NESH_MA00231', 'NESH_MA00232', 'NESH_MA00233', 'NESH_MA00234',\n      'NESH_MA00235', 'NESH_MA00236', 'NESH_MA00237', 'NESH_MA00238', 'NESH_MA00239',\n      'NESH_MA00240', 'NESH_MA00241', 'NESH_MA00242', 'NESH_MA00244', 'NESH_MA00245',\n      'NESH_MA00246', 'NESH_MA00256', 'NESH_MA00257', 'NESH_MA00258', 'NESH_MA00259',\n      'NESH_MA00260', 'NESH_MA00261', 'NESH_MA00262', 'NESH_MA00263', 'NESH_MA00264',\n      'NESH_MA00265', 'NESH_MA00266', 'NESH_MA00270', 'NESH_MA00216', 'NESH_MA00217',\n      'NESH_MA00220', 'NESH_MA00221', 'NESH_MA00222', 'NESH_MA00223', 'NESH_MA00181',\n      'NESH_MA00182', 'NESH_MA00184', 'NESH_MA00185', 'NESH_MA00183', 'NESH_MA00186',\n      'NESH_MA00187', 'NESH_AS00401', 'NESH_AS00403', 'NESH_AS00393', 'NESH_AS00557',\n      'NESH_AS00558', 'NESH_AS00242', 'NESH_AS00241', 'NESH_AS00562', 'NESH_AS00559',\n      'NESH_AS00070', 'NESH_AS00568', 'NESH_AS00563', 'NESH_AS00561', 'NESH_AS00560',\n      'NESH_AS00317', 'NESH_AS00314', 'NESH_MA00136', 'NESH_AS00011', 'NESH_AS00012',\n      'NESH_MA00170', 'NESH_AS00004')\n),\n-- JOINTURE ENTRE LA LISTE MACHINE DLOG avec les donn\u00e9es YUMAN\nmerged_materials_dlog_yuman AS (\n    SELECT \n        lo.device_id,\n        lo.device_code,\n        lo.device_name,\n        lo.company_code,\n        lo.company_name,\n        lo.last_installation_date,\n        lo.device_created_at,\n        lo.device_updated_at,\n        ym.material_id,\n        ym.material_serial_number,\n        ym.material_name,\n        ym.client_id,\n        ym.client_code,\n        ym.client_name,\n        ym.client_category,\n        ym.site_id,\n        ym.site_code,\n        ym.site_postal_code,\n        ym.created_at AS material_created_at,\n        ym.updated_at AS material_updated_at\n    FROM liste_machine_oracle lo\n    LEFT JOIN yuman_materials_clean ym\n        ON lo.device_code = ym.material_serial_number and lo.company_code = ym.client_code\n)\nSELECT * from merged_materials_dlog_yuman", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__machines_yuman_maintenance_base`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.356694Z", "completed_at": "2025-12-12T11:33:27.408927Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.440518Z", "completed_at": "2025-12-12T11:33:27.440530Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.14813661575317383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__valorisation_parc_machines", "compiled": true, "compiled_code": "\n\nWITH \n-- \u00c9tape 0 : Filtrer les clients actifs NESHU (company_code = \"CN\" + 4 chiffres)\ncompanies_filtered AS (\n  SELECT \n    company_id,\n    company_code\n  FROM `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company`\n  WHERE \n    is_active = TRUE\n    AND company_type = \"CLIENTNESHU\"\n    AND REGEXP_CONTAINS(company_code, r'^CN[0-9]{4}$')\n),\n-- \u00c9tape 1 : R\u00e9cup\u00e9rer les machines actives par client filtr\u00e9es\nactive_devices AS (\n  SELECT \n    d.device_id,\n    d.company_id,\n    cf.company_code,\n    d.device_name\n  FROM `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device` d\n  INNER JOIN companies_filtered cf\n    ON d.company_id = cf.company_id\n  WHERE \n    d.is_active = TRUE \n    AND d.device_iddevice IS NULL\n    AND d.device_name IN (\n      SELECT DISTINCT device_name \n      FROM `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__groupement_machine`\n    )\n),\n\n-- \u00c9tape 2 : Mapper chaque device avec son device_group\ndevices_with_group AS (\n  SELECT \n    ad.device_id,\n    ad.company_id,\n    ad.company_code,\n    ad.device_name,\n    gm.device_group\n  FROM active_devices ad\n  INNER JOIN `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__groupement_machine` gm\n    ON ad.device_name = gm.device_name\n),\n\n-- \u00c9tape 3 : Joindre avec la table de valorisation\ndevices_with_products AS (\n  SELECT \n    dwg.device_id,\n    dwg.company_id,\n    dwg.company_code,\n    dwg.device_name,\n    dwg.device_group,\n    vm.product_code,\n    vm.quantite\n  FROM devices_with_group dwg\n  LEFT JOIN `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__valo_machine_capacite` vm\n    ON LOWER(dwg.device_group) = LOWER(vm.device_group)\n),\n\n-- \u00c9tape 4 : Joindre avec la table produit pour obtenir les prix\ndevices_with_prices AS (\n  SELECT \n    dwp.device_id,\n    dwp.company_id,\n    dwp.company_code,\n    dwp.device_name,\n    dwp.device_group,\n    dwp.product_code,\n    dwp.quantite,\n    p.purchase_unit_price,\n    (dwp.quantite * p.purchase_unit_price) AS valorisation_produit\n  FROM devices_with_products dwp\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product` p\n    ON dwp.product_code = p.product_code\n),\n\n-- \u00c9tape 5 : Calculer la valorisation totale par machine (device)\nvalorisation_by_device AS (\n  SELECT \n    device_id,\n    device_name,\n    device_group,\n    SUM(valorisation_produit) AS valorisation_totale_machine\n  FROM devices_with_prices\n  GROUP BY device_id, device_name, device_group\n),\n\nfinal_result AS (\n-- R\u00e9sultat final : regroup\u00e9 par device_name / device_group\nSELECT\n  device_name,\n  device_group,\n  COUNT(device_id) AS nombre_machines,\n  ROUND(SUM(valorisation_totale_machine), 2) AS valorisation_totale_machine\nFROM valorisation_by_device\nGROUP BY device_name, device_group\n)\n\n-- Ajout m\u00e9tadonn\u00e9es dbt\nSELECT \n    device_name,\n    device_group,\n    nombre_machines,\n    valorisation_totale_machine,\n    -- M\u00e9tadonn\u00e9es d'ex\u00e9cution\n    CURRENT_TIMESTAMP() as dbt_updated_at,\n    '2595904a-aec3-41ec-a1e9-f19d18d6d7af' as dbt_invocation_id\nFROM final_result", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__valorisation_parc_machines`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.372390Z", "completed_at": "2025-12-12T11:33:27.436742Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.451599Z", "completed_at": "2025-12-12T11:33:27.451611Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.14483356475830078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__device_company_id.e17a3c2fb4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`\nwhere company_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.377840Z", "completed_at": "2025-12-12T11:33:27.438246Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.455111Z", "completed_at": "2025-12-12T11:33:27.455126Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.14711380004882812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__device_device_id.51db00e9ef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`\nwhere device_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.385521Z", "completed_at": "2025-12-12T11:33:27.438891Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.455765Z", "completed_at": "2025-12-12T11:33:27.455780Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.14716506004333496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_dim_oracle_neshu__device_company_id__company_id__ref_dim_oracle_neshu__company_.72b98eee1b", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select company_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`\n    where company_id is not null\n),\n\nparent as (\n    select company_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.393391Z", "completed_at": "2025-12-12T11:33:27.441242Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.458596Z", "completed_at": "2025-12-12T11:33:27.458607Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.14950060844421387, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_oracle_neshu__device_device_id.cbb3e59fc9", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select device_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`\n  where device_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.399101Z", "completed_at": "2025-12-12T11:33:27.441951Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.461276Z", "completed_at": "2025-12-12T11:33:27.461288Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.1450209617614746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_oracle_neshu__pa_business_review", "compiled": true, "compiled_code": "\n\nSELECT\n    -- Identifiants\n    pa.task_id,\n    pa.company_id,\n    pa.device_id,\n    pa.company_code,\n\n    -- Company\n    c.company_name,\n    CONCAT(c.company_name, ' - ', pa.company_code) AS company_info,\n\n    -- Device\n    d.device_brand,\n    d.device_code,\n    CONCAT(d.device_brand, ' - ', d.device_code) AS device_info,\n\n    -- Contexte temporel\n    pa.task_start_date,\n    DATE(pa.task_start_date) AS task_start_date_day,\n    pa.task_end_date,\n\n    -- Statut\n    pa.task_status_code,\n    CASE WHEN pa.task_status_code = 'FAIT' THEN 1 ELSE 0 END AS mission_faite,\n    CASE WHEN pa.task_status_code IN ('PREVU', 'FAIT', 'ENCOURS') THEN 1 ELSE 0 END AS mission_prevue,\n\n    -- M\u00e9tadonn\u00e9es dbt\n    CURRENT_TIMESTAMP() as dbt_updated_at,\n    '2595904a-aec3-41ec-a1e9-f19d18d6d7af' as dbt_invocation_id\n\nFROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks` pa\nJOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device` d \n    ON pa.device_id = d.device_id\nJOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company` c \n    ON pa.company_id = c.company_id\nWHERE DATE(pa.task_start_date) >= '2025-01-01'\n    AND pa.task_status_code != 'ANNULE'", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.403853Z", "completed_at": "2025-12-12T11:33:27.445092Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.462730Z", "completed_at": "2025-12-12T11:33:27.462744Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.14719653129577637, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__appro_tasks_created_at.2224651e8c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.410573Z", "completed_at": "2025-12-12T11:33:27.447000Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.464077Z", "completed_at": "2025-12-12T11:33:27.464092Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.14998435974121094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__appro_tasks_extracted_at.11b43558e3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.425863Z", "completed_at": "2025-12-12T11:33:27.450024Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.465417Z", "completed_at": "2025-12-12T11:33:27.465432Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.14929962158203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__appro_tasks_task_start_date.8e28b8d3b2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.418740Z", "completed_at": "2025-12-12T11:33:27.450835Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.466320Z", "completed_at": "2025-12-12T11:33:27.466336Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.15288996696472168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__appro_tasks_task_id.afbab212ea", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.431223Z", "completed_at": "2025-12-12T11:33:27.454453Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.470050Z", "completed_at": "2025-12-12T11:33:27.470066Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.15388083457946777, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__appro_tasks_updated_at.297f723da2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.501264Z", "completed_at": "2025-12-12T11:33:27.531586Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.564358Z", "completed_at": "2025-12-12T11:33:27.564377Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.16098570823669434, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__appro_tasks_task_id.27c5ab3d17", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`\n  where task_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.517997Z", "completed_at": "2025-12-12T11:33:27.562885Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.613322Z", "completed_at": "2025-12-12T11:33:27.613344Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.1661977767944336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__task_has_resources_idresources.5afdfd82d8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.524706Z", "completed_at": "2025-12-12T11:33:27.565173Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.621988Z", "completed_at": "2025-12-12T11:33:27.622006Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.16771602630615234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__task_has_resources_idtask.c853c7eb7b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.532270Z", "completed_at": "2025-12-12T11:33:27.572198Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.630775Z", "completed_at": "2025-12-12T11:33:27.630789Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.16643404960632324, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_has_resources_idresources__idresources__ref_stg_oracle_neshu__resources_.27237e11eb", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idresources as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources`\n    where idresources is not null\n),\n\nparent as (\n    select idresources as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.541741Z", "completed_at": "2025-12-12T11:33:27.598604Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.639989Z", "completed_at": "2025-12-12T11:33:27.640004Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.16492152214050293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_has_resources_idtask__idtask__ref_stg_oracle_neshu__task_.50dbc0d63f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idtask as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources`\n    where idtask is not null\n),\n\nparent as (\n    select idtask as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.549578Z", "completed_at": "2025-12-12T11:33:27.607176Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.643185Z", "completed_at": "2025-12-12T11:33:27.643199Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.16689586639404297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__chargement_tasks", "compiled": true, "compiled_code": "\n\nwith chargement_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.iddevice as device_id,\n        t.idcompany_peer as company_id,\n        t.idlocation as location_id,\n        t.idproduct_source as product_source_id,\n        t.type_product_source as product_source_type,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_destination as product_destination_type,\n        thp.idproduct as product_id,\n\n        -- Codes\n        c.code as company_code,\n        d.code as device_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n        la.code as load_type_code,\n\n        -- Informations m\u00e9tier\n        l.access_info as task_location_info,\n        t.real_start_date as task_start_date,\n\n        -- Informations de conditionnement\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity as base_unit_quantity,\n        thp.net_price as product_unit_price_task,\n        p.purchase_unit_price as product_unit_price_latest,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as load_quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) * p.purchase_unit_price as load_valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` c on c.idcompany = t.idcompany_peer\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device` d on d.iddevice = t.iddevice\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location` l on l.idlocation = t.idlocation\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task` lht on t.idtask = lht.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` la on lht.idlabel = la.idlabel\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts on t.idtask_status = ts.idtask_status\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 13 -- CHARGEMENT MACHINE\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.iddevice, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source, t.idlocation,\n        t.idproduct_destination, t.type_product_destination,\n        thp.idproduct,\n        c.code, d.code, p.code,\n        ts.code, la.code,\n        l.access_info, t.real_start_date,\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity,\n        thp.net_price,\n        p.purchase_unit_price,\n        t.updated_at, t.created_at, t.extracted_at\n),\n\nressources_roadman as (\n    select \n        thr.idtask, \n        min(r.idresources) as roadman_id,\n        min(r.code) as roadman_code\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources` thr\n    join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` r on r.idresources = thr.idresources\n    where r.idresources_type = 2\n    group by thr.idtask\n),\n\nressources_vehicle as (\n    select \n        thr.idtask, \n        min(r.idresources) as vehicle_id,\n        min(r.code) as vehicle_code\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources` thr\n    join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` r on r.idresources = thr.idresources\n    where r.idresources_type = 3\n    group by thr.idtask\n),\n\nchargement_enrichi as (\n    select \n        cb.*,\n        rr.roadman_id,\n        rr.roadman_code,\n        rv.vehicle_id,\n        rv.vehicle_code\n    from chargement_base cb\n    left join ressources_roadman rr on cb.task_id = rr.idtask\n    left join ressources_vehicle rv on cb.task_id = rv.idtask\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    device_id,\n    company_id,\n    product_id,\n    location_id,\n    product_source_id,\n    product_destination_id,\n    roadman_id,\n    vehicle_id,\n\n    -- Codes\n    company_code,\n    device_code,\n    product_code,\n    roadman_code,\n    vehicle_code,\n    task_status_code,\n    load_type_code,\n\n    -- Infos m\u00e9tier\n    product_source_type,\n    product_destination_type,\n    task_location_info,\n    task_start_date,\n\n    unit_coeff_multi,\n    unit_coeff_div,\n    base_unit_quantity,\n    product_unit_price_task,\n    product_unit_price_latest,\n\n    -- M\u00e9triques\n    load_quantity,\n    load_valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom chargement_enrichi\n\n\n  where updated_at >= (\n      select max(updated_at) - interval 1 day\n      from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\n  )\n", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.574356Z", "completed_at": "2025-12-12T11:33:27.638347Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.656862Z", "completed_at": "2025-12-12T11:33:27.656881Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.15870332717895508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__ecart_inventaire_tasks", "compiled": true, "compiled_code": "\n\nwith ecart_inventaire_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_source as product_source_id,\n        t.type_product_source as product_source_type,\n\n        -- Codes\n        case \n            when t.type_product_source = 'COMPANY' then cs.code\n            when t.type_product_source = 'RESOURCES' then r.code\n        end as source_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- Informations de conditionnement\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity as base_unit_quantity,\n        thp.net_price as product_unit_price_task,\n        p.purchase_unit_price as product_unit_price_latest,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * p.purchase_unit_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts on t.idtask_status = ts.idtask_status\n\n    -- jointure company pour la source si COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` cs \n        on t.idproduct_source = cs.idcompany \n       and t.type_product_source = 'COMPANY'\n\n    -- jointure resources pour la source si RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` r \n        on t.idproduct_source = r.idresources\n       and t.type_product_source = 'RESOURCES'\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 163 -- ECART INVENTAIRE\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source,\n        thp.idproduct,\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity,\n        thp.net_price,\n        p.purchase_unit_price,\n        cs.code, r.code, p.code, ts.code,\n        t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_source_id,\n    product_source_type,\n\n    -- Codes\n    source_code,\n    product_code,\n    task_status_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- Infos de conditionnement\n    unit_coeff_multi,\n    unit_coeff_div,\n    base_unit_quantity,\n    product_unit_price_task,\n    product_unit_price_latest,\n\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom ecart_inventaire_base\nwhere source_code is not null", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.566516Z", "completed_at": "2025-12-12T11:33:27.639044Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.657645Z", "completed_at": "2025-12-12T11:33:27.657656Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.16159892082214355, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__commande_interne", "compiled": true, "compiled_code": "\n\nwith commande_interne_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_source as product_source_id,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_source as product_source_type,\n        t.type_product_destination as product_destination_type,\n\n        -- Codes (source et destination)\n        case \n            when t.type_product_source = 'COMPANY' then cs.code\n            when t.type_product_source = 'RESOURCES' then rs.code\n        end as source_code,\n        case \n            when t.type_product_destination = 'COMPANY' then cd.code\n            when t.type_product_destination = 'RESOURCES' then rd.code\n        end as destination_code,\n\n        p.code as product_code,\n        ts.code as task_status_code,\n        la.code as label_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- Informations de conditionnement\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity as base_unit_quantity,\n        thp.net_price as product_unit_price_task,\n        p.purchase_unit_price as product_unit_price_latest,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * p.purchase_unit_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp \n        on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p \n        on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts \n        on t.idtask_status = ts.idtask_status\n\n    -- Source = COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` cs \n        on t.idproduct_source = cs.idcompany \n       and t.type_product_source = 'COMPANY'\n\n    -- Source = RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` rs \n        on t.idproduct_source = rs.idresources\n       and t.type_product_source = 'RESOURCES'\n\n    -- Destination = COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` cd \n        on t.idproduct_destination = cd.idcompany \n       and t.type_product_destination = 'COMPANY'\n\n    -- Destination = RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` rd \n        on t.idproduct_destination = rd.idresources\n       and t.type_product_destination = 'RESOURCES'\n\n    -- Jointures pour le filtrage sur labels t\u00e9l\u00e9m\u00e9trie\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task` lht\n        on t.idtask = lht.idtask   \n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` la\n        on lht.idlabel = la.idlabel  \n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf\n        on la.idlabel_family = lf.idlabel_family\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 132  -- LIVRAISON INTERNE\n        and lf.code = 'STATUT_LIVRAISON'\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, \n        t.idtask, \n        t.idcompany_peer,\n        thp.idproduct, \n        t.idproduct_source, \n        t.type_product_source,\n        t.idproduct_destination, \n        t.type_product_destination,\n        cs.code, rs.code, cd.code, rd.code,\n        p.code, ts.code, la.code,\n        t.real_start_date,\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity,\n        thp.net_price,\n        p.purchase_unit_price,\n        t.updated_at, t.created_at, t.extracted_at\n),\n\ndedup as (\n    select\n        *,\n        row_number() over (\n            partition by task_product_id\n            order by \n                case when label_code = 'LIVRE' then 1 else 2 end\n        ) as rn\n    from commande_interne_base\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_source_id,\n    product_source_type,\n    product_destination_id,\n    product_destination_type,\n\n    -- Codes\n    source_code,\n    destination_code,\n    product_code,\n    task_status_code,\n    label_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- Infos de conditionnement\n    unit_coeff_multi,\n    unit_coeff_div,\n    base_unit_quantity,\n    product_unit_price_task,\n    product_unit_price_latest,\n\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom dedup\nwhere rn = 1\n  and source_code is not null\n  and destination_code is not null", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.580856Z", "completed_at": "2025-12-12T11:33:27.640835Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.659039Z", "completed_at": "2025-12-12T11:33:27.659050Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.16155004501342773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__inter_techinique_tasks", "compiled": true, "compiled_code": "\n\nwith inter_base as (\n\n    select\n        -- Identifiants\n        t.idtask as task_id,\n        t.iddevice as device_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n\n        -- Codes\n        c.code as company_code,\n        d.code as device_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n        la.code as label_code,\n        lf.code as label_family_code,\n\n        -- Informations m\u00e9tier\n        t.real_start_date as task_start_date,\n        t.real_end_date as task_end_date,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` c on c.idcompany = t.idcompany_peer\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device` d on d.iddevice = t.iddevice\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task` lht on t.idtask = lht.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` la on lht.idlabel = la.idlabel\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf on la.idlabel_family = lf.idlabel_family\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts on t.idtask_status = ts.idtask_status\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 131 -- INTERVENTION TECHNIQUE\n        and t.real_start_date is not null\n)\n\nselect\n    -- Identifiants\n    task_id,\n    device_id,\n    company_id,\n    product_id,\n\n    -- Codes\n    company_code,\n    device_code,\n    product_code,\n    task_status_code,\n\n    -- Pivot des labels\n    max(case when label_family_code = 'Statut inter' then label_code end) as statut_inter,\n    max(case when label_family_code = 'DC04' then label_code end) as dc04,\n    max(case when label_family_code = 'MISSION_TYPE' then label_code end) as mission_type,\n    max(case when label_family_code = 'Objet intervent' then label_code end) as objet_intervent,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n    task_end_date,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom inter_base\ngroup by\n    task_id, device_id, company_id, product_id,\n    company_code, device_code, product_code, task_status_code,\n    task_start_date, task_end_date, updated_at, created_at, extracted_at\nHAVING MAX(CASE WHEN label_family_code = 'Objet intervent' THEN label_code END) = 'OC04'", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.593446Z", "completed_at": "2025-12-12T11:33:27.641862Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.661679Z", "completed_at": "2025-12-12T11:33:27.661692Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.1625046730041504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__livraison_interne_tasks", "compiled": true, "compiled_code": "\n\nwith mouvement_interne_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_source as product_source_id,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_source as product_source_type,\n        t.type_product_destination as product_destination_type,\n\n        -- Codes (source et destination)\n        case \n            when t.type_product_source = 'COMPANY' then cs.code\n            when t.type_product_source = 'RESOURCES' then rs.code\n        end as source_code,\n\n        case \n            when t.type_product_destination = 'COMPANY' then cd.code\n            when t.type_product_destination = 'RESOURCES' then rd.code\n        end as destination_code,\n\n        p.code as product_code,\n        ts.code as task_status_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- Informations de conditionnement\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity as base_unit_quantity,\n        thp.net_price as product_unit_price_task,\n        p.purchase_unit_price as product_unit_price_latest,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * p.purchase_unit_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp \n        on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p \n        on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts \n        on t.idtask_status = ts.idtask_status\n\n    -- Source = COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` cs \n        on t.idproduct_source = cs.idcompany \n       and t.type_product_source = 'COMPANY'\n\n    -- Source = RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` rs \n        on t.idproduct_source = rs.idresources\n       and t.type_product_source = 'RESOURCES'\n\n    -- Destination = COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` cd \n        on t.idproduct_destination = cd.idcompany \n       and t.type_product_destination = 'COMPANY'\n\n    -- Destination = RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` rd \n        on t.idproduct_destination = rd.idresources\n       and t.type_product_destination = 'RESOURCES'\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 161 -- LIVRAISONS INTERNE\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source,\n        t.idproduct_destination, t.type_product_destination,\n        thp.idproduct,\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity,\n        thp.net_price,\n        p.purchase_unit_price,\n        cs.code, rs.code, cd.code, rd.code,\n        p.code, ts.code,\n        t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_source_id,\n    product_source_type,\n    product_destination_id,\n    product_destination_type,\n\n    -- Codes\n    source_code,\n    destination_code,\n    product_code,\n    task_status_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- Infos de conditionnement\n    unit_coeff_multi,\n    unit_coeff_div,\n    base_unit_quantity,\n    product_unit_price_task,\n    product_unit_price_latest,\n\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom mouvement_interne_base\nwhere source_code is not null\n  and destination_code is not null", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.587172Z", "completed_at": "2025-12-12T11:33:27.642465Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.662320Z", "completed_at": "2025-12-12T11:33:27.662333Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.16592097282409668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__inventaire_tasks", "compiled": true, "compiled_code": "\n\nwith inventaire_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_source as product_source_id,\n        t.type_product_source as product_source_type,\n\n        -- Codes\n        case \n            when t.type_product_source = 'COMPANY' then cs.code\n            when t.type_product_source = 'RESOURCES' then r.code\n        end as source_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- Informations de conditionnement\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity as base_unit_quantity,\n        thp.net_price as product_unit_price_task,\n        p.purchase_unit_price as product_unit_price_latest,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * p.purchase_unit_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts on t.idtask_status = ts.idtask_status\n\n    -- jointure company pour la source si COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` cs \n        on t.idproduct_source = cs.idcompany \n       and t.type_product_source = 'COMPANY'\n\n    -- jointure resources pour la source si RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` r \n        on t.idproduct_source = r.idresources\n       and t.type_product_source = 'RESOURCES'\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 162 -- INVENTAIRE\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source,\n        thp.idproduct,\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity,\n        thp.net_price,\n        p.purchase_unit_price,\n        cs.code, r.code, p.code, ts.code,\n        t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_source_id,\n    product_source_type,\n\n    -- Codes\n    source_code,\n    product_code,\n    task_status_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- Infos de conditionnement\n    unit_coeff_multi,\n    unit_coeff_div,\n    base_unit_quantity,\n    product_unit_price_task,\n    product_unit_price_latest,\n\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom inventaire_base\nwhere source_code is not null", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.599502Z", "completed_at": "2025-12-12T11:33:27.643828Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.665025Z", "completed_at": "2025-12-12T11:33:27.665037Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.16114449501037598, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__livraison_tasks", "compiled": true, "compiled_code": "\n\nwith livraison_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_source as product_source_id,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_source as product_source_type,\n        t.type_product_destination as product_destination_type,\n\n        -- Codes\n        c.code as company_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- Informations de conditionnement\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity as base_unit_quantity,\n        thp.net_price as product_unit_price_task,\n        p.purchase_unit_price as product_unit_price_latest,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * p.purchase_unit_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` c on c.idcompany = t.idcompany_peer\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts on t.idtask_status = ts.idtask_status\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 101 -- BON LIVRAISON\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source,\n        t.idproduct_destination, t.type_product_destination,\n        thp.idproduct,\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity,\n        thp.net_price,\n        p.purchase_unit_price,\n        c.code, p.code,\n        ts.code, t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_source_id,\n    product_destination_id,\n    product_source_type,\n    product_destination_type,\n\n    -- Codes\n    company_code,\n    product_code,\n    task_status_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- Infos de conditionnement\n    unit_coeff_multi,\n    unit_coeff_div,\n    base_unit_quantity,\n    product_unit_price_task,\n    product_unit_price_latest,\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom livraison_base", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.607876Z", "completed_at": "2025-12-12T11:33:27.644820Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.665645Z", "completed_at": "2025-12-12T11:33:27.665658Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.1579902172088623, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__reception_tasks", "compiled": true, "compiled_code": "\n\nwith reception_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_destination as product_destination_type,\n\n        -- Codes\n        cd.code as destination_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- Informations de conditionnement\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity as base_unit_quantity,\n        thp.net_price as product_unit_price_task,\n        p.purchase_unit_price as product_unit_price_latest,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * p.purchase_unit_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp \n        on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p \n        on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts \n        on t.idtask_status = ts.idtask_status\n\n    -- Destination = COMPANY uniquement\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` cd\n        on t.idproduct_destination = cd.idcompany \n       and t.type_product_destination = 'COMPANY'\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 121 -- BON RECEPTION\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.idcompany_peer,\n        t.idproduct_destination, t.type_product_destination,\n        thp.idproduct,\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity,\n        thp.net_price,\n        p.purchase_unit_price,\n        cd.code,\n        p.code, ts.code,\n        t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_destination_id,\n    product_destination_type,\n\n    -- Codes\n    destination_code,\n    product_code,\n    task_status_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- Infos de conditionnement\n    unit_coeff_multi,\n    unit_coeff_div,\n    base_unit_quantity,\n    product_unit_price_task,\n    product_unit_price_latest,\n\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom reception_base", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.614057Z", "completed_at": "2025-12-12T11:33:27.653092Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.668481Z", "completed_at": "2025-12-12T11:33:27.668496Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.16053533554077148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__telemetry_tasks", "compiled": true, "compiled_code": "\n\nwith telemetry_tasks as (\n    select\n        -- PK naturelle de task_has_product\n        thp.idtask_has_product as task_product_id,\n        \n        -- IDs business\n        t.idtask as task_id,\n        t.iddevice as device_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idlocation as location_id,\n        \n        -- Codes m\u00e9tier pour les jointures futures\n        d.code as device_code,\n        thp.code as product_code,\n        c.code as company_code,\n        \n        -- Donn\u00e9es m\u00e9tier\n        c.name as company_name,\n        l.access_info as task_location_info,\n        \n        -- Dates business\n        t.real_start_date as task_start_date,\n        \n        -- M\u00e9trique business\n        CAST(1 AS INT64) AS telemetry_quantity,  -- 1 T\u00e2che = 1 unit\u00e9 de t\u00e9l\u00e9m\u00e9trie\n        \n        -- Timestamps techniques pour l'incr\u00e9ment\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n        \n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    \n    -- Jointure obligatoire pour r\u00e9cup\u00e9rer les produits\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp\n        on thp.idtask = t.idtask\n    \n    -- Jointures pour enrichissement\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` c\n        on c.idcompany = t.idcompany_peer\n        \n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device` d\n        on d.iddevice = t.iddevice\n        \n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location` l\n        on l.idlocation = t.idlocation\n    \n    -- Jointures pour le filtrage sur labels t\u00e9l\u00e9m\u00e9trie\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task` lht\n        on t.idtask = lht.idtask\n        \n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` la\n        on lht.idlabel = la.idlabel\n        \n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf\n        on la.idlabel_family = lf.idlabel_family\n    \n    where 1=1\n        -- Filtres business critiques\n        and t.idtask_status in (1, 4)  -- FAIT et VALIDE uniquement\n        and t.code_status_record = '1'   -- Enregistrement actif (string)\n        and t.idtask_type = 3           -- Type t\u00e9l\u00e9m\u00e9trie\n        and lf.code = 'TELEM_SOURCE'    -- Label famille t\u00e9l\u00e9m\u00e9trie source\n        \n        -- Filtre qualit\u00e9 donn\u00e9es\n        and t.real_start_date is not null  -- \u00c9viter les t\u00e2ches sans date de d\u00e9but\n)\n\nselect * from telemetry_tasks\n\n\n    where updated_at >= (\n        select max(updated_at) - interval 1 day\n        from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\n    )\n", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.625214Z", "completed_at": "2025-12-12T11:33:27.654059Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.669190Z", "completed_at": "2025-12-12T11:33:27.669201Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.1545112133026123, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__task_has_product_idtask_has_product.d3f98a1a05", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_has_product\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product`\nwhere idtask_has_product is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.631785Z", "completed_at": "2025-12-12T11:33:27.658262Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.674969Z", "completed_at": "2025-12-12T11:33:27.674981Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.15706872940063477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_has_product_idcompany_peer__idcompany__ref_stg_oracle_neshu__company_.9958fec509", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_peer as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product`\n    where idcompany_peer is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.706337Z", "completed_at": "2025-12-12T11:33:27.736578Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.762561Z", "completed_at": "2025-12-12T11:33:27.762578Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.15197420120239258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_has_product_idproduct__idproduct__ref_stg_oracle_neshu__product_.0304257578", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idproduct as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product`\n    where idproduct is not null\n),\n\nparent as (\n    select idproduct as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.730241Z", "completed_at": "2025-12-12T11:33:27.760694Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.804389Z", "completed_at": "2025-12-12T11:33:27.804405Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.14370036125183105, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__task_has_product_idtask_has_product.3f7428b52a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_has_product as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product`\n  where idtask_has_product is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.722763Z", "completed_at": "2025-12-12T11:33:27.761292Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.805108Z", "completed_at": "2025-12-12T11:33:27.805127Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.1506361961364746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_has_product_idtask__idtask__ref_stg_oracle_neshu__task_.e57798c3a4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idtask as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product`\n    where idtask is not null\n),\n\nparent as (\n    select idtask as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.737909Z", "completed_at": "2025-12-12T11:33:27.775117Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.826157Z", "completed_at": "2025-12-12T11:33:27.826170Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1488485336303711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu_gcs__stock_products_date_system.8fb446f793", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_system\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu_gcs__stock_products`\nwhere date_system is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.753322Z", "completed_at": "2025-12-12T11:33:27.798260Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.829364Z", "completed_at": "2025-12-12T11:33:27.829379Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.1441340446472168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu_gcs__stock_products_id_entity.ddabc813f3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id_entity\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu_gcs__stock_products`\nwhere id_entity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.747344Z", "completed_at": "2025-12-12T11:33:27.787363Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.827754Z", "completed_at": "2025-12-12T11:33:27.827766Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.14798974990844727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu_gcs__stock_products_file_datetime.c28506060e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect file_datetime\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu_gcs__stock_products`\nwhere file_datetime is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.769091Z", "completed_at": "2025-12-12T11:33:27.825407Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.839866Z", "completed_at": "2025-12-12T11:33:27.839879Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.13913488388061523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__clients_client_id.bb975d2fa4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect client_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__clients`\nwhere client_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.763990Z", "completed_at": "2025-12-12T11:33:27.826781Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.841357Z", "completed_at": "2025-12-12T11:33:27.841370Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.14255428314208984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu_gcs__stock_products_product_code.0878e32c8a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_code\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu_gcs__stock_products`\nwhere product_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.782338Z", "completed_at": "2025-12-12T11:33:27.828680Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.844093Z", "completed_at": "2025-12-12T11:33:27.844108Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.14200472831726074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__materials_material_id.8e2898dbe5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect material_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials`\nwhere material_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.788154Z", "completed_at": "2025-12-12T11:33:27.830875Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.849644Z", "completed_at": "2025-12-12T11:33:27.849655Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.14429593086242676, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__materials_site_id.614d463e6e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect site_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials`\nwhere site_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.775784Z", "completed_at": "2025-12-12T11:33:27.829966Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.848999Z", "completed_at": "2025-12-12T11:33:27.849016Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.14971470832824707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_yuman__clients_client_id.12116495a3", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select client_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_yuman__clients`\n  where client_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.799236Z", "completed_at": "2025-12-12T11:33:27.833925Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.851203Z", "completed_at": "2025-12-12T11:33:27.851214Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.1426849365234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__materials_clients_client_id.307466ae21", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect client_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials_clients`\nwhere client_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.793179Z", "completed_at": "2025-12-12T11:33:27.834516Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.851862Z", "completed_at": "2025-12-12T11:33:27.851876Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.15054082870483398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_yuman__materials_material_id.a2c990b4a9", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select material_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials`\n  where material_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.812484Z", "completed_at": "2025-12-12T11:33:27.839149Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.854563Z", "completed_at": "2025-12-12T11:33:27.854574Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.13907313346862793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__materials_clients_site_id.00254a1aa0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect site_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials_clients`\nwhere site_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.805917Z", "completed_at": "2025-12-12T11:33:27.837559Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.853238Z", "completed_at": "2025-12-12T11:33:27.853249Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.14249300956726074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__materials_clients_material_id.65161533d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect material_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials_clients`\nwhere material_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.820225Z", "completed_at": "2025-12-12T11:33:27.840597Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.857318Z", "completed_at": "2025-12-12T11:33:27.857335Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.13522100448608398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_yuman__materials_clients_material_id.3293b73ed8", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select material_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials_clients`\n  where material_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.889899Z", "completed_at": "2025-12-12T11:33:27.920974Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.952996Z", "completed_at": "2025-12-12T11:33:27.953015Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1568155288696289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__sites_client_id.cd8fb92b93", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect client_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`\nwhere client_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.902762Z", "completed_at": "2025-12-12T11:33:27.943889Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:27.996986Z", "completed_at": "2025-12-12T11:33:27.997011Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.1600959300994873, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__sites_site_id.d284592881", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect site_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`\nwhere site_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.912035Z", "completed_at": "2025-12-12T11:33:27.954337Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.016817Z", "completed_at": "2025-12-12T11:33:28.016833Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.1579902172088623, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_dim_yuman__materials_site_id__site_id__ref_dim_yuman__sites_.73849dcc87", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select site_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials`\n    where site_id is not null\n),\n\nparent as (\n    select site_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.923041Z", "completed_at": "2025-12-12T11:33:27.968566Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.019514Z", "completed_at": "2025-12-12T11:33:28.019527Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.15312623977661133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_dim_yuman__sites_client_id__client_id__ref_dim_yuman__clients_.3c8b8aee42", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select client_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`\n    where client_id is not null\n),\n\nparent as (\n    select client_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__clients`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.935616Z", "completed_at": "2025-12-12T11:33:27.980395Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.020398Z", "completed_at": "2025-12-12T11:33:28.020413Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.15381240844726562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_yuman_gcs__stock_articles_reference.f996334348", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect reference\nfrom `evs-datastack-prod`.`prod_marts`.`fct_yuman_gcs__stock_articles`\nwhere reference is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.930322Z", "completed_at": "2025-12-12T11:33:27.990682Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.022609Z", "completed_at": "2025-12-12T11:33:28.022625Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.1578078269958496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_yuman__sites_site_id.97c9826437", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select site_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`\n  where site_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.946030Z", "completed_at": "2025-12-12T11:33:28.017834Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.032475Z", "completed_at": "2025-12-12T11:33:28.032488Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.15169477462768555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_yuman_gcs__stock_articles_stock_date.f39c724228", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stock_date\nfrom `evs-datastack-prod`.`prod_marts`.`fct_yuman_gcs__stock_articles`\nwhere stock_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.955005Z", "completed_at": "2025-12-12T11:33:28.018886Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.033897Z", "completed_at": "2025-12-12T11:33:28.033910Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.15387225151062012, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_unique_combination_of_columns_fct_mssql_sage__pnl_bu_numero_ecriture_comptable__numero_plan_analytique__numero_ligne_analytique.4108e49150", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        numero_ecriture_comptable, numero_plan_analytique, numero_ligne_analytique\n    from `evs-datastack-prod`.`prod_marts`.`fct_mssql_sage__pnl_bu`\n    group by numero_ecriture_comptable, numero_plan_analytique, numero_ligne_analytique\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.962836Z", "completed_at": "2025-12-12T11:33:28.021072Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.039694Z", "completed_at": "2025-12-12T11:33:28.039706Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.15631318092346191, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_mssql_sage__pnl_bu_date_facturation.9715beddfa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_facturation\nfrom `evs-datastack-prod`.`prod_marts`.`fct_mssql_sage__pnl_bu`\nwhere date_facturation is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.969584Z", "completed_at": "2025-12-12T11:33:28.021737Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.040321Z", "completed_at": "2025-12-12T11:33:28.040332Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.1567060947418213, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_mssql_sage__pnl_bu_numero_compte_general.d696a3893a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect numero_compte_general\nfrom `evs-datastack-prod`.`prod_marts`.`fct_mssql_sage__pnl_bu`\nwhere numero_compte_general is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.981277Z", "completed_at": "2025-12-12T11:33:28.023534Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.043045Z", "completed_at": "2025-12-12T11:33:28.043057Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.1509075164794922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_yuman__workorder_pricing", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- MODEL: fct_yuman__workorder_pricing\n-- PURPOSE: Determine automatic pricing for technical interventions from Yuman\n-- AUTHOR: Cebrail AKSOY\n-- UPDATED: 2025-12-12 11:33:18.892053+00:00\n-- ============================================================================\n\nWITH \n-- ============================================================================\n-- 1. BASE DATA EXTRACTION\n-- ============================================================================\nbase_workorders AS (\n  SELECT\n    demand_id,\n    workorder_id,\n    material_id,\n    site_id,\n    client_id,\n    technician_id,\n    manager_id,\n    demand_description,\n    demand_status,\n    demand_created_at,\n    demand_updated_at,\n    demand_category_name,\n    workorder_number,\n    workorder_category,\n    workorder_status,\n    workorder_technician_name,\n    workorder_date_creation,\n    workorder_motif_non_intervention,\n    workorder_detail_non_intervention,\n    workorder_raison_mise_en_pause,\n    workorder_explication_mise_en_pause,\n    date_planned,\n    date_started,\n    date_done,\n    partner_name,\n    client_code,\n    client_name,\n    client_category,\n    client_is_active,\n    site_code,\n    site_name,\n    site_address,\n    site_postal_code,\n    material_serial_number,\n    technician_equipe,\n\n    -- Normalize workorder type\n    LOWER(COALESCE(\n      workorder_category,\n      CASE\n        WHEN workorder_type = 'Reactive' THEN 'curatif'\n        WHEN workorder_type = 'Preventive' THEN 'pr\u00e9ventif'\n        WHEN workorder_type = 'Installation' THEN 'installation'\n        ELSE workorder_type\n      END\n    )) AS workorder_type_raw,\n\n    -- Normalize machine category\n    LOWER(TRIM(CASE\n      WHEN material_category IS NOT NULL THEN material_category\n      WHEN LOWER(client_name) LIKE '%generique%' THEN CONCAT(partner_name, '_GENERIQUE')\n      WHEN partner_name = 'AUUM' THEN 'MGZ'\n      WHEN partner_name = 'TWYD' THEN 'FONTAINE TWYD'\n      WHEN partner_name = 'EXPRESSO' THEN 'MILANO'\n      WHEN partner_name = 'NESHU' THEN 'MILANO'\n      WHEN partner_name = 'BRITA' THEN 'viv t 85 c2-tg-i-cu ce'\n      WHEN partner_name = 'DAAN' THEN 'lave-vaisselle'\n      WHEN partner_name = 'NU' THEN 'frigo nu'\n      ELSE NULL  \n    END)) AS machine_raw,\n\n    -- Postal code correction\n    CASE\n      WHEN site_postal_code IS NULL OR site_postal_code = '00000' THEN (\n        SELECT code_postal\n        FROM UNNEST(REGEXP_EXTRACT_ALL(demand_description, r'\\b\\d{5}\\b')) AS code_postal\n        WHERE NOT REGEXP_CONTAINS(\n          LEFT(demand_description, STRPOS(demand_description, code_postal)-1),\n          r'(?i)N\u00b0\\s*$|interventions?\\s*$'\n        )\n        LIMIT 1\n      )\n      ELSE REGEXP_EXTRACT(site_address, r'\\b(\\d{5})\\b')\n    END AS postal_code_site,\n\n    -- Billing indicator\n    CASE\n      WHEN workorder_status = 'Closed'\n        AND workorder_motif_non_intervention IS NULL\n        AND workorder_detail_non_intervention IS NULL\n      THEN TRUE\n      ELSE FALSE\n    END AS a_facturer\n\n  FROM `evs-datastack-prod`.`prod_intermediate`.`int_yuman__demands_workorders_enriched`\n),\n\n-- ============================================================================\n-- 2. REFERENCE TABLES\n-- ============================================================================\nref_type_inter AS (\n  SELECT \n    LOWER(Type_intervention_Brut) AS workorder_type_raw,\n    LOWER(TYPE_INTER) AS workorder_type_clean\n  FROM `evs-datastack-prod`.`prod_reference`.`ref_yuman__type_inter_clean`\n),\n\nref_machine AS (\n  SELECT machine_raw, machine_clean\n  FROM (\n    SELECT \n      LOWER(TRIM(Machine_Brut)) AS machine_raw,\n      LOWER(TRIM(MACHINE)) AS machine_clean,\n      ROW_NUMBER() OVER(PARTITION BY LOWER(TRIM(Machine_Brut)) ORDER BY MACHINE) AS rn\n    FROM `evs-datastack-prod`.`prod_reference`.`ref_yuman__machine_clean`\n  )\n  WHERE rn = 1\n),\n\nref_cp_metropole AS (\n  SELECT Code_Postal, Metropole\n  FROM `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_metropole`\n),\n\nref_dpt_metropole AS (\n  SELECT Departement, Metropole\n  FROM `evs-datastack-prod`.`prod_reference`.`ref_yuman__dpt_metropole`\n),\n\nref_tarification AS (\n  SELECT\n    LOWER(CONCAT(\n      TYPE_INTER, '_',\n      MACHINE, '_',\n      MARQUE, '_',\n      Type_tarif, '_',\n      CAST(METROPOLE AS STRING)\n    )) AS key_tarif,\n    Montant,\n    PROD\n  FROM `evs-datastack-prod`.`prod_reference`.`ref_yuman__tarification_clean`\n),\n\n-- ============================================================================\n-- 3. ENRICHMENT & NORMALIZATION\n-- ============================================================================\nworkorders_enriched AS (\n  SELECT\n    w.*,\n    COALESCE(ti.workorder_type_clean, w.workorder_type_raw) AS workorder_type_clean,\n    COALESCE(m.machine_clean, w.machine_raw) AS machine_clean,\n    COALESCE(cp.Metropole, dp.Metropole) AS metropole_city,\n    CASE\n      WHEN w.postal_code_site IS NULL THEN 1\n      WHEN cp.Code_Postal IS NOT NULL THEN 1\n      WHEN dp.Departement IS NOT NULL THEN 1\n      ELSE 0\n    END AS metropole,\n    ROW_NUMBER() OVER(PARTITION BY w.workorder_id ORDER BY w.date_done) AS rn\n  FROM base_workorders w\n  LEFT JOIN ref_type_inter ti ON w.workorder_type_raw = ti.workorder_type_raw\n  LEFT JOIN ref_machine m ON w.machine_raw = m.machine_raw\n  LEFT JOIN ref_cp_metropole cp ON w.postal_code_site = cp.Code_Postal\n  LEFT JOIN ref_dpt_metropole dp ON LEFT(w.postal_code_site, 2) = dp.Departement\n),\n\n-- ============================================================================\n-- 4. DEDUPLICATION & RECURRENCE CALCULATION\n-- ============================================================================\nworkorders_dedup AS (\n  SELECT\n    *,\n    CASE\n      WHEN postal_code_site IS NULL THEN 1\n      ELSE COUNT(\n        CASE WHEN a_facturer THEN site_id END\n      ) OVER (PARTITION BY site_id, DATE(date_done))\n    END AS reccurence\n  FROM workorders_enriched\n),\n\n-- ============================================================================\n-- 5. PRICING TYPE DETERMINATION\n-- ============================================================================\nworkorders_with_tarif AS (\n  SELECT\n    *,\n    CASE\n      WHEN postal_code_site IS NULL THEN 'Tarif normal'\n      WHEN partner_name IN ('AUUM', 'FONTAINCO', 'TWYD', 'NESHU', 'NU', 'DAANTECH', 'EXPRESSO', 'DAAN') THEN\n        CASE\n          WHEN reccurence < 5 THEN 'Tarif normal'\n          WHEN reccurence BETWEEN 5 AND 20 THEN 'Remise niv1'\n          ELSE 'Remise niv2'\n        END\n      WHEN partner_name IN ('BRITA', 'FONTAINCO') THEN\n        CASE\n          WHEN reccurence < 2 THEN 'Tarif normal'\n          WHEN reccurence BETWEEN 2 AND 5 THEN 'Remise niv1'\n          ELSE 'Remise niv2'\n        END\n      ELSE 'Tarif normal'\n    END AS type_tarif\n  FROM workorders_dedup\n),\n\n-- ============================================================================\n-- 6. FINAL JOIN WITH TARIFF TABLE\n-- ============================================================================\nfinal_result AS (\n  SELECT\n    w.*,\n    t.Montant,\n    t.PROD,\n    LOWER(CONCAT(\n      w.workorder_type_clean, '_',\n      w.machine_clean, '_',\n      w.partner_name, '_',\n      w.type_tarif, '_',\n      CAST(w.metropole AS STRING)\n    )) AS key_tarif_used\n  FROM workorders_with_tarif w\n  LEFT JOIN ref_tarification t\n    ON LOWER(CONCAT(\n      w.workorder_type_clean, '_',\n      w.machine_clean, '_',\n      w.partner_name, '_',\n      w.type_tarif, '_',\n      CAST(w.metropole AS STRING)\n    )) = t.key_tarif\n)\n\n-- ============================================================================\n-- 7. FINAL SELECT (CLEAN OUTPUT)\n-- ============================================================================\nSELECT\n  demand_id,\n  workorder_id,\n  material_id,\n  site_id,\n  client_id,\n  technician_id,\n  manager_id,\n  demand_description,\n  demand_status,\n  demand_created_at,\n  demand_updated_at,\n  demand_category_name,\n  workorder_number,\n  workorder_category,\n  workorder_status,\n  workorder_technician_name,\n  workorder_date_creation,\n  workorder_motif_non_intervention,\n  workorder_detail_non_intervention,\n  workorder_raison_mise_en_pause,\n  workorder_explication_mise_en_pause,\n  date_planned,\n  date_started,\n  date_done,\n  partner_name,\n  client_code,\n  client_name,\n  client_category,\n  client_is_active,\n  site_code,\n  site_name,\n  site_address,\n  postal_code_site as site_postal_code,\n  material_serial_number,\n  workorder_type_raw,\n  machine_raw,\n\n  -- Renamed metrics and keys\n  workorder_type_clean,\n  machine_clean,\n  metropole             AS metropolitan,\n  metropole_city,\n  technician_equipe,\n  reccurence            AS recurrence_count,\n  type_tarif            AS pricing_type,\n  key_tarif_used        AS pricing_key_used,\n  a_facturer            AS to_invoice,\n  Montant               AS amount,\n  PROD                  AS prod_number,\n  CASE\n    WHEN Montant IS NOT NULL AND a_facturer = TRUE THEN 'VALIDATED'\n    WHEN Montant IS NULL AND a_facturer = TRUE THEN 'MISSING_TARIF'\n    ELSE 'NOT_BILLABLE'\n  END as billing_validation_status\n\nFROM final_result", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_pricing`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.975316Z", "completed_at": "2025-12-12T11:33:28.024437Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.043687Z", "completed_at": "2025-12-12T11:33:28.043703Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.15444612503051758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_mssql_sage__pnl_bu_numero_ecriture_comptable.4ef99525cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect numero_ecriture_comptable\nfrom `evs-datastack-prod`.`prod_marts`.`fct_mssql_sage__pnl_bu`\nwhere numero_ecriture_comptable is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.003286Z", "completed_at": "2025-12-12T11:33:28.029519Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.046440Z", "completed_at": "2025-12-12T11:33:28.046451Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.14782953262329102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_snap_oracle_neshu__device_dbt_scd_id.269fd19cb3", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select dbt_scd_id as unique_field\n  from `evs-datastack-prod`.`snapshots`.`snap_oracle_neshu__device`\n  where dbt_scd_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.991406Z", "completed_at": "2025-12-12T11:33:28.027721Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.045107Z", "completed_at": "2025-12-12T11:33:28.045119Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.1579737663269043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_snap_oracle_neshu__device_dbt_scd_id.39f7d4ed32", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dbt_scd_id\nfrom `evs-datastack-prod`.`snapshots`.`snap_oracle_neshu__device`\nwhere dbt_scd_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:27.997713Z", "completed_at": "2025-12-12T11:33:28.033160Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.049959Z", "completed_at": "2025-12-12T11:33:28.049971Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.15764665603637695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_snap_oracle_neshu__device_device_id.513485a549", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `evs-datastack-prod`.`snapshots`.`snap_oracle_neshu__device`\nwhere device_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.011631Z", "completed_at": "2025-12-12T11:33:28.036939Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.053640Z", "completed_at": "2025-12-12T11:33:28.053652Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.15686750411987305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__machines_yuman_maintenance_base_device_code.a8d1d80e51", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_code\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__machines_yuman_maintenance_base`\nwhere device_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.084683Z", "completed_at": "2025-12-12T11:33:28.112985Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.139364Z", "completed_at": "2025-12-12T11:33:28.139382Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.15421390533447266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__machines_yuman_maintenance_base_device_id.eb5ccd792d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__machines_yuman_maintenance_base`\nwhere device_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.099652Z", "completed_at": "2025-12-12T11:33:28.138703Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.191392Z", "completed_at": "2025-12-12T11:33:28.191417Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.15515351295471191, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__valorisation_parc_machines_device_group.4a8a9df545", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_group\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__valorisation_parc_machines`\nwhere device_group is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.107883Z", "completed_at": "2025-12-12T11:33:28.146546Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.197815Z", "completed_at": "2025-12-12T11:33:28.197833Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.1515951156616211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__valorisation_parc_machines_device_name.d0e9413d98", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_name\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__valorisation_parc_machines`\nwhere device_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.115440Z", "completed_at": "2025-12-12T11:33:28.153502Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.208986Z", "completed_at": "2025-12-12T11:33:28.209007Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.14992833137512207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_company_code.4dd651bc02", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_code\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere company_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.122245Z", "completed_at": "2025-12-12T11:33:28.159443Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.210513Z", "completed_at": "2025-12-12T11:33:28.210530Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1499161720275879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_company_info.8eeabe00a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_info\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere company_info is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.130570Z", "completed_at": "2025-12-12T11:33:28.172971Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.212433Z", "completed_at": "2025-12-12T11:33:28.212449Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.15107178688049316, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_device_id.cb546c4a7e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere device_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.140175Z", "completed_at": "2025-12-12T11:33:28.201016Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.222901Z", "completed_at": "2025-12-12T11:33:28.222917Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.1466236114501953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_device_info.08be705635", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_info\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere device_info is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.147281Z", "completed_at": "2025-12-12T11:33:28.209651Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.224004Z", "completed_at": "2025-12-12T11:33:28.224017Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.14740920066833496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_mission_faite.4c914d3f47", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mission_faite\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere mission_faite is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.154283Z", "completed_at": "2025-12-12T11:33:28.211720Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.230105Z", "completed_at": "2025-12-12T11:33:28.230120Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.1496875286102295, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_mission_prevue.79cb0b2a32", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mission_prevue\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere mission_prevue is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.160278Z", "completed_at": "2025-12-12T11:33:28.213055Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.230875Z", "completed_at": "2025-12-12T11:33:28.230891Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.15181469917297363, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_task_id.b47f804afa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.173736Z", "completed_at": "2025-12-12T11:33:28.215061Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.234183Z", "completed_at": "2025-12-12T11:33:28.234199Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.14638948440551758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_task_status_code.b0aa10d1d0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_status_code\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere task_status_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.165563Z", "completed_at": "2025-12-12T11:33:28.213995Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.233505Z", "completed_at": "2025-12-12T11:33:28.233517Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.1550273895263672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_task_start_date.8dceb0b3e4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.179205Z", "completed_at": "2025-12-12T11:33:28.215683Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.234848Z", "completed_at": "2025-12-12T11:33:28.234859Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.15030622482299805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_oracle_neshu__pa_business_review_device_id__device_id__ref_dim_oracle_neshu__device_.94d4d49600", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select device_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\n    where device_id is not null\n),\n\nparent as (\n    select device_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.186267Z", "completed_at": "2025-12-12T11:33:28.219752Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.236928Z", "completed_at": "2025-12-12T11:33:28.236939Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.15249419212341309, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_fct_oracle_neshu__pa_business_review_task_id.e6a4a507a2", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\n  where task_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.192568Z", "completed_at": "2025-12-12T11:33:28.226720Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.243314Z", "completed_at": "2025-12-12T11:33:28.243326Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.15078234672546387, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__chargement_tasks_created_at.099654dbc5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.201814Z", "completed_at": "2025-12-12T11:33:28.227398Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.243982Z", "completed_at": "2025-12-12T11:33:28.243993Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.14624595642089844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__chargement_tasks_extracted_at.7247f9f7e5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.273683Z", "completed_at": "2025-12-12T11:33:28.301926Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.329217Z", "completed_at": "2025-12-12T11:33:28.329235Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.14764976501464844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__chargement_tasks_product_id.97e92b8f9e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.289040Z", "completed_at": "2025-12-12T11:33:28.328410Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.381542Z", "completed_at": "2025-12-12T11:33:28.381563Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.15056371688842773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__chargement_tasks_task_id.dbf995a952", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.296449Z", "completed_at": "2025-12-12T11:33:28.335048Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.384761Z", "completed_at": "2025-12-12T11:33:28.384778Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.1487269401550293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__chargement_tasks_task_product_id.22016f77c7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.303318Z", "completed_at": "2025-12-12T11:33:28.342542Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.390742Z", "completed_at": "2025-12-12T11:33:28.390762Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.14944815635681152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__chargement_tasks_task_start_date.18b12689c3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.311507Z", "completed_at": "2025-12-12T11:33:28.343289Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.392369Z", "completed_at": "2025-12-12T11:33:28.392381Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1512296199798584, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__chargement_tasks_updated_at.cfb1806175", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.319352Z", "completed_at": "2025-12-12T11:33:28.362317Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.400086Z", "completed_at": "2025-12-12T11:33:28.400102Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.15031957626342773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__chargement_tasks_task_product_id.f02aff9a5d", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.329965Z", "completed_at": "2025-12-12T11:33:28.391537Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.412324Z", "completed_at": "2025-12-12T11:33:28.412337Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.14666175842285156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__ecart_inventaire_tasks_created_at.7d0fcea0cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.336374Z", "completed_at": "2025-12-12T11:33:28.398455Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.415902Z", "completed_at": "2025-12-12T11:33:28.415915Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.1482224464416504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__ecart_inventaire_tasks_extracted_at.3521403fea", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.344588Z", "completed_at": "2025-12-12T11:33:28.399409Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.416580Z", "completed_at": "2025-12-12T11:33:28.416592Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.1476151943206787, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__ecart_inventaire_tasks_product_id.7f8ffacb68", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.363900Z", "completed_at": "2025-12-12T11:33:28.401915Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.420541Z", "completed_at": "2025-12-12T11:33:28.420553Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.14838790893554688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__ecart_inventaire_tasks_task_start_date.6192042d8e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.351946Z", "completed_at": "2025-12-12T11:33:28.400767Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.417974Z", "completed_at": "2025-12-12T11:33:28.417986Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.1518237590789795, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__ecart_inventaire_tasks_task_id.a45f2ce08b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.369464Z", "completed_at": "2025-12-12T11:33:28.402928Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.421188Z", "completed_at": "2025-12-12T11:33:28.421199Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.14582157135009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__ecart_inventaire_tasks_updated_at.a93b91f4db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.357227Z", "completed_at": "2025-12-12T11:33:28.403535Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.421840Z", "completed_at": "2025-12-12T11:33:28.421851Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.1550755500793457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__ecart_inventaire_tasks_task_product_id.e6945505d5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.374842Z", "completed_at": "2025-12-12T11:33:28.407274Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.423939Z", "completed_at": "2025-12-12T11:33:28.423953Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.15126657485961914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__ecart_inventaire_tasks_task_product_id.0895448e86", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.385555Z", "completed_at": "2025-12-12T11:33:28.413088Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.426140Z", "completed_at": "2025-12-12T11:33:28.426152Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.13259291648864746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_created_at.49335f4f3a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.393072Z", "completed_at": "2025-12-12T11:33:28.417197Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.433959Z", "completed_at": "2025-12-12T11:33:28.433971Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.13677406311035156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_destination_code.60865e1142", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect destination_code\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere destination_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.459901Z", "completed_at": "2025-12-12T11:33:28.488044Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.511487Z", "completed_at": "2025-12-12T11:33:28.511504Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.14014935493469238, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_extracted_at.9d5f1d0c81", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.475487Z", "completed_at": "2025-12-12T11:33:28.512242Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.561262Z", "completed_at": "2025-12-12T11:33:28.561280Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.14623475074768066, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_product_id.422706e73d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.482882Z", "completed_at": "2025-12-12T11:33:28.513727Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.569928Z", "completed_at": "2025-12-12T11:33:28.569943Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.14928078651428223, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_source_code.806024b65d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect source_code\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere source_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.489802Z", "completed_at": "2025-12-12T11:33:28.515153Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.576143Z", "completed_at": "2025-12-12T11:33:28.576156Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.14960741996765137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_task_id.feb7a19392", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.496428Z", "completed_at": "2025-12-12T11:33:28.533225Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.576957Z", "completed_at": "2025-12-12T11:33:28.576968Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.1483018398284912, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_task_product_id.acafb99a38", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.503622Z", "completed_at": "2025-12-12T11:33:28.553187Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.585802Z", "completed_at": "2025-12-12T11:33:28.585816Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.15079545974731445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_task_start_date.863ef2a87e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.515832Z", "completed_at": "2025-12-12T11:33:28.577762Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.600599Z", "completed_at": "2025-12-12T11:33:28.600624Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.14653253555297852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_updated_at.bfec986bee", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.522970Z", "completed_at": "2025-12-12T11:33:28.584119Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.601626Z", "completed_at": "2025-12-12T11:33:28.601639Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.14807486534118652, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__commande_interne_task_product_id.b43ba28698", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.528155Z", "completed_at": "2025-12-12T11:33:28.584925Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.603130Z", "completed_at": "2025-12-12T11:33:28.603142Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.14997529983520508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_oracle_neshu__machines_maintenance_tracking", "compiled": true, "compiled_code": "-- fct_oracle_neshu__machines_maintenance_tracking.sql\n\n\nWITH machines_base AS (\n    SELECT * FROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__machines_yuman_maintenance_base`\n),\n\n-- INTERVENTIONS YUMAN (toutes, pas de filtre ici)\nall_workorders AS (\n    SELECT \n        wd.demand_id, \n        wd.workorder_id,\n        wd.material_id, \n        wd.demand_status,\n        wdc.demand_category_name, \n        wo.date_planned,\n        wo.date_done, \n        wo.workorder_type, \n        wo.workorder_status\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands` wd\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands_categories` wdc\n        ON wd.demand_category_id = wdc.demand_category_id\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders` wo\n        ON wd.workorder_id = wo.workorder_id\n),\n\n-- ENRICHISSEMENT : Ajouter les interventions AUX machines (LEFT JOIN)\nworkorder_enrichi AS (\n    SELECT \n        mb.*,\n        wo.demand_id,\n        wo.workorder_id,\n        wo.demand_status,\n        wo.demand_category_name,\n        wo.date_planned,\n        wo.date_done,\n        wo.workorder_type,\n        wo.workorder_status\n    FROM machines_base mb\n    LEFT JOIN all_workorders wo\n        ON mb.material_id = wo.material_id\n),\n\n-- LISTE INTERVENTION PREV DLOG\nintervention_prev_dlog AS (\n    SELECT \n        CONCAT('NESH_', device_code) AS device_code, \n        MAX(task_end_date) AS last_preventive_date\n    FROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\n    WHERE dc04 = 'DC0402'\n        AND task_status_code = 'FAIT'\n    GROUP BY device_code\n),\n\n-- AJOUT PREV DLOG DANS LA LISTE DES INTERVENTION YUMAN\nmaterial_enrichi AS (\n    SELECT \n        we.*, \n        ipd.last_preventive_date \n    FROM workorder_enrichi we\n    LEFT JOIN intervention_prev_dlog ipd\n        ON we.material_serial_number = ipd.device_code\n),\n\n-- CALCUL DU RETARD PAR MACHINE\ncalcul_retard AS (\n    SELECT\n        device_id,\n        material_id,\n        device_code,\n        material_serial_number,\n        last_installation_date,\n        device_name,\n        company_code,\n        company_name,\n        client_code,\n        client_name,\n        client_category,\n        site_postal_code,\n        demand_status,\n        date_planned,\n        material_created_at,\n        \n        -- D\u00e9terminer la derni\u00e8re pr\u00e9ventive de la source 1 (Yuman)\n        MAX(CASE \n            WHEN (workorder_type = 'Preventive' OR demand_category_name = 'PREVENTIVE PROG - NESHU') \n                AND workorder_status = 'Closed' \n            THEN date_done \n            ELSE NULL \n        END) OVER (PARTITION BY material_id) AS derniere_preventive_source1,\n        \n        -- R\u00e9cup\u00e9rer la pr\u00e9ventive externe (source 2 - DLOG)\n        MAX(last_preventive_date) OVER (PARTITION BY material_id) AS derniere_preventive_source2,\n        \n        -- Date du jour\n        CURRENT_TIMESTAMP() AS today\n        \n    FROM material_enrichi\n),\n\n-- LOGIQUE PRINCIPALE DE CALCUL\nretard_final AS (\n    SELECT DISTINCT\n        device_id,\n        material_id,\n        device_code,\n        material_serial_number,\n        last_installation_date,\n        device_name,\n        company_code,\n        company_name,\n        client_code,\n        client_name,\n        client_category,\n        site_postal_code,\n        demand_status,\n        date_planned,\n        material_created_at,\n        \n        -- CAS 1: Machine install\u00e9e depuis moins de 13 mois\n        CASE\n            WHEN last_installation_date > TIMESTAMP_SUB(today, INTERVAL 395 DAY) THEN\n                FALSE\n            \n            -- CAS 2: Machine ancienne sans aucune pr\u00e9ventive\n            WHEN derniere_preventive_source1 IS NULL AND derniere_preventive_source2 IS NULL THEN\n                TRUE\n            \n            -- CAS 3: Machine avec pr\u00e9ventives - v\u00e9rifier si retard > 365 jours\n            ELSE\n                CASE\n                    WHEN GREATEST(\n                        COALESCE(derniere_preventive_source1, TIMESTAMP('1900-01-01')),\n                        COALESCE(derniere_preventive_source2, TIMESTAMP('1900-01-01'))\n                    ) < TIMESTAMP_SUB(today, INTERVAL 365 DAY)\n                    THEN TRUE\n                    ELSE FALSE\n                END\n        END AS retard_bol,\n        \n        -- CALCUL DU D\u00c9LAI\n        CASE\n            -- CAS 1: Machine r\u00e9cente (< 13 mois)\n            WHEN last_installation_date > TIMESTAMP_SUB(today, INTERVAL 395 DAY) THEN\n                TIMESTAMP_DIFF(TIMESTAMP_ADD(last_installation_date, INTERVAL 395 DAY), today, DAY)\n            \n            -- CAS 2: Aucune pr\u00e9ventive\n            WHEN derniere_preventive_source1 IS NULL AND derniere_preventive_source2 IS NULL THEN\n                -TIMESTAMP_DIFF(today, TIMESTAMP_ADD(last_installation_date, INTERVAL 365 DAY), DAY)\n            \n            -- CAS 3: Avec pr\u00e9ventives\n            ELSE\n                CASE\n                    WHEN TIMESTAMP_DIFF(today, GREATEST(\n                        COALESCE(derniere_preventive_source1, TIMESTAMP('1900-01-01')),\n                        COALESCE(derniere_preventive_source2, TIMESTAMP('1900-01-01'))\n                    ), DAY) > 365\n                    THEN -(TIMESTAMP_DIFF(today, GREATEST(\n                        COALESCE(derniere_preventive_source1, TIMESTAMP('1900-01-01')),\n                        COALESCE(derniere_preventive_source2, TIMESTAMP('1900-01-01'))\n                    ), DAY) - 365)\n                    ELSE 365 - TIMESTAMP_DIFF(today, GREATEST(\n                        COALESCE(derniere_preventive_source1, TIMESTAMP('1900-01-01')),\n                        COALESCE(derniere_preventive_source2, TIMESTAMP('1900-01-01'))\n                    ), DAY)\n                END\n        END AS retard_delai,\n        \n        -- SOURCE DE LA DERNI\u00c8RE PR\u00c9VENTIVE\n        CASE\n            WHEN last_installation_date > TIMESTAMP_SUB(today, INTERVAL 395 DAY) THEN\n                'aucune'\n            WHEN derniere_preventive_source1 IS NULL AND derniere_preventive_source2 IS NULL THEN\n                'aucune'\n            WHEN derniere_preventive_source2 IS NULL OR \n                (derniere_preventive_source1 IS NOT NULL AND derniere_preventive_source1 > derniere_preventive_source2) THEN\n                'yuman'\n            ELSE\n                'dlog'\n        END AS source_last_preventive,\n        \n        today\n        \n    FROM calcul_retard\n),\n\n-- D\u00c9DUPLICATION: Garder une seule ligne par machine\ndeduplique AS (\n    SELECT\n        * EXCEPT(today),\n        ROW_NUMBER() OVER (\n            PARTITION BY material_serial_number \n            ORDER BY \n                retard_bol ASC,                -- Les machines non en retard d'abord (FALSE avant TRUE)\n                material_created_at DESC,      -- Si les 2 non en retard : la plus r\u00e9cente\n                retard_delai ASC               -- Si les 2 en retard : le plus grand d\u00e9lai (n\u00e9gatif donc ASC)\n        ) AS rn\n    FROM retard_final\n),\n\n-- R\u00c9SULTAT RETARD DEDUPLIQU\u00c9\nresultat_retard AS (\n    SELECT\n        device_id,\n        material_id,\n        device_code,\n        material_serial_number,\n        last_installation_date,\n        device_name,\n        company_code,\n        company_name,\n        client_code,\n        client_name,\n        client_category,\n        site_postal_code,\n        retard_bol,\n        retard_delai,\n        source_last_preventive,\n        material_created_at\n    FROM deduplique\n    WHERE rn = 1\n),\n\n-- DEMANDES D'INTERVENTION YUMAN OUVERTES & PLANIFI\u00c9ES\ndi_data AS (\n    SELECT \n        wd.material_id,\n        wo.date_planned,\n        wd.created_at AS demand_created_at,  -- R\u00e9cup\u00e9rer la date de cr\u00e9ation\n        CASE\n            WHEN wd.demand_status = 'Open' THEN 'Ouvert'\n            WHEN wo.workorder_status = 'Scheduled' THEN 'Planifie'\n            ELSE 'Aucune'\n        END AS status_inter\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands` wd\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands_categories` wdc\n        ON wd.demand_category_id = wdc.demand_category_id\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders` wo\n        ON wd.workorder_id = wo.workorder_id\n    WHERE wdc.demand_category_name = 'PREVENTIVE PROG - NESHU' \n        AND (wd.demand_status = 'Open' OR wo.workorder_status = 'Scheduled')\n),\n\n-- JOIN INTERM\u00c9DIAIRE\njoined_data AS (\n    SELECT\n        rr.device_id,\n        rr.device_code,\n        rr.device_name,\n        rr.company_code,\n        rr.company_name,\n        rr.last_installation_date,\n        rr.material_id,\n        rr.material_serial_number,\n        rr.client_code,\n        rr.client_name,\n        rr.client_category,\n        rr.site_postal_code,\n        rr.retard_bol,\n        rr.retard_delai,\n        rr.source_last_preventive,\n        rr.material_created_at,\n        di.status_inter,\n        di.date_planned,\n        di.demand_created_at\n    FROM resultat_retard rr\n    LEFT JOIN di_data di\n        ON rr.material_id = di.material_id\n),\n\n-- D\u00c9DUPLICATION PAR DEVICE_ID (garder la DI la plus r\u00e9cente)\ndeduplicated AS (\n    SELECT\n        *,\n        ROW_NUMBER() OVER (\n            PARTITION BY device_id\n            ORDER BY demand_created_at DESC NULLS LAST  -- Les plus r\u00e9centes d'abord, NULL \u00e0 la fin\n        ) AS rn\n    FROM joined_data\n),\n\n-- ENRICHISSEMENT FINAL\nfinal AS (\n    SELECT\n        device_id,\n        device_code,\n        device_name,\n        company_code,\n        company_name,\n        last_installation_date AS device_last_installation_date,\n        material_id,\n        material_serial_number,\n        client_code,\n        client_name,\n        client_category,\n        site_postal_code,\n        retard_bol,\n        retard_delai,\n        source_last_preventive,\n        COALESCE(status_inter, 'Aucune') AS status_inter,\n        date_planned,\n        material_created_at,\n\n        -- M\u00e9tadonn\u00e9es dbt\n        CURRENT_TIMESTAMP() as dbt_updated_at,\n        '2595904a-aec3-41ec-a1e9-f19d18d6d7af' as dbt_invocation_id\n\n    FROM deduplicated\n    WHERE rn = 1  -- Ne garder qu'une ligne par device_id\n)\n\nSELECT * FROM final", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.537140Z", "completed_at": "2025-12-12T11:33:28.586488Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.604505Z", "completed_at": "2025-12-12T11:33:28.604518Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.15004444122314453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inter_techinique_tasks_company_id.963bf0b41a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\nwhere company_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.542472Z", "completed_at": "2025-12-12T11:33:28.587166Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.607285Z", "completed_at": "2025-12-12T11:33:28.607304Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.15225744247436523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inter_techinique_tasks_created_at.23cf274781", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.548049Z", "completed_at": "2025-12-12T11:33:28.591522Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.609528Z", "completed_at": "2025-12-12T11:33:28.609539Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.15458154678344727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inter_techinique_tasks_device_id.a4926002cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\nwhere device_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.554064Z", "completed_at": "2025-12-12T11:33:28.590736Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.608716Z", "completed_at": "2025-12-12T11:33:28.608735Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.15796470642089844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inter_techinique_tasks_extracted_at.ebb7615afa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.564280Z", "completed_at": "2025-12-12T11:33:28.595377Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.611594Z", "completed_at": "2025-12-12T11:33:28.611605Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.14706659317016602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inter_techinique_tasks_task_id.2ab30c87a3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.570591Z", "completed_at": "2025-12-12T11:33:28.602399Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.616062Z", "completed_at": "2025-12-12T11:33:28.616079Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.14614629745483398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inter_techinique_tasks_task_start_date.4d976b328e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.578718Z", "completed_at": "2025-12-12T11:33:28.603758Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.619042Z", "completed_at": "2025-12-12T11:33:28.619055Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.14110803604125977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inter_techinique_tasks_updated_at.75a6fbc88b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.649865Z", "completed_at": "2025-12-12T11:33:28.677902Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.705597Z", "completed_at": "2025-12-12T11:33:28.705614Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.1486365795135498, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__inter_techinique_tasks_task_id.e6fbe5979b", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\n  where task_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.664013Z", "completed_at": "2025-12-12T11:33:28.703470Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.750358Z", "completed_at": "2025-12-12T11:33:28.750377Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.1537466049194336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_interne_tasks_created_at.c6d4b559be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.671399Z", "completed_at": "2025-12-12T11:33:28.704948Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.756240Z", "completed_at": "2025-12-12T11:33:28.756256Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.14895868301391602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_interne_tasks_extracted_at.931738aaac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.684014Z", "completed_at": "2025-12-12T11:33:28.718120Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.759711Z", "completed_at": "2025-12-12T11:33:28.759725Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.14959955215454102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_interne_tasks_task_id.3d326d6d80", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.678582Z", "completed_at": "2025-12-12T11:33:28.719894Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.766289Z", "completed_at": "2025-12-12T11:33:28.766305Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.15258097648620605, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_interne_tasks_product_id.84345d9252", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.695389Z", "completed_at": "2025-12-12T11:33:28.744265Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.777311Z", "completed_at": "2025-12-12T11:33:28.777327Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.149855375289917, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_interne_tasks_task_product_id.4515c1033a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.706545Z", "completed_at": "2025-12-12T11:33:28.760312Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.785583Z", "completed_at": "2025-12-12T11:33:28.785594Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.14447426795959473, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_interne_tasks_task_start_date.a2d90a847c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.712976Z", "completed_at": "2025-12-12T11:33:28.767032Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.790465Z", "completed_at": "2025-12-12T11:33:28.790481Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.14658832550048828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_interne_tasks_updated_at.40f144213d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.720566Z", "completed_at": "2025-12-12T11:33:28.775160Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.792053Z", "completed_at": "2025-12-12T11:33:28.792066Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.1478128433227539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__livraison_interne_tasks_task_product_id.cca996b12e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.726871Z", "completed_at": "2025-12-12T11:33:28.775878Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.792743Z", "completed_at": "2025-12-12T11:33:28.792759Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.14905190467834473, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inventaire_tasks_created_at.e03cda86f7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.734082Z", "completed_at": "2025-12-12T11:33:28.776617Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.794018Z", "completed_at": "2025-12-12T11:33:28.794030Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.15070009231567383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inventaire_tasks_extracted_at.ce6508aabf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.739220Z", "completed_at": "2025-12-12T11:33:28.777942Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.796827Z", "completed_at": "2025-12-12T11:33:28.796843Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.14645004272460938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inventaire_tasks_product_id.315d649f9b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.745108Z", "completed_at": "2025-12-12T11:33:28.781226Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.798253Z", "completed_at": "2025-12-12T11:33:28.798265Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.1490485668182373, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inventaire_tasks_task_id.12d8825475", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.751135Z", "completed_at": "2025-12-12T11:33:28.784789Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.800326Z", "completed_at": "2025-12-12T11:33:28.800341Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.14506983757019043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inventaire_tasks_task_product_id.40c0d72097", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.761077Z", "completed_at": "2025-12-12T11:33:28.791376Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.806531Z", "completed_at": "2025-12-12T11:33:28.806543Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.13537812232971191, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inventaire_tasks_task_start_date.6ab0a21e68", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.767680Z", "completed_at": "2025-12-12T11:33:28.793354Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.809267Z", "completed_at": "2025-12-12T11:33:28.809278Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.13620710372924805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inventaire_tasks_updated_at.ed499f687b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.836070Z", "completed_at": "2025-12-12T11:33:28.869807Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:28.889957Z", "completed_at": "2025-12-12T11:33:28.889973Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3900330066680908, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__inventaire_tasks_task_product_id.6de7c4abb7", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.855750Z", "completed_at": "2025-12-12T11:33:28.888641Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.181650Z", "completed_at": "2025-12-12T11:33:29.181708Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.39153599739074707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_tasks_extracted_at.175de36255", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.850273Z", "completed_at": "2025-12-12T11:33:28.889316Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.187258Z", "completed_at": "2025-12-12T11:33:29.187275Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.3953382968902588, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_tasks_created_at.d2d3de44aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.864717Z", "completed_at": "2025-12-12T11:33:28.901791Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.190630Z", "completed_at": "2025-12-12T11:33:29.190643Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3936002254486084, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_tasks_product_id.8522aad15d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.871553Z", "completed_at": "2025-12-12T11:33:28.902574Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.191411Z", "completed_at": "2025-12-12T11:33:29.191425Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.3949267864227295, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_tasks_task_id.aed5d7619e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.880130Z", "completed_at": "2025-12-12T11:33:29.182524Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.210305Z", "completed_at": "2025-12-12T11:33:29.210317Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.39573025703430176, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_tasks_task_product_id.e3b9b08f8d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.896457Z", "completed_at": "2025-12-12T11:33:29.192749Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.217610Z", "completed_at": "2025-12-12T11:33:29.217624Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.38710784912109375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_tasks_updated_at.4ae155633f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.890774Z", "completed_at": "2025-12-12T11:33:29.192112Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.214872Z", "completed_at": "2025-12-12T11:33:29.214882Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.39037108421325684, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_tasks_task_start_date.341a694abf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.903260Z", "completed_at": "2025-12-12T11:33:29.204207Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.220608Z", "completed_at": "2025-12-12T11:33:29.220623Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.39124274253845215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__livraison_tasks_task_product_id.011a4e9629", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.911347Z", "completed_at": "2025-12-12T11:33:29.205111Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.222501Z", "completed_at": "2025-12-12T11:33:29.222514Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.39289402961730957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__reception_tasks_created_at.8083bcc7e8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.916774Z", "completed_at": "2025-12-12T11:33:29.206912Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.223754Z", "completed_at": "2025-12-12T11:33:29.223765Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.393460750579834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__reception_tasks_extracted_at.ec88db7302", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.922007Z", "completed_at": "2025-12-12T11:33:29.207564Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.224355Z", "completed_at": "2025-12-12T11:33:29.224365Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.3948087692260742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__reception_tasks_product_id.aa8ad941b0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.927146Z", "completed_at": "2025-12-12T11:33:29.206267Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.223140Z", "completed_at": "2025-12-12T11:33:29.223150Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.3841245174407959, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__reception_tasks_task_id.73ba57ad4f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:28.932326Z", "completed_at": "2025-12-12T11:33:29.213256Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.228461Z", "completed_at": "2025-12-12T11:33:29.228472Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.3866434097290039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__reception_tasks_task_product_id.af91258a78", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.193487Z", "completed_at": "2025-12-12T11:33:29.221243Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.237531Z", "completed_at": "2025-12-12T11:33:29.237542Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.3787403106689453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__reception_tasks_task_start_date.eb50f49146", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.199008Z", "completed_at": "2025-12-12T11:33:29.221921Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.238225Z", "completed_at": "2025-12-12T11:33:29.238236Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.3806166648864746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__reception_tasks_updated_at.2d211b0f61", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.265049Z", "completed_at": "2025-12-12T11:33:29.299763Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.319395Z", "completed_at": "2025-12-12T11:33:29.319415Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.14577007293701172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__reception_tasks_task_product_id.bf4c38de57", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.277741Z", "completed_at": "2025-12-12T11:33:29.311889Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.363796Z", "completed_at": "2025-12-12T11:33:29.363817Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.15061211585998535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_oracle_neshu__conso_business_review", "compiled": true, "compiled_code": "\n\nWITH telemetry_data AS (\n  SELECT \n    -- IDs\n    t.company_id,\n    t.device_id,\n    t.location_id,\n    t.product_id,\n    \n    -- Company\n    c.company_code,\n    c.company_name,\n\n    -- Localisation\n    COALESCE(NULLIF(t.task_location_info, ''), d.device_location) AS location,\n\n    -- Machine\n    d.device_code AS device_serial_number,\n    d.device_name,\n    d.device_brand,\n    d.device_economic_model,\n\n    -- Produit\n    p.product_name,\n    p.product_brand,\n    p.product_family,\n    p.product_group,\n    p.product_type,\n\n    -- Contexte\n    DATE(t.task_start_date) AS consumption_date,\n    'TELEMETRIE' AS data_source,\n\n    -- Mesure\n    SUM(t.telemetry_quantity) AS quantity\n    \n  FROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks` t\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device` d \n    ON t.device_id = d.device_id\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product` p \n    ON t.product_id = p.product_id\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company` c\n    ON t.company_id = c.company_id\n  GROUP BY \n    t.company_id, t.device_id, t.location_id, t.product_id,\n    c.company_code, c.company_name,\n    COALESCE(NULLIF(t.task_location_info, ''), d.device_location),\n    d.device_code, d.device_name, d.device_brand, d.device_economic_model,\n    p.product_name, p.product_brand, p.product_family, p.product_group, p.product_type,\n    DATE(t.task_start_date)\n),\nchargement_data AS (\n  SELECT \n    -- IDs\n    l.company_id,\n    l.device_id,\n    l.location_id,\n    l.product_id,\n    \n    -- Company\n    c.company_code,\n    c.company_name,\n\n    -- Localisation\n    COALESCE(NULLIF(l.task_location_info, ''), d.device_location) AS location,\n\n    -- Machine\n    d.device_code AS device_serial_number,\n    d.device_name,\n    d.device_brand,\n    d.device_economic_model,\n\n    -- Produit\n    p.product_name,\n    p.product_brand,\n    p.product_family,\n    p.product_group,\n    p.product_type,\n\n    -- Contexte\n    DATE(l.task_start_date) AS consumption_date,\n    'CHARGEMENT' AS data_source,\n\n    -- Quantit\u00e9 (ajust\u00e9e selon le produit)\n    SUM(\n      CASE\n        WHEN p.product_name LIKE '%GOBELET%RAME 50%' THEN l.load_quantity * 50\n        WHEN p.product_name LIKE '%GOBELET%RAME DE 30%' THEN l.load_quantity * 30\n        WHEN p.product_name LIKE '%GOBELET%RAME 35%' THEN l.load_quantity * 35\n        WHEN p.product_name LIKE '%MELANG%BTE 200%' THEN l.load_quantity * 200\n        WHEN p.product_name LIKE '%MELANGEUR%BTE 200%' THEN l.load_quantity * 200\n        WHEN p.product_name LIKE '%MELANGEUR%BTE 100%' THEN l.load_quantity * 100\n        WHEN p.product_name LIKE '%BEGHIN SAY 300%' THEN l.load_quantity * 300\n        WHEN p.product_name LIKE '%CARTON DE 500%' THEN l.load_quantity * 500\n        WHEN p.product_name LIKE '%DISTRIBUTEUR 300 SUCRES%' THEN l.load_quantity * 300\n        WHEN p.product_name LIKE '%SUCRE BATONNET 100%' THEN l.load_quantity * 100\n        WHEN p.product_name LIKE '%SUCRE BTE 300%' THEN l.load_quantity * 300\n        WHEN p.product_name LIKE '%NESPRESSO MELANGEURS EN BAMBOU INDI%' THEN l.load_quantity * 100\n        ELSE l.load_quantity\n      END\n    ) AS quantity\n\n  FROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks` l\n  INNER JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device` d \n    ON l.device_id = d.device_id\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product` p \n    ON l.product_id = p.product_id\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company` c\n    ON l.company_id = c.company_id\n  WHERE l.task_status_code in ('FAIT','VALIDE')\n  GROUP BY \n    l.company_id, l.device_id, l.location_id, l.product_id,\n    COALESCE(NULLIF(l.task_location_info, ''), d.device_location), c.company_code, c.company_name,\n    d.device_code, d.device_name, d.device_brand, d.device_economic_model,\n    p.product_name, p.product_brand, p.product_family, p.product_group, p.product_type,\n    DATE(l.task_start_date)\n),\nlivraison_data AS (\n  SELECT\n    -- IDs\n    lt.company_id,\n    NULL AS device_id,\n    NULL AS location_id,\n    lt.product_id,\n\n    -- Company\n    c.company_code,\n    c.company_name,\n\n    -- Localisation (fixe)\n    'LIVRAISON' AS location,\n\n    -- Machine (fixe)\n    'LIVRAISON' AS device_serial_number,\n    'LIVRAISON' AS device_name,\n    'LIVRAISON' AS device_brand,\n    'LIVRAISON' AS device_economic_model,\n\n    -- Produit\n    p.product_name,\n    p.product_brand,\n    p.product_family,\n    p.product_group,\n    p.product_type,\n\n    -- Contexte\n    DATE(lt.task_start_date) AS consumption_date,\n    'LIVRAISON' AS data_source,\n\n    -- Quantit\u00e9 (ajust\u00e9e selon le produit)\n    SUM(\n      CASE\n        WHEN p.product_name LIKE '%GOBELET%RAME 50%' THEN lt.quantity * 50\n        WHEN p.product_name LIKE '%GOBELET%RAME DE 30%' THEN lt.quantity * 30\n        WHEN p.product_name LIKE '%GOBELET%RAME 35%' THEN lt.quantity * 35\n        WHEN p.product_name LIKE '%MELANG%BTE 200%' THEN lt.quantity * 200\n        WHEN p.product_name LIKE '%MELANGEUR%BTE 200%' THEN lt.quantity * 200\n        WHEN p.product_name LIKE '%MELANGEUR%BTE 100%' THEN lt.quantity * 100\n        WHEN p.product_name LIKE '%BEGHIN SAY 300%' THEN lt.quantity * 300\n        WHEN p.product_name LIKE '%CARTON DE 500%' THEN lt.quantity * 500\n        WHEN p.product_name LIKE '%DISTRIBUTEUR 300 SUCRES%' THEN lt.quantity * 300\n        WHEN p.product_name LIKE '%SUCRE BATONNET 100%' THEN lt.quantity * 100\n        WHEN p.product_name LIKE '%SUCRE BTE 300%' THEN lt.quantity * 300\n        WHEN p.product_name LIKE '%NESPRESSO MELANGEURS EN BAMBOU INDI%' THEN lt.quantity * 100\n        ELSE lt.quantity\n      END\n    ) AS quantity\n\n  FROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks` lt\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product` p \n    ON lt.product_id = p.product_id\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company` c\n    ON lt.company_id = c.company_id\n  WHERE lt.task_status_code in ('FAIT','VALIDE')\n  AND p.product_type in ('THE','CAFE CAPS','CHOCOLATS VAN HOUTEN','BOISSONS GOURMANDES','ACCESSOIRES')\n  GROUP BY \n    lt.company_id, lt.product_id,\n    p.product_name, p.product_brand, p.product_family, p.product_group, p.product_type, c.company_code, c.company_name,\n    DATE(lt.task_start_date)\n),\n-- Version optimis\u00e9e : remplace combined_data + donnees_filtrees\ncombined_and_filtered_data AS (\n\n  -- Cas particulier : machine AS00446 chez CN1046\n  SELECT *\n  FROM chargement_data\n  WHERE device_serial_number = 'AS00446'\n    AND company_code = 'CN1046'\n    AND consumption_date < '2025-08-28'\n    AND product_type IN ('THE','CAFE CAPS','CHOCOLATS VAN HOUTEN')\n\n  UNION ALL\n\n  SELECT *\n  FROM telemetry_data\n  WHERE device_serial_number = 'AS00446'\n    AND company_code = 'CN1046'\n    AND consumption_date >= '2025-08-28'\n\n  UNION ALL\n\n  -- TELEMETRIE avec filtres\n  SELECT *\n  FROM telemetry_data\n  WHERE product_type IN ('BOISSONS GOURMANDES', 'CAFE CAPS', 'CAFENOIR', 'INDEFINI', 'THE', 'SNACKING', 'BOISSONS FRAICHES', 'CHOCOLATS VAN HOUTEN')\n    AND NOT (\n      device_brand IN ('NESTLE','ANIMO')\n      AND (device_economic_model NOT IN ('Participatif valeurs','Participatif unit\u00e9s','Payant') OR device_economic_model IS NULL)\n      AND product_type = 'THE'\n    )\n    AND NOT (company_code = 'CN1071' AND product_type = 'THE')\n    AND NOT (device_serial_number = 'AS00446' AND company_code = 'CN1046') \n\n\n  UNION ALL\n\n  -- CHARGEMENT avec tous les filtres consolid\u00e9s\n  SELECT *\n  FROM chargement_data\n  WHERE (\n    (device_brand = 'NESPRESSO'\n     AND (device_economic_model NOT IN ('Participatif valeurs','Participatif unit\u00e9s','Payant') OR device_economic_model IS NULL)\n     AND product_type IN ('THE','CAFE CAPS')\n     AND (company_code <> 'CN1070' OR consumption_date >= '2025-03-01'))\n    OR (device_brand IN ('NESTLE','ANIMO')\n        AND (device_economic_model NOT IN ('Participatif valeurs','Participatif unit\u00e9s','Payant') OR device_economic_model IS NULL)\n        AND product_type = 'THE')\n    OR (device_brand IN ('NESPRESSO','NESTLE','ANIMO')\n        AND product_type = 'CHOCOLATS VAN HOUTEN')\n    OR (product_type = 'ACCESSOIRES')\n    OR (company_code = 'CN1071' AND product_type = 'THE')\n    AND NOT (device_serial_number = 'AS00446' AND company_code = 'CN1046') \n  )\n\n  UNION ALL\n\n  -- LIVRAISON (tous les enregistrements)\n  SELECT *\n  FROM livraison_data\n)\n\n\nSELECT \n  -- Identifiants\n  company_id,\n  device_id,\n  location_id,\n  product_id,\n  \n  -- Company\n  company_code,\n  company_name,\n\n  -- Localisation\n  location,\n\n  -- Machine\n  device_serial_number,\n  device_name,\n  device_brand,\n  device_economic_model,\n\n  -- Produit\n  product_name,\n  product_brand,\n  product_family,\n  product_group,\n  product_type,\n\n  -- Contexte\n  consumption_date,\n  data_source,\n\n  -- Mesure\n  quantity,\n\n  -- M\u00e9tadonn\u00e9es d'ex\u00e9cution\n  CURRENT_TIMESTAMP() as dbt_updated_at,\n  '2595904a-aec3-41ec-a1e9-f19d18d6d7af' as dbt_invocation_id\n\nFROM combined_and_filtered_data", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.287900Z", "completed_at": "2025-12-12T11:33:29.317815Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.365939Z", "completed_at": "2025-12-12T11:33:29.365952Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.15037941932678223, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__telemetry_tasks_created_at.ef85effe50", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.294507Z", "completed_at": "2025-12-12T11:33:29.331840Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.376066Z", "completed_at": "2025-12-12T11:33:29.376085Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.15008544921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__telemetry_tasks_extracted_at.5c3a5f7ac5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.301830Z", "completed_at": "2025-12-12T11:33:29.338761Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.383534Z", "completed_at": "2025-12-12T11:33:29.383548Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1523275375366211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__telemetry_tasks_product_id.04e1d8477d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.320140Z", "completed_at": "2025-12-12T11:33:29.376798Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.403054Z", "completed_at": "2025-12-12T11:33:29.403068Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.14627599716186523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__telemetry_tasks_task_product_id.3c6e38ed4d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.312556Z", "completed_at": "2025-12-12T11:33:29.377508Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.404343Z", "completed_at": "2025-12-12T11:33:29.404358Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.15675854682922363, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__telemetry_tasks_task_id.2a5854e826", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.326748Z", "completed_at": "2025-12-12T11:33:29.384346Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.407958Z", "completed_at": "2025-12-12T11:33:29.407972Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.1519172191619873, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__telemetry_tasks_task_start_date.66646fa50e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.332848Z", "completed_at": "2025-12-12T11:33:29.390806Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.408781Z", "completed_at": "2025-12-12T11:33:29.408796Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.15262746810913086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__telemetry_tasks_updated_at.8d8d17e88a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.345349Z", "completed_at": "2025-12-12T11:33:29.393003Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.410741Z", "completed_at": "2025-12-12T11:33:29.410758Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.15463781356811523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_yuman__workorder_delais_neshu", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- MODEL: fct_yuman__workorder_delais_neshu\n-- PURPOSE: Determiner les delais des inter (notamment curative) pas partenaire\n-- AUTHOR: Etienne BOULINIER\n-- ============================================================================\n\nWITH adjusted_dates AS (\n    -- Calculer la date de r\u00e9f\u00e9rence (ajouter 1 jour si l'heure d\u00e9passe 16h)\n    select\n    \tsfp.workorder_id as sfp_numero,\n        coalesce(TIMESTAMP(sfp.workorder_date_creation),sfp.demand_created_at) as date_creation_initial,\n        sfp.date_done as date_fin,\n        CASE\n          WHEN EXTRACT(TIME FROM COALESCE(TIMESTAMP(sfp.workorder_date_creation), sfp.demand_created_at)) > '16:00:00'\n            THEN TIMESTAMP(DATE(COALESCE(TIMESTAMP(sfp.workorder_date_creation), sfp.demand_created_at)) + 1)\n          ELSE COALESCE(TIMESTAMP(sfp.workorder_date_creation), sfp.demand_created_at)\n        END AS date_creation_ref\n    FROM `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_pricing` sfp\n),\ndates_range AS (\n  SELECT\n    ad.sfp_numero,\n    ad.date_creation_initial,\n    ad.date_fin,\n    ad.date_creation_ref,\n    date_jour\n  FROM adjusted_dates ad,\n  UNNEST(\n    GENERATE_DATE_ARRAY(\n      DATE(ad.date_creation_ref),\n      DATE(ad.date_fin),\n      INTERVAL 1 DAY\n    )\n  ) AS date_jour\n),\njours_feries as (\nselect * from `evs-datastack-prod`.`prod_reference`.`ref_general__feries_metropole`  \n),\nfamille_machine as (\nselect \n  Machine_Brut,\n  MACHINE,\n  famille_neshu\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__machine_clean`\n),\njours_ouvrables AS (\n    -- Filtrer les jours ouvr\u00e9s (exclure week-ends et jours f\u00e9ri\u00e9s)\n    select\n    \tdr.sfp_numero,\n        dr.date_creation_initial,\n        dr.date_fin,\n        dr.date_creation_ref,\n        dr.date_jour,\n        jf.date_ferie\n    FROM\n        dates_range dr\n    LEFT JOIN jours_feries jf ON dr.date_jour = jf.date_ferie\n    WHERE\n        EXTRACT(DAYOFWEEK FROM dr.date_jour) NOT IN (1, 7)-- Exclure samedi (7) et dimanche (1)\n        AND jf.date_ferie IS null -- Exclure jours f\u00e9ri\u00e9s\n),\ndelai_calcul AS (\n    -- Calculer le nombre total de jours ouvr\u00e9s entre date_creation_ref et date_fin\n    select\n    \tjo.sfp_numero,\n        jo.date_creation_initial,\n        jo.date_fin,\n        jo.date_creation_ref,\n        COUNT(jo.date_jour)-1 AS delai_jours_ouvres\n    FROM\n        jours_ouvrables jo\n    GROUP BY\n        jo.sfp_numero,jo.date_creation_initial, jo.date_fin, jo.date_creation_ref\n),\n-- R\u00e9sultat final CTE\nfinal_table as (\n  select sfp.*,dc.date_creation_ref,dc.delai_jours_ouvres,\n    (case when dc.delai_jours_ouvres = 0 then 'J+0,5'\n    \t  when dc.delai_jours_ouvres = 1 and extract(time from date_creation_ref) > '12:00:00' and extract(time from date_fin) < '12:00:00' then 'J+0,5'\n    \t  when dc.delai_jours_ouvres = 1 then 'J+1'\n    \t  when dc.delai_jours_ouvres = 2 then 'J+2'\n    \t  when dc.delai_jours_ouvres > 2 then 'J++'\n    \t  else 'ERREUR'\n   \tEND) as type_delai,\n  fm.famille_neshu\nfrom `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_pricing` sfp\nleft join delai_calcul dc on dc.sfp_numero = sfp.workorder_id\nleft join famille_machine fm on fm.Machine_Brut = sfp.machine_raw)\n--where extract(month from sfp.date_done) = 11 and extract(year from sfp.date_done) = 2025)\n-- SELECT REQUETE GLOBALE\nselect * from final_table", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_delais_neshu`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.339401Z", "completed_at": "2025-12-12T11:33:29.391539Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.409464Z", "completed_at": "2025-12-12T11:33:29.409476Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.1579580307006836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__telemetry_tasks_task_product_id.4d229c656f", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.350525Z", "completed_at": "2025-12-12T11:33:29.393850Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.411384Z", "completed_at": "2025-12-12T11:33:29.411397Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.15845060348510742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_yuman__workorder_pricing_client_id__client_id__ref_dim_yuman__clients_.21ac718d59", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select client_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_pricing`\n    where client_id is not null\n),\n\nparent as (\n    select client_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__clients`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.358595Z", "completed_at": "2025-12-12T11:33:29.400046Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.414952Z", "completed_at": "2025-12-12T11:33:29.414964Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.1518089771270752, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_yuman__workorder_pricing_material_id__material_id__ref_dim_yuman__materials_.ed56aeb83a", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select material_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_pricing`\n    where material_id is not null\n),\n\nparent as (\n    select material_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.366580Z", "completed_at": "2025-12-12T11:33:29.403677Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.418565Z", "completed_at": "2025-12-12T11:33:29.418580Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.14951539039611816, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_yuman__workorder_pricing_site_id__site_id__ref_dim_yuman__sites_.c702139d38", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select site_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_pricing`\n    where site_id is not null\n),\n\nparent as (\n    select site_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.378359Z", "completed_at": "2025-12-12T11:33:29.407283Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.422071Z", "completed_at": "2025-12-12T11:33:29.422083Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.13843321800231934, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_fct_yuman__workorder_pricing_demand_id.76643d2143", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select demand_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_pricing`\n  where demand_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.385372Z", "completed_at": "2025-12-12T11:33:29.410063Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.427034Z", "completed_at": "2025-12-12T11:33:29.427050Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.14069819450378418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_fct_yuman__workorder_pricing_workorder_id.0674558cf3", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select workorder_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_pricing`\n  where workorder_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.454431Z", "completed_at": "2025-12-12T11:33:29.496255Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.517656Z", "completed_at": "2025-12-12T11:33:29.517700Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.15025544166564941, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.accepted_values_fct_oracle_neshu__machines_maintenance_tracking_source_last_preventive__yuman__dlog__aucune.ac417d2f59", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        source_last_preventive as value_field,\n        count(*) as n_records\n\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\n    group by source_last_preventive\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'yuman','dlog','aucune'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.483583Z", "completed_at": "2025-12-12T11:33:29.511801Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.562299Z", "completed_at": "2025-12-12T11:33:29.562317Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.16846752166748047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_company_code.0cdf0f5a6b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_code\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere company_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.475229Z", "completed_at": "2025-12-12T11:33:29.510988Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.561459Z", "completed_at": "2025-12-12T11:33:29.561477Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.1730649471282959, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.accepted_values_fct_oracle_neshu__machines_maintenance_tracking_status_inter__Ouvert__Planifie__Aucune.808c90cc4e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status_inter as value_field,\n        count(*) as n_records\n\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\n    group by status_inter\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Ouvert','Planifie','Aucune'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.490093Z", "completed_at": "2025-12-12T11:33:29.518884Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.565457Z", "completed_at": "2025-12-12T11:33:29.565469Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.16978931427001953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_company_name.3bf8fed65d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_name\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere company_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.498290Z", "completed_at": "2025-12-12T11:33:29.538215Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.598628Z", "completed_at": "2025-12-12T11:33:29.598641Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1728665828704834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_device_code.21e30b32f5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_code\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere device_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.512467Z", "completed_at": "2025-12-12T11:33:29.571410Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.610436Z", "completed_at": "2025-12-12T11:33:29.610449Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.15712189674377441, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_device_id.980098d686", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere device_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.519536Z", "completed_at": "2025-12-12T11:33:29.584334Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.611295Z", "completed_at": "2025-12-12T11:33:29.611308Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.15860462188720703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_device_last_installation_date.2fb83a6c11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_last_installation_date\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere device_last_installation_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.526385Z", "completed_at": "2025-12-12T11:33:29.597980Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.613837Z", "completed_at": "2025-12-12T11:33:29.613852Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.1597001552581787, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_device_name.27263a7181", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_name\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere device_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.531784Z", "completed_at": "2025-12-12T11:33:29.599301Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.615202Z", "completed_at": "2025-12-12T11:33:29.615217Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.1618351936340332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_retard_bol.1a01596ee3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect retard_bol\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere retard_bol is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.550843Z", "completed_at": "2025-12-12T11:33:29.601343Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.618433Z", "completed_at": "2025-12-12T11:33:29.618444Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.15281176567077637, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_status_inter.169cfdb158", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status_inter\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere status_inter is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.538892Z", "completed_at": "2025-12-12T11:33:29.600429Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.617815Z", "completed_at": "2025-12-12T11:33:29.617827Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.16467618942260742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_retard_delai.90bc56ccbd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect retard_delai\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere retard_delai is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.545514Z", "completed_at": "2025-12-12T11:33:29.602134Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.619077Z", "completed_at": "2025-12-12T11:33:29.619088Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.16616034507751465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_source_last_preventive.00eb8f212a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect source_last_preventive\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere source_last_preventive is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.556155Z", "completed_at": "2025-12-12T11:33:29.602796Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.619695Z", "completed_at": "2025-12-12T11:33:29.619706Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.1526329517364502, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_fct_oracle_neshu__machines_maintenance_tracking_device_id.259a568a16", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select device_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\n  where device_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.574152Z", "completed_at": "2025-12-12T11:33:29.612476Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.627431Z", "completed_at": "2025-12-12T11:33:29.627446Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.14278578758239746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.accepted_values_fct_oracle_neshu__conso_business_review_product_type__THE__CAFE_CAPS__CHOCOLATS_VAN_HOUTEN__BOISSONS_GOURMANDES__ACCESSOIRES__CAFENOIR__INDEFINI__SNACKING__BOISSONS_FRAICHES.09a104a84b", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        product_type as value_field,\n        count(*) as n_records\n\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n    group by product_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'THE','CAFE CAPS','CHOCOLATS VAN HOUTEN','BOISSONS GOURMANDES','ACCESSOIRES','CAFENOIR','INDEFINI','SNACKING','BOISSONS FRAICHES'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.566347Z", "completed_at": "2025-12-12T11:33:29.613174Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.628126Z", "completed_at": "2025-12-12T11:33:29.628140Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.1524982452392578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.accepted_values_fct_oracle_neshu__conso_business_review_data_source__TELEMETRIE__CHARGEMENT__LIVRAISON.5ec7a388a7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        data_source as value_field,\n        count(*) as n_records\n\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n    group by data_source\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'TELEMETRIE','CHARGEMENT','LIVRAISON'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.586852Z", "completed_at": "2025-12-12T11:33:29.614411Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.628881Z", "completed_at": "2025-12-12T11:33:29.628897Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.14489173889160156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_accepted_range_fct_oracle_neshu__conso_business_review_consumption_date__current_date____2020_01_01_.5aa992f77c", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not consumption_date >= '2020-01-01'\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not consumption_date <= current_date()\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.659588Z", "completed_at": "2025-12-12T11:33:29.694760Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.720037Z", "completed_at": "2025-12-12T11:33:29.720055Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.14731526374816895, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.device_id_required_except_livraison.acb84a4429", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n\nwhere not((device_id IS NOT NULL) OR (data_source = 'LIVRAISON'))\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.675037Z", "completed_at": "2025-12-12T11:33:29.711622Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.756435Z", "completed_at": "2025-12-12T11:33:29.756451Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.14812803268432617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_company_code.5a6eede86e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_code\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere company_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.687405Z", "completed_at": "2025-12-12T11:33:29.718620Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.765543Z", "completed_at": "2025-12-12T11:33:29.765556Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.149061918258667, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_company_name.6beef2cb38", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_name\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere company_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.680688Z", "completed_at": "2025-12-12T11:33:29.719223Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.766296Z", "completed_at": "2025-12-12T11:33:29.766307Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.15303397178649902, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_company_id.ce47b5568c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere company_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.697343Z", "completed_at": "2025-12-12T11:33:29.739255Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.784272Z", "completed_at": "2025-12-12T11:33:29.784289Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.1479482650756836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_consumption_date.a8716670d9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect consumption_date\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere consumption_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.706479Z", "completed_at": "2025-12-12T11:33:29.764756Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.791610Z", "completed_at": "2025-12-12T11:33:29.791621Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.14247536659240723, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_data_source.af5248f6f7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect data_source\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere data_source is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.712494Z", "completed_at": "2025-12-12T11:33:29.766961Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.797146Z", "completed_at": "2025-12-12T11:33:29.797158Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.14596915245056152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_dbt_invocation_id.50b356c305", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dbt_invocation_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere dbt_invocation_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.727140Z", "completed_at": "2025-12-12T11:33:29.784916Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.799949Z", "completed_at": "2025-12-12T11:33:29.799965Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.14455962181091309, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_product_id.8da405d6c4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.722028Z", "completed_at": "2025-12-12T11:33:29.785725Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.803352Z", "completed_at": "2025-12-12T11:33:29.803368Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.14926528930664062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_dbt_updated_at.15c85805ca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dbt_updated_at\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere dbt_updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.732346Z", "completed_at": "2025-12-12T11:33:29.786376Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.804027Z", "completed_at": "2025-12-12T11:33:29.804038Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.1495649814605713, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_product_name.08b08915c7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_name\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere product_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.739899Z", "completed_at": "2025-12-12T11:33:29.787342Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.804641Z", "completed_at": "2025-12-12T11:33:29.804656Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.15100550651550293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_product_type.e47220660c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_type\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere product_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.744876Z", "completed_at": "2025-12-12T11:33:29.788107Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.805292Z", "completed_at": "2025-12-12T11:33:29.805303Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.15242815017700195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_quantity.b59694399a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantity\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.749835Z", "completed_at": "2025-12-12T11:33:29.788831Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.805936Z", "completed_at": "2025-12-12T11:33:29.805950Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.15434050559997559, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_oracle_neshu__conso_business_review_company_id__company_id__ref_dim_oracle_neshu__company_.f366f159ac", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select company_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n    where company_id is not null\n),\n\nparent as (\n    select company_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.757316Z", "completed_at": "2025-12-12T11:33:29.794433Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.810171Z", "completed_at": "2025-12-12T11:33:29.810187Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.13817787170410156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_oracle_neshu__conso_business_review_device_id__device_id__ref_dim_oracle_neshu__device_.28a6562f85", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select device_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n    where device_id is not null\n),\n\nparent as (\n    select device_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.769962Z", "completed_at": "2025-12-12T11:33:29.799233Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.814285Z", "completed_at": "2025-12-12T11:33:29.814297Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.13983154296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_oracle_neshu__conso_business_review_product_id__product_id__ref_dim_oracle_neshu__product_.8d74866c2a", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.775136Z", "completed_at": "2025-12-12T11:33:29.802753Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.817796Z", "completed_at": "2025-12-12T11:33:29.817807Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.14216828346252441, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_consumption_record.1740417b5a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        company_id, device_id, product_id, location_id, location, consumption_date, data_source\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n    group by company_id, device_id, product_id, location_id, location, consumption_date, data_source\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.849801Z", "completed_at": "2025-12-12T11:33:29.874687Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.876849Z", "completed_at": "2025-12-12T11:33:29.876867Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.054616451263427734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_yuman__workorder_delais_neshu_material_id__material_id__ref_dim_yuman__materials_.0c6f62d93b", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select material_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_delais_neshu`\n    where material_id is not null\n),\n\nparent as (\n    select material_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.857704Z", "completed_at": "2025-12-12T11:33:29.875507Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.877632Z", "completed_at": "2025-12-12T11:33:29.877648Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05493521690368652, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_yuman__workorder_delais_neshu_site_id__site_id__ref_dim_yuman__sites_.71af699e42", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select site_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_delais_neshu`\n    where site_id is not null\n),\n\nparent as (\n    select site_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.841637Z", "completed_at": "2025-12-12T11:33:29.876129Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.879508Z", "completed_at": "2025-12-12T11:33:29.879523Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07541871070861816, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_yuman__workorder_delais_neshu_client_id__client_id__ref_dim_yuman__clients_.d087bc885e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select client_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_delais_neshu`\n    where client_id is not null\n),\n\nparent as (\n    select client_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__clients`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.863738Z", "completed_at": "2025-12-12T11:33:29.878270Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.882521Z", "completed_at": "2025-12-12T11:33:29.882540Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.05905771255493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_fct_yuman__workorder_delais_neshu_demand_id.0cbb695c5d", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select demand_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_delais_neshu`\n  where demand_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-12-12T11:33:29.869050Z", "completed_at": "2025-12-12T11:33:29.878888Z"}, {"name": "execute", "started_at": "2025-12-12T11:33:29.885254Z", "completed_at": "2025-12-12T11:33:29.885265Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05549979209899902, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_fct_yuman__workorder_delais_neshu_workorder_id.af9d57d961", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select workorder_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_delais_neshu`\n  where workorder_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 7.566079378128052, "args": {"cache_selected_only": false, "state_modified_compare_vars": false, "require_all_warnings_handled_by_warn_error": false, "upload_to_artifacts_ingest_api": false, "quiet": false, "print": true, "require_yaml_configuration_for_mf_time_spines": false, "vars": {}, "warn_error_options": {"error": [], "warn": [], "silence": []}, "log_path": "/home/runner/work/dbt_transform/dbt_transform/logs", "static_parser": true, "indirect_selection": "eager", "which": "generate", "partial_parse": true, "require_nested_cumulative_type_params": false, "skip_nodes_if_on_run_start_fails": false, "compile": true, "strict_mode": false, "invocation_command": "dbt docs generate --target prod", "log_format_file": "debug", "project_dir": "/home/runner/work/dbt_transform/dbt_transform", "show_all_deprecations": false, "show_resource_report": false, "target": "prod", "static": false, "require_generic_test_arguments_property": true, "macro_debugging": false, "printer_width": 80, "log_level": "info", "require_resource_names_without_spaces": true, "log_file_max_bytes": 10485760, "source_freshness_run_project_hooks": true, "write_json": true, "log_format": "default", "select": [], "partial_parse_file_diff": true, "empty_catalog": false, "use_colors_file": true, "send_anonymous_usage_stats": false, "log_level_file": "debug", "profiles_dir": "/home/runner/work/dbt_transform/dbt_transform", "defer": false, "state_modified_compare_more_unrendered_values": false, "exclude": [], "introspect": true, "validate_macro_args": false, "version_check": true, "favor_state": false, "require_unique_project_resource_names": false, "use_colors": true, "require_explicit_package_overrides_for_builtin_materializations": true, "use_fast_test_edges": false, "populate_cache": true, "require_batched_execution_for_custom_microbatch_strategy": false}}
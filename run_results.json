{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.3", "generated_at": "2026-02-09T09:55:37.479265Z", "invocation_id": "cb08451a-2004-4aaf-949e-f43cc89d5466", "invocation_started_at": "2026-02-09T09:54:45.179075Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:49.737268Z", "completed_at": "2026-02-09T09:54:49.966216Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.025822Z", "completed_at": "2026-02-09T09:54:50.025844Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3729071617126465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_gac__sinistres_sg", "compiled": true, "compiled_code": "-- TEST SELECTIVE RUN, test de fdp\n\n\n\nwith source as (\n    select * from `evs-datastack-prod`.`prod_raw`.`gac_suivi_sinistres_sg`\n),\n\ncleaned as (\n    select\n        -- Nettoyage des cha\u00eenes vides en NULL\n        nullif(trim(n_de_sinistre), '') as n_de_sinistre,\n        nullif(trim(type), '') as type_sinistre,\n        nullif(trim(r_f_rence_gac), '') as reference_gac,\n        nullif(trim(immat_), '') as immat,\n        nullif(trim(circonstance), '') as circonstance,\n        nullif(trim(cl_tur_), '') as cloture,\n        nullif(trim(description), '') as description,\n        nullif(trim(tiers), '') as tiers,\n        nullif(trim(resp_), '') as resp,\n        nullif(trim(matricule), '') as matricule,\n        nullif(trim(nom), '') as nom,\n        nullif(trim(pr_nom), '') as prenom,\n        nullif(trim(centre_de_co_ts), '') as centre_de_couts,\n        nullif(trim(genre_fiscal), '') as genre_fiscal,\n        nullif(trim(statut_actuel), '') as statut_actuel,\n        nullif(trim(remboursement), '') as remboursement,\n        nullif(trim(constat_envoy_l_assureur), '') as constat_envoye_assureur,\n        nullif(trim(franchise_sup_rieure_la_r_paration), '') as franchise_superieure_reparation,\n        nullif(trim(trajet_domicile_travail), '') as trajet_domicile_travail,\n        nullif(trim(accident_de_week_end), '') as accident_de_week_end,\n        nullif(trim(lieu_du_sinistre), '') as lieu_du_sinistre,\n        nullif(trim(entit_entit_1), '') as entite_entite_1,\n        nullif(trim(entit_entit_2), '') as entite_entite_2,\n        nullif(trim(entit_entit_3), '') as entite_entite_3,\n        nullif(trim(entit_entit_4), '') as entite_entite_4,\n\n        -- Mesure\n        CAST(co_t_assureur AS FLOAT64) AS cout_assureur,\n        CAST(auto_assurance AS FLOAT64) AS auto_assurance,\n        CAST(franchise AS FLOAT64) AS franchise,\n        CAST(co_t_global AS FLOAT64) AS cout_global,\n        CAST(co_t_client AS FLOAT64) AS cout_client,\n\n        -- Date\n        SAFE.PARSE_TIMESTAMP('%d/%m/%Y %H:%M:%S', NULLIF(TRIM(date), '')) AS date_sinistre,\n        SAFE.PARSE_TIMESTAMP('%d/%m/%Y %H:%M:%S', NULLIF(TRIM(date_de_cr_ation), '')) AS date_de_creation,\n\n        -- Date annexe\n        SAFE.PARSE_DATE('%d/%m/%Y', NULLIF(TRIM(date_de_passage_de_l_expert), '')) AS date_passage_expert,\n        SAFE.PARSE_DATE('%d/%m/%Y', NULLIF(TRIM(date_de_r_ception_du_constat), '')) AS date_reception_constat,\n        SAFE.PARSE_DATE('%d/%m/%Y', NULLIF(TRIM(date_d_envoi_du_constat_l_assureur), '')) AS date_envoie_constat_assureur,\n        SAFE.PARSE_DATE('%d/%m/%Y', NULLIF(TRIM(date_de_d_but_de_r_paration), '')) AS date_debut_reparation,\n        SAFE.PARSE_DATE('%d/%m/%Y', NULLIF(TRIM(date_de_fin_de_r_paration), '')) AS date_fin_reparation,\n        SAFE.PARSE_DATE('%d/%m/%Y', NULLIF(TRIM(date_de_remise_du_v_hicule_au_collaborateur_apr_s_r_paration), '')) AS date_remise_vehicule_collaborateur,\n        SAFE.PARSE_DATE('%d/%m/%Y', NULLIF(TRIM(date_de_cl_ture_du_sinistre), '')) AS date_cloture_sinistre,\n\n        -- M\u00e9tadonn\u00e9es Meltano\n        _sdc_source_file,\n        _sdc_source_lineno,\n        _sdc_received_at,\n        _sdc_batched_at,\n        _sdc_sequence\n        \n    from source\n)\n\nselect * from cleaned", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_gac__sinistres_sg`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:49.756056Z", "completed_at": "2026-02-09T09:54:49.995049Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.042756Z", "completed_at": "2026-02-09T09:54:50.042771Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.41573548316955566, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_mssql_sage__f_collaborateur", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n    SELECT *\n    FROM `evs-datastack-prod`.`prod_raw`.`dbo_f_collaborateur`\n),\n\ncleaned_data AS (\n    SELECT\n        -- Champs principaux\n        CAST(JSON_VALUE(data, '$.CO_No') as INT64) AS co_no,\n        JSON_VALUE(data, '$.CO_Nom') AS co_nom,\n        JSON_VALUE(data, '$.CO_Prenom') AS co_prenom,\n        JSON_VALUE(data, '$.CO_Fonction') AS co_fonction,\n\n        -- Metadata\n        TIMESTAMP(JSON_VALUE(data, '$.cbCreation')) AS created_at,\n        TIMESTAMP(JSON_VALUE(data, '$.cbModification')) AS updated_at,\n        _sdc_extracted_at AS extracted_at\n\n    FROM source_data\n)\n\nSELECT *\nFROM cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_collaborateur`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:49.763029Z", "completed_at": "2026-02-09T09:54:50.010851Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.046153Z", "completed_at": "2026-02-09T09:54:50.046167Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.4574434757232666, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_mssql_sage__f_comptet", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n    SELECT *\n    FROM `evs-datastack-prod`.`prod_raw`.`dbo_f_comptet`\n),\n\ncleaned_data AS (\n    SELECT\n        -- Champs principaux\n        JSON_VALUE(data, '$.CT_Num') AS ct_num,\n        JSON_VALUE(data, '$.CT_Intitule') AS ct_intitule,\n        CAST(JSON_VALUE(data, '$.CT_Type') AS INT64) AS ct_type,\n        JSON_VALUE(data, '$.CT_Contact') AS ct_contact,\n        JSON_VALUE(data, '$.CT_Adresse') AS ct_adresse,\n        JSON_VALUE(data, '$.CT_Complement') AS ct_complement,\n        JSON_VALUE(data, '$.CT_CodePostal') AS ct_codepostal,\n        JSON_VALUE(data, '$.CT_Ville') AS ct_ville,\n        JSON_VALUE(data, '$.CT_Pays') AS ct_pays,\n        JSON_VALUE(data, '$.CT_Siret') AS ct_siret,\n        JSON_VALUE(data, '$.CT_NumPayeur') AS ct_numpayeur,\n        CAST(JSON_VALUE(data, '$.CO_No') AS INT64) AS co_no,\n        JSON_VALUE(data, '$.CT_Telephone') AS ct_telephone,\n        JSON_VALUE(data, '$.CT_EMail') AS ct_email,\n\n        -- Champs avec espaces\n        JSON_VALUE(data, '$.\"CATEGORISATION NIV 1\"') AS categorisation_niv_1,\n        JSON_VALUE(data, '$.\"CATEGORISATION NIV 2\"') AS categorisation_niv_2,\n        JSON_VALUE(data, '$.\"CATEGORISATION NIV 3\"') AS categorisation_niv_3,\n        JSON_VALUE(data, '$.\"LIGNE DE SERVICE\"') AS ligne_de_service,\n        JSON_VALUE(data, '$.\"ANNEE ORIGINE\"') AS annee_origine,\n        JSON_VALUE(data, '$.\"CLIENT PERDU\"') AS client_perdu,\n\n        -- Champs divers\n        JSON_VALUE(data, '$.TYPOLOGIE') AS typologie,\n\n        -- Metadata\n        TIMESTAMP(JSON_VALUE(data, '$.cbCreation')) AS created_at,\n        TIMESTAMP(JSON_VALUE(data, '$.cbModification')) AS updated_at,\n        _sdc_extracted_at AS extracted_at\n\n    FROM source_data\n)\n\nSELECT *\nFROM cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_comptet`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:49.966904Z", "completed_at": "2026-02-09T09:54:50.040897Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.093254Z", "completed_at": "2026-02-09T09:54:50.093269Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.49904417991638184, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_mssql_sage__f_docligne", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n    SELECT *\n    FROM `evs-datastack-prod`.`prod_raw`.`dbo_f_docligne`\n),\n\ncleaned_data AS (\n    SELECT\n        -- Identifiant unique de la ligne\n        CAST(JSON_VALUE(data, '$.DL_No') AS INT64) AS dl_no, -- PK\n        CAST(JSON_VALUE(data, '$.cbCO_No') AS INT64) AS cbco_no, -- FK pour table collaborateur\n\n        -- Champs principaux\n        JSON_VALUE(data, '$.CT_Num') AS ct_num,\n        JSON_VALUE(data, '$.DO_Piece') AS do_piece,\n        JSON_VALUE(data, '$.DL_Design') AS dl_design,\n        JSON_VALUE(data, '$.AR_Ref') AS ar_ref,\n\n        -- Dates & montants\n        TIMESTAMP(JSON_VALUE(data, '$.DO_Date')) AS do_date,\n        CAST(JSON_VALUE(data, '$.DL_Qte') AS FLOAT64) AS dl_qte,\n        CAST(JSON_VALUE(data, '$.DL_MontantHT') AS FLOAT64) AS dl_montant_ht,\n        CAST(JSON_VALUE(data, '$.DL_MontantTTC') AS FLOAT64) AS dl_montant_ttc,\n        CAST(JSON_VALUE(data, '$.DL_PrixUnitaire') AS FLOAT64) AS dl_prix_unitaire,\n\n        -- Metadata\n        TIMESTAMP(JSON_VALUE(data, '$.cbCreation')) AS created_at,\n        TIMESTAMP(JSON_VALUE(data, '$.cbModification')) AS updated_at,\n        _sdc_extracted_at AS extracted_at\n    FROM source_data\n)\n\nSELECT *\nFROM cleaned_data\n\n\n", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_docligne`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:49.978066Z", "completed_at": "2026-02-09T09:54:50.041723Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.094744Z", "completed_at": "2026-02-09T09:54:50.094756Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.539729118347168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_mssql_sage__f_ecriturea", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`dbo_f_ecriturea`\n),\n\ncleaned_data as (\n    select\n        -- IDs et num\u00e9ro convertis en BIGINT\n        cast(cb_marq as int64) as cb_marq,\n        cast(ec_no as int64) as ec_no,\n        cast(n_analytique as int64) as n_analytique,\n        cast(ea_ligne as int64) as ea_ligne,\n\n        -- Colonnes texte\n        ca_num,\n        cb_createur,\n        cb_creation_user,\n\n        -- Colonnes num\u00e9riques avec gestion des valeurs nulles\n        ea_montant,\n        ea_quantite,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(cb_creation) as created_at,\n        timestamp(coalesce(cb_modification, cb_creation)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect *\nfrom cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturea`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:49.990480Z", "completed_at": "2026-02-09T09:54:50.043635Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.138291Z", "completed_at": "2026-02-09T09:54:50.138303Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.5799994468688965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_nesp_co__activite", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`nespresso_commerce_activite`\n),\n\nbase_activite as (\n    select\n        -- IDs convertis en BIGINT\n        cast(nullif(activity_id, '#') as int64) as activity_id,\n\n        -- ID STRING\n        nullif(unnamed_1, '#') as c4c_id_commercial,\n        cast(nullif(unnamed_12, '#') as int64) as c4c_id_main_account,\n        nullif(nessoft_id_main_account, '#') as nessoft_id_main_account,\n        cast(nullif(unnamed_22, '#') as int64) as c4c_id_campaign,\n        nullif(campaign_id_preceding_lead, '#') as campaign_id_preceding_lead,\n\n        -- Colonnes texte\n        nullif(employee_responsible, '#') as employee_responsible,\n        nullif(activity_type, '#') as activity_type,\n        nullif(phone_call, '#') as phone_call,\n        nullif(created_by_phone_call, '#') as created_by_phone_call,\n        nullif(appointment, '#') as appointment,\n        nullif(created_by_appointment, '#') as created_by_appointment,\n        nullif(activity_category, '#') as activity_category,\n        nullif(main_account, '#') as main_account,\n        nullif(role, '#') as role,\n        nullif(activity_unit, '#') as activity_unit,\n        nullif(activity_life_cycle_status, '#') as activity_life_cycle_status,\n        nullif(notes, '#') as notes,\n\n        -- Dates harmonis\u00e9es (converties en TIMESTAMP)\n        timestamp(nullif(start_date_phone_call, '#')) as start_date_phone_call,\n        timestamp(nullif(start_date_appointment, '#')) as start_date_appointment,\n        timestamp(nullif(start_date_task, '#')) as start_date_task,\n        nullif(calendar_month, '#') as calendar_month,\n\n        -- Metadata\n        timestamp(extracted_at) as extracted_at,\n        timestamp(file_date) as file_date,\n        source_file\n\n    from source_data\n)\n\nselect *\nfrom base_activite", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_nesp_co__activite`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:49.984350Z", "completed_at": "2026-02-09T09:54:50.044761Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.138936Z", "completed_at": "2026-02-09T09:54:50.138968Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.6227917671203613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_mssql_sage__f_ecriturec", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`dbo_f_ecriturec`\n),\n\ncleaned_data as (\n    select\n        -- Identifiants\n        cast(ec_no as int64) as ec_no,\n        cast(ec_no_link as int64) as ec_no_link,\n        cast(cb_marq as int64) as cb_marq,\n\n        -- Journal et comptes\n        jo_num,\n        cg_num,\n        ct_num,\n        ec_intitule,\n\n        -- Montants et sens\n        coalesce(ec_sens, 0) as ec_sens,\n        coalesce(ec_montant, 0.0) as ec_montant,\n        coalesce(ec_montant_regle, 0.0) as ec_montant_regle,\n        ec_devise,\n        n_devise,\n\n        -- Dates\n        timestamp(ec_date) as ec_date,\n        timestamp(jm_date) as jm_date,\n        ec_jour,\n        case when ec_echeance = '1753-01-01' then NULL else timestamp(ec_echeance) end as ec_echeance,\n        case when ec_date_rappro = '1753-01-01' then NULL else timestamp(ec_date_rappro) end as ec_date_rappro,\n        case when ec_date_regle = '1753-01-01' then NULL else timestamp(ec_date_regle) end as ec_date_regle,\n\n        -- M\u00e9tadonn\u00e9es\n        cb_createur,\n        cb_creation_user,\n        timestamp(cb_creation) as created_at,\n        timestamp(coalesce(cb_modification, cb_creation)) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nselect *\nfrom cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturec`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.000497Z", "completed_at": "2026-02-09T09:54:50.046756Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.140304Z", "completed_at": "2026-02-09T09:54:50.140315Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.7023282051086426, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_nesp_co__opportunite", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`nespresso_commerce_opportunite`\n),\n\nbase_opportunite as (\n    select\n        -- IDs convertis en BIGINT\n        cast(\n                case\n                    when opportunity = '#' then null\n                    when opportunity = 'Result' then null\n                    else opportunity\n                end\n            as int64) as opportunity_id,\n\n        -- ID STRING\n        nullif(unnamed_2, '#') as c4c_id_commercial,\n        cast(regexp_replace(nullif(unnamed_13, '#'), r'\\.0$', '') as int64) as c4c_id_account,\n        nullif(nessoft_id, '#') as nessoft_id_account,\n        cast(nullif(unnamed_8, '#') as int64) as c4c_id_campaign,\n\n        -- Colonnes texte\n        nullif(employee_responsible, '#') as employee_responsible,\n        nullif(created_by, '#') as created_by,\n        nullif(unnamed_6, '#') as opportunity_name,\n        nullif(campaign, '#') as campaign_name,\n        nullif(source, '#') as source,\n        nullif(account, '#') as account_name,\n        nullif(reason_for_status, '#') as reason_for_status,\n        nullif(sales_unit, '#') as sales_unit,\n        nullif(role_account, '#') as role_account,\n        nullif(lifecycle_status, '#') as lifecycle_status,\n\n        -- Mesures num\u00e9riques\n        cast(nullif(first_coffee_order, '#') as float64) as first_coffee_order,\n        cast(nullif(expected_value, '#') as float64) as expected_value,\n        cast(nullif(zeq_zenius_equivalent, '#') as float64) as zeq_zenius_equivalent,\n        cast(replace(replace(trim(nullif(chance_of_success, '#')), '%', ''), ',', '.') as float64) as chance_of_success,\n        cast(nullif(machines, '#') as int64) as machines_opportunity,\n\n        -- Dates harmonis\u00e9es (converties en TIMESTAMP)\n        timestamp(nullif(created_on, '#')) as created_on,\n        timestamp(nullif(close_date, '#')) as close_date,\n\n        -- Metadata\n        timestamp(extracted_at) as extracted_at,\n        timestamp(file_date) as file_date,\n        source_file\n\n    from source_data\n)\n\nselect *\nfrom base_opportunite\nwhere opportunity_id is not null", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_nesp_co__opportunite`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:49.995765Z", "completed_at": "2026-02-09T09:54:50.045445Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.139586Z", "completed_at": "2026-02-09T09:54:50.139597Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.7049136161804199, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_nesp_co__client", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`nespresso_base_client`\n    where third is not null\n),\n\nbase_client as (\n    select\n        -- IDs convertis en BIGINT\n        cast(third as int64) as third,\n\n        -- Colonnes texte\n        third_name,\n        third_adr_ln1,\n        third_adr_ln2,\n        third_post_code,\n        third_city,\n        third_status_descr, \n        segmentation_hypercare,\n        categorie_client,\n        region,\n        secteur,\n        code_lmb,\n        mb_descr,\n        code_mb,\n        siret,\n        nb_salaries,\n        order_placer_name,\n        order_placer_adr_ln1,\n        order_placer_post_code,\n        order_placer_city,\n        order_placer_phone,\n\n        -- Dates\n        safe_cast(club_dt_disp as timestamp) as club_dt_disp,\n        safe_cast(last_caps_ord_dt_disp as timestamp) as last_caps_ord_dt_disp,\n\n        -- Mesures\n        ns,\n        ns_n1,\n        ns_n_ytd,\n        ns_n1_ytd,\n        cast(caps as int64) as caps,\n        cast(caps_n1 as int64) as caps_n1,\n        cast(_caps_n_ytd as int64) as caps_n_ytd,\n        cast(caps_n1_ytd as int64) as caps_n1_ytd,\n        cast(caps_b2b as int64) as caps_b2b,\n        cast(caps_b2c as int64) as caps_b2c,\n        cast(caps_b2c_ytd_ as int64) as caps_b2c_ytd,\n        cast(ez as int64) as ez,\n        cast(ez_n_ytd as int64) as ez_n_ytd,\n        cast(ez_n1 as int64) as ez_n1,\n\n        -- Metadata\n        _smart_source_bucket,\n        _smart_source_file,\n        _smart_source_lineno,\n        _sdc_batched_at,\n        _sdc_received_at\n\n    from source_data\n)\n\nselect * from base_client", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_nesp_co__client`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.005012Z", "completed_at": "2026-02-09T09:54:50.048258Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.182685Z", "completed_at": "2026-02-09T09:54:50.182697Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.7453563213348389, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_nesp_tech__articles", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`nespresso_technique_articles`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT (avec traitement des nan)\n        case \n            when lower(trim(cast(n_planning as string))) = 'nan' then null\n            else cast(n_planning as int64)\n        end as n_planning,\n        case \n            when lower(trim(cast(n_client as string))) = 'nan' then null\n            else cast(n_client as int64)\n        end as n_client,\n        case \n            when lower(trim(cast(n_site as string))) = 'nan' then null\n            else CAST(CAST(n_site AS FLOAT64) AS INT64)\n        end as n_site,\n\n        -- Colonnes texte\n        nullif(lower(trim(n_tech)), 'nan') as n_tech,\n        nullif(lower(trim(nom_tech)), 'nan') as nom_tech,\n        nullif(lower(trim(prenom_tech)), 'nan') as prenom_tech,\n        nullif(lower(trim(raison_sociale_client)), 'nan') as raison_sociale_client,\n        nullif(lower(trim(nom_site)), 'nan') as nom_site,\n        nullif(lower(trim(code_machine)), 'nan') as code_machine,\n        nullif(lower(trim(nom_machine)), 'nan') as nom_machine,\n        nullif(lower(trim(n_serie_machine)), 'nan') as num_serie_machine,\n        nullif(lower(trim(code_article)), 'nan') as code_article,\n        nullif(lower(trim(nom_article)), 'nan') as nom_article,\n\n        -- Mesure\n        cast(quantite as float64) as quantite_article,\n\n        -- Dates harmonis\u00e9es\n        case \n            when lower(trim(date)) in ('nat', 'nan') then null\n            else PARSE_DATE('%d/%m/%Y', date)\n        end as date_intervention,\n\n        -- Metadata\n        timestamp(extracted_at) as extracted_at,\n        source_file\n        \n    from source_data\n),\n\ndeduped as (\n    select *\n    from (\n        select *,\n               row_number() over (\n                   partition by n_planning, code_article, date_intervention\n                   order by extracted_at desc\n               ) as rn\n        from cleaned_data\n    )\n    where rn = 1\n)\n\nselect * \nfrom deduped", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_nesp_tech__articles`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.016841Z", "completed_at": "2026-02-09T09:54:50.048855Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.183355Z", "completed_at": "2026-02-09T09:54:50.183368Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.7726919651031494, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__company", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_company`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idcompany as int64) as idcompany,\n        cast(company_idcompany as int64) as company_idcompany,\n        cast(idcompany_type as int64) as idcompany_type,\n        cast(idcontact_creation as int64) as idcontact_creation,\n        cast(idcontact_modification as int64) as idcontact_modification,\n\n        -- Colonnes texte\n        code,\n        code_status_record,\n        name,\n        siret,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.011662Z", "completed_at": "2026-02-09T09:54:50.049576Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.184103Z", "completed_at": "2026-02-09T09:54:50.184115Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.8151373863220215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_nesp_tech__interventions", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`nespresso_technique_interventions`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT (avec traitement des nan)\n        case \n            when lower(trim(cast(n_planning as string))) = 'nan' then null\n            else cast(n_planning as int64)\n        end as n_planning,\n        case \n            when lower(trim(cast(n_client as string))) = 'nan' then null\n            else cast(n_client as int64)\n        end as n_client,\n        case \n            when lower(trim(cast(n_site as string))) = 'nan' then null\n            else CAST(CAST(n_site AS FLOAT64) AS INT64)\n        end as n_site,\n\n        -- Colonnes texte (avec traitement \"nan\" -> NULL)\n        nullif(lower(trim(n_tech)), 'nan') as n_tech,\n        nullif(lower(trim(nom_tech)), 'nan') as nom_tech,\n        nullif(lower(trim(prenom_tech)), 'nan') as prenom_tech,\n        nullif(lower(trim(raison_sociale_client)), 'nan') as raison_sociale_client,\n        nullif(lower(trim(adresse_client)), 'nan') as adresse_client,\n        nullif(lower(trim(code_postal_client)), 'nan') as code_postal_client,\n        nullif(lower(trim(ville_client)), 'nan') as ville_client,\n        nullif(lower(trim(nom_site)), 'nan') as nom_site,\n        nullif(lower(trim(adresse_site)), 'nan') as adresse_site,\n        case\n            when regexp_contains(\n                regexp_replace(\n                    nullif(lower(trim(code_postal_site)), 'nan'),\n                    r'\\.0$',\n                    ''\n                ),\n                r'^\\d{4}$'\n            )\n                then concat(\n                    '0',\n                    regexp_replace(\n                        nullif(lower(trim(code_postal_site)), 'nan'),\n                        r'\\.0$',\n                        ''\n                    )\n                )\n            else regexp_replace(\n                nullif(lower(trim(code_postal_site)), 'nan'),\n                r'\\.0$',\n                ''\n            )\n        end as code_postal_site,\n        nullif(lower(trim(ville_site)), 'nan') as ville_site,\n        nullif(lower(trim(code_machine)), 'nan') as code_machine,\n        nullif(lower(trim(nom_machine)), 'nan') as nom_machine,\n        nullif(lower(trim(n_serie_machine)), 'nan') as num_serie_machine,\n        nullif(lower(trim(type)), 'nan') as type,\n        nullif(lower(trim(etat_inter)), 'nan') as etat_intervention,\n        nullif(lower(trim(observations)), 'nan') as observations,\n        nullif(lower(trim(agency)), 'nan') as agency,\n        regexp_replace(\n            nullif(lower(trim(repair_code_1)), 'nan'),\n            r'\\.0$',\n            ''\n        ) as repair_code_1,\n        regexp_replace(\n            nullif(lower(trim(repair_code_2)), 'nan'),\n            r'\\.0$',\n            ''\n        ) as repair_code_2,\n\n        regexp_replace(\n            nullif(lower(trim(repair_code_3)), 'nan'),\n            r'\\.0$',\n            ''\n        ) as repair_code_3,\n        nullif(lower(trim(failure_code)), 'nan') as failure_code,\n        nullif(lower(trim(consignes)), 'nan') as consignes,\n        -- Dates harmonis\u00e9es (converties en TIMESTAMP, avec traitement \"NaT\" et dates invalides -> NULL)\n        case \n            when lower(trim(date_heure_debut)) in ('nat', 'nan') then null\n            when date_heure_debut like '01/01/0001%' then null\n            else TIMESTAMP(date_heure_debut)\n        end as date_heure_debut,\n        case \n            when lower(trim(date_heure_fin)) in ('nat', 'nan') then null\n            when date_heure_fin like '01/01/0001%' then null\n            else TIMESTAMP(date_heure_fin)\n        end as date_heure_fin,\n        case \n            when lower(trim(creation_date)) in ('nat', 'nan') then null\n            when creation_date like '01/01/0001%' then null\n            else TIMESTAMP(creation_date)\n        end as creation_date,\n        case \n            when lower(trim(pickup_date)) in ('nat', 'nan') then null\n            when pickup_date like '01/01/0001%' then null\n            else TIMESTAMP(pickup_date)\n        end as pickup_date,\n        case \n            when lower(trim(date_planning_nomadrepair)) in ('nat', 'nan') then null\n            when date_planning_nomadrepair like '01/01/0001%' then null\n            else TIMESTAMP(date_planning_nomadrepair)\n        end as date_planning_nomadrepair,\n\n        -- Metadata\n        timestamp(extracted_at) as extracted_at,\n        source_file\n        \n    from source_data\n),\n\ndeduplicated_data as (\n    select * from (\n        select \n            *,\n            row_number() over (\n                partition by n_planning, etat_intervention, date_heure_fin \n                order by extracted_at desc\n            ) as rn\n        from cleaned_data\n    )\n    where rn = 1\n)\n\nselect * from deduplicated_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_nesp_tech__interventions`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.021422Z", "completed_at": "2026-02-09T09:54:50.092260Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.185557Z", "completed_at": "2026-02-09T09:54:50.185569Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.8974757194519043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__company_has_location", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_company_has_location`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlocation as int64) as idlocation,\n        cast(idcompany as int64) as idcompany,\n        cast(idlocation_type as int64) as idlocation_type,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company_has_location`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.032068Z", "completed_at": "2026-02-09T09:54:50.094028Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.186579Z", "completed_at": "2026-02-09T09:54:50.186591Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.8965392112731934, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__contact", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_contact`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idcontact as int64) as idcontact,\n        cast(idcompany as int64) as idcompany,\n\n        -- Colonnes texte\n        code,\n        first_name,\n        last_name,\n        email,\n        name,\n        mobile,\n        phone,\n        qualite,\n        code_status_record,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__contact`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.036591Z", "completed_at": "2026-02-09T09:54:50.095360Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.269675Z", "completed_at": "2026-02-09T09:54:50.269688Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.9391584396362305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__contract", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select\n        cast(idcontract as int64) as idcontract,\n        idcontract_type,\n        idcompany_self,\n        idcompany_financial,\n        idcompany_peer,\n        idcontact_creation,\n        idcontact_modification,\n        code,\n        name,\n        code_status_record,\n        xml,\n        original_start_date,\n        original_end_date,\n        current_end_date,\n        termination_date,\n        creation_date,\n        modification_date,\n        _sdc_extracted_at,\n        _sdc_deleted_at\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_contract`\n),\n\ncleaned_data as (\n    select\n        cast(idcontract as int64) as idcontract,\n        cast(idcontract_type as int64) as idcontract_type,\n        cast(idcompany_self as int64) as idcompany_self,\n        cast(idcompany_financial as int64) as idcompany_financial,\n        cast(idcompany_peer as int64) as idcompany_peer,\n        cast(idcontact_creation as int64) as idcontact_creation,\n        cast(idcontact_modification as int64) as idcontact_modification,\n\n        code,\n        name,\n        code_status_record,\n\n        timestamp(original_start_date) as original_start_date,\n        timestamp(original_end_date) as original_end_date,\n        timestamp(current_end_date) as current_end_date,\n        timestamp(termination_date) as termination_date,\n\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at,\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__contract`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.026743Z", "completed_at": "2026-02-09T09:54:50.096085Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.271440Z", "completed_at": "2026-02-09T09:54:50.271455Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.9842050075531006, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__company_type", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_company_type`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idcompany_type as int64) as idcompany_type,\n\n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company_type`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.758640Z", "completed_at": "2026-02-09T09:54:50.792227Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.841642Z", "completed_at": "2026-02-09T09:54:50.841664Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3376784324645996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__device", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_device`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(iddevice as int64) as iddevice,\n        cast(device_iddevice as int64) as device_iddevice,\n        cast(iddevice_type as int64) as iddevice_type,\n        cast(idmodel as int64) as idmodel,\n        cast(idcompany_customer as int64) as idcompany_customer,\n        cast(idcompany_supplier as int64) as idcompany_supplier,\n        cast(idcompany_owner as int64) as idcompany_owner,\n        cast(idcontact_creation as int64) as idcontact_creation,\n        cast(idcontact_modification as int64) as idcontact_modification,\n        cast(idlocation as int64) as idlocation,\n\n        -- Colonnes texte\n        code,\n        name,\n        serial,\n        code_status_record,\n\n        -- Date li\u00e9e \u00e0 la machine\n        timestamp(last_installation_date) as last_installation_date,\n        timestamp(purchase_date) as purchase_date,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__device`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.766997Z", "completed_at": "2026-02-09T09:54:50.798680Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.853572Z", "completed_at": "2026-02-09T09:54:50.853589Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.25513601303100586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__label", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_label`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idlabel_family as int64) as idlabel_family,\n\n        -- Colonnes texte\n        code,\n\n        -- Bolean\n        cast(system as boolean) as is_system,\n        cast(enabled as boolean) as is_enabled,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.774921Z", "completed_at": "2026-02-09T09:54:50.822190Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.858568Z", "completed_at": "2026-02-09T09:54:50.858583Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.25309324264526367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__label_family", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_label_family`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel_family as int64) as idlabel_family,\n\n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_family`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.782721Z", "completed_at": "2026-02-09T09:54:50.842421Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.861250Z", "completed_at": "2026-02-09T09:54:50.861262Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.288654088973999, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__label_has_company", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_label_has_company`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idcompany as int64) as idcompany,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_company`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.788088Z", "completed_at": "2026-02-09T09:54:50.847312Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.904844Z", "completed_at": "2026-02-09T09:54:50.904859Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3316071033477783, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__label_has_contract", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_label_has_contract`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idcontract as int64) as idcontract,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_contract`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.794418Z", "completed_at": "2026-02-09T09:54:50.854269Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.907743Z", "completed_at": "2026-02-09T09:54:50.907756Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.3715229034423828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__label_has_device", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_label_has_device`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(iddevice as int64) as iddevice,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_device`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.799573Z", "completed_at": "2026-02-09T09:54:50.855767Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.949759Z", "completed_at": "2026-02-09T09:54:50.949772Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.41300439834594727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__label_has_product", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_label_has_product`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idproduct as int64) as idproduct,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.803872Z", "completed_at": "2026-02-09T09:54:50.856432Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.951574Z", "completed_at": "2026-02-09T09:54:50.951586Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.454268217086792, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__label_has_resources", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_label_has_resources`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idresources as int64) as idresources,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_resources`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.809324Z", "completed_at": "2026-02-09T09:54:50.857134Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.952232Z", "completed_at": "2026-02-09T09:54:50.952247Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.4952843189239502, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__location", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_location`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlocation as int64) as idlocation,\n\n        -- Colonnes texte\n        name,\n        access_info,\n        address1,\n        address2,\n        address3,\n        postal,\n        city,\n        country,\n        code,\n        code_status_record,\n        longitude,\n        latitude,\n        altitude,\n\n        -- Dates et timestamps\n        timestamp(localisation_date) as localisation_date,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__location`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.818031Z", "completed_at": "2026-02-09T09:54:50.857798Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.952863Z", "completed_at": "2026-02-09T09:54:50.952875Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.535109281539917, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__product_type", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_product_type`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idproduct_type as int64) as idproduct_type,\n\n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__product_type`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.813674Z", "completed_at": "2026-02-09T09:54:50.859246Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.994094Z", "completed_at": "2026-02-09T09:54:50.994107Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.577434778213501, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__product", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_product`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idproduct as int64) as idproduct,\n        cast(idproduct_type as int64) as idproduct_type,\n        cast(idcompany_supplier as int64) as idcompany_supplier,\n        cast(idcontact_creation as int64) as idcontact_creation,\n        cast(idcontact_modification as int64) as idcontact_modification,\n\n        -- Colonnes texte\n        code,\n        name,\n        commercial_name,\n        code_status_record,\n\n        -- Colonnes num\u00e9riques\n        cast(purchase_unit_price as float64) as purchase_unit_price,\n        cast(average_purchase_price as float64) as average_purchase_price,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.828164Z", "completed_at": "2026-02-09T09:54:50.902731Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.996646Z", "completed_at": "2026-02-09T09:54:50.996657Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.6538197994232178, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__resources_type", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_resources_type`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idresources_type as int64) as idresources_type,\n\n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__resources_type`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.822984Z", "completed_at": "2026-02-09T09:54:50.860552Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:50.995834Z", "completed_at": "2026-02-09T09:54:50.995849Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.6613438129425049, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__resources", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_resources`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idresources as int64) as idresources,\n        cast(idresources_type as int64) as idresources_type,\n        cast(resources_idresources as int64) as resources_idresources,\n        cast(idcompany as int64) as idcompany,\n        cast(idcompany_storehouse as int64) as idcompany_storehouse,\n        cast(idlocation as int64) as idlocation,\n        cast(idcontact as int64) as idcontact,\n        cast(idcontact_creation as int64) as idcontact_creation,\n        cast(idcontact_modification as int64) as idcontact_modification,\n\n        -- Colonnes texte\n        code,\n        name,\n        code_status_record,\n\n        -- Colonnes num\u00e9riques\n        cast(cost as float64) as cost,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(arrival) as arrival,\n        timestamp(departure) as departure,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__resources`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.832631Z", "completed_at": "2026-02-09T09:54:50.905822Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:51.080914Z", "completed_at": "2026-02-09T09:54:51.080927Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.698836088180542, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__task", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_task`\n),\n\ncleaned_data as (\n    select\n        -- IDs (cl\u00e9s primaires et \u00e9trang\u00e8res)\n        cast(idtask as int64) as idtask,\n        cast(task_idtask as int64) as task_idtask,\n        cast(idtask_type as int64) as idtask_type,\n        cast(idtask_status as int64) as idtask_status,\n        cast(iddevice as int64) as iddevice,\n        cast(idcompany_peer as int64) as idcompany_peer,\n        cast(idlocation as int64) as idlocation,\n        cast(idcontact as int64) as idcontact,\n        cast(idproduct_source as int64) as idproduct_source,\n        cast(idproduct_destination as int64) as idproduct_destination,\n\n        -- Colonnes texte et types\n        type_product_source,\n        type_product_destination,\n\n        -- Colonne num\u00e9rique\n        spantime as spantime, -- dur\u00e9e de la t\u00e2che en minute\n        CAST(code_status_record AS STRING) as code_status_record, -- status record (1 = valid\u00e9, 0 ou -1 possiblement inactif/desactiv\u00e9 : \u00e0 confirmer)\n\n        -- Date de la tache\n        timestamp(real_start_date) as real_start_date,\n        timestamp(real_end_date) as real_end_date,\n        timestamp(planed_start_date) as planed_start_date,\n        timestamp(planed_end_date) as planed_end_date,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nSELECT * FROM cleaned_data\n\nWHERE\n    (\n        updated_at > (\n            SELECT MAX(updated_at)\n            FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task`\n        )\n        OR updated_at >= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 7 DAY)\n    )\n", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.843143Z", "completed_at": "2026-02-09T09:54:50.907000Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:51.082792Z", "completed_at": "2026-02-09T09:54:51.082808Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7387135028839111, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__task_status", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_task_status`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idtask_status as int64) as idtask_status,\n\n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_status`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:50.847993Z", "completed_at": "2026-02-09T09:54:50.949012Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:51.083589Z", "completed_at": "2026-02-09T09:54:51.083601Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7769374847412109, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__task_type", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_task_type`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idtask_type as int64) as idtask_type,\n\n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_type`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:51.568676Z", "completed_at": "2026-02-09T09:54:51.602362Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:51.648347Z", "completed_at": "2026-02-09T09:54:51.648366Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.28870415687561035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__company", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_company`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idcompany as int64) as idcompany,\n        cast(company_idcompany as int64) as company_idcompany,\n        cast(idcompany_type as int64) as idcompany_type,\n        cast(idcontact_creation as int64) as idcontact_creation,\n        cast(idcontact_modification as int64) as idcontact_modification,\n        \n        -- Colonnes texte\n        code,\n        code_status_record,\n        name,\n        siret,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:51.576581Z", "completed_at": "2026-02-09T09:54:51.608853Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:51.660219Z", "completed_at": "2026-02-09T09:54:51.660232Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.2481238842010498, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__company_has_location", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_company_has_location`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlocation as int64) as idlocation,\n        cast(idcompany as int64) as idcompany,\n        cast(idlocation_type as int64) as idlocation_type,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_has_location`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:51.585073Z", "completed_at": "2026-02-09T09:54:51.638219Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:51.664003Z", "completed_at": "2026-02-09T09:54:51.664018Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.24493670463562012, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__company_type", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_company_type`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idcompany_type as int64) as idcompany_type,\n        \n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_type`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:51.591606Z", "completed_at": "2026-02-09T09:54:51.643303Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:51.666266Z", "completed_at": "2026-02-09T09:54:51.666279Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.2866172790527344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__contact", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_contact`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idcontact as int64) as idcontact,\n        cast(idcompany as int64) as idcompany,\n        \n        -- Colonnes texte\n        code,\n        first_name,\n        last_name,\n        email,\n        name,\n        mobile,\n        phone,\n        qualite,\n        code_status_record,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contact`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:51.603674Z", "completed_at": "2026-02-09T09:54:51.659408Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:51.711682Z", "completed_at": "2026-02-09T09:54:51.711697Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.325547456741333, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__device", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_device`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(iddevice as int64) as iddevice,\n        cast(device_iddevice as int64) as device_iddevice,\n        cast(iddevice_type as int64) as iddevice_type,\n        cast(idmodel as int64) as idmodel,\n        cast(idcompany_customer as int64) as idcompany_customer,\n        cast(idcompany_supplier as int64) as idcompany_supplier,\n        cast(idcompany_owner as int64) as idcompany_owner,\n        cast(idcontact_creation as int64) as idcontact_creation,\n        cast(idcontact_modification as int64) as idcontact_modification,\n        cast(idlocation as int64) as idlocation,\n        \n        -- Colonnes texte\n        code,\n        name,\n        serial,\n        code_status_record,\n\n        -- Date li\u00e9e \u00e0 la machine\n        timestamp(last_installation_date) as last_installation_date,\n        timestamp(purchase_date) as purchase_date,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:51.596747Z", "completed_at": "2026-02-09T09:54:51.648993Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:51.710727Z", "completed_at": "2026-02-09T09:54:51.710739Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3708152770996094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__contract", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select\n        cast(idcontract as int64) as idcontract,\n        idcontract_type,\n        idcompany_self,\n        idcompany_financial,\n        idcompany_peer,\n        idcontact_creation,\n        idcontact_modification,\n        code,\n        name,\n        code_status_record,\n        xml,\n        original_start_date,\n        original_end_date,\n        current_end_date,\n        termination_date,\n        creation_date,\n        modification_date,\n        _sdc_extracted_at,\n        _sdc_deleted_at\n    from `evs-datastack-prod`.`prod_raw`.`evs_contract`\n),\n\n\nparsed_data as (\n    select\n        cast(idcontract as int64) as idcontract,\n        \n        -- nombre_collab \u2192 conversion en entier\n        cast(nullif(trim(nombre_collab), '') as int64) as nombre_collab,\n\n        -- garder la valeur brute telle quelle\n        trim(engagement) as engagement_raw,\n\n        -- version nettoy\u00e9e num\u00e9rique\n        case\n            when upper(trim(engagement)) = 'AUCUN' then 0\n            else cast(\n                regexp_replace(regexp_extract(engagement, r'[\\d\\s]+'), r'\\s+', '') as int64\n            )\n        end as engagement_clean,\n\n        timestamp(extracted_at) as parsed_extracted_at\n    from `evs-datastack-prod`.`prod_raw`.`evs_contract_parsed`\n),\n\ncleaned_data as (\n    select\n        -- Colonnes de evs_contract\n        cast(c.idcontract as int64) as idcontract,\n        cast(c.idcontract_type as int64) as idcontract_type,\n        cast(c.idcompany_self as int64) as idcompany_self,\n        cast(c.idcompany_financial as int64) as idcompany_financial,\n        cast(c.idcompany_peer as int64) as idcompany_peer,\n        cast(c.idcontact_creation as int64) as idcontact_creation,\n        cast(c.idcontact_modification as int64) as idcontact_modification,\n        \n        c.code,\n        c.name,\n        c.code_status_record,\n        -- Colonnes enrichies depuis evs_contract_parsed\n        p.nombre_collab,\n        p.engagement_raw,\n        p.engagement_clean,\n\n        timestamp(c.original_start_date) as original_start_date,\n        timestamp(c.original_end_date) as original_end_date,\n        timestamp(c.current_end_date) as current_end_date,\n        timestamp(c.termination_date) as termination_date,\n\n        timestamp(p.parsed_extracted_at) as parsed_extracted_at,\n        timestamp(c.creation_date) as created_at,\n        timestamp(coalesce(c.modification_date, c.creation_date)) as updated_at,\n        timestamp(c._sdc_extracted_at) as extracted_at,\n        timestamp(c._sdc_deleted_at) as deleted_at,\n\n    from source_data c\n    left join parsed_data p using (idcontract)\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contract`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:51.609498Z", "completed_at": "2026-02-09T09:54:51.661581Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:51.713822Z", "completed_at": "2026-02-09T09:54:51.713834Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.40822696685791016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idlabel_family as int64) as idlabel_family,\n        \n        -- Colonnes texte\n        code,\n\n        -- Bolean\n        cast(system as boolean) as is_system,\n        cast(enabled as boolean) as is_enabled,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:51.615175Z", "completed_at": "2026-02-09T09:54:51.662256Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:51.755879Z", "completed_at": "2026-02-09T09:54:51.755892Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.45006299018859863, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label_family", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label_family`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel_family as int64) as idlabel_family,\n        \n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:51.623868Z", "completed_at": "2026-02-09T09:54:51.663261Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:51.756593Z", "completed_at": "2026-02-09T09:54:51.756608Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.5322434902191162, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label_has_contract", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label_has_contract`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idcontract as int64) as idcontract,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_contract`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:51.619565Z", "completed_at": "2026-02-09T09:54:51.664669Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:51.757406Z", "completed_at": "2026-02-09T09:54:51.757417Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.5340349674224854, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label_has_company", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label_has_company`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idcompany as int64) as idcompany,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_company`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:51.628246Z", "completed_at": "2026-02-09T09:54:51.665374Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:51.799733Z", "completed_at": "2026-02-09T09:54:51.799749Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5745871067047119, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label_has_device", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label_has_device`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(iddevice as int64) as iddevice,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_device`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:51.633602Z", "completed_at": "2026-02-09T09:54:51.666858Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:51.800580Z", "completed_at": "2026-02-09T09:54:51.800591Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.6161983013153076, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label_has_product", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label_has_product`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idproduct as int64) as idproduct,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:51.638960Z", "completed_at": "2026-02-09T09:54:51.667531Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:51.842843Z", "completed_at": "2026-02-09T09:54:51.842861Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.6573531627655029, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label_has_resources", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label_has_resources`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idresources as int64) as idresources,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_resources`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:51.644034Z", "completed_at": "2026-02-09T09:54:51.710024Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:51.844344Z", "completed_at": "2026-02-09T09:54:51.844357Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.6931872367858887, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__location", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_location`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlocation as int64) as idlocation,\n        \n        -- Colonnes texte\n        name,\n        access_info,\n        address1,\n        address2,\n        address3,\n        postal,\n        city,\n        country,\n        code,\n        code_status_record,\n        longitude,\n        latitude,\n        altitude,\n\n        -- Dates et timestamps\n        timestamp(localisation_date) as localisation_date,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:51.649730Z", "completed_at": "2026-02-09T09:54:51.712462Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:51.927520Z", "completed_at": "2026-02-09T09:54:51.927534Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7351324558258057, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__product", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_product`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idproduct as int64) as idproduct,\n        cast(idproduct_type as int64) as idproduct_type,\n        cast(idcompany_supplier as int64) as idcompany_supplier,\n        cast(idcontact_creation as int64) as idcontact_creation,\n        cast(idcontact_modification as int64) as idcontact_modification,\n        \n        -- Colonnes texte\n        code,\n        name,\n        commercial_name,\n        code_status_record,\n\n        -- Colonnes num\u00e9riques\n        cast(purchase_unit_price as float64) as purchase_unit_price,\n        cast(average_purchase_price as float64) as average_purchase_price,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:51.655134Z", "completed_at": "2026-02-09T09:54:51.713115Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:51.929345Z", "completed_at": "2026-02-09T09:54:51.929360Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7712419033050537, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__product_type", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_product_type`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idproduct_type as int64) as idproduct_type,\n        \n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at, \n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product_type`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:52.372452Z", "completed_at": "2026-02-09T09:54:52.410059Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:52.453539Z", "completed_at": "2026-02-09T09:54:52.453554Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.29523253440856934, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__resources", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_resources`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idresources as int64) as idresources,\n        cast(idresources_type as int64) as idresources_type,\n        cast(resources_idresources as int64) as resources_idresources,\n        cast(idcompany as int64) as idcompany,\n        cast(idcompany_storehouse as int64) as idcompany_storehouse,\n        cast(idlocation as int64) as idlocation,\n        cast(idcontact as int64) as idcontact,\n        cast(idcontact_creation as int64) as idcontact_creation,\n        cast(idcontact_modification as int64) as idcontact_modification,\n        \n        -- Colonnes texte\n        code,\n        name,\n        code_status_record,\n\n        -- Colonnes num\u00e9riques\n        cast(cost as float64) as cost,\n    \n        -- Timestamps harmonis\u00e9s\n        timestamp(arrival) as arrival,\n        timestamp(departure) as departure,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:52.383535Z", "completed_at": "2026-02-09T09:54:52.426808Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:52.470799Z", "completed_at": "2026-02-09T09:54:52.470812Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.2132117748260498, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__resources_type", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_resources_type`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idresources_type as int64) as idresources_type,\n        \n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources_type`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:52.388909Z", "completed_at": "2026-02-09T09:54:52.437273Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:52.473898Z", "completed_at": "2026-02-09T09:54:52.473910Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.25459933280944824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__task", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_task`\n),\n\ncleaned_data as (\n    select\n        -- IDs (cl\u00e9s primaires et \u00e9trang\u00e8res)\n        cast(idtask as int64) as idtask,\n        cast(task_idtask as int64) as task_idtask,\n        cast(idtask_type as int64) as idtask_type,\n        cast(idtask_status as int64) as idtask_status,\n        cast(iddevice as int64) as iddevice,\n        cast(idcompany_peer as int64) as idcompany_peer,\n        cast(idlocation as int64) as idlocation,\n        cast(idcontact as int64) as idcontact,\n        cast(idproduct_source as int64) as idproduct_source,\n        cast(idproduct_destination as int64) as idproduct_destination,\n\n        -- Colonnes texte et types\n        type_product_source,\n        type_product_destination,\n\n        -- Colonne num\u00e9rique\n        spantime as spantime, -- dur\u00e9e de la t\u00e2che en minute\n        CAST(code_status_record AS STRING) as code_status_record, -- status record (1 = valid\u00e9, 0 ou -1 possiblement inactif/desactiv\u00e9 : \u00e0 confirmer)\n        \n        -- Date de la tache\n        timestamp(real_start_date) as real_start_date,\n        timestamp(real_end_date) as real_end_date,\n        timestamp(planed_start_date) as planed_start_date,\n        timestamp(planed_end_date) as planed_end_date,\n        \n        -- Timestamps harmonis\u00e9s\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nSELECT * FROM cleaned_data\n\nWHERE\n    (\n        updated_at > (\n            SELECT MAX(updated_at)\n            FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n        )\n        OR updated_at >= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 7 DAY)\n    )\n", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:52.398997Z", "completed_at": "2026-02-09T09:54:52.452747Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:52.475534Z", "completed_at": "2026-02-09T09:54:52.475546Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.29350733757019043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__task_status", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_task_status`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idtask_status as int64) as idtask_status,\n\n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:52.411827Z", "completed_at": "2026-02-09T09:54:52.469719Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:52.522726Z", "completed_at": "2026-02-09T09:54:52.522739Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.37481236457824707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu_gcs__stock_theorique", "compiled": true, "compiled_code": "\n\nSELECT\n    CAST(id_entity AS INT64) AS id_entity,  \n    entity_name,\n    entity_type,\n    CAST(DATE_SYSTEM AS TIMESTAMP) AS date_system,\n    resources_code,\n    code_source AS product_code,\n    code_name AS product_name,\n    SAFE.PARSE_TIMESTAMP('%d/%m/%Y %H:%M', DATE_INVENTAIRE) AS date_inventaire,\n    CAST(STOCK_INVENTAIRE AS NUMERIC) AS stock_inventaire,\n    CAST(PLUS AS NUMERIC) AS plus,\n    CAST(MOINS AS NUMERIC) AS moins,\n    CAST(STOCK_AT_DATE AS NUMERIC) AS stock_at_date,\n    CAST(DPA AS NUMERIC) AS dpa,\n    CAST(PUMP AS NUMERIC) AS pump,\n    CAST(PURCHASE_PRICE AS NUMERIC) AS purchase_price,\n    CAST(extracted_at AS TIMESTAMP) AS extracted_at,\n    row_count,\n    PARSE_DATETIME('%Y_%m_%d_%H%M', REGEXP_EXTRACT(_FILE_NAME, r'(\\d{4}_\\d{2}_\\d{2}_\\d{4})')) AS file_datetime\nFROM `evs-datastack-prod`.`prod_raw`.`ext_gcs_oracle_neshu__stock_theorique`", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu_gcs__stock_theorique`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:52.404972Z", "completed_at": "2026-02-09T09:54:52.460072Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:52.521104Z", "completed_at": "2026-02-09T09:54:52.521121Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.3774418830871582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__task_type", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_task_type`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idtask_type as int64) as idtask_type,\n\n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_type`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:52.422449Z", "completed_at": "2026-02-09T09:54:52.472522Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:52.566215Z", "completed_at": "2026-02-09T09:54:52.566231Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.4572005271911621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__materials", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`yuman_materials`\n),\n\ncleaned_materials as (\n    select\n        id as material_id,\n        site_id,\n        category_id, \n        name as material_name,\n        serial_number as material_serial_number,\n        brand as material_brand,\n        description as material_description,\n        in_service_date as material_in_service_date,\n\n        (\n          select JSON_VALUE(elem, '$.value')\n          from UNNEST(JSON_QUERY_ARRAY(_embed_fields)) elem\n          where JSON_VALUE(elem, '$.name') = 'LOCALISATION'\n        ) as material_localisation,\n\n        timestamp(created_at) as created_at,\n        timestamp(updated_at) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n    where id is not null\n)\n\nselect * from cleaned_materials", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:52.417845Z", "completed_at": "2026-02-09T09:54:52.471839Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:52.524431Z", "completed_at": "2026-02-09T09:54:52.524444Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.45977330207824707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__clients", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`yuman_clients`\n),\n\nbase_clients as (\n    select\n        id as client_id,\n        partner_id, \n        code as client_code,\n        name as client_name,\n        address as client_address,       \n        active as is_active,\n        SAFE.PARSE_JSON(_embed_fields) as embed_fields,\n        TIMESTAMP(created_at) as created_at,\n        TIMESTAMP(updated_at) as updated_at,\n        TIMESTAMP(_sdc_extracted_at) as extracted_at,\n        TIMESTAMP(_sdc_deleted_at) as deleted_at\n    from source_data\n    where id is not null\n),\n\njson_parsed as (\n    select\n        client_id,\n        client_code,\n        client_name,\n        updated_at,\n        JSON_EXTRACT_SCALAR(item, '$.name') as field_name,\n        JSON_EXTRACT_SCALAR(item, '$.value') as field_value\n    from base_clients,\n    UNNEST(JSON_EXTRACT_ARRAY(embed_fields)) as item\n),\n\nextracted_fields as (\n    select\n        client_id,\n        client_code,\n        client_name,\n        updated_at,\n        field_name,\n        field_value\n    from json_parsed\n    where field_name is not null\n),\n\npivoted as (\n    select\n        bc.client_id,\n        bc.partner_id,\n        bc.client_code,\n        bc.client_name,\n        MAX(IF(ef.field_name = 'CATEGORIE CLIENT EVS', ef.field_value, NULL)) as client_category,\n        bc.client_address,\n        bc.is_active,\n        bc.created_at,\n        bc.updated_at,\n        bc.extracted_at,\n        bc.deleted_at\n    from base_clients bc\n    left join extracted_fields ef on ef.client_id = bc.client_id\n    group by \n        bc.client_id, bc.client_code, bc.client_name, bc.client_address,\n        bc.partner_id, bc.is_active,\n        bc.created_at, bc.updated_at, bc.extracted_at, bc.deleted_at\n),\n\n-- Ajout du nom du partenaire via self join\nwith_partner_name as (\n    select \n        p.*,\n        partner.client_name as partner_name\n    from pivoted p\n    left join pivoted partner on p.partner_id = partner.client_id\n),\n\nfinal as (\n    select * from with_partner_name\n    where client_id is not null\n)\n--Titre chang\u00e9\nselect \n    client_id,\n    partner_id,\n    partner_name,\n    client_code,\n    client_name,\n    client_category,\n    client_address,\n    is_active,\n    created_at,\n    updated_at,\n    extracted_at,\n    deleted_at\nfrom final", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__clients`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:52.427625Z", "completed_at": "2026-02-09T09:54:52.473150Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:52.567978Z", "completed_at": "2026-02-09T09:54:52.567990Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.4989500045776367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__materials_categories", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`yuman_material_categories`\n),\n\ncleaned_material_categories as (\n    select\n        id as category_id,\n        name as category_name,   \n        TIMESTAMP(created_at) as created_at,\n        TIMESTAMP(updated_at) as updated_at,\n        TIMESTAMP(_sdc_extracted_at) as extracted_at,\n        TIMESTAMP(_sdc_deleted_at) as deleted_at\n    from source_data\n    where id is not null\n)\n\nselect * from cleaned_material_categories", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__materials_categories`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:52.433011Z", "completed_at": "2026-02-09T09:54:52.474603Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:52.568795Z", "completed_at": "2026-02-09T09:54:52.568807Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.5408599376678467, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__products", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`yuman_products`\n),\n\ncleaned_products as (\n    select\n        id as product_id,\n        reference as product_code,\n        designation as product_name,\n        product_type as product_type,\n        brand as product_brand,\n        unit as product_unit,\n        purchase_price as product_purchase_price,\n        sale_price as product_sale_price,    \n        active as is_active,\n        TIMESTAMP(created_at) as created_at,\n        TIMESTAMP(updated_at) as updated_at,\n        TIMESTAMP(_sdc_extracted_at) as extracted_at,\n        TIMESTAMP(_sdc_deleted_at) as deleted_at\n    from source_data\n    where id is not null\n)\n\nselect * from cleaned_products", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__products`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:52.438087Z", "completed_at": "2026-02-09T09:54:52.476221Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:52.651676Z", "completed_at": "2026-02-09T09:54:52.651692Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5821409225463867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__purchase_orders", "compiled": true, "compiled_code": "\n\nwith src as (\n  select * from `evs-datastack-prod`.`prod_raw`.`yuman_purchase_orders`\n),\n\n-- Normalisation / typage des champs ent\u00eate\npo_base as (\n  select\n    SAFE_CAST(id AS INT64)                            as purchase_order_id,\n    number                                           as purchase_order_number,\n    status                                           as purchase_order_satus,\n    invoice_status                              as purchase_order_invoice_status,\n    title                                           as purchase_order_title,\n    description                                      as order_description,\n    TIMESTAMP(creation_date)                         as creation_date,\n    TIMESTAMP(expected_delivery_date)                as expected_delivery_date,\n    TIMESTAMP(created_at)                             as order_created_at,\n    TIMESTAMP(updated_at)                             as order_updated_at,\n    SAFE_CAST(vat AS FLOAT64)                        as order_vat,\n    SAFE_CAST(subtotal AS FLOAT64)                   as order_subtotal,\n    SAFE_CAST(total AS FLOAT64)                      as order_total,\n    SAFE_CAST(manager_id AS INT64)                   as manager_id,\n    SAFE_CAST(quote_id AS INT64)                     as quote_id,\n    SAFE_CAST(supplier_id AS INT64)                  as supplier_id,\n    delivery_address,\n    TIMESTAMP(_sdc_extracted_at)                     as extracted_at,\n    SAFE_CAST(_sdc_sequence AS INT64)                as sdc_sequence,\n    lines\n  from src\n  where id is not null\n),\n\n-- Explode JSON array 'lines' : chaque item devient une ligne\nlines_exploded as (\n  select\n    pb.*,\n    item\n  from po_base pb,\n  unnest(\n    -- JSON_EXTRACT_ARRAY ne supporte pas nulls ; SAFE.PARSE_JSON \u00e9vite les erreurs\n    COALESCE(JSON_EXTRACT_ARRAY(SAFE.PARSE_JSON(lines)), []) \n  ) as item\n),\n\n-- Extraction des champs de chaque item JSON\nline_parsed as (\n  select\n    purchase_order_id,\n    purchase_order_number,\n    purchase_order_satus,\n    purchase_order_invoice_status,\n    purchase_order_title,\n    order_description,\n    creation_date,\n    expected_delivery_date,\n    order_created_at,\n    order_updated_at,\n    order_vat,\n    order_subtotal,\n    order_total,\n    manager_id,\n    quote_id,\n    supplier_id,\n    delivery_address,\n    extracted_at,\n    sdc_sequence,\n\n    -- champs ligne\n    SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.id') AS INT64)                 as purchase_order_line_id,\n    JSON_EXTRACT_SCALAR(item, '$.reference')                             as line_reference,\n    JSON_EXTRACT_SCALAR(item, '$.description')                           as line_description,\n    SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.quantity') AS FLOAT64)        as quantity,\n    JSON_EXTRACT_SCALAR(item, '$.unit')                                  as unit,\n    SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.quantity_received') AS FLOAT64) as quantity_received,\n    SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.unit_price') AS FLOAT64)      as unit_price,\n    SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.vat') AS FLOAT64)             as line_vat,\n    SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.subtotal') AS FLOAT64)        as line_subtotal,\n    SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.product_id') AS INT64)        as product_id,\n    SAFE_DIVIDE(\n      SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.subtotal_received.cents') AS INT64), \n      100\n    ) as subtotal_received_eur,\n    JSON_EXTRACT_SCALAR(item, '$.subtotal_received.currency_iso')        as subtotal_received_currency,\n    TIMESTAMP(JSON_EXTRACT_SCALAR(item, '$.created_at'))                 as line_created_at,\n    TIMESTAMP(JSON_EXTRACT_SCALAR(item, '$.updated_at'))                 as line_updated_at\n  from lines_exploded\n)\n\nselect\n  -- ent\u00eate commande (utile pour jointures et analyses)\n  purchase_order_id,\n  purchase_order_number,\n  purchase_order_satus,\n  purchase_order_invoice_status,\n  purchase_order_title,\n  order_description,\n  creation_date,\n  expected_delivery_date,\n  order_created_at,\n  order_updated_at,\n  order_vat,\n  order_subtotal,\n  order_total,\n  manager_id,\n  quote_id,\n  supplier_id,\n  delivery_address,\n\n  -- champs ligne (une ligne par item)\n  purchase_order_line_id,\n  line_reference,\n  line_description,\n  quantity,\n  unit,\n  quantity_received,\n  unit_price,\n  line_vat,\n  line_subtotal,\n  product_id,\n  subtotal_received_eur,\n  subtotal_received_currency,\n  line_created_at,\n  line_updated_at,\n\n  -- m\u00e9tadatas\n  extracted_at,\n  sdc_sequence\n\nfrom line_parsed\n-- si certaines commandes ont lines null on peut garder une ligne (optionnel) :\nwhere purchase_order_line_id is not null", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__purchase_orders`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:52.447589Z", "completed_at": "2026-02-09T09:54:52.518504Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:52.653643Z", "completed_at": "2026-02-09T09:54:52.653655Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.6162779331207275, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__storehouses", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`yuman_storehouses`\n),\n\ncleaned_storehouses as (\n    select\n        id as storehouses_id,\n        name as storehouses_name,\n        address as storehouses_address,\n        cast(_sdc_extracted_at as timestamp) as extracted_at,\n        cast(null as timestamp) as deleted_at\n    from source_data\n)\n\nselect *\nfrom cleaned_storehouses\n\n\n\nunion all\n\n-- lignes supprim\u00e9es depuis la source\nselect\n    s.storehouses_id,\n    s.storehouses_name,\n    s.storehouses_address,\n    s.extracted_at,\n    current_timestamp() as deleted_at\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__storehouses` s\nleft join cleaned_storehouses c\non s.storehouses_id = c.storehouses_id\nwhere c.storehouses_id is null\n\n", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__storehouses`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:52.443053Z", "completed_at": "2026-02-09T09:54:52.520413Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:52.655131Z", "completed_at": "2026-02-09T09:54:52.655143Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.6661152839660645, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__sites", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * from `evs-datastack-prod`.`prod_raw`.`yuman_sites`\n),\n\nextracted_postal_code as (\n    select\n        *,\n        (\n            select JSON_EXTRACT_SCALAR(value, '$.value')\n            from unnest(JSON_EXTRACT_ARRAY(_embed_fields)) as value\n            where JSON_EXTRACT_SCALAR(value, '$.name') = 'CODE POSTAL'\n            limit 1\n        ) as raw_code_postal\n    from source_data\n),\n\ncleaned as (\n    select\n        id as site_id,\n        client_id,\n        agency_id,\n        code as site_code,\n        name as site_name,\n        address as site_address,\n        -- Nettoyage du code postal : suppression du \".0\", puis cast en texte\n        regexp_replace(raw_code_postal, r'\\.0$', '') as site_postal_code,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at,\n        cast(_sdc_extracted_at as timestamp) as extracted_at,\n        cast(_sdc_deleted_at as timestamp) as deleted_at\n    from extracted_postal_code\n)\n\nselect * from cleaned", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:52.455739Z", "completed_at": "2026-02-09T09:54:52.522013Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:52.656100Z", "completed_at": "2026-02-09T09:54:52.656116Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.6992428302764893, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__users", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * from `evs-datastack-prod`.`prod_raw`.`yuman_users`\n),\n\ncleaned_users as (\n    select\n        id as user_id,\n        manager_id, -- ID du manager de l'utilisateur\n        name as user_name,\n        email as user_email,\n        user_type as user_type,\n        phone as user_phone,\n        manager_as_technician as is_manager_as_technician,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at,\n        cast(_sdc_extracted_at as timestamp) as extracted_at,\n        cast(_sdc_deleted_at as timestamp) as deleted_at\n    from source_data\n)\n\nselect * from cleaned_users", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__users`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:52.460911Z", "completed_at": "2026-02-09T09:54:52.523572Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:52.656963Z", "completed_at": "2026-02-09T09:54:52.656974Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7402927875518799, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__workorder_demands", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`yuman_workorder_demands`\n),\n\ncleaned_workorder_demdands as (\n    select\n        id as demand_id,\n        workorder_id,\n        material_id,\n        site_id,\n        client_id,\n        user_id,\n        cast(contact_id as int64) as contact_id,\n        category_id as demand_category_id,\n        description as demand_description,\n        status as demand_status,\n        reject_comment as demand_reject_comment,\n        TIMESTAMP(created_at) as created_at,\n        TIMESTAMP(updated_at) as updated_at,\n        TIMESTAMP(_sdc_extracted_at) as extracted_at,\n        TIMESTAMP(_sdc_deleted_at) as deleted_at\n    from source_data\n    where id is not null\n)\n\nselect * from cleaned_workorder_demdands", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:52.465305Z", "completed_at": "2026-02-09T09:54:52.565374Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:52.740857Z", "completed_at": "2026-02-09T09:54:52.740882Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7824397087097168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__workorder_demands_categories", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * from `evs-datastack-prod`.`prod_raw`.`yuman_workorder_demands_categories`\n),\n\ncleaned_categories as (\n    select\n        id as demand_category_id,\n        name as demand_category_name,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at,\n        cast(_sdc_extracted_at as timestamp) as extracted_at,\n        cast(_sdc_deleted_at as timestamp) as deleted_at\n    from source_data\n)\n\nselect * from cleaned_categories", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands_categories`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.184953Z", "completed_at": "2026-02-09T09:54:53.213888Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:53.249208Z", "completed_at": "2026-02-09T09:54:53.249221Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.31438422203063965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__workorder_products", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`yuman_workorders`\n),\n\nworkorder_products_unnested as (\n    select\n        wo.id as workorder_id,\n        cast(json_extract_scalar(product, '$.id') as int64) as workorder_product_id,\n        cast(json_extract_scalar(product, '$.product_id') as int64) as product_id,\n        json_extract_scalar(product, '$.product_reference') as product_reference,\n        json_extract_scalar(product, '$.product_designation') as product_designation,\n        cast(json_extract_scalar(product, '$.quantity') as float64) as product_quantity,\n        timestamp(json_extract_scalar(product, '$.created_at')) as product_created_at,\n        timestamp(json_extract_scalar(product, '$.updated_at')) as product_updated_at\n    from source_data wo,\n    unnest(json_extract_array(wo._embed_products)) as product\n),\n\nfinal as (\n    select\n        workorder_product_id,\n        workorder_id,\n        product_id,\n        product_reference,\n        product_designation,\n        product_quantity,\n        product_created_at,\n        product_updated_at\n    from workorder_products_unnested\n)\n\nselect * from final", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.215186Z", "completed_at": "2026-02-09T09:54:53.217581Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:53.252813Z", "completed_at": "2026-02-09T09:54:53.252825Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.17775678634643555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_general__feries_metropole", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.219073Z", "completed_at": "2026-02-09T09:54:53.221506Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:53.256423Z", "completed_at": "2026-02-09T09:54:53.256434Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.2178173065185547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_mssql_sage__code_analytique_bu", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.223058Z", "completed_at": "2026-02-09T09:54:53.226642Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:53.261219Z", "completed_at": "2026-02-09T09:54:53.261231Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.298353910446167, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_mssql_sage__code_comptable_bu", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.227385Z", "completed_at": "2026-02-09T09:54:53.229658Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:53.261863Z", "completed_at": "2026-02-09T09:54:53.261880Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.29909825325012207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_nesp_tech__articles_prix", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.194414Z", "completed_at": "2026-02-09T09:54:53.230381Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:53.262643Z", "completed_at": "2026-02-09T09:54:53.262654Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.39603734016418457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__workorders", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`yuman_workorders`\n),\n\nbase_workorders as (\n    select\n    -- IDs and foreign keys\n        id as workorder_id,\n        site_id,\n        client_id,\n        technician_id,\n        manager_id,\n        category_id,\n        contact_id,\n    -- Workorder details\n        number as workorder_number,\n        workorder_type,\n        _embed_category_name as workorder_category,\n        status as workorder_status,\n        title as workorder_title,\n        description as workorder_description,\n        report as workorder_report,\n        _embed_technician_name as workorder_technician_name,\n        time_taken as workorder_time_taken,\n    -- JSON\n        SAFE.PARSE_JSON(_embed_fields) as embed_fields,\n    -- Dates\n        TIMESTAMP(date_planned) as date_planned,\n        TIMESTAMP(date_started) as date_started,\n        TIMESTAMP(date_done) as date_done,\n        TIMESTAMP(created_at) as created_at,\n        TIMESTAMP(updated_at) as updated_at,\n        TIMESTAMP(_sdc_extracted_at) as extracted_at,\n        TIMESTAMP(_sdc_deleted_at) as deleted_at\n    from source_data\n),\n\njson_parsed as (\n    select\n        *,\n        -- Extraction des champs sp\u00e9cifiques depuis le JSON array\n        (\n            select field\n            from unnest(json_extract_array(embed_fields)) as field\n            where json_extract_scalar(field, '$.name') = 'DATE DE CREATION'\n        ) as date_creation_field,\n        \n        (\n            select field\n            from unnest(json_extract_array(embed_fields)) as field\n            where json_extract_scalar(field, '$.name') = 'MOTIF DE NON INTERVENTION'\n        ) as motif_non_intervention_field,\n        \n        (\n            select field\n            from unnest(json_extract_array(embed_fields)) as field\n            where json_extract_scalar(field, '$.name') = 'NON INTERVENTION : DETAIL/AUTRE MOTIF'\n        ) as detail_non_intervention_field,\n        \n        (\n            select field\n            from unnest(json_extract_array(embed_fields)) as field\n            where json_extract_scalar(field, '$.name') = 'RAISON MISE EN PAUSE'\n        ) as raison_pause_field,\n        \n        (\n            select field\n            from unnest(json_extract_array(embed_fields)) as field\n            where json_extract_scalar(field, '$.name') = 'EXPLICATION MISE EN PAUSE'\n        ) as explication_pause_field,\n        \n        (\n            select field\n            from unnest(json_extract_array(embed_fields)) as field\n            where json_extract_scalar(field, '$.name') = \"NECESSITE D\\'INTERVENIR\"\n        ) as necessite_intervenir_field,\n        \n        (\n            select field\n            from unnest(json_extract_array(embed_fields)) as field\n            where json_extract_scalar(field, '$.name') = 'SI NON POURQUOI ?'\n        ) as si_non_pourquoi_field\n        \n    from base_workorders\n),\n\nfinal as (\n    select\n        -- Colonnes de base\n        workorder_id,\n        site_id,\n        client_id,\n        technician_id,\n        manager_id,\n        category_id,\n        contact_id,\n        workorder_number,\n        workorder_type,\n        workorder_category,\n        workorder_status,\n        workorder_title,\n        workorder_description,\n        workorder_report,\n        workorder_technician_name,\n        workorder_time_taken,\n\n        -- Champs extraits du JSON avec nettoyage\n        case \n            when json_extract_scalar(date_creation_field, '$.value') is not null\n            then safe.parse_date('%d/%m/%Y', json_extract_scalar(date_creation_field, '$.value'))\n        end as workorder_date_creation,\n        \n        json_extract_scalar(motif_non_intervention_field, '$.value') as workorder_motif_non_intervention,\n        json_extract_scalar(detail_non_intervention_field, '$.value') as workorder_detail_non_intervention,\n        json_extract_scalar(raison_pause_field, '$.value') as workorder_raison_mise_en_pause,\n        json_extract_scalar(explication_pause_field, '$.value') as workorder_explication_mise_en_pause,\n        json_extract_scalar(necessite_intervenir_field, '$.value') as workorder_necessite_intervenir,\n        json_extract_scalar(si_non_pourquoi_field, '$.value') as workorder_si_non_pourquoi,\n        \n        -- Dates\n        date_planned,\n        date_started,\n        date_done,\n        created_at,\n        updated_at,\n        extracted_at,\n        deleted_at\n        \n    from json_parsed\n)\n\nselect * from final", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.231079Z", "completed_at": "2026-02-09T09:54:53.233425Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:53.263297Z", "completed_at": "2026-02-09T09:54:53.263308Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.38182997703552246, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_nesp_tech__cps_montagne_primes", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.234214Z", "completed_at": "2026-02-09T09:54:53.236486Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:53.263910Z", "completed_at": "2026-02-09T09:54:53.263924Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.4222226142883301, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_nesp_tech__dpts_montagne_factu", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.237215Z", "completed_at": "2026-02-09T09:54:53.239710Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:53.264579Z", "completed_at": "2026-02-09T09:54:53.264592Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.46326541900634766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_nesp_tech__key_facturation", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.201294Z", "completed_at": "2026-02-09T09:54:53.240360Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:53.265231Z", "completed_at": "2026-02-09T09:54:53.265241Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5594480037689209, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__workorders_categories", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * from `evs-datastack-prod`.`prod_raw`.`yuman_workorder_categories`\n),\n\ncleaned_categories as (\n    select\n        id as category_id,\n        name as category_name,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at,\n        cast(_sdc_extracted_at as timestamp) as extracted_at,\n        cast(_sdc_deleted_at as timestamp) as deleted_at\n    from source_data\n)\n\nselect * from cleaned_categories", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders_categories`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.241098Z", "completed_at": "2026-02-09T09:54:53.244684Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:53.265849Z", "completed_at": "2026-02-09T09:54:53.265861Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.545499324798584, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_nesp_tech__key_type_inter", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.208079Z", "completed_at": "2026-02-09T09:54:53.248423Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:53.267253Z", "completed_at": "2026-02-09T09:54:53.267264Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6409420967102051, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman_gcs__stock_theorique", "compiled": true, "compiled_code": "\n\nwith source as (\n    select \n        *\n    from `evs-datastack-prod`.`prod_raw`.`ext_gcs_yuman__stock_theorique`\n),\n\ncleaned as (\n    select\n        -- Clean and normalize fields\n        trim(r_f_rence) as reference,\n        trim(d_signation) as designation,\n        \n        -- Convert quantity to float, handling decimal commas\n        cast(replace(quantit_, ',', '.') as float64) as quantite,\n        \n        NULLIF(trim(nom_du_stock), '') as nom_du_stock,\n        \n        -- Metadata fields\n        export_date,\n        _sdc_source_file,\n        _sdc_source_lineno\n        \n    from source\n)\n\nselect * from cleaned", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman_gcs__stock_theorique`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.245417Z", "completed_at": "2026-02-09T09:54:53.247782Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:53.266612Z", "completed_at": "2026-02-09T09:54:53.266623Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.6235599517822266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_nesp_tech__machines_clean", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.249862Z", "completed_at": "2026-02-09T09:54:53.252166Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:53.267977Z", "completed_at": "2026-02-09T09:54:53.267988Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.6654808521270752, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_oracle_neshu__groupement_machine", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.253485Z", "completed_at": "2026-02-09T09:54:53.255764Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:53.311747Z", "completed_at": "2026-02-09T09:54:53.311764Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7077958583831787, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_oracle_neshu__roadman_gea", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.257089Z", "completed_at": "2026-02-09T09:54:53.260551Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:53.395913Z", "completed_at": "2026-02-09T09:54:53.395927Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.749077320098877, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_oracle_neshu__valo_machine_capacite", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.974886Z", "completed_at": "2026-02-09T09:54:53.977846Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.041927Z", "completed_at": "2026-02-09T09:54:54.041971Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.17264246940612793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_oracle_neshu__valo_parc_machine", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.979347Z", "completed_at": "2026-02-09T09:54:53.983712Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.057173Z", "completed_at": "2026-02-09T09:54:54.057190Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.21314454078674316, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_yuman__cp_metropole", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.989202Z", "completed_at": "2026-02-09T09:54:53.991854Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.076187Z", "completed_at": "2026-02-09T09:54:54.076204Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.2534451484680176, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_yuman__dpt_metropole", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.995885Z", "completed_at": "2026-02-09T09:54:53.999434Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.077654Z", "completed_at": "2026-02-09T09:54:54.077669Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.2948799133300781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_yuman__marque_clean", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.992537Z", "completed_at": "2026-02-09T09:54:53.995220Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.076885Z", "completed_at": "2026-02-09T09:54:54.076904Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.3773524761199951, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_yuman__machine_clean", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:53.985081Z", "completed_at": "2026-02-09T09:54:53.987782Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.066104Z", "completed_at": "2026-02-09T09:54:54.066120Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.3809494972229004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_yuman__cp_tech", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.000110Z", "completed_at": "2026-02-09T09:54:54.002565Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.078374Z", "completed_at": "2026-02-09T09:54:54.078389Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.41884398460388184, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_yuman__tarification_clean", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.003243Z", "completed_at": "2026-02-09T09:54:54.005691Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.079038Z", "completed_at": "2026-02-09T09:54:54.079053Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.4597506523132324, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_yuman__tech_agence", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.006362Z", "completed_at": "2026-02-09T09:54:54.008763Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.079676Z", "completed_at": "2026-02-09T09:54:54.079688Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5007970333099365, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_yuman__tech_nomad", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.014308Z", "completed_at": "2026-02-09T09:54:54.016954Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.080986Z", "completed_at": "2026-02-09T09:54:54.080997Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.5410046577453613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_yuman__type_inter_clean", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.009538Z", "completed_at": "2026-02-09T09:54:54.013548Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.080334Z", "completed_at": "2026-02-09T09:54:54.080345Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5832228660583496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.ref_yuman__technicien_clean", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.017648Z", "completed_at": "2026-02-09T09:54:54.082197Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.545371Z", "completed_at": "2026-02-09T09:54:54.545384Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.636911153793335, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_source_expression_is_true_marts_oracle_neshu_external_fct_oracle_neshu__passages_appro_passage_duration_min___0_OR_passage_duration_min_IS_NULL.62641ce8d8", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__passages_appro`\n\nwhere not(passage_duration_min >= 0 OR passage_duration_min IS NULL)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.042686Z", "completed_at": "2026-02-09T09:54:54.167992Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.548323Z", "completed_at": "2026-02-09T09:54:54.548335Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.717498779296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_source_unique_combination_of_columns_marts_oracle_neshu_external_fct_oracle_neshu__passages_appro_task_id__roadman_code.f180dd15c6", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        task_id, roadman_code\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__passages_appro`\n    group by task_id, roadman_code\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.034685Z", "completed_at": "2026-02-09T09:54:54.123966Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.546053Z", "completed_at": "2026-02-09T09:54:54.546068Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7201287746429443, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_source_expression_is_true_marts_oracle_neshu_external_fct_oracle_neshu__passages_appro_passage_start_datetime___passage_end_datetime.dfc7811618", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__passages_appro`\n\nwhere not(passage_start_datetime <= passage_end_datetime)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.057886Z", "completed_at": "2026-02-09T09:54:54.168699Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.549169Z", "completed_at": "2026-02-09T09:54:54.549181Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7595655918121338, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_source_unique_combination_of_columns_mssql_sage_dbo_f_ecriturea_ec_no__n_analytique__ea_ligne.d6b0f7b301", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        ec_no, n_analytique, ea_ligne\n    from `evs-datastack-prod`.`prod_raw`.`dbo_f_ecriturea`\n    group by ec_no, n_analytique, ea_ligne\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.066776Z", "completed_at": "2026-02-09T09:54:54.211669Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.550567Z", "completed_at": "2026-02-09T09:54:54.550579Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.8006196022033691, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_marts_oracle_neshu_external_fct_oracle_neshu__passages_appro_loaded_at_utc.c33d26b383", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect loaded_at_utc\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__passages_appro`\nwhere loaded_at_utc is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.786487Z", "completed_at": "2026-02-09T09:54:54.858276Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.881079Z", "completed_at": "2026-02-09T09:54:54.881101Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3496568202972412, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_marts_oracle_neshu_external_fct_oracle_neshu__passages_appro_passage_start_datetime.b0a2c77abe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect passage_start_datetime\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__passages_appro`\nwhere passage_start_datetime is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.793722Z", "completed_at": "2026-02-09T09:54:54.859557Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.888088Z", "completed_at": "2026-02-09T09:54:54.888102Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3908545970916748, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_marts_oracle_neshu_external_fct_oracle_neshu__passages_appro_task_id.3aadab2139", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__passages_appro`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.801285Z", "completed_at": "2026-02-09T09:54:54.861197Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.894018Z", "completed_at": "2026-02-09T09:54:54.894031Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.3496077060699463, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_mssql_sage_dbo_f_ecriturea_cb_marq.7d3e1176b7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cb_marq\nfrom `evs-datastack-prod`.`prod_raw`.`dbo_f_ecriturea`\nwhere cb_marq is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.807704Z", "completed_at": "2026-02-09T09:54:54.862934Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.901794Z", "completed_at": "2026-02-09T09:54:54.901806Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.30864620208740234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_mssql_sage_dbo_f_ecriturec_ec_no.714fd67ceb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ec_no\nfrom `evs-datastack-prod`.`prod_raw`.`dbo_f_ecriturec`\nwhere ec_no is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.815389Z", "completed_at": "2026-02-09T09:54:54.863763Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.902461Z", "completed_at": "2026-02-09T09:54:54.902473Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.3498802185058594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_company_has_location_idcompany.78a3855ee6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_company_has_location`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.826915Z", "completed_at": "2026-02-09T09:54:54.864622Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.903131Z", "completed_at": "2026-02-09T09:54:54.903146Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.3903369903564453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_company_has_location_idlocation_type.c00751ddcc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation_type\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_company_has_location`\nwhere idlocation_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.821027Z", "completed_at": "2026-02-09T09:54:54.865711Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.903765Z", "completed_at": "2026-02-09T09:54:54.903776Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.4326786994934082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_company_has_location_idlocation.4cb1462c14", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_company_has_location`\nwhere idlocation is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.845367Z", "completed_at": "2026-02-09T09:54:54.873096Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.905681Z", "completed_at": "2026-02-09T09:54:54.905696Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.5590507984161377, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_contact_idcontact.5d0bfb48b5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontact\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_contact`\nwhere idcontact is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.839789Z", "completed_at": "2026-02-09T09:54:54.867214Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.905064Z", "completed_at": "2026-02-09T09:54:54.905075Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5617029666900635, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_company_type_idcompany_type.9340021aa9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany_type\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_company_type`\nwhere idcompany_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.833015Z", "completed_at": "2026-02-09T09:54:54.866564Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.904409Z", "completed_at": "2026-02-09T09:54:54.904427Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.56345534324646, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_company_idcompany.ca0aa09708", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_company`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.850922Z", "completed_at": "2026-02-09T09:54:54.881769Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:54.948927Z", "completed_at": "2026-02-09T09:54:54.948940Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.6032686233520508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_contract_idcontract.c89aed1d30", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontract\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_contract`\nwhere idcontract is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.868033Z", "completed_at": "2026-02-09T09:54:54.947131Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:55.332544Z", "completed_at": "2026-02-09T09:54:55.332560Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6332950592041016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_device_iddevice.6496feac91", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect iddevice\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_device`\nwhere iddevice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.875468Z", "completed_at": "2026-02-09T09:54:54.949765Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:55.336467Z", "completed_at": "2026-02-09T09:54:55.336483Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.671860933303833, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_label_family_idlabel_family.5769f912e2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel_family\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_label_family`\nwhere idlabel_family is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.882448Z", "completed_at": "2026-02-09T09:54:54.992208Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:55.379266Z", "completed_at": "2026-02-09T09:54:55.379280Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7134296894073486, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_label_has_company_idcompany.6d88a51aa2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_label_has_company`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.895119Z", "completed_at": "2026-02-09T09:54:55.076964Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:55.381419Z", "completed_at": "2026-02-09T09:54:55.381432Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7826411724090576, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_label_has_contract_idcontract.37b21d29b3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontract\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_label_has_contract`\nwhere idcontract is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:54.888816Z", "completed_at": "2026-02-09T09:54:55.077629Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:55.382087Z", "completed_at": "2026-02-09T09:54:55.382113Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7914323806762695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_label_has_company_idlabel.7de096df35", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_label_has_company`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:55.621731Z", "completed_at": "2026-02-09T09:54:55.688157Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:55.709659Z", "completed_at": "2026-02-09T09:54:55.709676Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3491659164428711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_label_has_device_iddevice.f53ade6533", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect iddevice\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_label_has_device`\nwhere iddevice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:55.614827Z", "completed_at": "2026-02-09T09:54:55.688761Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:55.710965Z", "completed_at": "2026-02-09T09:54:55.710978Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.39355993270874023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_label_has_contract_idlabel.d5144c39d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_label_has_contract`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:55.637169Z", "completed_at": "2026-02-09T09:54:55.692387Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:55.730675Z", "completed_at": "2026-02-09T09:54:55.730690Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3914642333984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_label_has_product_idlabel.1e9661cbb2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_label_has_product`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:55.629327Z", "completed_at": "2026-02-09T09:54:55.691087Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:55.724100Z", "completed_at": "2026-02-09T09:54:55.724115Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.4751853942871094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_label_has_device_idlabel.b0258c6fd3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_label_has_device`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:55.662295Z", "completed_at": "2026-02-09T09:54:55.693840Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:55.731440Z", "completed_at": "2026-02-09T09:54:55.731456Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.3474557399749756, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_label_has_task_idlabel.fca5e949e5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_label_has_task`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:55.655006Z", "completed_at": "2026-02-09T09:54:55.700058Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:55.732245Z", "completed_at": "2026-02-09T09:54:55.732257Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.39119696617126465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_label_has_resources_idresources.8b06b6a6f2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_label_has_resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:55.644167Z", "completed_at": "2026-02-09T09:54:55.700781Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:55.733558Z", "completed_at": "2026-02-09T09:54:55.733573Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.4343695640563965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_label_has_product_idproduct.cbd041fa26", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_label_has_product`\nwhere idproduct is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:55.681550Z", "completed_at": "2026-02-09T09:54:55.707733Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:55.734876Z", "completed_at": "2026-02-09T09:54:55.734891Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5104963779449463, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_location_idlocation.97a995d58f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_location`\nwhere idlocation is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:55.649799Z", "completed_at": "2026-02-09T09:54:55.701659Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:55.734231Z", "completed_at": "2026-02-09T09:54:55.734242Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.5172176361083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_label_has_resources_idlabel.df9b9b5f22", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_label_has_resources`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:55.668771Z", "completed_at": "2026-02-09T09:54:55.709039Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:55.735756Z", "completed_at": "2026-02-09T09:54:55.735768Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5573248863220215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_label_has_task_idtask.6226e38a09", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_label_has_task`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:55.674494Z", "completed_at": "2026-02-09T09:54:55.710313Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:55.779505Z", "completed_at": "2026-02-09T09:54:55.779517Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.5996737480163574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_label_idlabel.9efb329cc3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_label`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:55.694541Z", "completed_at": "2026-02-09T09:54:55.732899Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:55.949849Z", "completed_at": "2026-02-09T09:54:55.949860Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.636481761932373, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_product_idproduct.3ec372946b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_product`\nwhere idproduct is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:55.702661Z", "completed_at": "2026-02-09T09:54:55.736598Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:56.118107Z", "completed_at": "2026-02-09T09:54:56.118119Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.6662673950195312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_product_type_idproduct_type.a5abc1c42f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct_type\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_product_type`\nwhere idproduct_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:55.711590Z", "completed_at": "2026-02-09T09:54:55.780852Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:56.161151Z", "completed_at": "2026-02-09T09:54:56.161167Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7009015083312988, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_resources_idresources.4a1706a9f8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:55.718236Z", "completed_at": "2026-02-09T09:54:55.863858Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:56.204127Z", "completed_at": "2026-02-09T09:54:56.204139Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7369728088378906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_resources_type_idresources_type.25c8b3a5bf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources_type\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_resources_type`\nwhere idresources_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:55.724762Z", "completed_at": "2026-02-09T09:54:55.864556Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:56.204798Z", "completed_at": "2026-02-09T09:54:56.204814Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7780790328979492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_task_has_product_idtask_has_product.18fd39c5e9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_has_product\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_task_has_product`\nwhere idtask_has_product is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:56.438751Z", "completed_at": "2026-02-09T09:54:56.506126Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:56.538599Z", "completed_at": "2026-02-09T09:54:56.538613Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3490145206451416, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_task_has_resources_idresources.532c1fb7a3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_task_has_resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:56.447996Z", "completed_at": "2026-02-09T09:54:56.513173Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:56.545686Z", "completed_at": "2026-02-09T09:54:56.545699Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3496413230895996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_task_has_resources_idtask.88593b6885", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_task_has_resources`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:56.466979Z", "completed_at": "2026-02-09T09:54:56.514929Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:56.552173Z", "completed_at": "2026-02-09T09:54:56.552188Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.26405858993530273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_task_type_idtask_type.fbaf60d254", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_type\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_task_type`\nwhere idtask_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:56.456183Z", "completed_at": "2026-02-09T09:54:56.523294Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:56.555251Z", "completed_at": "2026-02-09T09:54:56.555265Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.30719828605651855, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_task_idtask.859d7e99cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_task`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:56.461796Z", "completed_at": "2026-02-09T09:54:56.520937Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:56.554444Z", "completed_at": "2026-02-09T09:54:56.554456Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.34807682037353516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_lcdp_lcdp_task_status_idtask_status.42f7b1952f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_status\nfrom `evs-datastack-prod`.`prod_raw`.`lcdp_task_status`\nwhere idtask_status is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:56.473834Z", "completed_at": "2026-02-09T09:54:56.524229Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:56.556056Z", "completed_at": "2026-02-09T09:54:56.556072Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.3888580799102783, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_company_has_location_idcompany.d2e7a813ca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_raw`.`evs_company_has_location`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:56.486405Z", "completed_at": "2026-02-09T09:54:56.531401Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:56.558095Z", "completed_at": "2026-02-09T09:54:56.558107Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.46976804733276367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_company_has_location_idlocation_type.b7ffe23a12", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation_type\nfrom `evs-datastack-prod`.`prod_raw`.`evs_company_has_location`\nwhere idlocation_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:56.480640Z", "completed_at": "2026-02-09T09:54:56.524927Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:56.557321Z", "completed_at": "2026-02-09T09:54:56.557332Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.4717533588409424, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_company_has_location_idlocation.e1aaef8e8b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation\nfrom `evs-datastack-prod`.`prod_raw`.`evs_company_has_location`\nwhere idlocation is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:56.493082Z", "completed_at": "2026-02-09T09:54:56.537426Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:56.559370Z", "completed_at": "2026-02-09T09:54:56.559380Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.5129320621490479, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_company_idcompany.c223201709", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_raw`.`evs_company`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:56.498861Z", "completed_at": "2026-02-09T09:54:56.539431Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:56.560328Z", "completed_at": "2026-02-09T09:54:56.560339Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5538730621337891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_company_type_idcompany_type.11fcffba5d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany_type\nfrom `evs-datastack-prod`.`prod_raw`.`evs_company_type`\nwhere idcompany_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:56.506803Z", "completed_at": "2026-02-09T09:54:56.551472Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:56.603440Z", "completed_at": "2026-02-09T09:54:56.603451Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.5942807197570801, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_contact_idcontact.d426a1c13e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontact\nfrom `evs-datastack-prod`.`prod_raw`.`evs_contact`\nwhere idcontact is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:56.515878Z", "completed_at": "2026-02-09T09:54:56.556642Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:56.814288Z", "completed_at": "2026-02-09T09:54:56.814302Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6363909244537354, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_contract_idcontract.f730c61b9d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontract\nfrom `evs-datastack-prod`.`prod_raw`.`evs_contract`\nwhere idcontract is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:56.525826Z", "completed_at": "2026-02-09T09:54:56.558724Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:56.898636Z", "completed_at": "2026-02-09T09:54:56.898648Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.668602705001831, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_contract_parsed_idcontract.34a4825dee", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontract\nfrom `evs-datastack-prod`.`prod_raw`.`evs_contract_parsed`\nwhere idcontract is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:56.532345Z", "completed_at": "2026-02-09T09:54:56.602442Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:56.983617Z", "completed_at": "2026-02-09T09:54:56.983629Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7064492702484131, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_device_iddevice.d62f2bee11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect iddevice\nfrom `evs-datastack-prod`.`prod_raw`.`evs_device`\nwhere iddevice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:56.540112Z", "completed_at": "2026-02-09T09:54:56.646262Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:57.026690Z", "completed_at": "2026-02-09T09:54:57.026704Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7480199337005615, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_family_idlabel_family.76e2fc3d22", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel_family\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_family`\nwhere idlabel_family is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:56.546394Z", "completed_at": "2026-02-09T09:54:56.772004Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:57.029836Z", "completed_at": "2026-02-09T09:54:57.029848Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7916262149810791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_company_idcompany.9fb5a691bb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_company`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:57.263290Z", "completed_at": "2026-02-09T09:54:57.336131Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:57.365407Z", "completed_at": "2026-02-09T09:54:57.365428Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3110542297363281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_company_idlabel.84c84e0808", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_company`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:57.270587Z", "completed_at": "2026-02-09T09:54:57.336838Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:57.366172Z", "completed_at": "2026-02-09T09:54:57.366188Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.35262584686279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_contract_idcontract.34f534407d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontract\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_contract`\nwhere idcontract is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:57.278283Z", "completed_at": "2026-02-09T09:54:57.338714Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:57.373163Z", "completed_at": "2026-02-09T09:54:57.373177Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.3103811740875244, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_contract_idlabel.1500ee3c29", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_contract`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:57.285264Z", "completed_at": "2026-02-09T09:54:57.339512Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:57.373819Z", "completed_at": "2026-02-09T09:54:57.373830Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3513946533203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_device_iddevice.67fa8a09c3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect iddevice\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_device`\nwhere iddevice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:57.297213Z", "completed_at": "2026-02-09T09:54:57.346897Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:57.381151Z", "completed_at": "2026-02-09T09:54:57.381163Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.3507838249206543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_product_idlabel.5191f399c0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_product`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:57.315833Z", "completed_at": "2026-02-09T09:54:57.349090Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:57.382085Z", "completed_at": "2026-02-09T09:54:57.382105Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.4314427375793457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_resources_idresources.701adf32da", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:57.290966Z", "completed_at": "2026-02-09T09:54:57.340817Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:57.379672Z", "completed_at": "2026-02-09T09:54:57.379686Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.4797978401184082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_device_idlabel.7913e12518", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_device`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:57.310251Z", "completed_at": "2026-02-09T09:54:57.355652Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:57.383080Z", "completed_at": "2026-02-09T09:54:57.383093Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.4775538444519043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_resources_idlabel.eabdfa7bbf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_resources`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:57.302894Z", "completed_at": "2026-02-09T09:54:57.356378Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:57.384513Z", "completed_at": "2026-02-09T09:54:57.384528Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5215744972229004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_product_idproduct.6048527bb0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_product`\nwhere idproduct is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:57.322505Z", "completed_at": "2026-02-09T09:54:57.364558Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:57.385878Z", "completed_at": "2026-02-09T09:54:57.385893Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5597045421600342, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_task_idlabel.9722fba510", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_task`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:57.329891Z", "completed_at": "2026-02-09T09:54:57.366801Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:57.429503Z", "completed_at": "2026-02-09T09:54:57.429519Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6015617847442627, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_task_idtask.407d48dbcb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_task`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:57.341575Z", "completed_at": "2026-02-09T09:54:57.383749Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:57.686231Z", "completed_at": "2026-02-09T09:54:57.686254Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6442668437957764, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_idlabel.725504fd88", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:57.349790Z", "completed_at": "2026-02-09T09:54:57.385128Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:57.729022Z", "completed_at": "2026-02-09T09:54:57.729041Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.6854007244110107, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_location_idlocation.252e77f735", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation\nfrom `evs-datastack-prod`.`prod_raw`.`evs_location`\nwhere idlocation is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:57.357001Z", "completed_at": "2026-02-09T09:54:57.428676Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:57.813878Z", "completed_at": "2026-02-09T09:54:57.813893Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7154052257537842, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_product_idproduct.0e5cc2ab70", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct\nfrom `evs-datastack-prod`.`prod_raw`.`evs_product`\nwhere idproduct is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:57.367452Z", "completed_at": "2026-02-09T09:54:57.512807Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:57.857991Z", "completed_at": "2026-02-09T09:54:57.858009Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7580296993255615, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_product_type_idproduct_type.2e7c2d534c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct_type\nfrom `evs-datastack-prod`.`prod_raw`.`evs_product_type`\nwhere idproduct_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:57.374489Z", "completed_at": "2026-02-09T09:54:57.683676Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:57.861742Z", "completed_at": "2026-02-09T09:54:57.861756Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7842295169830322, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_resources_idresources.04add56fa5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_raw`.`evs_resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.094438Z", "completed_at": "2026-02-09T09:54:58.163096Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:58.191145Z", "completed_at": "2026-02-09T09:54:58.191174Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3131136894226074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_resources_type_idresources_type.c0ade33349", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources_type\nfrom `evs-datastack-prod`.`prod_raw`.`evs_resources_type`\nwhere idresources_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.104345Z", "completed_at": "2026-02-09T09:54:58.171486Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:58.198512Z", "completed_at": "2026-02-09T09:54:58.198530Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.35239362716674805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_task_has_product_idtask_has_product.52f463d476", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_has_product\nfrom `evs-datastack-prod`.`prod_raw`.`evs_task_has_product`\nwhere idtask_has_product is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.111883Z", "completed_at": "2026-02-09T09:54:58.173026Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:58.205575Z", "completed_at": "2026-02-09T09:54:58.205596Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.351276159286499, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_task_has_resources_idresources.6896d0d7f1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_raw`.`evs_task_has_resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.124039Z", "completed_at": "2026-02-09T09:54:58.175565Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:58.208161Z", "completed_at": "2026-02-09T09:54:58.208172Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.3916447162628174, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_task_idtask.d1aa0b27a5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_raw`.`evs_task`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.118320Z", "completed_at": "2026-02-09T09:54:58.174933Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:58.207487Z", "completed_at": "2026-02-09T09:54:58.207503Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.39353203773498535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_task_has_resources_idtask.3c6bbcc3c8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_raw`.`evs_task_has_resources`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.130684Z", "completed_at": "2026-02-09T09:54:58.174133Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:58.206851Z", "completed_at": "2026-02-09T09:54:58.206863Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.4338111877441406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_task_status_idtask_status.2b475b6b56", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_status\nfrom `evs-datastack-prod`.`prod_raw`.`evs_task_status`\nwhere idtask_status is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.136572Z", "completed_at": "2026-02-09T09:54:58.183300Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:58.215499Z", "completed_at": "2026-02-09T09:54:58.215515Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.47563886642456055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_task_type_idtask_type.d7f9ba800f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_type\nfrom `evs-datastack-prod`.`prod_raw`.`evs_task_type`\nwhere idtask_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.142870Z", "completed_at": "2026-02-09T09:54:58.190377Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:58.216444Z", "completed_at": "2026-02-09T09:54:58.216456Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.4747810363769531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_clients_id.94442bf14b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_clients`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.149314Z", "completed_at": "2026-02-09T09:54:58.191844Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:58.259014Z", "completed_at": "2026-02-09T09:54:58.259029Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5177724361419678, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_material_categories_id.4ef54c952f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_material_categories`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.157989Z", "completed_at": "2026-02-09T09:54:58.199205Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:58.303640Z", "completed_at": "2026-02-09T09:54:58.303652Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.559950590133667, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_materials_id.ef8e1020be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_materials`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.165585Z", "completed_at": "2026-02-09T09:54:58.206223Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:58.345908Z", "completed_at": "2026-02-09T09:54:58.345920Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6007552146911621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_materials_site_id.f462c1646e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect site_id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_materials`\nwhere site_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.177130Z", "completed_at": "2026-02-09T09:54:58.217196Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:58.558014Z", "completed_at": "2026-02-09T09:54:58.558029Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6400651931762695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_products_id.9d76ec0f24", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_products`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.184851Z", "completed_at": "2026-02-09T09:54:58.217870Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:58.558722Z", "completed_at": "2026-02-09T09:54:58.558734Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.6722707748413086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_purchase_orders_id.3eb709d1c8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_purchase_orders`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.192604Z", "completed_at": "2026-02-09T09:54:58.302884Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:58.602578Z", "completed_at": "2026-02-09T09:54:58.602591Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7091259956359863, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_sites_client_id.6e84614dea", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect client_id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_sites`\nwhere client_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.199889Z", "completed_at": "2026-02-09T09:54:58.346628Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:58.646061Z", "completed_at": "2026-02-09T09:54:58.646076Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7444655895233154, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_sites_id.cc7391839c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_sites`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.208761Z", "completed_at": "2026-02-09T09:54:58.557226Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:58.691702Z", "completed_at": "2026-02-09T09:54:58.691717Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7681517601013184, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_storehouses_id.bb31da2576", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_storehouses`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.920223Z", "completed_at": "2026-02-09T09:54:58.983905Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.015537Z", "completed_at": "2026-02-09T09:54:59.015557Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3074359893798828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_users_id.d5dd93c383", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_users`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.934102Z", "completed_at": "2026-02-09T09:54:58.985260Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.017486Z", "completed_at": "2026-02-09T09:54:59.017502Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.3886573314666748, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_workorder_demands_categories_id.a8a4d3d9e4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_workorder_demands_categories`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.928243Z", "completed_at": "2026-02-09T09:54:58.984638Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.016828Z", "completed_at": "2026-02-09T09:54:59.016841Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.39059901237487793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_workorder_categories_id.481d28172c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_workorder_categories`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.943197Z", "completed_at": "2026-02-09T09:54:59.000467Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.030831Z", "completed_at": "2026-02-09T09:54:59.030847Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.34755420684814453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_workorder_demands_id.2951fa446c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_workorder_demands`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.955010Z", "completed_at": "2026-02-09T09:54:59.012463Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.033566Z", "completed_at": "2026-02-09T09:54:59.033578Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.38878560066223145, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_marts_oracle_neshu_external_fct_oracle_neshu__passages_appro_task_id.6808d3b688", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__passages_appro`\n  where task_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.949507Z", "completed_at": "2026-02-09T09:54:59.006210Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.032779Z", "completed_at": "2026-02-09T09:54:59.032790Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4309995174407959, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_workorders_id.e6c047d2a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_workorders`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.970290Z", "completed_at": "2026-02-09T09:54:59.014143Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.040538Z", "completed_at": "2026-02-09T09:54:59.040552Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.4734783172607422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_mssql_sage_dbo_f_ecriturec_ec_no.6925cf7be5", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select ec_no as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`dbo_f_ecriturec`\n  where ec_no is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.963430Z", "completed_at": "2026-02-09T09:54:59.014795Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.041831Z", "completed_at": "2026-02-09T09:54:59.041842Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.5174357891082764, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_mssql_sage_dbo_f_ecriturea_cb_marq.ce4c2c11f4", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select cb_marq as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`dbo_f_ecriturea`\n  where cb_marq is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.978022Z", "completed_at": "2026-02-09T09:54:59.016234Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.084286Z", "completed_at": "2026-02-09T09:54:59.084299Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5149555206298828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_lcdp_lcdp_company_idcompany.4549e70046", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcompany as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`lcdp_company`\n  where idcompany is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.986533Z", "completed_at": "2026-02-09T09:54:59.031514Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.211918Z", "completed_at": "2026-02-09T09:54:59.211930Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5578529834747314, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_lcdp_lcdp_company_type_idcompany_type.0ffbd194af", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcompany_type as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`lcdp_company_type`\n  where idcompany_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:58.992878Z", "completed_at": "2026-02-09T09:54:59.032195Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.212558Z", "completed_at": "2026-02-09T09:54:59.212569Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.5976324081420898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_lcdp_lcdp_contact_idcontact.d56875f909", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcontact as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`lcdp_contact`\n  where idcontact is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:59.001150Z", "completed_at": "2026-02-09T09:54:59.034311Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.296390Z", "completed_at": "2026-02-09T09:54:59.296406Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.679485559463501, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_lcdp_lcdp_contract_idcontract.656a480f87", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcontract as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`lcdp_contract`\n  where idcontract is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:59.007328Z", "completed_at": "2026-02-09T09:54:59.041216Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.297337Z", "completed_at": "2026-02-09T09:54:59.297349Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.6800632476806641, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_lcdp_lcdp_device_iddevice.d19ee52359", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select iddevice as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`lcdp_device`\n  where iddevice is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:59.018135Z", "completed_at": "2026-02-09T09:54:59.168804Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.427707Z", "completed_at": "2026-02-09T09:54:59.427722Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7054629325866699, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_lcdp_lcdp_label_family_idlabel_family.275773cead", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlabel_family as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`lcdp_label_family`\n  where idlabel_family is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:59.023915Z", "completed_at": "2026-02-09T09:54:59.211321Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.429111Z", "completed_at": "2026-02-09T09:54:59.429123Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7455441951751709, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_lcdp_lcdp_label_idlabel.294c637ef9", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlabel as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`lcdp_label`\n  where idlabel is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:59.034958Z", "completed_at": "2026-02-09T09:54:59.298024Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.515795Z", "completed_at": "2026-02-09T09:54:59.515817Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7564225196838379, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_lcdp_lcdp_location_idlocation.12e278225c", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlocation as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`lcdp_location`\n  where idlocation is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:59.746594Z", "completed_at": "2026-02-09T09:54:59.801353Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.838226Z", "completed_at": "2026-02-09T09:54:59.838245Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.30404114723205566, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_lcdp_lcdp_product_idproduct.55b73df919", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idproduct as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`lcdp_product`\n  where idproduct is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:59.755109Z", "completed_at": "2026-02-09T09:54:59.808901Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.839794Z", "completed_at": "2026-02-09T09:54:59.839806Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.34486865997314453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_lcdp_lcdp_product_type_idproduct_type.50fe0b690a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idproduct_type as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`lcdp_product_type`\n  where idproduct_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:59.761574Z", "completed_at": "2026-02-09T09:54:59.810465Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.846656Z", "completed_at": "2026-02-09T09:54:59.846671Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4280822277069092, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_lcdp_lcdp_resources_idresources.481fe480c1", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idresources as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`lcdp_resources`\n  where idresources is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:59.767258Z", "completed_at": "2026-02-09T09:54:59.811857Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.853412Z", "completed_at": "2026-02-09T09:54:59.853427Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.3878953456878662, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_lcdp_lcdp_resources_type_idresources_type.4f4621d0e4", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idresources_type as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`lcdp_resources_type`\n  where idresources_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:59.774326Z", "completed_at": "2026-02-09T09:54:59.818024Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.854246Z", "completed_at": "2026-02-09T09:54:59.854261Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.38636207580566406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_lcdp_lcdp_task_has_product_idtask_has_product.d6a751bfe6", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_has_product as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`lcdp_task_has_product`\n  where idtask_has_product is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:59.782350Z", "completed_at": "2026-02-09T09:54:59.830047Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.856468Z", "completed_at": "2026-02-09T09:54:59.856479Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.42862963676452637, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_lcdp_lcdp_task_idtask.e3b5c7fef3", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`lcdp_task`\n  where idtask is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:59.790032Z", "completed_at": "2026-02-09T09:54:59.839073Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.904448Z", "completed_at": "2026-02-09T09:54:59.904467Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.42624855041503906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_lcdp_lcdp_task_status_idtask_status.8a0e7b6a4a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_status as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`lcdp_task_status`\n  where idtask_status is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:59.795671Z", "completed_at": "2026-02-09T09:54:59.840486Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.948572Z", "completed_at": "2026-02-09T09:54:59.948584Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.4712183475494385, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_lcdp_lcdp_task_type_idtask_type.10b460fa71", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_type as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`lcdp_task_type`\n  where idtask_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:59.802133Z", "completed_at": "2026-02-09T09:54:59.847315Z"}, {"name": "execute", "started_at": "2026-02-09T09:54:59.949566Z", "completed_at": "2026-02-09T09:54:59.949578Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5123608112335205, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_company_idcompany.6df2f6792e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcompany as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_company`\n  where idcompany is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:59.812499Z", "completed_at": "2026-02-09T09:54:59.855014Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:00.076104Z", "completed_at": "2026-02-09T09:55:00.076121Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5519857406616211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_company_type_idcompany_type.56f35aae37", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcompany_type as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_company_type`\n  where idcompany_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:59.818772Z", "completed_at": "2026-02-09T09:54:59.855804Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:00.076900Z", "completed_at": "2026-02-09T09:55:00.076918Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.5937521457672119, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_contact_idcontact.d870dc347d", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcontact as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_contact`\n  where idcontact is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:59.824511Z", "completed_at": "2026-02-09T09:54:59.857155Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:00.078356Z", "completed_at": "2026-02-09T09:55:00.078371Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6348097324371338, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_contract_idcontract.00683b26ea", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcontract as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_contract`\n  where idcontract is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:59.831340Z", "completed_at": "2026-02-09T09:54:59.906461Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:00.163740Z", "completed_at": "2026-02-09T09:55:00.163753Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.6772327423095703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_contract_parsed_idcontract.88000e1326", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcontract as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_contract_parsed`\n  where idcontract is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:59.841162Z", "completed_at": "2026-02-09T09:54:59.950301Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:00.208716Z", "completed_at": "2026-02-09T09:55:00.208731Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.6937704086303711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_device_iddevice.397252bea8", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select iddevice as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_device`\n  where iddevice is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:59.847940Z", "completed_at": "2026-02-09T09:55:00.077572Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:00.294918Z", "completed_at": "2026-02-09T09:55:00.294934Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7383837699890137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_label_family_idlabel_family.52acfecf7e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlabel_family as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_label_family`\n  where idlabel_family is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:54:59.857757Z", "completed_at": "2026-02-09T09:55:00.162342Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:00.380443Z", "completed_at": "2026-02-09T09:55:00.380458Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7685861587524414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_label_idlabel.f4f4d52728", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlabel as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_label`\n  where idlabel is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:00.566700Z", "completed_at": "2026-02-09T09:55:00.618006Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:00.662303Z", "completed_at": "2026-02-09T09:55:00.662320Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.5777554512023926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_location_idlocation.e07de44c8b", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlocation as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_location`\n  where idlocation is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:00.575047Z", "completed_at": "2026-02-09T09:55:00.632272Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:00.670107Z", "completed_at": "2026-02-09T09:55:00.670120Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.5792446136474609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_product_idproduct.56c841c209", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idproduct as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_product`\n  where idproduct is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:00.594279Z", "completed_at": "2026-02-09T09:55:00.644985Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:00.671002Z", "completed_at": "2026-02-09T09:55:00.671017Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.6161525249481201, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_resources_type_idresources_type.94e4b1617f", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idresources_type as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_resources_type`\n  where idresources_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:00.589106Z", "completed_at": "2026-02-09T09:55:00.645729Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:00.671718Z", "completed_at": "2026-02-09T09:55:00.671734Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.6179296970367432, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_resources_idresources.65588abfd8", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idresources as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_resources`\n  where idresources is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:00.583196Z", "completed_at": "2026-02-09T09:55:00.646344Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:00.672473Z", "completed_at": "2026-02-09T09:55:00.672488Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.6601405143737793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_product_type_idproduct_type.f77e407933", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idproduct_type as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_product_type`\n  where idproduct_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:00.610878Z", "completed_at": "2026-02-09T09:55:00.660515Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:00.681703Z", "completed_at": "2026-02-09T09:55:00.681714Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.6568863391876221, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_task_idtask.e261c356e9", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_task`\n  where idtask is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:00.604340Z", "completed_at": "2026-02-09T09:55:00.659620Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:00.681037Z", "completed_at": "2026-02-09T09:55:00.681054Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.7011723518371582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_task_has_product_idtask_has_product.b9af110684", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_has_product as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_task_has_product`\n  where idtask_has_product is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:00.618780Z", "completed_at": "2026-02-09T09:55:00.668789Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:00.959732Z", "completed_at": "2026-02-09T09:55:00.959747Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.6991009712219238, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_task_status_idtask_status.b176cc0c5b", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_status as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_task_status`\n  where idtask_status is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:00.625990Z", "completed_at": "2026-02-09T09:55:00.669484Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:00.960468Z", "completed_at": "2026-02-09T09:55:00.960479Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.7398834228515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_task_type_idtask_type.3b8b3b9ff6", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_type as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_task_type`\n  where idtask_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:00.639429Z", "completed_at": "2026-02-09T09:55:00.673079Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:01.128683Z", "completed_at": "2026-02-09T09:55:01.128699Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.7812192440032959, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_material_categories_id.8e8a025d0a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_material_categories`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:00.633662Z", "completed_at": "2026-02-09T09:55:00.678828Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:01.129369Z", "completed_at": "2026-02-09T09:55:01.129381Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.8243212699890137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_clients_id.ac9ad6b2fc", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_clients`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:00.647675Z", "completed_at": "2026-02-09T09:55:00.682355Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:01.172075Z", "completed_at": "2026-02-09T09:55:01.172087Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.86397385597229, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_materials_id.627fc0bbcf", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_materials`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:00.654541Z", "completed_at": "2026-02-09T09:55:00.916252Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:01.214863Z", "completed_at": "2026-02-09T09:55:01.214876Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.899322509765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_products_id.0797f24444", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_products`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:00.663252Z", "completed_at": "2026-02-09T09:55:00.961090Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:01.300138Z", "completed_at": "2026-02-09T09:55:01.300151Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.9351413249969482, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_purchase_orders_id.1a3a583089", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_purchase_orders`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:00.673738Z", "completed_at": "2026-02-09T09:55:01.172659Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:01.387901Z", "completed_at": "2026-02-09T09:55:01.387913Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.9600996971130371, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_sites_id.c7e2661f2f", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_sites`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:00.683117Z", "completed_at": "2026-02-09T09:55:01.216543Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:01.473773Z", "completed_at": "2026-02-09T09:55:01.473788Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.9919788837432861, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_storehouses_id.00c2ccf09c", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_storehouses`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:01.618069Z", "completed_at": "2026-02-09T09:55:01.671254Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:01.707331Z", "completed_at": "2026-02-09T09:55:01.707352Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.34323978424072266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_users_id.9323495945", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_users`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:01.634698Z", "completed_at": "2026-02-09T09:55:01.679557Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:01.722927Z", "completed_at": "2026-02-09T09:55:01.722960Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.3074920177459717, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_workorder_demands_categories_id.d7d762a90b", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_workorder_demands_categories`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:01.640159Z", "completed_at": "2026-02-09T09:55:01.688024Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:01.724397Z", "completed_at": "2026-02-09T09:55:01.724409Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.348832368850708, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_workorder_demands_id.61272d2b5b", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_workorder_demands`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:01.627454Z", "completed_at": "2026-02-09T09:55:01.680216Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:01.723619Z", "completed_at": "2026-02-09T09:55:01.723634Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.3930675983428955, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_workorder_categories_id.ae2a36c8ed", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_workorder_categories`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:01.645595Z", "completed_at": "2026-02-09T09:55:01.688598Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:01.725071Z", "completed_at": "2026-02-09T09:55:01.725087Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4318728446960449, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_workorders_id.cf3a021d13", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_workorders`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:01.651981Z", "completed_at": "2026-02-09T09:55:01.695630Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:01.731999Z", "completed_at": "2026-02-09T09:55:01.732014Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.4723093509674072, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_gac__sinistres_sg", "compiled": true, "compiled_code": "\n-- ============================================================================\n-- MODEL: fct_gac__sinistres_sg\n-- PURPOSE: Table de faits sur les sinistres vehicules\n-- AUTHOR: Etienne BOULINIER\n-- ============================================================================\nSELECT \n-- Infos Sinistre\nn_de_sinistre,\nDATE(date_sinistre) as date_sinistre,\ndate_de_creation,\ncirconstance,\ntiers,\nresp,\ncloture,\n-- Infos Vehicule\nimmat,\nnom,\nprenom,\nstatut_actuel,\ngenre_fiscal,\nreference_gac,\nentite_entite_2,\nentite_entite_3,\n--Couts\ncentre_de_couts,\ncout_assureur,\nauto_assurance,\nfranchise,\ncout_global,\ncout_client,\n-- M\u00e9tadonn\u00e9es dbt\nCURRENT_TIMESTAMP() as dbt_updated_at,\n'cb08451a-2004-4aaf-949e-f43cc89d5466' as dbt_invocation_id\n FROM `evs-datastack-prod`.`prod_staging`.`stg_gac__sinistres_sg`", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_gac__sinistres_sg`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:01.666165Z", "completed_at": "2026-02-09T09:55:01.714889Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:01.782542Z", "completed_at": "2026-02-09T09:55:01.782556Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.5114915370941162, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_mssql_sage__f_collaborateur_co_no.086b5b6003", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select co_no as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_collaborateur`\n  where co_no is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:01.659850Z", "completed_at": "2026-02-09T09:55:01.713116Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:01.775364Z", "completed_at": "2026-02-09T09:55:01.775377Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5154092311859131, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_mssql_sage__f_collaborateur_co_no.8fe666d6a9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect co_no\nfrom `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_collaborateur`\nwhere co_no is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:01.672826Z", "completed_at": "2026-02-09T09:55:01.722331Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:01.783906Z", "completed_at": "2026-02-09T09:55:01.783918Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5139679908752441, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_mssql_sage__f_comptet_ct_intitule.8b30e5ed44", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ct_intitule\nfrom `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_comptet`\nwhere ct_intitule is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:01.680983Z", "completed_at": "2026-02-09T09:55:01.730994Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:01.950749Z", "completed_at": "2026-02-09T09:55:01.950767Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.5553333759307861, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_mssql_sage__f_comptet_ct_num.e1aafeeaf3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ct_num\nfrom `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_comptet`\nwhere ct_num is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:01.689369Z", "completed_at": "2026-02-09T09:55:01.773513Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:01.995111Z", "completed_at": "2026-02-09T09:55:01.995123Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5971903800964355, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_mssql_sage__f_comptet_ct_num.dd74c728b2", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select ct_num as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_comptet`\n  where ct_num is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:01.696314Z", "completed_at": "2026-02-09T09:55:01.781260Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:01.996603Z", "completed_at": "2026-02-09T09:55:01.996615Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6380622386932373, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_mssql_sage__f_docligne_dl_no.fdbc1a884d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dl_no\nfrom `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_docligne`\nwhere dl_no is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:01.702097Z", "completed_at": "2026-02-09T09:55:01.783157Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:02.079961Z", "completed_at": "2026-02-09T09:55:02.079978Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.6717991828918457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_mssql_sage__f_docligne_cbco_no__co_no__ref_stg_mssql_sage__f_collaborateur_.91341252b0", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select cbco_no as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_docligne`\n    where cbco_no is not null\n),\n\nparent as (\n    select co_no as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_collaborateur`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:01.715659Z", "completed_at": "2026-02-09T09:55:01.784665Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:02.123173Z", "completed_at": "2026-02-09T09:55:02.123187Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7071812152862549, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_mssql_sage__f_docligne_dl_no.bbe213a3d0", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select dl_no as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_docligne`\n  where dl_no is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:01.725890Z", "completed_at": "2026-02-09T09:55:01.994456Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:02.170248Z", "completed_at": "2026-02-09T09:55:02.170260Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7290270328521729, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_mssql_sage__f_ecriturea_cb_marq.2b7821a339", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cb_marq\nfrom `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturea`\nwhere cb_marq is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:01.776192Z", "completed_at": "2026-02-09T09:55:02.122347Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:02.298202Z", "completed_at": "2026-02-09T09:55:02.298218Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7605433464050293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_mssql_sage__f_ecriturea_ec_no.e9561d3019", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ec_no\nfrom `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturea`\nwhere ec_no is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:02.438087Z", "completed_at": "2026-02-09T09:55:02.485554Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:02.522413Z", "completed_at": "2026-02-09T09:55:02.522426Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.426177978515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_mssql_sage__f_ecriturea_cb_marq.4564af1e9a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select cb_marq as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturea`\n  where cb_marq is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:02.464817Z", "completed_at": "2026-02-09T09:55:02.507932Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:02.545042Z", "completed_at": "2026-02-09T09:55:02.545054Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.3107755184173584, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_nesp_co__activite_activity_type.6269f4d592", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_nesp_co__activite`\nwhere activity_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:02.451108Z", "completed_at": "2026-02-09T09:55:02.507055Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:02.544007Z", "completed_at": "2026-02-09T09:55:02.544023Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.39644908905029297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_unique_combination_of_columns_stg_nesp_co__activite_activity_id__employee_responsible__activity_type.3141a808e6", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        activity_id, employee_responsible, activity_type\n    from `evs-datastack-prod`.`prod_staging`.`stg_nesp_co__activite`\n    group by activity_id, employee_responsible, activity_type\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:02.471219Z", "completed_at": "2026-02-09T09:55:02.514301Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:02.546389Z", "completed_at": "2026-02-09T09:55:02.546399Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3947937488555908, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_nesp_co__activite_employee_responsible.d3ecc8807d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect employee_responsible\nfrom `evs-datastack-prod`.`prod_staging`.`stg_nesp_co__activite`\nwhere employee_responsible is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:02.459342Z", "completed_at": "2026-02-09T09:55:02.514872Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:02.547057Z", "completed_at": "2026-02-09T09:55:02.547069Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.4385988712310791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_nesp_co__activite_activity_id.ed7ee09b3c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect activity_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_nesp_co__activite`\nwhere activity_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:02.476618Z", "completed_at": "2026-02-09T09:55:02.521342Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:02.554024Z", "completed_at": "2026-02-09T09:55:02.554040Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.4800229072570801, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_unique_combination_of_columns_stg_nesp_co__opportunite_opportunity_id__employee_responsible__created_by.6f803e112e", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        opportunity_id, employee_responsible, created_by\n    from `evs-datastack-prod`.`prod_staging`.`stg_nesp_co__opportunite`\n    group by opportunity_id, employee_responsible, created_by\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:02.486177Z", "completed_at": "2026-02-09T09:55:02.536108Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:02.599141Z", "completed_at": "2026-02-09T09:55:02.599159Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.4790458679199219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_mssql_sage__f_ecriturec_cb_marq.3bd93c8d9a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cb_marq\nfrom `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturec`\nwhere cb_marq is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:02.499566Z", "completed_at": "2026-02-09T09:55:02.538196Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:02.610464Z", "completed_at": "2026-02-09T09:55:02.610485Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5189132690429688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_nesp_co__opportunite_created_by.e087b6981a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_by\nfrom `evs-datastack-prod`.`prod_staging`.`stg_nesp_co__opportunite`\nwhere created_by is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:02.493043Z", "completed_at": "2026-02-09T09:55:02.545644Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:02.654409Z", "completed_at": "2026-02-09T09:55:02.654423Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5630142688751221, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_mssql_sage__f_ecriturec_ec_no.72ebe5dc6d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ec_no\nfrom `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturec`\nwhere ec_no is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:02.508927Z", "completed_at": "2026-02-09T09:55:02.547675Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:02.739041Z", "completed_at": "2026-02-09T09:55:02.739054Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.559323787689209, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_nesp_co__opportunite_employee_responsible.76da6c5062", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect employee_responsible\nfrom `evs-datastack-prod`.`prod_staging`.`stg_nesp_co__opportunite`\nwhere employee_responsible is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:02.515564Z", "completed_at": "2026-02-09T09:55:02.595886Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:02.782472Z", "completed_at": "2026-02-09T09:55:02.782485Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5940976142883301, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_nesp_co__opportunite_opportunity_id.0a9bc53265", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect opportunity_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_nesp_co__opportunite`\nwhere opportunity_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:02.531044Z", "completed_at": "2026-02-09T09:55:02.611195Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:02.868428Z", "completed_at": "2026-02-09T09:55:02.868444Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.6758584976196289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_mssql_sage__f_ecriturec_ec_no.dfbf7515df", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select ec_no as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturec`\n  where ec_no is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:02.523144Z", "completed_at": "2026-02-09T09:55:02.598294Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:02.825600Z", "completed_at": "2026-02-09T09:55:02.825613Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6777315139770508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_mssql_sage__f_ecriturea_ec_no__ec_no__ref_stg_mssql_sage__f_ecriturec_.de8056a230", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select ec_no as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturea`\n    where ec_no is not null\n),\n\nparent as (\n    select ec_no as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturec`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:02.538785Z", "completed_at": "2026-02-09T09:55:02.655024Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:02.952721Z", "completed_at": "2026-02-09T09:55:02.952734Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.712090253829956, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_nesp_co__client_third.d883c825bf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect third\nfrom `evs-datastack-prod`.`prod_staging`.`stg_nesp_co__client`\nwhere third is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:02.548323Z", "completed_at": "2026-02-09T09:55:02.781798Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:02.998302Z", "completed_at": "2026-02-09T09:55:02.998314Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7309868335723877, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_nesp_co__client_third.99e6484872", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select third as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_nesp_co__client`\n  where third is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:02.599994Z", "completed_at": "2026-02-09T09:55:02.909372Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:03.126406Z", "completed_at": "2026-02-09T09:55:03.126418Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7554798126220703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_unique_combination_of_columns_stg_nesp_tech__articles_n_planning__code_article__date_intervention.c99ba416cb", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        n_planning, code_article, date_intervention\n    from `evs-datastack-prod`.`prod_staging`.`stg_nesp_tech__articles`\n    group by n_planning, code_article, date_intervention\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:03.268265Z", "completed_at": "2026-02-09T09:55:03.319278Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:03.359370Z", "completed_at": "2026-02-09T09:55:03.359385Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3875706195831299, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_nesp_tech__articles_n_planning.91c4d84500", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect n_planning\nfrom `evs-datastack-prod`.`prod_staging`.`stg_nesp_tech__articles`\nwhere n_planning is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:03.277935Z", "completed_at": "2026-02-09T09:55:03.334172Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:03.366729Z", "completed_at": "2026-02-09T09:55:03.366742Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.3489816188812256, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_unique_combination_of_columns_stg_nesp_tech__interventions_n_planning__etat_intervention__date_heure_fin.2996dd747c", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        n_planning, etat_intervention, date_heure_fin\n    from `evs-datastack-prod`.`prod_staging`.`stg_nesp_tech__interventions`\n    group by n_planning, etat_intervention, date_heure_fin\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:03.299511Z", "completed_at": "2026-02-09T09:55:03.348609Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:03.377572Z", "completed_at": "2026-02-09T09:55:03.377583Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.34775424003601074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_lcdp__company_idcompany.aaa590b5bf", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcompany as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company`\n  where idcompany is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:03.293222Z", "completed_at": "2026-02-09T09:55:03.347811Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:03.376731Z", "completed_at": "2026-02-09T09:55:03.376746Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3932838439941406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__company_idcompany.449c2abce0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:03.285615Z", "completed_at": "2026-02-09T09:55:03.351602Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:03.384411Z", "completed_at": "2026-02-09T09:55:03.384430Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.43797898292541504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_nesp_tech__interventions_n_planning.2e2f201deb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect n_planning\nfrom `evs-datastack-prod`.`prod_staging`.`stg_nesp_tech__interventions`\nwhere n_planning is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:03.305708Z", "completed_at": "2026-02-09T09:55:03.357529Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:03.385688Z", "completed_at": "2026-02-09T09:55:03.385700Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.47678613662719727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__company_has_location_idcompany.2febe3a86c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company_has_location`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:03.313081Z", "completed_at": "2026-02-09T09:55:03.358740Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:03.386429Z", "completed_at": "2026-02-09T09:55:03.386440Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.4758150577545166, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__company_has_location_idlocation.9d14ced282", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company_has_location`\nwhere idlocation is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:03.320581Z", "completed_at": "2026-02-09T09:55:03.367340Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:03.477547Z", "completed_at": "2026-02-09T09:55:03.477559Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5192680358886719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__company_has_location_idlocation_type.ca35bd73c5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company_has_location`\nwhere idlocation_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:03.326884Z", "completed_at": "2026-02-09T09:55:03.373299Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:03.478202Z", "completed_at": "2026-02-09T09:55:03.478217Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5189967155456543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__company_has_location_idcompany__idcompany__ref_stg_oracle_lcdp__company_.30de093e0c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company_has_location`\n    where idcompany is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:03.335554Z", "completed_at": "2026-02-09T09:55:03.378201Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:03.521552Z", "completed_at": "2026-02-09T09:55:03.521565Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.5598020553588867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__contact_idcontact.56e09f7523", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontact\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__contact`\nwhere idcontact is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:03.342568Z", "completed_at": "2026-02-09T09:55:03.385102Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:03.608626Z", "completed_at": "2026-02-09T09:55:03.608640Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.6027016639709473, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__contact_idcompany__idcompany__ref_stg_oracle_lcdp__company_.c53d5cdb72", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__contact`\n    where idcompany is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:03.352461Z", "completed_at": "2026-02-09T09:55:03.427699Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:03.693998Z", "completed_at": "2026-02-09T09:55:03.694018Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.6370675563812256, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_lcdp__contact_idcontact.999556a054", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcontact as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__contact`\n  where idcontact is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:03.360046Z", "completed_at": "2026-02-09T09:55:03.435385Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:03.695706Z", "completed_at": "2026-02-09T09:55:03.695721Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6780939102172852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__contract_idcontract.235610bf68", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontract\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__contract`\nwhere idcontract is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:03.368095Z", "completed_at": "2026-02-09T09:55:03.479223Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:03.780170Z", "completed_at": "2026-02-09T09:55:03.780185Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7085797786712646, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__contract_idcompany_peer__idcompany__ref_stg_oracle_lcdp__company_.45f79c288b", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_peer as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__contract`\n    where idcompany_peer is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:03.378915Z", "completed_at": "2026-02-09T09:55:03.606546Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:03.825736Z", "completed_at": "2026-02-09T09:55:03.825750Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7300965785980225, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_lcdp__contract_idcontract.1e5edd119b", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcontract as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__contract`\n  where idcontract is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:03.429669Z", "completed_at": "2026-02-09T09:55:03.697220Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:03.955620Z", "completed_at": "2026-02-09T09:55:03.955635Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7647018432617188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__company_type_idcompany_type.f71696b851", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company_type`\nwhere idcompany_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.097463Z", "completed_at": "2026-02-09T09:55:04.152124Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:04.194523Z", "completed_at": "2026-02-09T09:55:04.194538Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.38782334327697754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__company_idcompany_type__idcompany_type__ref_stg_oracle_lcdp__company_type_.fe26fc3f8b", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_type as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company`\n    where idcompany_type is not null\n),\n\nparent as (\n    select idcompany_type as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company_type`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.108505Z", "completed_at": "2026-02-09T09:55:04.165267Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:04.196655Z", "completed_at": "2026-02-09T09:55:04.196667Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.3551027774810791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_lcdp__company_type_idcompany_type.38fa6aebc2", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcompany_type as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company_type`\n  where idcompany_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.115968Z", "completed_at": "2026-02-09T09:55:04.173262Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:04.205999Z", "completed_at": "2026-02-09T09:55:04.206012Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.39527130126953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__device_iddevice.4fdc2029ce", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect iddevice\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__device`\nwhere iddevice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.122347Z", "completed_at": "2026-02-09T09:55:04.174693Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:04.214651Z", "completed_at": "2026-02-09T09:55:04.214669Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3955211639404297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__device_idcompany_customer__idcompany__ref_stg_oracle_lcdp__company_.4bb83512a1", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_customer as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__device`\n    where idcompany_customer is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.130176Z", "completed_at": "2026-02-09T09:55:04.181233Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:04.215507Z", "completed_at": "2026-02-09T09:55:04.215523Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.3949592113494873, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__device_idcompany_owner__idcompany__ref_stg_oracle_lcdp__company_.0ac68c04a0", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_owner as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__device`\n    where idcompany_owner is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.145170Z", "completed_at": "2026-02-09T09:55:04.195152Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:04.259692Z", "completed_at": "2026-02-09T09:55:04.259705Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.43686914443969727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_lcdp__device_iddevice.e3d3e8deb3", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select iddevice as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__device`\n  where iddevice is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.137924Z", "completed_at": "2026-02-09T09:55:04.195729Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:04.260956Z", "completed_at": "2026-02-09T09:55:04.260967Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.48066067695617676, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__device_idcompany_supplier__idcompany__ref_stg_oracle_lcdp__company_.9ddfdaef6f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_supplier as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__device`\n    where idcompany_supplier is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.158116Z", "completed_at": "2026-02-09T09:55:04.197967Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:04.268598Z", "completed_at": "2026-02-09T09:55:04.268611Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4765312671661377, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_lcdp__label_idlabel.fd75d0f4cc", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlabel as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label`\n  where idlabel is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.152845Z", "completed_at": "2026-02-09T09:55:04.203673Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:04.310829Z", "completed_at": "2026-02-09T09:55:04.310842Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5607547760009766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__label_idlabel.3594ee9d46", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.167688Z", "completed_at": "2026-02-09T09:55:04.206744Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:04.311810Z", "completed_at": "2026-02-09T09:55:04.311822Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.5578081607818604, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__label_family_idlabel_family.629674f823", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel_family\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_family`\nwhere idlabel_family is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.175619Z", "completed_at": "2026-02-09T09:55:04.216721Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:04.438883Z", "completed_at": "2026-02-09T09:55:04.438895Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.6002016067504883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_lcdp__label_family_idlabel_family.8b42a15c1d", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlabel_family as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_family`\n  where idlabel_family is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.181966Z", "completed_at": "2026-02-09T09:55:04.217355Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:04.439534Z", "completed_at": "2026-02-09T09:55:04.439546Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.633080244064331, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__label_has_company_idcompany.41cf7b716b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_company`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.187303Z", "completed_at": "2026-02-09T09:55:04.260322Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:04.483081Z", "completed_at": "2026-02-09T09:55:04.483093Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6756250858306885, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__label_has_company_idlabel.0c15dfb7d8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_company`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.198593Z", "completed_at": "2026-02-09T09:55:04.354122Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:04.652929Z", "completed_at": "2026-02-09T09:55:04.652964Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.709399938583374, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__label_has_company_idcompany__idcompany__ref_stg_oracle_lcdp__company_.ca41e33708", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_company`\n    where idcompany is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.207436Z", "completed_at": "2026-02-09T09:55:04.396623Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:04.654340Z", "completed_at": "2026-02-09T09:55:04.654355Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7445011138916016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__label_has_company_idlabel__idlabel__ref_stg_oracle_lcdp__label_.4df0d71f6f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_company`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.261741Z", "completed_at": "2026-02-09T09:55:04.567794Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:04.786201Z", "completed_at": "2026-02-09T09:55:04.786218Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7577869892120361, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__label_has_contract_idcontract.3ab150b6f1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontract\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_contract`\nwhere idcontract is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.929209Z", "completed_at": "2026-02-09T09:55:04.988691Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.028229Z", "completed_at": "2026-02-09T09:55:05.028248Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.4036865234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__label_has_contract_idlabel.90ce8fe0c5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_contract`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.939312Z", "completed_at": "2026-02-09T09:55:05.008807Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.037825Z", "completed_at": "2026-02-09T09:55:05.037840Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.35961294174194336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__label_has_contract_idcontract__idcontract__ref_stg_oracle_lcdp__contract_.33c63b31d7", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcontract as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_contract`\n    where idcontract is not null\n),\n\nparent as (\n    select idcontract as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__contract`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.949377Z", "completed_at": "2026-02-09T09:55:05.012317Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.055029Z", "completed_at": "2026-02-09T09:55:05.055044Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.4499320983886719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__label_has_contract_idlabel__idlabel__ref_stg_oracle_lcdp__label_.39f4f36b80", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_contract`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.958159Z", "completed_at": "2026-02-09T09:55:05.020419Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.055837Z", "completed_at": "2026-02-09T09:55:05.055851Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.45058536529541016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__label_has_device_iddevice.004c7e4006", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect iddevice\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_device`\nwhere iddevice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.964859Z", "completed_at": "2026-02-09T09:55:05.026260Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.056577Z", "completed_at": "2026-02-09T09:55:05.056596Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.45049262046813965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__label_has_device_idlabel.d4f9e1c20f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_device`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.972102Z", "completed_at": "2026-02-09T09:55:05.028925Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.058280Z", "completed_at": "2026-02-09T09:55:05.058293Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.44916367530822754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__label_has_device_iddevice__iddevice__ref_stg_oracle_lcdp__device_.ae5bf72995", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select iddevice as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_device`\n    where iddevice is not null\n),\n\nparent as (\n    select iddevice as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__device`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.980338Z", "completed_at": "2026-02-09T09:55:05.034725Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.101978Z", "completed_at": "2026-02-09T09:55:05.101992Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.49160337448120117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__label_has_device_idlabel__idlabel__ref_stg_oracle_lcdp__label_.09bbabe6e8", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_device`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.990182Z", "completed_at": "2026-02-09T09:55:05.038466Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.146036Z", "completed_at": "2026-02-09T09:55:05.146053Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5344569683074951, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__label_has_product_idlabel.314a0a4c53", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_product`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:04.996070Z", "completed_at": "2026-02-09T09:55:05.039839Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.153348Z", "completed_at": "2026-02-09T09:55:05.153365Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.575242280960083, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__label_has_product_idproduct.01a34de4dc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_product`\nwhere idproduct is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.002028Z", "completed_at": "2026-02-09T09:55:05.045655Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.154039Z", "completed_at": "2026-02-09T09:55:05.154054Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6191089153289795, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__label_has_product_idlabel__idlabel__ref_stg_oracle_lcdp__label_.d57798963b", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_product`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.013020Z", "completed_at": "2026-02-09T09:55:05.057253Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.240780Z", "completed_at": "2026-02-09T09:55:05.240795Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.6174657344818115, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__label_has_resources_idlabel.a033219841", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_resources`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.021177Z", "completed_at": "2026-02-09T09:55:05.099337Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.284182Z", "completed_at": "2026-02-09T09:55:05.284203Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.65181565284729, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__label_has_resources_idresources.fa9890619b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.029623Z", "completed_at": "2026-02-09T09:55:05.143435Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.328200Z", "completed_at": "2026-02-09T09:55:05.328218Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6951193809509277, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__label_has_resources_idlabel__idlabel__ref_stg_oracle_lcdp__label_.914462ee04", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_resources`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.040570Z", "completed_at": "2026-02-09T09:55:05.155246Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.457888Z", "completed_at": "2026-02-09T09:55:05.457906Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7140040397644043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_oracle_lcdp__company", "compiled": true, "compiled_code": "\n\nWITH company_labels AS (\n  SELECT\n    c.idcompany as company_id,\n    c.code AS company_code,\n    c.idcompany_type as company_type_id,\n    c.name AS company_name,\n    c.created_at,\n    c.updated_at,\n    l.code AS label_code,\n    lf.code AS label_family_code,\n    loc.address1,\n    loc.address2,\n    loc.city,\n    loc.postal AS postal_code,\n    loc.country\n  FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company` c\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_company` lhc\n    ON lhc.idcompany = c.idcompany AND lhc.idlabel IS NOT NULL\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label` l\n    ON l.idlabel = lhc.idlabel\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_family` lf\n    ON lf.idlabel_family = l.idlabel_family\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company_has_location` chl\n    ON chl.idcompany = c.idcompany AND chl.idlocation_type = 1\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__location` loc\n    ON loc.idlocation = chl.idlocation\n  WHERE c.idcompany_type IN (1, 2, 4, 6)\n),\n\naggregated_labels AS (\n  SELECT\n    company_id,\n    company_type_id,\n    company_code,\n    company_name,\n    created_at,\n    updated_at,\n    address1,\n    address2,\n    city,\n    postal_code,\n    country,\n    MAX(CASE WHEN label_family_code = 'BL_GRP' THEN label_code END) AS bl_group,\n    MAX(CASE WHEN label_family_code = 'BUSMOD' THEN label_code END) AS business_model,\n    MAX(CASE WHEN label_family_code = 'DOMACT' THEN label_code END) AS activity_domain,\n    MAX(CASE WHEN label_family_code = 'GC' THEN label_code END) AS key_account,\n    MAX(CASE WHEN label_family_code = 'Gestion reliquat' THEN label_code END) AS remainder_management,\n    MAX(CASE WHEN label_family_code = 'ISACTIVE' THEN label_code END) AS is_active,\n    MAX(CASE WHEN label_family_code = 'MEF' THEN label_code END) AS invoice_delivery_mode,\n    MAX(CASE WHEN label_family_code = 'MODEH' THEN label_code END) AS model_horeca,\n    MAX(CASE WHEN label_family_code = 'MODEOF' THEN label_code END) AS model_office,\n    MAX(CASE WHEN label_family_code = 'MODER' THEN label_code END) AS model_revendeur,\n    MAX(CASE WHEN label_family_code = 'PROPRIO' THEN label_code END) AS owner,\n    MAX(CASE WHEN label_family_code = 'REPRES' THEN label_code END) AS representative,\n    MAX(CASE WHEN label_family_code = 'ZGEO' THEN label_code END) AS geo_zone\n  FROM company_labels\n  GROUP BY\n    company_id,\n    company_type_id,\n    company_code,\n    company_name,\n    created_at,\n    updated_at,\n    address1,\n    address2,\n    city,\n    postal_code,\n    country\n)\n\nSELECT\n  -- Identifiants\n  company_id,\n  company_type_id,\n\n  -- Codes et noms\n  company_code,\n  company_name,\n\n  -- Caract\u00e9ristiques entreprise\n  geo_zone,\n  activity_domain,\n  business_model,\n  key_account,\n\n  CASE\n    WHEN LOWER(is_active) = 'yes' THEN TRUE\n    ELSE FALSE\n  END AS is_active,\n\n  -- Mod\u00e8les m\u00e9tier\n  model_horeca,\n  model_office,\n  model_revendeur,\n  owner,\n\n  -- Gestion commerciale\n  representative,\n  bl_group,\n  invoice_delivery_mode,\n  remainder_management,\n\n  -- Adresse\n  address1,\n  address2,\n  city,\n  postal_code,\n  country,\n\n  -- Dates\n  created_at,\n  updated_at\n\nFROM aggregated_labels", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_oracle_lcdp__company`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.048790Z", "completed_at": "2026-02-09T09:55:05.156025Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.459281Z", "completed_at": "2026-02-09T09:55:05.459293Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7499043941497803, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_oracle_lcdp__device", "compiled": true, "compiled_code": "\n\nWITH device_labels AS (\n  SELECT\n    d.iddevice as device_id,\n    d.device_iddevice,\n    d.iddevice_type as device_type_id,\n    d.code AS device_code,\n    d.name AS device_name,\n    d.last_installation_date,\n    d.created_at,\n    d.updated_at,\n    d.idlocation as location_id,\n    d.idcompany_customer as company_id,\n    c.code AS company_code,\n    c.name AS company_name,\n    lo.access_info,\n    l.code AS label_code,\n    lf.code AS label_family_code\n  FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__device` d\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_device` lhd\n    ON lhd.iddevice = d.iddevice AND lhd.idlabel IS NOT NULL\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label` l\n    ON l.idlabel = lhd.idlabel\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_family` lf\n    ON lf.idlabel_family = l.idlabel_family\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company` c\n    ON c.idcompany = d.idcompany_customer\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__location` lo\n    ON lo.idlocation = d.idlocation\n  WHERE d.idcompany_customer IS NOT NULL\n),\n\naggregated_labels AS (\n  SELECT\n    device_id,\n    device_type_id,\n    device_iddevice,\n    company_id,\n    location_id,\n    device_code,\n    device_name,\n    company_code,\n    company_name,\n    access_info,\n    last_installation_date,\n    created_at,\n    updated_at,\n    MAX(CASE WHEN label_family_code = 'CATMACH' THEN label_code END) AS device_category,\n    MAX(CASE WHEN label_family_code = 'STATUT_MATERIEL' THEN label_code END) AS device_material_status,\n    MAX(CASE WHEN label_family_code = 'TYPEAUDIT' THEN label_code END) AS audit_type,\n    MAX(CASE WHEN label_family_code = 'TYPFONT' THEN label_code END) AS fountain_type,\n    MAX(CASE WHEN label_family_code = 'TYPSP' THEN label_code END) AS type_sp,\n    MAX(CASE WHEN label_family_code = 'TYPBROY' THEN label_code END) AS grinder_type,\n    MAX(CASE WHEN label_family_code = 'ETAT_MACHINE' THEN label_code END) AS device_state,\n    MAX(CASE WHEN label_family_code = 'TYDA' THEN label_code END) AS typology_da,\n    MAX(CASE WHEN label_family_code = 'BADGE' THEN label_code END) AS badge,\n    MAX(CASE WHEN label_family_code = 'MARQUE' THEN label_code END) AS device_brand,\n    MAX(CASE WHEN label_family_code = 'MODSP' THEN label_code END) AS model_sp,\n    MAX(CASE WHEN label_family_code = 'ISACTIVE' THEN label_code END) AS is_active,\n    MAX(CASE WHEN label_family_code = 'TYPDASA' THEN label_code END) AS type_dasa,\n    MAX(CASE WHEN label_family_code = 'MARQSP' THEN label_code END) AS brand_sp,\n    MAX(CASE WHEN label_family_code = 'TYPPERCO' THEN label_code END) AS percolator_type,\n    MAX(CASE WHEN label_family_code = 'LCDPMON' THEN label_code END) AS currency_mode\n  FROM device_labels\n  GROUP BY\n    device_id,\n    device_type_id,\n    device_iddevice,\n    company_id,\n    location_id,\n    device_code,\n    device_name,\n    company_code,\n    company_name,\n    access_info,\n    last_installation_date,\n    created_at,\n    updated_at\n)\n\nSELECT\n  -- Identifiants\n  device_id,\n  device_iddevice,\n  device_type_id,\n  company_id,\n  location_id,\n\n  -- Codes et noms\n  device_code,\n  device_name,\n  company_code,\n  company_name,\n\n  -- Caract\u00e9ristiques machine\n  device_category,\n  device_brand,\n  device_state,\n  device_material_status,\n  audit_type,\n  typology_da,\n  currency_mode,\n\n  -- Types machine\n  fountain_type,\n  grinder_type,\n  percolator_type,\n  type_sp,\n  type_dasa,\n  model_sp,\n  brand_sp,\n  badge,\n\n  -- Localisation\n  access_info as device_location,\n\n  -- Statut\n  CASE\n    WHEN LOWER(is_active) = 'yes' THEN TRUE\n    ELSE FALSE\n  END AS is_active,\n\n  -- Dates\n  last_installation_date,\n  created_at,\n  updated_at\n\nFROM aggregated_labels", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_oracle_lcdp__device`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.146712Z", "completed_at": "2026-02-09T09:55:05.458539Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.636444Z", "completed_at": "2026-02-09T09:55:05.636459Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7617754936218262, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__location_idlocation.1725f55309", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__location`\nwhere idlocation is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.787695Z", "completed_at": "2026-02-09T09:55:05.848352Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.887062Z", "completed_at": "2026-02-09T09:55:05.887083Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.31713199615478516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__company_has_location_idlocation__idlocation__ref_stg_oracle_lcdp__location_.a6411f426e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlocation as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company_has_location`\n    where idlocation is not null\n),\n\nparent as (\n    select idlocation as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__location`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.777869Z", "completed_at": "2026-02-09T09:55:05.848969Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.887846Z", "completed_at": "2026-02-09T09:55:05.887862Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.4100654125213623, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__product_type_idproduct_type.b155475ffa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__product_type`\nwhere idproduct_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.805938Z", "completed_at": "2026-02-09T09:55:05.862496Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.898835Z", "completed_at": "2026-02-09T09:55:05.898852Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3361635208129883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_lcdp__location_idlocation.4c2b99bf80", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlocation as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__location`\n  where idlocation is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.811485Z", "completed_at": "2026-02-09T09:55:05.863164Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.899603Z", "completed_at": "2026-02-09T09:55:05.899618Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.37807703018188477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_lcdp__product_type_idproduct_type.9ae9750a83", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idproduct_type as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__product_type`\n  where idproduct_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.799257Z", "completed_at": "2026-02-09T09:55:05.869924Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.901527Z", "completed_at": "2026-02-09T09:55:05.901543Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.42234158515930176, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__device_idlocation__idlocation__ref_stg_oracle_lcdp__location_.e56ee0508c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlocation as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__device`\n    where idlocation is not null\n),\n\nparent as (\n    select idlocation as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__location`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.819703Z", "completed_at": "2026-02-09T09:55:05.870594Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.902712Z", "completed_at": "2026-02-09T09:55:05.902727Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.46167659759521484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_oracle_lcdp__product", "compiled": true, "compiled_code": "\n\nWITH product_labels AS (\n  SELECT\n    p.idproduct as product_id,\n    p.idproduct_type as product_type_id,\n    p.code AS product_code,\n    p.name AS product_name,\n    p.purchase_unit_price AS purchase_unit_price,\n    -- Correction de created_at si idproduct = 1\n    CASE\n      WHEN p.idproduct = 1 AND p.created_at IS NULL THEN p.updated_at\n      ELSE p.created_at\n    END AS created_at,\n    p.updated_at,\n    l.code AS label_code,\n    lf.code AS label_family_code\n  FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__product` p\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_product` lhp\n    ON lhp.idproduct = p.idproduct\n    AND lhp.idlabel IS NOT NULL\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label` l\n    ON l.idlabel = lhp.idlabel\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_family` lf\n    ON lf.idlabel_family = l.idlabel_family\n  WHERE p.idproduct_type IN (1, 5)\n    AND (\n      CASE\n        WHEN p.idproduct = 1 AND p.created_at IS NULL THEN p.updated_at\n        ELSE p.created_at\n      END\n    ) IS NOT NULL\n),\n\naggregated_labels AS (\n  SELECT\n    product_id,\n    product_type_id,\n    product_code,\n    product_name,\n    purchase_unit_price,\n    created_at,\n    updated_at,\n    MAX(CASE WHEN label_family_code = 'FAMIPRO' THEN label_code END) AS product_family,\n    MAX(CASE WHEN label_family_code = 'GROUPRO' THEN label_code END) AS product_group,\n    MAX(CASE WHEN label_family_code = 'BIO' THEN label_code END) AS product_bio,\n    MAX(CASE WHEN label_family_code = 'ISACTIVE' THEN label_code END) AS is_active,\n    MAX(CASE WHEN label_family_code = 'MARQPRO' THEN label_code END) AS product_brand\n  FROM product_labels\n  GROUP BY\n    product_id,\n    product_type_id,\n    product_code,\n    product_name,\n    purchase_unit_price,\n    created_at,\n    updated_at\n)\n\nSELECT\n  -- Identifiants\n  product_id,\n  product_type_id,\n\n  -- Codes et noms\n  product_code,\n  product_name,\n  purchase_unit_price,\n\n  -- Caract\u00e9ristiques produit\n  product_family,\n  product_group,\n  product_brand,\n  product_bio,\n\n  CASE\n    WHEN LOWER(is_active) = 'yes' THEN TRUE\n    ELSE FALSE\n  END AS is_active,\n\n  -- Dates\n  created_at,\n  updated_at\n\nFROM aggregated_labels", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_oracle_lcdp__product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.824957Z", "completed_at": "2026-02-09T09:55:05.876371Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.904151Z", "completed_at": "2026-02-09T09:55:05.904167Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.5022470951080322, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__product_idproduct.e49c7b55bc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__product`\nwhere idproduct is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.831680Z", "completed_at": "2026-02-09T09:55:05.879124Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.905427Z", "completed_at": "2026-02-09T09:55:05.905443Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5424025058746338, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__label_has_product_idproduct__idproduct__ref_stg_oracle_lcdp__product_.bcf75eb593", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idproduct as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_product`\n    where idproduct is not null\n),\n\nparent as (\n    select idproduct as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__product`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.838978Z", "completed_at": "2026-02-09T09:55:05.888481Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:05.999358Z", "completed_at": "2026-02-09T09:55:05.999379Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5857861042022705, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__product_idproduct_type__idproduct_type__ref_stg_oracle_lcdp__product_type_.e5883efedd", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idproduct_type as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__product`\n    where idproduct_type is not null\n),\n\nparent as (\n    select idproduct_type as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__product_type`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.850346Z", "completed_at": "2026-02-09T09:55:05.898122Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:06.015914Z", "completed_at": "2026-02-09T09:55:06.015931Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.5856423377990723, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_lcdp__product_idproduct.8bd31be803", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idproduct as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__product`\n  where idproduct is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.856847Z", "completed_at": "2026-02-09T09:55:05.900275Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:06.059215Z", "completed_at": "2026-02-09T09:55:06.059231Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.6247730255126953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__resources_type_idresources_type.6367fcaf8f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__resources_type`\nwhere idresources_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.863832Z", "completed_at": "2026-02-09T09:55:05.903392Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:06.185613Z", "completed_at": "2026-02-09T09:55:06.185630Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.6689505577087402, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_lcdp__resources_type_idresources_type.a70fb54738", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idresources_type as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__resources_type`\n  where idresources_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.871268Z", "completed_at": "2026-02-09T09:55:05.906969Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:06.269665Z", "completed_at": "2026-02-09T09:55:06.269683Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.7001707553863525, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__resources_idresources.3b4ee1b7b7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.879749Z", "completed_at": "2026-02-09T09:55:05.952087Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:06.272433Z", "completed_at": "2026-02-09T09:55:06.272450Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7345583438873291, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__label_has_resources_idresources__idresources__ref_stg_oracle_lcdp__resources_.32ffd59187", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idresources as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_resources`\n    where idresources is not null\n),\n\nparent as (\n    select idresources as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__resources`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:05.889881Z", "completed_at": "2026-02-09T09:55:06.016650Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:06.316051Z", "completed_at": "2026-02-09T09:55:06.316065Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7766749858856201, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__resources_idcompany__idcompany__ref_stg_oracle_lcdp__company_.e820f4b168", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__resources`\n    where idcompany is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:06.001393Z", "completed_at": "2026-02-09T09:55:06.316668Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:06.574142Z", "completed_at": "2026-02-09T09:55:06.574159Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7774596214294434, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__resources_idlocation__idlocation__ref_stg_oracle_lcdp__location_.088181b46e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlocation as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__resources`\n    where idlocation is not null\n),\n\nparent as (\n    select idlocation as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__location`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:06.635609Z", "completed_at": "2026-02-09T09:55:06.695361Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:06.741861Z", "completed_at": "2026-02-09T09:55:06.741880Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.31079959869384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__resources_idresources_type__idresources_type__ref_stg_oracle_lcdp__resources_type_.3ba3960448", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idresources_type as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__resources`\n    where idresources_type is not null\n),\n\nparent as (\n    select idresources_type as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__resources_type`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:06.643844Z", "completed_at": "2026-02-09T09:55:06.696054Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:06.743392Z", "completed_at": "2026-02-09T09:55:06.743405Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3200798034667969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_lcdp__resources_idresources.1d1a04ed1f", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idresources as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__resources`\n  where idresources is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:06.653381Z", "completed_at": "2026-02-09T09:55:06.718362Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:06.752510Z", "completed_at": "2026-02-09T09:55:06.752527Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3164098262786865, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__label_has_task", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_label_has_task`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idtask as int64) as idtask,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n),\n\nfiltered_data as (\n    select lht.*\n    from cleaned_data lht\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task` t\n        on lht.idtask = t.idtask\n)\n\nselect * from filtered_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_task`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:06.667202Z", "completed_at": "2026-02-09T09:55:06.719403Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:06.753876Z", "completed_at": "2026-02-09T09:55:06.753891Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.3565218448638916, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__task_has_resources", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_task_has_resources`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idtask as int64) as idtask,\n        cast(idresources as int64) as idresources,\n        cast(task_status as int64) as task_status,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n),\n\n-- Synchro avec la table des t\u00e2ches pour \u00e9viter les orphelins\nfiltered_data as (\n    select cr.*\n    from cleaned_data cr\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task` t\n      on cr.idtask = t.idtask\n)\n\nselect * from filtered_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_resources`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:06.671893Z", "completed_at": "2026-02-09T09:55:06.726114Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:06.755810Z", "completed_at": "2026-02-09T09:55:06.755821Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.39875078201293945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__task_idtask.eb7cd14689", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:06.660437Z", "completed_at": "2026-02-09T09:55:06.720222Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:06.755178Z", "completed_at": "2026-02-09T09:55:06.755193Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.4416468143463135, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_lcdp__task_has_product", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`lcdp_task_has_product`\n),\n\ncleaned_data as (\n    select\n        -- IDs (cl\u00e9s primaires et \u00e9trang\u00e8res)\n        cast(idtask_has_product as int64) as idtask_has_product,\n        cast(idtask as int64) as idtask,\n        cast(idproduct as int64) as idproduct,\n        cast(idproduct_source as int64) as idproduct_source,\n        cast(idproduct_destination as int64) as idproduct_destination,\n        cast(idtax as int64) as idtax,\n        cast(idtask_has_product_associed as int64) as idtask_has_product_associed,\n        cast(iddevice as int64) as iddevice,\n        cast(idcompany_peer as int64) as idcompany_peer,\n        cast(idlocation as int64) as idlocation,\n\n        -- Colonnes texte et types\n        type_product_source,\n        type_product_destination,\n        code,\n        name,\n        cast(priceline_number as int64) as priceline_number,\n\n        -- Colonnes num\u00e9riques\n        cast(real_quantity as float64) as real_quantity,\n        cast(average_purchase_price as float64) as average_purchase_price,\n        cast(tax_rate as float64) as tax_rate,\n        cast(tax_amount as float64) as tax_amount,\n        cast(global_discount_amount as float64) as global_discount_amount,\n        cast(net_price as float64) as net_price,\n        cast(sale_amount_net_tax as float64) as sale_amount_net_tax,\n        cast(sale_amount_net as float64) as sale_amount_net,\n        cast(sale_unit_price as float64) as sale_unit_price,\n        cast(purchase_unit_price as float64) as purchase_unit_price,\n        cast(sale_amount_brut as float64) as sale_amount_brut,\n        cast(unit_coeff_multi as float64) as unit_coeff_multi,\n        cast(sale_unit_price_tax as float64) as sale_unit_price_tax,\n        cast(unit_coeff_div as float64) as unit_coeff_div,\n\n        -- Timestamps harmonis\u00e9s (standard DBT)\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n),\n\n-- S\u00e9curit\u00e9 de jointure pour \u00e9viter les orphelins\nfiltered_data as (\n    select c.*\n    from cleaned_data c\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task` t\n        on c.idtask = t.idtask\n)\n\nSELECT * FROM filtered_data\n\nWHERE\n    (\n        updated_at > (\n            SELECT MAX(updated_at)\n            FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_product`\n        )\n        OR updated_at >= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 7 DAY)\n    )\n", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:06.677595Z", "completed_at": "2026-02-09T09:55:06.728342Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:06.756607Z", "completed_at": "2026-02-09T09:55:06.756619Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.4818575382232666, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__task_idcompany_peer__idcompany__ref_stg_oracle_lcdp__company_.d0a1246825", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_peer as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task`\n    where idcompany_peer is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:06.687102Z", "completed_at": "2026-02-09T09:55:06.742738Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:06.800493Z", "completed_at": "2026-02-09T09:55:06.800509Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5236170291900635, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__task_idcontact__idcontact__ref_stg_oracle_lcdp__contact_.0cbf0a03a9", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcontact as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task`\n    where idcontact is not null\n),\n\nparent as (\n    select idcontact as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__contact`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:06.696693Z", "completed_at": "2026-02-09T09:55:06.744827Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:06.807882Z", "completed_at": "2026-02-09T09:55:06.807913Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5634770393371582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__task_iddevice__iddevice__ref_stg_oracle_lcdp__device_.c0ea59dee1", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select iddevice as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task`\n    where iddevice is not null\n),\n\nparent as (\n    select iddevice as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__device`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:06.704659Z", "completed_at": "2026-02-09T09:55:06.753203Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:06.892146Z", "completed_at": "2026-02-09T09:55:06.892163Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.5627543926239014, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__task_idlocation__idlocation__ref_stg_oracle_lcdp__location_.4e1f63f3c9", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlocation as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task`\n    where idlocation is not null\n),\n\nparent as (\n    select idlocation as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__location`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:06.711444Z", "completed_at": "2026-02-09T09:55:06.754539Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:06.936409Z", "completed_at": "2026-02-09T09:55:06.936423Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.6057887077331543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_lcdp__task_idtask.a52355e8d4", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task`\n  where idtask is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:06.720954Z", "completed_at": "2026-02-09T09:55:06.757299Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:07.020902Z", "completed_at": "2026-02-09T09:55:07.020916Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.6464087963104248, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_lcdp__appro_tasks", "compiled": true, "compiled_code": "\n\nwith passage_appro_base as (\n\n    select\n        -- Identifiants\n        t.idtask as task_id,\n        t.iddevice as device_id,\n        t.idcompany_peer as company_id,\n        t.idproduct_source as product_source_id,\n        t.type_product_source as product_source_type,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_destination as product_destination_type,\n\n        -- Codes\n        c.code as company_code,\n\n        -- Infos m\u00e9tier\n        l.access_info as task_location_info,\n        t.real_start_date as task_start_date,\n        t.real_end_date as task_end_date,\n\n        -- Status\n        ts.code as task_status_code,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task` as t\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company` as c on t.idcompany_peer = c.idcompany\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_status` as ts on t.idtask_status = ts.idtask_status\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__location` as l on t.idlocation = l.idlocation\n\n    where\n        1 = 1\n        and t.idtask_type = 32 -- PASSAGE APPROVISIONNEURS\n        and t.code_status_record = '1'\n        and t.real_start_date is not null\n\n    group by\n        t.idtask, t.iddevice, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source,\n        t.idproduct_destination, t.type_product_destination,\n        ts.code, c.code, l.access_info,\n        t.real_start_date, t.real_end_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_id,\n    device_id,\n    company_id,\n    product_source_id,\n    product_destination_id,\n\n    -- Codes\n    company_code,\n\n    -- Infos m\u00e9tier\n    product_source_type,\n    product_destination_type,\n    task_location_info,\n    task_status_code,\n    task_start_date,\n    task_end_date,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom passage_appro_base\n\n\n    where passage_appro_base.updated_at >= (\n        select max(updated_at) - interval 1 day  -- noqa: RF02\n        from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__appro_tasks`\n    )\n", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__appro_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:06.728976Z", "completed_at": "2026-02-09T09:55:06.801888Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:07.064602Z", "completed_at": "2026-02-09T09:55:07.064617Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.688422441482544, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__task_status_idtask_status.c24c60ea0e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_status\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_status`\nwhere idtask_status is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:06.734635Z", "completed_at": "2026-02-09T09:55:06.801209Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:07.063873Z", "completed_at": "2026-02-09T09:55:07.063889Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7150304317474365, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__task_idtask_status__idtask_status__ref_stg_oracle_lcdp__task_status_.af6758bb29", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idtask_status as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task`\n    where idtask_status is not null\n),\n\nparent as (\n    select idtask_status as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_status`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:06.745443Z", "completed_at": "2026-02-09T09:55:06.894064Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:07.192966Z", "completed_at": "2026-02-09T09:55:07.192980Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.758765459060669, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_lcdp__task_status_idtask_status.781dd59580", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_status as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_status`\n  where idtask_status is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:06.802633Z", "completed_at": "2026-02-09T09:55:07.149575Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:07.367219Z", "completed_at": "2026-02-09T09:55:07.367233Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7586894035339355, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__task_type_idtask_type.aeed44d71a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_type`\nwhere idtask_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:07.467590Z", "completed_at": "2026-02-09T09:55:07.549597Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:07.589365Z", "completed_at": "2026-02-09T09:55:07.589382Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.365842342376709, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__task_idtask_type__idtask_type__ref_stg_oracle_lcdp__task_type_.e7da4fb0da", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idtask_type as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task`\n    where idtask_type is not null\n),\n\nparent as (\n    select idtask_type as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_type`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:07.479327Z", "completed_at": "2026-02-09T09:55:07.556920Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:07.592235Z", "completed_at": "2026-02-09T09:55:07.592251Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.33112549781799316, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_lcdp__task_type_idtask_type.1dd4f4fcad", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_type as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_type`\n  where idtask_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:07.485770Z", "completed_at": "2026-02-09T09:55:07.558366Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:07.598315Z", "completed_at": "2026-02-09T09:55:07.598330Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.37136292457580566, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_expectations_expect_table_row_count_to_be_between_stg_oracle_neshu__company_100000__100.0f74911932", "compiled": true, "compiled_code": "\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and count(*) >= 100 and count(*) <= 100000\n)\n as expression\n\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:07.514966Z", "completed_at": "2026-02-09T09:55:07.565200Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:07.599601Z", "completed_at": "2026-02-09T09:55:07.599617Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.410170316696167, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__company_idcompany.f25c2833cc", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcompany as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n  where idcompany is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:07.508677Z", "completed_at": "2026-02-09T09:55:07.564412Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:07.598971Z", "completed_at": "2026-02-09T09:55:07.598983Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.4536161422729492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__company_idcompany.a1f4fb5739", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:07.527798Z", "completed_at": "2026-02-09T09:55:07.580144Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:07.601422Z", "completed_at": "2026-02-09T09:55:07.601436Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.4523742198944092, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__company_has_location_idlocation.a2b189f3f3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_has_location`\nwhere idlocation is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:07.522365Z", "completed_at": "2026-02-09T09:55:07.586196Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:07.602771Z", "completed_at": "2026-02-09T09:55:07.602782Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.4951746463775635, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__company_has_location_idcompany.ed01157bcd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_has_location`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:07.534977Z", "completed_at": "2026-02-09T09:55:07.588512Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:07.604159Z", "completed_at": "2026-02-09T09:55:07.604174Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5337948799133301, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__company_has_location_idlocation_type.9d6f83a35c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_has_location`\nwhere idlocation_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:07.541638Z", "completed_at": "2026-02-09T09:55:07.590885Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:07.654296Z", "completed_at": "2026-02-09T09:55:07.654310Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5742099285125732, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__company_has_location_idcompany__idcompany__ref_stg_oracle_neshu__company_.801bad8c2d", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_has_location`\n    where idcompany is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:07.550441Z", "completed_at": "2026-02-09T09:55:07.591580Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:07.655010Z", "completed_at": "2026-02-09T09:55:07.655022Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.5743229389190674, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__company_type_idcompany_type.7432808513", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_type`\nwhere idcompany_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:07.572828Z", "completed_at": "2026-02-09T09:55:07.602051Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:07.824752Z", "completed_at": "2026-02-09T09:55:07.824765Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.604499101638794, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__contact_idcontact.257cd1bcbe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontact\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contact`\nwhere idcontact is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:07.559329Z", "completed_at": "2026-02-09T09:55:07.600591Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:07.823940Z", "completed_at": "2026-02-09T09:55:07.823974Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.658607006072998, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__company_idcompany_type__idcompany_type__ref_stg_oracle_neshu__company_type_.945a4fb37c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_type as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n    where idcompany_type is not null\n),\n\nparent as (\n    select idcompany_type as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_type`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:07.567509Z", "completed_at": "2026-02-09T09:55:07.603431Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:07.867129Z", "completed_at": "2026-02-09T09:55:07.867142Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.6991720199584961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__company_type_idcompany_type.d5392ad073", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcompany_type as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_type`\n  where idcompany_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:07.581072Z", "completed_at": "2026-02-09T09:55:07.604932Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:07.949882Z", "completed_at": "2026-02-09T09:55:07.949896Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7304718494415283, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__contact_idcompany__idcompany__ref_stg_oracle_neshu__company_.2dd653d1ee", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contact`\n    where idcompany is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:07.592860Z", "completed_at": "2026-02-09T09:55:07.738291Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:08.037823Z", "completed_at": "2026-02-09T09:55:08.037839Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7406492233276367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__contact_idcontact.fc71eec394", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcontact as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contact`\n  where idcontact is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:07.647644Z", "completed_at": "2026-02-09T09:55:08.036392Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:08.212168Z", "completed_at": "2026-02-09T09:55:08.212181Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7491960525512695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__device_iddevice.27e0db8158", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect iddevice\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\nwhere iddevice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:08.313525Z", "completed_at": "2026-02-09T09:55:08.383004Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:08.414022Z", "completed_at": "2026-02-09T09:55:08.414040Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.2695045471191406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__device_idcompany_customer__idcompany__ref_stg_oracle_neshu__company_.b388815945", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_customer as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\n    where idcompany_customer is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:08.322378Z", "completed_at": "2026-02-09T09:55:08.383674Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:08.415337Z", "completed_at": "2026-02-09T09:55:08.415351Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3089907169342041, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__device_idcompany_owner__idcompany__ref_stg_oracle_neshu__company_.e812fc7be1", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_owner as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\n    where idcompany_owner is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:08.329974Z", "completed_at": "2026-02-09T09:55:08.390532Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:08.424312Z", "completed_at": "2026-02-09T09:55:08.424331Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.35084033012390137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__device_idcompany_supplier__idcompany__ref_stg_oracle_neshu__company_.44ccca01df", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_supplier as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\n    where idcompany_supplier is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:08.344050Z", "completed_at": "2026-02-09T09:55:08.404424Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:08.426206Z", "completed_at": "2026-02-09T09:55:08.426218Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.3906266689300537, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__contract_idcontract.fd3fe25c02", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontract\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contract`\nwhere idcontract is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:08.338639Z", "completed_at": "2026-02-09T09:55:08.397955Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:08.425215Z", "completed_at": "2026-02-09T09:55:08.425227Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.39238810539245605, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__device_iddevice.0ca29b8e9a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select iddevice as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\n  where iddevice is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:08.351018Z", "completed_at": "2026-02-09T09:55:08.405046Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:08.428845Z", "completed_at": "2026-02-09T09:55:08.428856Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.4341862201690674, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__contract_idcompany_peer__idcompany__ref_stg_oracle_neshu__company_.8ccff45442", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_peer as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contract`\n    where idcompany_peer is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:08.358272Z", "completed_at": "2026-02-09T09:55:08.411449Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:08.429569Z", "completed_at": "2026-02-09T09:55:08.429584Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.5147614479064941, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__contract_idcontract.7b7904e17e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcontract as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contract`\n  where idcontract is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:08.364903Z", "completed_at": "2026-02-09T09:55:08.412523Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:08.430217Z", "completed_at": "2026-02-09T09:55:08.430228Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5151221752166748, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_idlabel.f0d32bb28d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:08.371314Z", "completed_at": "2026-02-09T09:55:08.414630Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:08.480366Z", "completed_at": "2026-02-09T09:55:08.480380Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5599174499511719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__label_idlabel.9ab3749a9c", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlabel as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\n  where idlabel is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:08.376493Z", "completed_at": "2026-02-09T09:55:08.415934Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:08.522588Z", "completed_at": "2026-02-09T09:55:08.522600Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6022915840148926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_family_idlabel_family.da97b662a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel_family\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family`\nwhere idlabel_family is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:08.392875Z", "completed_at": "2026-02-09T09:55:08.427593Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:08.650198Z", "completed_at": "2026-02-09T09:55:08.650210Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.6396839618682861, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_oracle_neshu__contract", "compiled": true, "compiled_code": "\n\nWITH contract_labels AS (\n  SELECT \n    c.idcontract as contract_id,\n    c.idcompany_peer as company_id,\n    c.code AS contract_code,\n    c.engagement_raw,\n    c.engagement_clean,\n    c.nombre_collab,\n    l.code AS label_code,\n    lf.code AS label_family_code,\n    c.original_start_date,\n    c.original_end_date,\n    c.current_end_date,\n    c.termination_date,\n    c.created_at,\n    c.updated_at\n  FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contract` c\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_contract` lhc \n    ON lhc.idcontract = c.idcontract AND lhc.idlabel IS NOT NULL\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` l \n    ON l.idlabel = lhc.idlabel\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf \n    ON lf.idlabel_family = l.idlabel_family\n),\n\naggregated_labels AS ( \n  SELECT\n    contract_id,\n    company_id,\n    contract_code,\n    engagement_raw,\n    engagement_clean,\n    nombre_collab,\n    original_start_date,\n    original_end_date,\n    current_end_date,\n    termination_date,\n    created_at,\n    updated_at,\n\n    -- pivot des familles de labels\n    MAX(CASE WHEN label_family_code = 'TRANCHE_COLLAB' THEN label_code END) AS employee_range,\n    MAX(CASE WHEN label_family_code = 'PROADMAN' THEN label_code END) AS proadman,\n    MAX(CASE WHEN label_family_code = 'REGION' THEN label_code END) AS region,\n    MAX(CASE WHEN label_family_code = 'TELETRAVAIL' THEN label_code END) AS teletravail,\n    MAX(CASE WHEN label_family_code = 'ISACTIVE' THEN label_code END) AS is_active\n\n  FROM contract_labels\n  GROUP BY\n    contract_id,\n    company_id,\n    contract_code,\n    engagement_raw,\n    engagement_clean,\n    nombre_collab,\n    original_start_date,\n    original_end_date,\n    current_end_date,\n    termination_date,\n    created_at,\n    updated_at\n),\n\naggreated_contract as (\n  SELECT\n    contract_id,\n    company_id,\n    contract_code,\n    engagement_raw,\n    engagement_clean,\n    nombre_collab,\n    CASE\n      WHEN LOWER(is_active) = 'yes' THEN TRUE\n      ELSE FALSE\n    END AS is_active,\n    original_start_date,\n    original_end_date,\n    current_end_date,\n    termination_date,\n    created_at,\n    updated_at\n  FROM aggregated_labels\n)\n\nSELECT\n  contract_id,\n  company_id,\n  contract_code,\n  engagement_raw,\n  engagement_clean,\n  nombre_collab,\n  is_active,\n  original_start_date,\n  original_end_date,\n  current_end_date,\n  termination_date,\n  created_at,\n  updated_at\nFROM (\n    SELECT *,\n           ROW_NUMBER() OVER (\n               PARTITION BY company_id\n               ORDER BY current_end_date DESC, original_start_date DESC, contract_id\n           ) as rn\n    FROM aggreated_contract\n    WHERE is_active = TRUE\n) subq\nWHERE rn = 1", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__contract`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:08.385468Z", "completed_at": "2026-02-09T09:55:08.426920Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:08.649546Z", "completed_at": "2026-02-09T09:55:08.649558Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6415591239929199, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__label_family_idlabel_family.bcaa4d9c71", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlabel_family as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family`\n  where idlabel_family is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:08.398852Z", "completed_at": "2026-02-09T09:55:08.428215Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:08.650816Z", "completed_at": "2026-02-09T09:55:08.650831Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.6821589469909668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_contract_idcontract.dbb35a2666", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontract\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_contract`\nwhere idcontract is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:08.405968Z", "completed_at": "2026-02-09T09:55:08.435982Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:08.776528Z", "completed_at": "2026-02-09T09:55:08.776543Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7239909172058105, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_contract_idlabel.6c3946bf93", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_contract`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:08.416595Z", "completed_at": "2026-02-09T09:55:08.648866Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:08.867081Z", "completed_at": "2026-02-09T09:55:08.867097Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7473864555358887, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_contract_idcontract__idcontract__ref_stg_oracle_neshu__contract_.e5b8eb3f0a", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcontract as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_contract`\n    where idcontract is not null\n),\n\nparent as (\n    select idcontract as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contract`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:08.430863Z", "completed_at": "2026-02-09T09:55:08.778215Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:09.037731Z", "completed_at": "2026-02-09T09:55:09.037744Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7497255802154541, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_contract_idlabel__idlabel__ref_stg_oracle_neshu__label_.d7a7c60364", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_contract`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:09.141252Z", "completed_at": "2026-02-09T09:55:09.200452Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:09.254205Z", "completed_at": "2026-02-09T09:55:09.254219Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.33760499954223633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_company_idcompany.b2f23ed472", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_company`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:09.149183Z", "completed_at": "2026-02-09T09:55:09.208184Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:09.254920Z", "completed_at": "2026-02-09T09:55:09.254931Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.37779760360717773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_company_idlabel.1abe8b79c5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_company`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:09.157007Z", "completed_at": "2026-02-09T09:55:09.218077Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:09.255736Z", "completed_at": "2026-02-09T09:55:09.255759Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3775787353515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_company_idcompany__idcompany__ref_stg_oracle_neshu__company_.66c4f4fc27", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_company`\n    where idcompany is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:09.162187Z", "completed_at": "2026-02-09T09:55:09.220604Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:09.257756Z", "completed_at": "2026-02-09T09:55:09.257767Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.4606199264526367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_company_idlabel__idlabel__ref_stg_oracle_neshu__label_.4081c7be89", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_company`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:09.170809Z", "completed_at": "2026-02-09T09:55:09.219630Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:09.257119Z", "completed_at": "2026-02-09T09:55:09.257130Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.4603722095489502, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_device_iddevice.c9592a7b37", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect iddevice\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_device`\nwhere iddevice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:09.179264Z", "completed_at": "2026-02-09T09:55:09.252377Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:09.273025Z", "completed_at": "2026-02-09T09:55:09.273038Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.46073031425476074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_device_idlabel.2efbd34860", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_device`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:09.192188Z", "completed_at": "2026-02-09T09:55:09.252955Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:09.274284Z", "completed_at": "2026-02-09T09:55:09.274300Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5020220279693604, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_device_idlabel__idlabel__ref_stg_oracle_neshu__label_.9d728f2f84", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_device`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:09.185510Z", "completed_at": "2026-02-09T09:55:09.253555Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:09.275500Z", "completed_at": "2026-02-09T09:55:09.275511Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.5467345714569092, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_device_iddevice__iddevice__ref_stg_oracle_neshu__device_.3c06d4671c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select iddevice as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_device`\n    where iddevice is not null\n),\n\nparent as (\n    select iddevice as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:09.201223Z", "completed_at": "2026-02-09T09:55:09.256444Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:09.334212Z", "completed_at": "2026-02-09T09:55:09.334224Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5445060729980469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_product_idlabel.c10c951091", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_product`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:09.237890Z", "completed_at": "2026-02-09T09:55:09.265715Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:09.503783Z", "completed_at": "2026-02-09T09:55:09.503795Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.5817370414733887, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_resources_idresources.c45dd6d64e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:09.208857Z", "completed_at": "2026-02-09T09:55:09.258363Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:09.502996Z", "completed_at": "2026-02-09T09:55:09.503013Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6271862983703613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_product_idproduct.48b2a5d583", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_product`\nwhere idproduct is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:09.221685Z", "completed_at": "2026-02-09T09:55:09.266383Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:09.504546Z", "completed_at": "2026-02-09T09:55:09.504560Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.6681702136993408, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_product_idlabel__idlabel__ref_stg_oracle_neshu__label_.5b4fd68430", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_product`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:09.231909Z", "completed_at": "2026-02-09T09:55:09.273615Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:09.546678Z", "completed_at": "2026-02-09T09:55:09.546693Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.7093124389648438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_resources_idlabel.03938ed9d6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_resources`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:09.245080Z", "completed_at": "2026-02-09T09:55:09.274850Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:09.591908Z", "completed_at": "2026-02-09T09:55:09.591922Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7430152893066406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_resources_idlabel__idlabel__ref_stg_oracle_neshu__label_.e6142d2b42", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_resources`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:09.258998Z", "completed_at": "2026-02-09T09:55:09.505255Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:09.763576Z", "completed_at": "2026-02-09T09:55:09.763588Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7617509365081787, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_oracle_neshu__company", "compiled": true, "compiled_code": "\n\nWITH company_labels AS (\n  SELECT \n    c.idcompany as company_id,\n    c.code AS company_code,\n    c.idcompany_type as company_type_id,\n    c.name AS company_name,\n    c.created_at,\n    c.updated_at,\n    l.code AS label_code,\n    lf.code AS label_family_code,\n    loc.address1,\n    loc.address2,\n    loc.city,\n    loc.postal AS postal_code,\n    loc.country\n  FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` c\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_company` lhc \n    ON lhc.idcompany = c.idcompany AND lhc.idlabel IS NOT NULL\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` l \n    ON l.idlabel = lhc.idlabel\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf \n    ON lf.idlabel_family = l.idlabel_family\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_has_location` chl\n    ON chl.idcompany = c.idcompany AND chl.idlocation_type = 1\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location` loc\n    ON loc.idlocation = chl.idlocation\n  WHERE ((c.idcompany_type IN (1,2,4,6))\n)),\naggregated_labels AS (\n  SELECT\n    company_id,\n    company_type_id,\n    company_code,\n    company_name,\n    created_at,\n    updated_at,\n    address1,\n    address2,\n    city,\n    postal_code,\n    country,\n    MAX(CASE WHEN label_family_code = 'TRANCHE_COLLAB' THEN label_code END) AS employee_range,\n    MAX(CASE WHEN label_family_code = 'PROADMAN' THEN label_code END) AS proadman,\n    MAX(CASE WHEN label_family_code = 'REGION' THEN label_code END) AS region,\n    MAX(CASE WHEN label_family_code = 'TELETRAVAIL' THEN label_code END) AS remote_work,\n    MAX(CASE WHEN label_family_code = 'SECTEUR_ACTVITE' THEN label_code END) AS sector,\n    MAX(CASE WHEN label_family_code = 'SECTEUR_DACTIVITE' THEN label_code END) AS activity_sector,\n    MAX(CASE WHEN label_family_code = 'RCOMM' THEN label_code END) AS commercial_rep,\n    MAX(CASE WHEN label_family_code = 'HORECA' THEN label_code END) AS horeca,\n    MAX(CASE WHEN label_family_code = 'GSM_TERRAIN' THEN label_code END) AS gsm,\n    MAX(CASE WHEN label_family_code = 'KATIERS' THEN label_code END) AS katiers,\n    MAX(CASE WHEN label_family_code = 'ISACTIVE' THEN label_code END) AS is_active,\n    MAX(CASE WHEN label_family_code = 'CODE_SECTEUR' THEN label_code END) AS sector_code,\n    MAX(CASE WHEN label_family_code = 'STATUT_CLIENT' THEN label_code END) AS client_status,\n    MAX(CASE WHEN label_family_code = 'Gestion reliquat' THEN label_code END) AS remainder_management,\n    MAX(CASE WHEN label_family_code = 'MODEENVOIFACTURE' THEN label_code END) AS invoice_delivery_mode,\n    MAX(CASE WHEN label_family_code = 'BADGE' THEN label_code END) AS badge,\n    MAX(CASE WHEN label_family_code = 'RECYCLAGE' THEN label_code END) AS recycling,\n    MAX(CASE WHEN label_family_code = 'TYPECOMPAGNIE' THEN label_code END) AS company_type,\n    MAX(CASE WHEN label_family_code = 'MODELEECOCLIENT' THEN label_code END) AS company_economic_model,\n    MAX(CASE WHEN label_family_code = 'BL_GRP' THEN label_code END) AS bl_group,\n    MAX(CASE WHEN label_family_code = 'KA' THEN label_code END) AS key_account\n  FROM company_labels\n  GROUP BY\n    company_id,\n    company_type_id,\n    company_code,\n    company_name,\n    created_at,\n    updated_at,\n    address1,\n    address2,\n    city,\n    postal_code,\n    country\n)\n\nSELECT\n  -- \ud83d\udd11 Identifiants\n  company_id,\n  company_type_id,\n\n  -- \ud83d\udcc7 Codes et noms\n  company_code,\n  company_name,\n\n  -- \ud83c\udfe2 Caract\u00e9ristiques entreprise\n  region,\n  sector,\n  sector_code,\n  activity_sector,\n  employee_range,\n  company_type,\n  company_economic_model,\n  client_status,\n  \n  CASE\n    WHEN LOWER(is_active) = 'yes' THEN TRUE\n    ELSE FALSE\n  END AS is_active,\n\n  -- \ud83d\udc65 Gestion commerciale\n  key_account,\n  katiers,\n\n  -- \ud83c\udfe8 Sp\u00e9cificit\u00e9s m\u00e9tier  \n  remote_work,\n\n  -- \ud83d\udd27 Services et options\n  proadman,\n  gsm,\n  badge,\n  recycling,\n\n  -- \ud83d\udccd Adresse\n  address1,\n  address2,\n  city,\n  postal_code,\n  country,\n\n  -- \ud83d\udd52 Dates\n  created_at,\n  updated_at\n\nFROM aggregated_labels", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:09.267088Z", "completed_at": "2026-02-09T09:55:09.592633Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:09.889657Z", "completed_at": "2026-02-09T09:55:09.889670Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7834446430206299, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_oracle_neshu__device", "compiled": true, "compiled_code": "\n\nWITH device_labels AS (\n  SELECT \n    d.iddevice as device_id,\n    d.device_iddevice,\n    d.iddevice_type as device_type_id,\n    d.code AS device_code,\n    d.name AS device_name,\n    d.last_installation_date,\n    d.created_at,\n    d.updated_at,\n    d.idlocation as location_id,\n    d.idcompany_customer as company_id,\n    c.code AS company_code,\n    c.name AS company_name,\n    lo.access_info,\n    l.code AS label_code,\n    lf.code AS label_family_code\n  FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device` d\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_device` lhd \n    ON lhd.iddevice = d.iddevice AND lhd.idlabel IS NOT NULL\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` l \n    ON l.idlabel = lhd.idlabel\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf \n    ON lf.idlabel_family = l.idlabel_family\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` c \n    ON c.idcompany = d.idcompany_customer\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location` lo\n    ON lo.idlocation = d.idlocation\n  WHERE d.idcompany_customer IS NOT NULL\n),\naggregated_labels AS (\n  SELECT\n    device_id,\n    device_type_id,\n    device_iddevice,\n    company_id,\n    location_id,\n    device_code,\n    device_name,\n    company_code,\n    company_name,\n    access_info,\n    last_installation_date,\n    created_at,\n    updated_at,\n    MAX(CASE WHEN label_family_code = 'ETAT_MACHINE' THEN label_code END) AS device_state,\n    MAX(CASE WHEN label_family_code = 'STATUT_MATERIEL' THEN label_code END) AS device_material_status,\n    MAX(CASE WHEN label_family_code = 'ISACTIVE' THEN label_code END) AS is_active,\n    MAX(CASE WHEN label_family_code = 'GAMME' THEN label_code END) AS device_gamme,\n    MAX(CASE WHEN label_family_code = 'CATEGORIE' THEN label_code END) AS device_category,\n    MAX(CASE WHEN label_family_code = 'MARQUE' THEN label_code END) AS device_brand,\n    MAX(CASE WHEN label_family_code = 'MODECOMA' THEN label_code END) AS device_economic_model\n  FROM device_labels\n  GROUP BY\n    device_id,\n    device_type_id,\n    device_iddevice,\n    company_id,\n    location_id,\n    device_code,\n    device_name,\n    company_code,\n    company_name,\n    access_info,\n    last_installation_date,\n    created_at,\n    updated_at\n)\n\nSELECT\n  -- \ud83d\udd11 Identifiants\n  device_id,\n  device_iddevice,\n  device_type_id,\n  company_id,\n  location_id,\n\n  -- \ud83d\udcc7 Codes et noms\n  device_code,\n  device_name,\n  company_code,\n  company_name,\n\n  -- \ud83c\udff7\ufe0f Caract\u00e9ristiques machine\n  device_brand,\n  device_gamme,\n  device_category,\n  device_economic_model,\n\n  -- \ud83d\udccd Localisation\n  access_info as device_location,\n\n  -- \ud83c\udff7\ufe0f \u00c9tat et statu\n  CASE\n    WHEN LOWER(is_active) = 'yes' THEN TRUE\n    ELSE FALSE\n  END AS is_active,\n\n  -- \ud83d\udd52 Dates\n  last_installation_date,\n  created_at,\n  updated_at\nFROM aggregated_labels", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:09.995866Z", "completed_at": "2026-02-09T09:55:10.052706Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.096903Z", "completed_at": "2026-02-09T09:55:10.096919Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.26993608474731445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__location_idlocation.fc8389056b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location`\nwhere idlocation is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.002783Z", "completed_at": "2026-02-09T09:55:10.060533Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.098353Z", "completed_at": "2026-02-09T09:55:10.098362Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.31152796745300293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__company_has_location_idlocation__idlocation__ref_stg_oracle_neshu__location_.a32b27875e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlocation as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_has_location`\n    where idlocation is not null\n),\n\nparent as (\n    select idlocation as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.007973Z", "completed_at": "2026-02-09T09:55:10.061333Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.099643Z", "completed_at": "2026-02-09T09:55:10.099657Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.35233402252197266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__device_idlocation__idlocation__ref_stg_oracle_neshu__location_.4b2426f16b", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlocation as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\n    where idlocation is not null\n),\n\nparent as (\n    select idlocation as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.016859Z", "completed_at": "2026-02-09T09:55:10.061958Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.100312Z", "completed_at": "2026-02-09T09:55:10.100323Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.3925509452819824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__location_idlocation.1903e54c83", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlocation as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location`\n  where idlocation is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.023766Z", "completed_at": "2026-02-09T09:55:10.074606Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.101245Z", "completed_at": "2026-02-09T09:55:10.101256Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.4352447986602783, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_oracle_neshu__product", "compiled": true, "compiled_code": "\n\nWITH product_labels AS (\n  SELECT \n    p.idproduct as product_id,\n    p.idproduct_type as product_type_id,\n    p.code AS product_code,\n    p.name AS product_name,\n    p.purchase_unit_price AS purchase_unit_price,\n    -- Correction de created_at si idproduct = 1\n    CASE \n      WHEN p.idproduct = 1 AND p.created_at IS NULL THEN p.updated_at\n      ELSE p.created_at\n    END AS created_at,\n    p.updated_at,\n    l.code AS label_code,\n    lf.code AS label_family_code\n  FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_product` lhp \n    ON lhp.idproduct = p.idproduct\n    AND lhp.idlabel IS NOT NULL\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` l \n    ON l.idlabel = lhp.idlabel\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf \n    ON lf.idlabel_family = l.idlabel_family\n  WHERE p.idproduct_type IN (1, 5)\n    AND (\n      CASE \n        WHEN p.idproduct = 1 AND p.created_at IS NULL THEN p.updated_at\n        ELSE p.created_at\n      END\n    ) IS NOT NULL\n),\n\npivoted AS (\n  SELECT *\n  FROM product_labels\n  PIVOT (\n    MAX(label_code)\n    FOR label_family_code IN (\n      'MARQUEP' AS product_brand,\n      'PROPRIETAIRE' AS product_owner,\n      'FAMILLE' AS product_family, \n      'BIO' AS product_bio,\n      'PLANOETE' AS product_planoete,\n      'PLANOHIVER' AS product_planohiver,\n      'HPALME' AS product_hpalme,\n      'CLASSABC' AS product_classabc,\n      'EXPLOIT' AS product_exploit,\n      'GROUPE' AS product_group,\n      'LPTYPE' AS product_type_raw,\n      'ISACTIVE' AS isactive\n    )\n  )\n),\n\nfinal AS (\n  SELECT\n    product_id,\n    product_type_id,\n    product_code,\n    product_name,\n    purchase_unit_price,\n    product_brand,\n    product_owner,\n    product_family,\n    product_bio,\n    product_planoete,\n    product_planohiver,\n    product_hpalme,\n    product_classabc,\n    product_exploit,\n    product_group,\n    product_type_raw,\n    -- convert isactive from string to boolean\n    CASE\n      WHEN LOWER(isactive) = 'yes' THEN TRUE\n      ELSE FALSE\n    END AS is_active,\n    created_at,\n    updated_at,\n    -- logique de typologie standardis\u00e9e\n    COALESCE(\n      CASE\n        WHEN product_id = 1 THEN 'INDEFINI'\n        WHEN product_family IN ('CAFE CAPSULES', 'CAFE CAPSULES PREMIUM') THEN 'CAFE CAPS'\n        WHEN product_family IN ('THE') THEN 'THE'\n        WHEN product_group = 'ACCESSOIRES' THEN 'ACCESSOIRES'\n        WHEN product_group = 'BOISSONS FRAICHES' THEN 'BOISSONS FRAICHES'\n        WHEN product_group = 'SNACKING' THEN 'SNACKING'\n        WHEN product_code = 'VANHCHOC23' THEN 'CHOCOLATS VAN HOUTEN'\n        WHEN product_type_raw = 'BGOURMANDE' THEN 'BOISSONS GOURMANDES'\n        ELSE NULL\n      END,\n      NULLIF(TRIM(product_type_raw), ''),\n      'Non renseign\u00e9'\n    ) AS product_type\n  FROM pivoted\n),\n\nstandardized AS (\n  SELECT\n    product_id,\n    product_type_id,\n    product_code,\n    product_name,\n    purchase_unit_price,\n\n    -- FORCING champs \u00e0 'INDEFINI' si product_type est 'INDEFINI'\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_brand END AS product_brand,\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_owner END AS product_owner,\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_family END AS product_family,\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_bio END AS product_bio,\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_planoete END AS product_planoete,\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_planohiver END AS product_planohiver,\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_hpalme END AS product_hpalme,\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_classabc END AS product_classabc,\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_exploit END AS product_exploit,\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_group END AS product_group,\n\n    product_type_raw,\n    is_active,\n    created_at,\n    updated_at,\n    product_type\n  FROM final\n)\n\nSELECT  \n  product_id,\n  product_type_id,\n  product_code,\n  product_name,\n  purchase_unit_price,\n  product_brand,\n  product_owner,\n  product_family,\n  product_bio,\n  product_planoete,\n  product_planohiver,\n  product_hpalme,\n  product_classabc,\n  product_exploit,\n  product_group,\n  product_type,\n  is_active,\n  created_at,\n  updated_at\nFROM standardized", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.031414Z", "completed_at": "2026-02-09T09:55:10.088161Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.111870Z", "completed_at": "2026-02-09T09:55:10.111884Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.4350717067718506, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__product_idproduct.2c91d8d9c3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product`\nwhere idproduct is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.038317Z", "completed_at": "2026-02-09T09:55:10.096136Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.118802Z", "completed_at": "2026-02-09T09:55:10.118818Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.47476816177368164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__product_type_idproduct_type.99ebe48fd1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product_type`\nwhere idproduct_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.046108Z", "completed_at": "2026-02-09T09:55:10.097598Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.162192Z", "completed_at": "2026-02-09T09:55:10.162204Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.5156424045562744, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_product_idproduct__idproduct__ref_stg_oracle_neshu__product_.f60b56a60c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idproduct as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_product`\n    where idproduct is not null\n),\n\nparent as (\n    select idproduct as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.053563Z", "completed_at": "2026-02-09T09:55:10.099011Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.162916Z", "completed_at": "2026-02-09T09:55:10.162931Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5148205757141113, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__product_idproduct_type__idproduct_type__ref_stg_oracle_neshu__product_type_.6fbc9b03a0", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idproduct_type as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product`\n    where idproduct_type is not null\n),\n\nparent as (\n    select idproduct_type as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product_type`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.068129Z", "completed_at": "2026-02-09T09:55:10.101880Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.288347Z", "completed_at": "2026-02-09T09:55:10.288358Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.5561203956604004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__product_type_idproduct_type.9bdaa55835", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idproduct_type as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product_type`\n  where idproduct_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.062599Z", "completed_at": "2026-02-09T09:55:10.102509Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.329884Z", "completed_at": "2026-02-09T09:55:10.329897Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.5993301868438721, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__product_idproduct.ecd2622966", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idproduct as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product`\n  where idproduct is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.075229Z", "completed_at": "2026-02-09T09:55:10.110972Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.331784Z", "completed_at": "2026-02-09T09:55:10.331798Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.6408283710479736, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__resources_idresources.eb8d9bd2ca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.081582Z", "completed_at": "2026-02-09T09:55:10.112587Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.374719Z", "completed_at": "2026-02-09T09:55:10.374731Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6824791431427002, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_resources_idresources__idresources__ref_stg_oracle_neshu__resources_.400dad49ad", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idresources as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_resources`\n    where idresources is not null\n),\n\nparent as (\n    select idresources as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.089570Z", "completed_at": "2026-02-09T09:55:10.119534Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.417178Z", "completed_at": "2026-02-09T09:55:10.417191Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7217364311218262, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__resources_idcompany__idcompany__ref_stg_oracle_neshu__company_.a03aed6b41", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`\n    where idcompany is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.103263Z", "completed_at": "2026-02-09T09:55:10.332538Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.589895Z", "completed_at": "2026-02-09T09:55:10.589908Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7296116352081299, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__resources_idlocation__idlocation__ref_stg_oracle_neshu__location_.763e5415e9", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlocation as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`\n    where idlocation is not null\n),\n\nparent as (\n    select idlocation as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.113233Z", "completed_at": "2026-02-09T09:55:10.417787Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.717789Z", "completed_at": "2026-02-09T09:55:10.717802Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7670588493347168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__resources_idresources.20bf66b8cb", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idresources as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`\n  where idresources is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.821612Z", "completed_at": "2026-02-09T09:55:10.877909Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.924483Z", "completed_at": "2026-02-09T09:55:10.924501Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.26996397972106934, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__resources_type_idresources_type.9e5d062342", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources_type`\nwhere idresources_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.835106Z", "completed_at": "2026-02-09T09:55:10.885658Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.926082Z", "completed_at": "2026-02-09T09:55:10.926094Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.30861878395080566, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__resources_type_idresources_type.60d0042392", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idresources_type as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources_type`\n  where idresources_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.843554Z", "completed_at": "2026-02-09T09:55:10.886350Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.926741Z", "completed_at": "2026-02-09T09:55:10.926756Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.34960198402404785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label_has_task", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label_has_task`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idtask as int64) as idtask,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n),\n\nfiltered_data as (\n    select lht.*\n    from cleaned_data lht\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n        on lht.idtask = t.idtask\n)\n\nselect * from filtered_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.829929Z", "completed_at": "2026-02-09T09:55:10.894782Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.928135Z", "completed_at": "2026-02-09T09:55:10.928150Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3932766914367676, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__resources_idresources_type__idresources_type__ref_stg_oracle_neshu__resources_type_.0a90a13b3c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idresources_type as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`\n    where idresources_type is not null\n),\n\nparent as (\n    select idresources_type as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources_type`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.849362Z", "completed_at": "2026-02-09T09:55:10.908206Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.936333Z", "completed_at": "2026-02-09T09:55:10.936345Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.4332399368286133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__task_has_product", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_task_has_product`\n),\n\ncleaned_data as (\n    select\n        -- IDs (cl\u00e9s primaires et \u00e9trang\u00e8res)\n        cast(idtask_has_product as int64) as idtask_has_product,\n        cast(idtask as int64) as idtask,\n        cast(idproduct as int64) as idproduct,\n        cast(idproduct_source as int64) as idproduct_source,\n        cast(idproduct_destination as int64) as idproduct_destination,\n        cast(idtax as int64) as idtax,\n        cast(idtask_has_product_associed as int64) as idtask_has_product_associed,\n        cast(iddevice as int64) as iddevice,\n        cast(idcompany_peer as int64) as idcompany_peer,\n        cast(idlocation as int64) as idlocation,\n\n        -- Colonnes texte et types\n        type_product_source,\n        type_product_destination,\n        code,\n        name,\n        cast(priceline_number as int64) as priceline_number,\n\n        -- Colonnes num\u00e9riques\n        cast(real_quantity as float64) as real_quantity,\n        cast(average_purchase_price as float64) as average_purchase_price,\n        cast(tax_rate as float64) as tax_rate,\n        cast(tax_amount as float64) as tax_amount,\n        cast(global_discount_amount as float64) as global_discount_amount,\n        cast(net_price as float64) as net_price,\n        cast(sale_amount_net_tax as float64) as sale_amount_net_tax,\n        cast(sale_amount_net as float64) as sale_amount_net,\n        cast(sale_unit_price as float64) as sale_unit_price,\n        cast(purchase_unit_price as float64) as purchase_unit_price,\n        cast(sale_amount_brut as float64) as sale_amount_brut,\n        cast(unit_coeff_multi as float64) as unit_coeff_multi,\n        cast(sale_unit_price_tax as float64) as sale_unit_price_tax,\n        cast(unit_coeff_div as float64) as unit_coeff_div,\n\n        -- Timestamps harmonis\u00e9s (standard DBT)\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n),\n\n-- \u26a0\ufe0f S\u00e9curit\u00e9 de jointure pour \u00e9viter les orphelins\nfiltered_data as (\n    select c.*\n    from cleaned_data c\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n        on c.idtask = t.idtask\n)\n\nSELECT * FROM filtered_data\n\nWHERE\n    (\n        updated_at > (\n            SELECT MAX(updated_at)\n            FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product`\n        )\n        OR updated_at >= TIMESTAMP_SUB(CURRENT_TIMESTAMP(), INTERVAL 7 DAY)\n    )\n", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.858006Z", "completed_at": "2026-02-09T09:55:10.923091Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.944786Z", "completed_at": "2026-02-09T09:55:10.944802Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.4343698024749756, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__task_has_resources", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_task_has_resources`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idtask as int64) as idtask,\n        cast(idresources as int64) as idresources,\n        cast(task_status as int64) as task_status,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n),\n\n-- Synchro avec la table des t\u00e2ches pour \u00e9viter les orphelins\nfiltered_data as (\n    select cr.*\n    from cleaned_data cr\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n      on cr.idtask = t.idtask\n)\n\nselect * from filtered_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.863701Z", "completed_at": "2026-02-09T09:55:10.923754Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.946093Z", "completed_at": "2026-02-09T09:55:10.946104Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5160276889801025, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__task_idtask.2b9ac7a02d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.871351Z", "completed_at": "2026-02-09T09:55:10.925308Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:10.946829Z", "completed_at": "2026-02-09T09:55:10.946840Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.47266650199890137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_idcompany_peer__idcompany__ref_stg_oracle_neshu__company_.9ee5ef13e5", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_peer as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n    where idcompany_peer is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.878545Z", "completed_at": "2026-02-09T09:55:10.927362Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.072399Z", "completed_at": "2026-02-09T09:55:11.072414Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.517775297164917, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_idcontact__idcontact__ref_stg_oracle_neshu__contact_.ded621d0d6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcontact as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n    where idcontact is not null\n),\n\nparent as (\n    select idcontact as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contact`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.886982Z", "completed_at": "2026-02-09T09:55:10.929030Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.114706Z", "completed_at": "2026-02-09T09:55:11.114718Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.5576777458190918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_iddevice__iddevice__ref_stg_oracle_neshu__device_.03aef0389f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select iddevice as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n    where iddevice is not null\n),\n\nparent as (\n    select iddevice as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.895548Z", "completed_at": "2026-02-09T09:55:10.937879Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.158144Z", "completed_at": "2026-02-09T09:55:11.158155Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.5987594127655029, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_idlocation__idlocation__ref_stg_oracle_neshu__location_.8b4be19759", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlocation as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n    where idlocation is not null\n),\n\nparent as (\n    select idlocation as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.902120Z", "completed_at": "2026-02-09T09:55:10.937110Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.157451Z", "completed_at": "2026-02-09T09:55:11.157464Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.6418731212615967, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__task_idtask.d1f0e7ba99", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n  where idtask is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.914373Z", "completed_at": "2026-02-09T09:55:10.945445Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.200891Z", "completed_at": "2026-02-09T09:55:11.200909Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.6806199550628662, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__task_status_idtask_status.fb3f3fc34e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_status\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status`\nwhere idtask_status is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.909121Z", "completed_at": "2026-02-09T09:55:10.938703Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.159437Z", "completed_at": "2026-02-09T09:55:11.159455Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.7241263389587402, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__appro_tasks", "compiled": true, "compiled_code": "\n\nwith passage_appro_base as (\n\n    select\n        -- Identifiants\n        t.idtask as task_id,\n        t.iddevice as device_id,\n        t.idcompany_peer as company_id,\n        t.idproduct_source as product_source_id,\n        t.type_product_source as product_source_type,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_destination as product_destination_type,\n\n        -- Codes\n        c.code as company_code,\n\n        -- Infos m\u00e9tier\n        l.access_info as task_location_info,\n        t.real_start_date as task_start_date,\n        t.real_end_date as task_end_date,\n\n        -- Status\n        ts.code as task_status_code,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` as t\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` as c on t.idcompany_peer = c.idcompany\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` as ts on t.idtask_status = ts.idtask_status\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location` as l on t.idlocation = l.idlocation\n\n    where\n        1 = 1\n        and t.idtask_type = 32 -- PASSAGE APPROVISIONNEURS\n        and t.code_status_record = '1'\n        and t.real_start_date is not null\n\n    group by\n        t.idtask, t.iddevice, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source,\n        t.idproduct_destination, t.type_product_destination,\n        ts.code, c.code, l.access_info,\n        t.real_start_date, t.real_end_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_id,\n    device_id,\n    company_id,\n    product_source_id,\n    product_destination_id,\n\n    -- Codes\n    company_code,\n\n    -- Infos m\u00e9tier\n    product_source_type,\n    product_destination_type,\n    task_location_info,\n    task_status_code,\n    task_start_date,\n    task_end_date,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom passage_appro_base\n\n\n    where passage_appro_base.updated_at >= (\n        select max(updated_at) - interval 1 day  -- noqa: RF02\n        from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`\n    )\n", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.929733Z", "completed_at": "2026-02-09T09:55:11.158789Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.416669Z", "completed_at": "2026-02-09T09:55:11.416682Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7373321056365967, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_idtask_status__idtask_status__ref_stg_oracle_neshu__task_status_.8e6c31af0d", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idtask_status as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n    where idtask_status is not null\n),\n\nparent as (\n    select idtask_status as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:10.939357Z", "completed_at": "2026-02-09T09:55:11.286969Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.546999Z", "completed_at": "2026-02-09T09:55:11.547011Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7703952789306641, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__task_status_idtask_status.6822490986", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_status as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status`\n  where idtask_status is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:11.650266Z", "completed_at": "2026-02-09T09:55:11.705549Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.744836Z", "completed_at": "2026-02-09T09:55:11.744853Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.26285362243652344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_oracle_neshu_gcs__stock_products", "compiled": true, "compiled_code": "\n\nWITH resources_labels AS (\n    SELECT\n        r.idresources,\n        r.idresources_type,\n        r.code AS resources_code,\n        r.name AS resources_name,\n        lh.idlabel,\n        l.code AS label_code,\n        lf.code AS label_family_code\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` r\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_resources` lh\n        ON lh.idresources = r.idresources\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` l\n        ON l.idlabel = lh.idlabel\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf\n        ON lf.idlabel_family = l.idlabel_family\n),\n\naggregated_labels AS (\n    SELECT\n        idresources,\n        idresources_type,\n        resources_code,\n        resources_name,\n        MAX(CASE WHEN label_family_code = 'ISACTIVE' THEN label_code END) AS is_active\n    FROM resources_labels\n    WHERE idresources_type = 3  -- TYPE VEHICULE\n    GROUP BY 1,2,3,4\n),\n\nfiltered_stock AS (\n    SELECT\n        st.id_entity,\n        st.entity_type,\n        st.resources_code AS entity_code,\n        st.entity_name,\n        st.product_code,\n        st.product_name,\n        st.stock_at_date,\n        CASE WHEN st.stock_at_date = 0 THEN TRUE ELSE FALSE END AS is_out_of_stock,\n        st.date_inventaire,\n        st.stock_inventaire,\n        st.plus,\n        st.moins,\n        COALESCE(st.dpa, st.purchase_price) AS dpa,\n        st.purchase_price,\n        st.date_system,\n        st.extracted_at,\n        st.file_datetime\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu_gcs__stock_theorique` st\n    LEFT JOIN aggregated_labels al\n        ON st.id_entity = al.idresources\n        AND st.entity_type = 'RESOURCE'\n    WHERE \n        (\n            st.entity_type = 'COMPANY'\n            AND st.entity_name IN (\n                '01 - RUNGIS DEPOT PRODUITS',\n                '02 - LYON DEPOT PRODUITS',\n                '03 - BORDEAUX DEPOT PRODUITS',\n                '04 - STRASBOURG DEPOT PRODUITS',\n                '05 - PERIMES DEPOT',\n                '10 - REBUS DEPOT',\n                '13 - MARSEILLE DEPOT PRODUITS'\n            )\n        )\n        OR\n        (\n            st.entity_type = 'RESOURCE'\n            AND al.is_active = 'YES'\n        )\n)\n\nSELECT *\nFROM filtered_stock", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu_gcs__stock_products`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:11.656781Z", "completed_at": "2026-02-09T09:55:11.710804Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.746900Z", "completed_at": "2026-02-09T09:55:11.746912Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.30431032180786133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu_gcs__stock_theorique_date_system.4726062962", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_system\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu_gcs__stock_theorique`\nwhere date_system is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:11.668533Z", "completed_at": "2026-02-09T09:55:11.717339Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.748819Z", "completed_at": "2026-02-09T09:55:11.748833Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3445758819580078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu_gcs__stock_theorique_id_entity.fc4ff33db7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id_entity\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu_gcs__stock_theorique`\nwhere id_entity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:11.663357Z", "completed_at": "2026-02-09T09:55:11.711447Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.748176Z", "completed_at": "2026-02-09T09:55:11.748188Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.38686466217041016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu_gcs__stock_theorique_file_datetime.79c559191e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect file_datetime\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu_gcs__stock_theorique`\nwhere file_datetime is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:11.676381Z", "completed_at": "2026-02-09T09:55:11.729003Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.749729Z", "completed_at": "2026-02-09T09:55:11.749743Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.4267385005950928, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu_gcs__stock_theorique_product_code.4c3ae6f9c8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_code\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu_gcs__stock_theorique`\nwhere product_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:11.685229Z", "completed_at": "2026-02-09T09:55:11.745475Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.767408Z", "completed_at": "2026-02-09T09:55:11.767424Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.4274928569793701, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__task_type_idtask_type.30b55370e2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_type`\nwhere idtask_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:11.690642Z", "completed_at": "2026-02-09T09:55:11.744128Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.766641Z", "completed_at": "2026-02-09T09:55:11.766656Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.469712495803833, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_idtask_type__idtask_type__ref_stg_oracle_neshu__task_type_.b77e854b8e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idtask_type as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n    where idtask_type is not null\n),\n\nparent as (\n    select idtask_type as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_type`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:11.697847Z", "completed_at": "2026-02-09T09:55:11.746257Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.810025Z", "completed_at": "2026-02-09T09:55:11.810037Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.5104095935821533, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__task_type_idtask_type.6a67987299", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_type as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_type`\n  where idtask_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:11.706670Z", "completed_at": "2026-02-09T09:55:11.747563Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.810752Z", "completed_at": "2026-02-09T09:55:11.810765Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5074710845947266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_yuman__clients", "compiled": true, "compiled_code": "\n\nSELECT \n-- Informations Client \nclient_id,\npartner_name,\nclient_code,\nclient_name,\nclient_category,\nclient_address,\nis_active as client_is_active,\ncreated_at,\nupdated_at\n\nFROM `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients` ym", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_yuman__clients`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:11.712254Z", "completed_at": "2026-02-09T09:55:11.750388Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.977865Z", "completed_at": "2026-02-09T09:55:11.977877Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.5499939918518066, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__clients_client_id.2396172faf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect client_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients`\nwhere client_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:11.718082Z", "completed_at": "2026-02-09T09:55:11.751005Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.978514Z", "completed_at": "2026-02-09T09:55:11.978525Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.6317274570465088, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__materials_material_id.ebfe5a9c25", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect material_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`\nwhere material_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:11.723924Z", "completed_at": "2026-02-09T09:55:11.757222Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.979150Z", "completed_at": "2026-02-09T09:55:11.979162Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.6323685646057129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__materials_site_id.e77c7f24c2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect site_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`\nwhere site_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:11.737760Z", "completed_at": "2026-02-09T09:55:11.766014Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.981321Z", "completed_at": "2026-02-09T09:55:11.981332Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.7118756771087646, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__materials_material_id.0de6595c40", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select material_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`\n  where material_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:11.729791Z", "completed_at": "2026-02-09T09:55:11.758329Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:11.979860Z", "completed_at": "2026-02-09T09:55:11.979875Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7156927585601807, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__clients_client_id.f44f6dd39f", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select client_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients`\n  where client_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:11.751898Z", "completed_at": "2026-02-09T09:55:11.980681Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:12.278933Z", "completed_at": "2026-02-09T09:55:12.278967Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7291843891143799, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_yuman__materials", "compiled": true, "compiled_code": "\n\nSELECT \n-- Informations Machine\nym.material_id,\nym.site_id,\nym.material_description,\nym.material_name,\nym.material_brand,\nym.material_serial_number,\nycat.category_name,\nym.material_in_service_date,\nym.created_at,\nym.updated_at\nFROM `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials` ym\nleft join `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials_categories` ycat on ycat.category_id = ym.category_id", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_yuman__materials`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:11.758987Z", "completed_at": "2026-02-09T09:55:12.065021Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:12.364329Z", "completed_at": "2026-02-09T09:55:12.364345Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7534778118133545, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__materials_category_id__category_id__ref_stg_yuman__materials_categories_.14b0abe07f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select category_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`\n    where category_id is not null\n),\n\nparent as (\n    select category_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials_categories`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:12.467513Z", "completed_at": "2026-02-09T09:55:12.766325Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:12.807932Z", "completed_at": "2026-02-09T09:55:12.807964Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.5083885192871094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__products_product_id.4e68e010db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__products`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:12.475794Z", "completed_at": "2026-02-09T09:55:12.772333Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:12.809407Z", "completed_at": "2026-02-09T09:55:12.809420Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5477664470672607, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__products_product_id.da6f1079d3", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select product_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__products`\n  where product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:12.483459Z", "completed_at": "2026-02-09T09:55:12.773139Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:12.810639Z", "completed_at": "2026-02-09T09:55:12.810651Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.6290321350097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__purchase_orders_purchase_order_id.668459bb5c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect purchase_order_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__purchase_orders`\nwhere purchase_order_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:12.489233Z", "completed_at": "2026-02-09T09:55:12.784009Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:12.811388Z", "completed_at": "2026-02-09T09:55:12.811401Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.6295499801635742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__purchase_orders_purchase_order_line_id.d6eed878cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect purchase_order_line_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__purchase_orders`\nwhere purchase_order_line_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:12.494766Z", "completed_at": "2026-02-09T09:55:12.790070Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:12.812766Z", "completed_at": "2026-02-09T09:55:12.812779Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.6718249320983887, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__purchase_orders_product_id__product_id__ref_stg_yuman__products_.ff6ab86020", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__purchase_orders`\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__products`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:12.760862Z", "completed_at": "2026-02-09T09:55:12.807300Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:12.829159Z", "completed_at": "2026-02-09T09:55:12.829176Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.6665928363800049, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__storehouses_storehouses_id.1b6953f5b9", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select storehouses_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__storehouses`\n  where storehouses_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:12.505792Z", "completed_at": "2026-02-09T09:55:12.806590Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:12.828302Z", "completed_at": "2026-02-09T09:55:12.828321Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.7113101482391357, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__purchase_orders_purchase_order_line_id.6a52ee22dc", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select purchase_order_line_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__purchase_orders`\n  where purchase_order_line_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:12.754216Z", "completed_at": "2026-02-09T09:55:12.808629Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:12.870897Z", "completed_at": "2026-02-09T09:55:12.870913Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.753366231918335, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__storehouses_storehouses_id.9995b08d83", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect storehouses_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__storehouses`\nwhere storehouses_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:12.766938Z", "completed_at": "2026-02-09T09:55:12.810049Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:12.872998Z", "completed_at": "2026-02-09T09:55:12.873010Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.7523796558380127, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_yuman__materials_clients", "compiled": true, "compiled_code": "\n\nSELECT \n-- Informations Machine\nym.material_id,\nym.material_description,\nym.material_name,\nym.material_brand,\nym.material_serial_number,\nycat.category_name,\nym.material_in_service_date,\n-- Informations Client \nyc.client_id,\nyc.client_code,\nyc.client_address,\nyc.client_name,\nyc.partner_name,\n-- Informations Site\nys.site_id,\nys.site_address,\nys.site_name, \nys.site_postal_code\nFROM `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials` ym\nleft join `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites` ys on ym.site_id=ys.site_id\nleft join `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients` yc on ys.client_id= yc.client_id\nleft join `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials_categories` ycat on ycat.category_id = ym.category_id", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_yuman__materials_clients`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:12.773837Z", "completed_at": "2026-02-09T09:55:12.812035Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:12.999001Z", "completed_at": "2026-02-09T09:55:12.999013Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.7930946350097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_yuman__sites", "compiled": true, "compiled_code": "\n\nSELECT \n-- Informations Client \nsite_id,\nclient_id,\nagency_id,\nsite_code,\nsite_name,\nsite_address,\nsite_postal_code,\ncreated_at,\nupdated_at\n\nFROM `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites` ym", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:12.785007Z", "completed_at": "2026-02-09T09:55:12.818961Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:12.999716Z", "completed_at": "2026-02-09T09:55:12.999728Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.8339939117431641, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__sites_site_id.7b80b04fc4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect site_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\nwhere site_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:12.791019Z", "completed_at": "2026-02-09T09:55:12.822170Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:13.042664Z", "completed_at": "2026-02-09T09:55:13.042675Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.8758995532989502, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__users_user_id.9881abfe99", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__users`\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:12.778969Z", "completed_at": "2026-02-09T09:55:12.821545Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:13.042028Z", "completed_at": "2026-02-09T09:55:13.042042Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.9196712970733643, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__sites_client_id.a2a87aa602", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect client_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\nwhere client_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:12.797179Z", "completed_at": "2026-02-09T09:55:12.829786Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:13.127365Z", "completed_at": "2026-02-09T09:55:13.127380Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.9600090980529785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__materials_site_id__site_id__ref_stg_yuman__sites_.074fc55183", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select site_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`\n    where site_id is not null\n),\n\nparent as (\n    select site_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:12.813884Z", "completed_at": "2026-02-09T09:55:13.043262Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:13.382126Z", "completed_at": "2026-02-09T09:55:13.382139Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.9734015464782715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__sites_client_id__client_id__ref_stg_yuman__clients_.ab91ca52c3", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select client_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\n    where client_id is not null\n),\n\nparent as (\n    select client_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:12.822896Z", "completed_at": "2026-02-09T09:55:13.128010Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:13.426911Z", "completed_at": "2026-02-09T09:55:13.426926Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7616639137268066, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__sites_site_id.c2fdd1abc3", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select site_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\n  where site_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:13.530964Z", "completed_at": "2026-02-09T09:55:13.585316Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:13.635861Z", "completed_at": "2026-02-09T09:55:13.635878Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.2725841999053955, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__users_user_id.e4b2c79cf4", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select user_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__users`\n  where user_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:13.540245Z", "completed_at": "2026-02-09T09:55:13.598227Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:13.636644Z", "completed_at": "2026-02-09T09:55:13.636656Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3135826587677002, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorder_demands_demand_id.12776f5dd4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect demand_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\nwhere demand_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:13.546531Z", "completed_at": "2026-02-09T09:55:13.612908Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:13.638555Z", "completed_at": "2026-02-09T09:55:13.638579Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.35630202293395996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorder_demands_client_id__client_id__ref_stg_yuman__clients_.71d22ac8fd", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select client_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\n    where client_id is not null\n),\n\nparent as (\n    select client_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:13.553159Z", "completed_at": "2026-02-09T09:55:13.620238Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:13.641237Z", "completed_at": "2026-02-09T09:55:13.641252Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.43985915184020996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorder_demands_material_id__material_id__ref_stg_yuman__materials_.0624c21af4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select material_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\n    where material_id is not null\n),\n\nparent as (\n    select material_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:13.562612Z", "completed_at": "2026-02-09T09:55:13.626028Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:13.641900Z", "completed_at": "2026-02-09T09:55:13.641915Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.4388446807861328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorder_demands_site_id__site_id__ref_stg_yuman__sites_.207aca79ff", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select site_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\n    where site_id is not null\n),\n\nparent as (\n    select site_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:13.570418Z", "completed_at": "2026-02-09T09:55:13.633157Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:13.649975Z", "completed_at": "2026-02-09T09:55:13.649988Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.47913551330566406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorder_demands_user_id__user_id__ref_stg_yuman__users_.605074afbf", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select user_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\n    where user_id is not null\n),\n\nparent as (\n    select user_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__users`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:13.577531Z", "completed_at": "2026-02-09T09:55:13.635100Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:13.657960Z", "completed_at": "2026-02-09T09:55:13.657972Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.48213648796081543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__workorder_demands_demand_id.adbb788cb2", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select demand_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\n  where demand_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:13.585929Z", "completed_at": "2026-02-09T09:55:13.637348Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:13.701171Z", "completed_at": "2026-02-09T09:55:13.701182Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4811525344848633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorder_demands_categories_demand_category_id.5e8aa9b42e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect demand_category_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands_categories`\nwhere demand_category_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:13.592964Z", "completed_at": "2026-02-09T09:55:13.639175Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:13.743540Z", "completed_at": "2026-02-09T09:55:13.743554Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5222518444061279, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorder_demands_demand_category_id__demand_category_id__ref_stg_yuman__workorder_demands_categories_.871194aaa2", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select demand_category_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\n    where demand_category_id is not null\n),\n\nparent as (\n    select demand_category_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands_categories`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:13.607166Z", "completed_at": "2026-02-09T09:55:13.639809Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:13.787959Z", "completed_at": "2026-02-09T09:55:13.787977Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.561558723449707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorder_products_product_id.92e35e7cb0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:13.599065Z", "completed_at": "2026-02-09T09:55:13.640490Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:13.788661Z", "completed_at": "2026-02-09T09:55:13.788676Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6043710708618164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__workorder_demands_categories_demand_category_id.36d7a5e24e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select demand_category_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands_categories`\n  where demand_category_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:13.613628Z", "completed_at": "2026-02-09T09:55:13.642507Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:13.873421Z", "completed_at": "2026-02-09T09:55:13.873433Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6447000503540039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorder_products_product_quantity.9f9bbee75c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_quantity\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`\nwhere product_quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:13.620910Z", "completed_at": "2026-02-09T09:55:13.650603Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:13.915914Z", "completed_at": "2026-02-09T09:55:13.915930Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.6867959499359131, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorder_products_workorder_id.a954e8ba15", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect workorder_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`\nwhere workorder_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:13.628084Z", "completed_at": "2026-02-09T09:55:13.699133Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:13.959801Z", "completed_at": "2026-02-09T09:55:13.959815Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7279486656188965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorder_products_workorder_product_id.f12c8d1634", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect workorder_product_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`\nwhere workorder_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:13.643273Z", "completed_at": "2026-02-09T09:55:13.916539Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:14.215249Z", "completed_at": "2026-02-09T09:55:14.215261Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7254493236541748, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorder_products_product_id__product_id__ref_stg_yuman__products_.ed6480bad9", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__products`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:13.651376Z", "completed_at": "2026-02-09T09:55:13.958126Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:14.215880Z", "completed_at": "2026-02-09T09:55:14.215896Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__workorder_products_workorder_product_id.1591ef7ef7", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select workorder_product_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`\n  where workorder_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:14.362737Z", "completed_at": "2026-02-09T09:55:14.417664Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:14.460040Z", "completed_at": "2026-02-09T09:55:14.460055Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.2622108459472656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_nesp_tech__delais_interventions", "compiled": true, "compiled_code": "\n\nWITH inter AS (\n    -- Pr\u00e9paration des interventions \u00e9ligibles\n    -- + d\u00e9finition de la date de r\u00e9f\u00e9rence pour le calcul des d\u00e9lais\n    SELECT\n        *,\n        CASE\n            -- Si pickup avant cr\u00e9ation, on prend cr\u00e9ation comme point de d\u00e9part\n            WHEN pickup_date < creation_date THEN creation_date\n            ELSE pickup_date\n        END AS date_creation_delai\n\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_nesp_tech__interventions`\n\n    -- Filtrage des interventions trait\u00e9es uniquement\n    WHERE etat_intervention IN ('termin\u00e9e sign\u00e9e', 'signature diff\u00e9r\u00e9e')\n      AND agency IN ('evs idf', 'evs', 'evs paris', 'evs paris 2')\n),\n\nferies AS (\n    -- Table de r\u00e9f\u00e9rence des jours f\u00e9ri\u00e9s France m\u00e9tropole\n    SELECT \n        CAST(date_ferie AS DATE) AS date_ferie\n    FROM `evs-datastack-prod`.`prod_reference`.`ref_general__feries_metropole`\n),\n\nexploded AS (\n    -- Expansion journali\u00e8re : 1 ligne par jour entre cr\u00e9ation et fin\n    -- Permet un calcul pr\u00e9cis des jours et heures ouvr\u00e9es\n    SELECT\n        i.n_planning,\n        i.type,\n        i.code_machine,\n        i.date_creation_delai,\n        i.date_heure_debut,\n        i.date_heure_fin,\n\n        -- Date calendrier g\u00e9n\u00e9r\u00e9e\n        d AS cal_date,\n\n        -- Indique si le jour est f\u00e9ri\u00e9\n        f.date_ferie\n\n    FROM inter i\n\n    CROSS JOIN UNNEST(\n        GENERATE_DATE_ARRAY(\n            LEAST(DATE(i.date_creation_delai), DATE(i.date_heure_debut)),\n            DATE(i.date_heure_fin)\n        )\n    ) AS d\n\n    LEFT JOIN feries f\n        ON d = f.date_ferie\n),\n\ndelais AS (\n    -- Agr\u00e9gation des d\u00e9lais par intervention\n    SELECT\n        n_planning,\n        type,\n        code_machine,\n\n        /* ============================\n           JOURS OUVR\u00c9S AVANT D\u00c9BUT\n           ============================ */\n        COUNTIF(\n            EXTRACT(DAYOFWEEK FROM cal_date) NOT IN (1,7)\n            AND date_ferie IS NULL\n            AND cal_date <= DATE(date_heure_debut)\n        ) AS delai_jours_debut,\n\n        /* ============================\n           JOURS OUVR\u00c9S AVANT FIN\n           ============================ */\n        COUNTIF(\n            EXTRACT(DAYOFWEEK FROM cal_date) NOT IN (1,7)\n            AND date_ferie IS NULL\n            AND cal_date <= DATE(date_heure_fin)\n        ) AS delai_jours_fin,\n\n        /* ============================\n           HEURES OUVR\u00c9ES JUSQU\u2019AU D\u00c9BUT\n           ============================ */\n        SUM(\n            CASE\n                WHEN EXTRACT(DAYOFWEEK FROM cal_date) IN (1,7)\n                     OR date_ferie IS NOT NULL\n                     OR cal_date > DATE(date_heure_debut)\n                THEN 0\n                ELSE TIMESTAMP_DIFF(\n                    LEAST(\n                        date_heure_debut,\n                        TIMESTAMP_ADD(TIMESTAMP(cal_date), INTERVAL 1 DAY)\n                    ),\n                    GREATEST(date_creation_delai, TIMESTAMP(cal_date)),\n                    SECOND\n                ) / 3600\n            END\n        ) AS delai_heures_debut,\n\n        /* ============================\n           HEURES OUVR\u00c9ES JUSQU\u2019A LA FIN\n           ============================ */\n        SUM(\n            CASE\n                WHEN EXTRACT(DAYOFWEEK FROM cal_date) IN (1,7)\n                     OR date_ferie IS NOT NULL\n                     OR cal_date > DATE(date_heure_fin)\n                THEN 0\n                ELSE TIMESTAMP_DIFF(\n                    LEAST(\n                        date_heure_fin,\n                        TIMESTAMP_ADD(TIMESTAMP(cal_date), INTERVAL 1 DAY)\n                    ),\n                    GREATEST(date_creation_delai, TIMESTAMP(cal_date)),\n                    SECOND\n                ) / 3600\n            END\n        ) AS delai_heures_fin\n\n    FROM exploded\n    GROUP BY n_planning, type, code_machine\n),\n\nfinal AS (\n    -- Calcul des attributs m\u00e9tiers interm\u00e9diaires\n    SELECT\n        *,\n\n        -- D\u00e9lai total de traitement (jours ouvr\u00e9s)\n        delai_jours_fin - delai_jours_debut AS delai_traitement_jours,\n\n        -- Cat\u00e9gorisation SLA fin\n        CASE\n            WHEN delai_jours_fin <= 1 THEN 'J+0'\n            WHEN delai_jours_fin = 2 THEN 'J+1'\n            WHEN delai_jours_fin = 3 THEN 'J+2'\n            WHEN delai_jours_fin = 4 THEN 'J+3'\n            ELSE 'J++'\n        END AS type_delai_fin,\n\n        -- Cat\u00e9gorisation SLA d\u00e9but\n        CASE\n            WHEN delai_jours_debut <= 1 THEN 'J+0'\n            WHEN delai_jours_debut = 2 THEN 'J+1'\n            WHEN delai_jours_debut = 3 THEN 'J+2'\n            WHEN delai_jours_debut = 4 THEN 'J+3'\n            ELSE 'J++'\n        END AS type_delai_debut,\n\n        -- Flag bonus (logique m\u00e9tier interm\u00e9diaire)\n        CASE\n            WHEN delai_jours_fin <= 2\n                 AND type = '5'\n                 AND code_machine NOT LIKE 'ag%'\n            THEN TRUE\n            ELSE FALSE\n        END AS delai_bonus_bool,\n\n        -- Montant bonus calcul\u00e9\n        CASE\n            WHEN delai_jours_fin <= 2\n                 AND type = '5'\n                 AND code_machine NOT LIKE 'ag%'\n            THEN 15\n            ELSE 0\n        END AS delai_bonus_valeur\n\n    FROM delais\n)\n\n-- ============================\n-- SORTIE INTERMEDIATE\n-- ============================\nSELECT\n    -- Info Intervention\n    n_planning,\n    type,\n    code_machine,\n    -- Info delais debut (utile primes)\n    delai_jours_debut,\n    delai_heures_debut,\n    type_delai_debut,\n    -- Info delais fin (utiles facturation)\n    delai_jours_fin,\n    delai_heures_fin,\n    type_delai_fin,\n    delai_traitement_jours,\n    -- Info Bonus Curative\n    delai_bonus_bool,\n    delai_bonus_valeur\nFROM final", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_nesp_tech__delais_interventions`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:14.368764Z", "completed_at": "2026-02-09T09:55:14.430967Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:14.462351Z", "completed_at": "2026-02-09T09:55:14.462363Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3057069778442383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_general__feries_metropole_annee.8bddc6a4ab", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect annee\nfrom `evs-datastack-prod`.`prod_reference`.`ref_general__feries_metropole`\nwhere annee is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:14.375243Z", "completed_at": "2026-02-09T09:55:14.431599Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:14.463687Z", "completed_at": "2026-02-09T09:55:14.463699Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3464221954345703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_general__feries_metropole_date_ferie.4127e8fff9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_ferie\nfrom `evs-datastack-prod`.`prod_reference`.`ref_general__feries_metropole`\nwhere date_ferie is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:14.383519Z", "completed_at": "2026-02-09T09:55:14.437261Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:14.465043Z", "completed_at": "2026-02-09T09:55:14.465055Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.38661694526672363, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_general__feries_metropole_mois.465a60af3b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mois\nfrom `evs-datastack-prod`.`prod_reference`.`ref_general__feries_metropole`\nwhere mois is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:14.389661Z", "completed_at": "2026-02-09T09:55:14.449868Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:14.465846Z", "completed_at": "2026-02-09T09:55:14.465858Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.42711400985717773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_general__feries_metropole_nom_jour_ferie.cd4b7e3874", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nom_jour_ferie\nfrom `evs-datastack-prod`.`prod_reference`.`ref_general__feries_metropole`\nwhere nom_jour_ferie is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:14.396022Z", "completed_at": "2026-02-09T09:55:14.451615Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:14.473387Z", "completed_at": "2026-02-09T09:55:14.473402Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.46968936920166016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_mssql_sage__code_analytique_bu_code_analytique.ef2bcb0ae7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect code_analytique\nfrom `evs-datastack-prod`.`prod_reference`.`ref_mssql_sage__code_analytique_bu`\nwhere code_analytique is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:14.404478Z", "completed_at": "2026-02-09T09:55:14.460666Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:14.522114Z", "completed_at": "2026-02-09T09:55:14.522129Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.4309854507446289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_mssql_sage__pnl_bu", "compiled": true, "compiled_code": "\n\nWITH ecritures_comptables AS (\n  SELECT\n    ec_no AS numero_ecriture_comptable,\n    cg_num AS numero_compte_general,\n    ec_intitule AS libelle_ecriture,\n    ec_sens as sens_ecriture,\n    ec_date AS date_ecriture_comptable,\n    jm_date AS date_periode_facturation,\n    ec_jour AS jour_facturation,\n    timestamp(DATE_ADD(jm_date, INTERVAL (ec_jour - 1) DAY)) AS date_facturation,\n    created_at,\n    updated_at\n  FROM `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturec`\n  WHERE LEFT(CAST(cg_num AS STRING), 1) IN ('6', '7')\n),\n\nhistoric_mapping AS (\n    SELECT *\n    FROM `evs-datastack-prod`.`historic`.`update_mssql_sage__analytique_2024`\n),\n\necritures_analytiques AS (\n  SELECT\n    ec_no AS numero_ecriture_comptable,\n    n_analytique AS numero_plan_analytique,\n    ea_ligne AS numero_ligne_analytique,\n    ca_num AS code_analytique,\n    ea_montant AS montant_analytique,\n    created_at,\n    updated_at\n  FROM `evs-datastack-prod`.`prod_staging`.`stg_mssql_sage__f_ecriturea`\n),\n\nmapping_code_comptable__bu AS (\n  SELECT * FROM `evs-datastack-prod`.`prod_reference`.`ref_mssql_sage__code_comptable_bu`\n),\n\nmapping_code_analytique__bu AS (\n  SELECT * FROM `evs-datastack-prod`.`prod_reference`.`ref_mssql_sage__code_analytique_bu`\n),\n\n-- \ud83e\udde9 Jointure principale + fallback BU analytique\nmapped_with_fallback AS (\n  SELECT\n    c.numero_ecriture_comptable,\n    a.numero_plan_analytique,\n    a.numero_ligne_analytique,\n\n    a.code_analytique,\n    -- Fallback logique pour le code BU analytique\n    CASE\n      WHEN bu.code_analytique_bu IS NOT NULL THEN bu.code_analytique_bu\n      WHEN a.code_analytique LIKE 'NUN%' THEN 'NUNSHEN'\n      WHEN a.code_analytique LIKE 'HOR%' THEN 'COMMERCE'\n      WHEN a.code_analytique LIKE 'OFF%' THEN 'COMMERCE'\n      WHEN a.code_analytique LIKE 'NES%' THEN 'NESHU'\n      WHEN a.code_analytique LIKE 'SAV%' THEN 'TECHNIQUE'\n      WHEN a.code_analytique LIKE 'COM%' THEN 'COMMERCE'\n      WHEN a.code_analytique LIKE 'PDET%' THEN 'PIECES DET'\n      ELSE NULL\n    END AS code_analytique_bu,\n\n    c.numero_compte_general,\n    c.libelle_ecriture,\n    cbu.macro_categorie_pnl_bu,\n\n    c.sens_ecriture,\n\n    a.montant_analytique,\n\n    c.date_facturation,\n    c.date_ecriture_comptable,\n    c.date_periode_facturation,\n    c.jour_facturation,\n\n    -- Indicateur qualit\u00e9 : \u00e9criture sans ligne analytique\n    CASE \n      WHEN a.numero_ecriture_comptable IS NULL THEN TRUE \n      ELSE FALSE \n    END AS is_missing_analytical,\n\n    -- M\u00e9tadonn\u00e9es\n    COALESCE(a.created_at, c.created_at) AS created_at,\n    COALESCE(a.updated_at, c.updated_at) AS updated_at\n\n  FROM ecritures_comptables c\n  LEFT JOIN ecritures_analytiques a\n    ON c.numero_ecriture_comptable = a.numero_ecriture_comptable\n  LEFT JOIN mapping_code_analytique__bu bu\n    ON a.code_analytique = bu.code_analytique\n  LEFT JOIN mapping_code_comptable__bu cbu\n    ON CAST(c.numero_compte_general AS STRING) = cbu.code_comptable\n),\n\nupdated_2024 AS (\n  SELECT \n    f.numero_ecriture_comptable,\n    f.numero_plan_analytique,\n    f.numero_ligne_analytique,\n    f.code_analytique,\n    -- Remplace par le code_analytique_bu de la table de r\u00e9f\u00e9rence si disponible\n    COALESCE(u.code_analytique_bu, f.code_analytique_bu) AS code_analytique_bu,\n    f.numero_compte_general,\n    f.libelle_ecriture,\n    f.macro_categorie_pnl_bu,\n    f.sens_ecriture,\n    f.montant_analytique,\n    f.date_facturation,\n    f.date_ecriture_comptable,\n    f.date_periode_facturation,\n    f.jour_facturation,\n    f.is_missing_analytical,\n    f.created_at,\n    f.updated_at\n  FROM \n    mapped_with_fallback f  -- \u26a0\ufe0f Remplace par le nom de ta derni\u00e8re CTE avant le SELECT final\n  LEFT JOIN\n    historic_mapping u\n    ON f.numero_ecriture_comptable = u.numero_ecriture_comptable\n    AND (\n      -- Cas 1: Jointure compl\u00e8te sur les 3 cl\u00e9s quand elles sont renseign\u00e9es\n      (f.numero_plan_analytique IS NOT NULL \n       AND f.numero_ligne_analytique IS NOT NULL\n       AND f.numero_plan_analytique = u.numero_plan_analytique\n       AND f.numero_ligne_analytique = u.numero_ligne_analytique)\n      OR\n      -- Cas 2: Jointure uniquement sur numero_ecriture_comptable si les autres sont vides\n      (f.numero_plan_analytique IS NULL OR f.numero_ligne_analytique IS NULL)\n    )\n    AND EXTRACT(YEAR FROM f.date_facturation) = 2024  -- \u26a0\ufe0f Filtre uniquement l'ann\u00e9e 2024\n)\n\n-- \u2705 SELECT final (modifi\u00e9 pour utiliser updated_2024 au lieu de mapped_with_fallback)\nSELECT\n  numero_ecriture_comptable,\n  numero_plan_analytique,\n  numero_ligne_analytique,\n  code_analytique,\n  code_analytique_bu,\n  numero_compte_general,\n  libelle_ecriture,\n  macro_categorie_pnl_bu,\n  sens_ecriture,\n  montant_analytique,\n\n  CASE\n    WHEN LEFT(CAST(numero_compte_general AS STRING), 1) = '6' AND sens_ecriture = 0 THEN -ABS(montant_analytique)\n    WHEN LEFT(CAST(numero_compte_general AS STRING), 1) = '6' AND sens_ecriture = 1 THEN ABS(montant_analytique)\n    WHEN LEFT(CAST(numero_compte_general AS STRING), 1) = '7' AND sens_ecriture = 0 THEN -ABS(montant_analytique)\n    WHEN LEFT(CAST(numero_compte_general AS STRING), 1) = '7' AND sens_ecriture = 1 THEN ABS(montant_analytique)\n    ELSE montant_analytique\n  END AS montant_analytique_signe,\n\n  date_facturation,\n  date_ecriture_comptable,\n  date_periode_facturation,\n  jour_facturation,\n  is_missing_analytical,\n  \n  CASE\n    WHEN code_analytique_bu IS NULL AND is_missing_analytical = FALSE THEN TRUE\n    ELSE FALSE\n  END AS is_missing_bu_mapping,\n\n  CASE\n    WHEN macro_categorie_pnl_bu IS NULL THEN TRUE\n    ELSE FALSE\n  END AS is_missing_comptable_mapping,\n\n  created_at,\n  updated_at,\n  \nFROM updated_2024  -- \u26a0\ufe0f Chang\u00e9 de mapped_with_fallback \u00e0 updated_2024", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_mssql_sage__pnl_bu`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:14.411868Z", "completed_at": "2026-02-09T09:55:14.461640Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:14.523409Z", "completed_at": "2026-02-09T09:55:14.523420Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4702305793762207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_mssql_sage__code_comptable_bu_code_comptable.00794e5ede", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect code_comptable\nfrom `evs-datastack-prod`.`prod_reference`.`ref_mssql_sage__code_comptable_bu`\nwhere code_comptable is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:14.418396Z", "completed_at": "2026-02-09T09:55:14.462981Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:14.524160Z", "completed_at": "2026-02-09T09:55:14.524172Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5173132419586182, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_mssql_sage__code_comptable_bu_designation_compte.97015b9642", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect designation_compte\nfrom `evs-datastack-prod`.`prod_reference`.`ref_mssql_sage__code_comptable_bu`\nwhere designation_compte is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:14.424090Z", "completed_at": "2026-02-09T09:55:14.464284Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:14.566255Z", "completed_at": "2026-02-09T09:55:14.566268Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5593230724334717, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_ref_mssql_sage__code_comptable_bu_code_comptable.91b63969c2", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select code_comptable as unique_field\n  from `evs-datastack-prod`.`prod_reference`.`ref_mssql_sage__code_comptable_bu`\n  where code_comptable is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:14.438254Z", "completed_at": "2026-02-09T09:55:14.466590Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:14.692602Z", "completed_at": "2026-02-09T09:55:14.692615Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6412017345428467, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_expression_is_true_ref_nesp_tech__articles_prix_article_prix_unitaire___0.25c20464af", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__articles_prix`\n\nwhere not(article_prix_unitaire  >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:14.432302Z", "completed_at": "2026-02-09T09:55:14.467259Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:14.693278Z", "completed_at": "2026-02-09T09:55:14.693294Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6439154148101807, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_nesp_tech__pieces_detachees_pricing", "compiled": true, "compiled_code": "\n\n-- Mod\u00e8le : interventions_articles\n-- Objectif : ce mod\u00e8le combine les interventions termin\u00e9es/sign\u00e9es avec les articles consomm\u00e9s\n-- et leurs informations tarifaires, afin de calculer les montants totaux par article.\n-- Il permet d\u2019obtenir un niveau de d\u00e9tail par intervention (n_planning) et article.\n\nwith inters as (\n  -- \u00c9tape 1 : S\u00e9lection des interventions termin\u00e9es ou sign\u00e9es, filtr\u00e9es par les agences EVS\n  -- NB : on r\u00e9cup\u00e9re les dates de fin de la partie Interventions car pour les Pi\u00e8ces, c'est la date de d\u00e9but qui fait foi.\n  select \n    n_planning,\n    cast(date_heure_fin as date) as date_fin\n  from `evs-datastack-prod`.`prod_staging`.`stg_nesp_tech__interventions`\n  where etat_intervention in ('termin\u00e9e sign\u00e9e','signature diff\u00e9r\u00e9e')\n    and agency in ('evs','evs paris','evs idf','evs paris 2')\n),\nfinal as (\n  -- \u00c9tape 2 : Jointure avec les consommations d\u2019articles et leurs prix\n  select \n    i.n_planning,\n    i.date_fin,\n    extract(year from i.date_fin) as annee,\n    extract(month from i.date_fin) as mois,\n    extract(day from i.date_fin) as jour,\n    n_tech,\n    nom_tech,\n    prenom_tech,\n    art_pricing.article_ref_nomad as piece_ref_nomad,\n    art_pricing.article_desc as piece_desc,\n    quantite_article as piece_quantite,\n    article_prix_unitaire as piece_prix_unitaire,\n    (quantite_article * article_prix_unitaire) as montant_total\n  from `evs-datastack-prod`.`prod_staging`.`stg_nesp_tech__articles` art_conso\n  left join `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__articles_prix` art_pricing\n    on art_conso.code_article = lower(art_pricing.article_ref_nomad)\n  inner join inters i \n    on i.n_planning = art_conso.n_planning\n)\n-- \u00c9tape 3 : S\u00e9lection finale\nSELECT\n-- Info Interventions et Technicien\nn_planning,\ndate_fin,\nn_tech,\nnom_tech,\nprenom_tech,\n-- Info Piece detachees\npiece_ref_nomad,\npiece_desc,\npiece_prix_unitaire,\npiece_quantite,\n-- Montant a facturer\nmontant_total,\n-- M\u00e9tadonn\u00e9es dbt\nCURRENT_TIMESTAMP() as dbt_updated_at,\n'cb08451a-2004-4aaf-949e-f43cc89d5466' as dbt_invocation_id\nFROM final", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_nesp_tech__pieces_detachees_pricing`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:14.444789Z", "completed_at": "2026-02-09T09:55:14.474034Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:14.694183Z", "completed_at": "2026-02-09T09:55:14.694195Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.6840636730194092, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_nesp_tech__articles_prix_article_prix_unitaire.aabfc3df88", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect article_prix_unitaire\nfrom `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__articles_prix`\nwhere article_prix_unitaire is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:14.453127Z", "completed_at": "2026-02-09T09:55:14.522717Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:14.780602Z", "completed_at": "2026-02-09T09:55:14.780641Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7265768051147461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_nesp_tech__articles_prix_article_ref_nomad.43370917a3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect article_ref_nomad\nfrom `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__articles_prix`\nwhere article_ref_nomad is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:14.467890Z", "completed_at": "2026-02-09T09:55:14.737182Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:15.045006Z", "completed_at": "2026-02-09T09:55:15.045022Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7360255718231201, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_ref_nesp_tech__articles_prix_article_ref_nomad.7aeda94d1d", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select article_ref_nomad as unique_field\n  from `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__articles_prix`\n  where article_ref_nomad is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:14.474648Z", "completed_at": "2026-02-09T09:55:14.738703Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:15.046448Z", "completed_at": "2026-02-09T09:55:15.046460Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7775964736938477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorders_created_at.0aad14f863", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:15.189906Z", "completed_at": "2026-02-09T09:55:15.244186Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:15.286447Z", "completed_at": "2026-02-09T09:55:15.286463Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.3084080219268799, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorders_workorder_id.7745d31fcf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect workorder_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\nwhere workorder_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:15.201383Z", "completed_at": "2026-02-09T09:55:15.263192Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:15.293397Z", "completed_at": "2026-02-09T09:55:15.293409Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3074774742126465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorder_products_workorder_id__workorder_id__ref_stg_yuman__workorders_.c56a733e8f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select workorder_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`\n    where workorder_id is not null\n),\n\nparent as (\n    select workorder_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:15.209342Z", "completed_at": "2026-02-09T09:55:15.264663Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:15.295033Z", "completed_at": "2026-02-09T09:55:15.295044Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3484320640563965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorders_client_id__client_id__ref_stg_yuman__clients_.2696f7708f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select client_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\n    where client_id is not null\n),\n\nparent as (\n    select client_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:15.216592Z", "completed_at": "2026-02-09T09:55:15.270616Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:15.296302Z", "completed_at": "2026-02-09T09:55:15.296313Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.38872361183166504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorders_site_id__site_id__ref_stg_yuman__sites_.966845c1c7", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select site_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\n    where site_id is not null\n),\n\nparent as (\n    select site_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:15.223161Z", "completed_at": "2026-02-09T09:55:15.283641Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:15.297958Z", "completed_at": "2026-02-09T09:55:15.297971Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.43163561820983887, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__workorders_workorder_id.38a2d26084", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select workorder_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\n  where workorder_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:15.231753Z", "completed_at": "2026-02-09T09:55:15.285819Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:15.312678Z", "completed_at": "2026-02-09T09:55:15.312691Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.47294068336486816, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_nesp_tech__cps_montagne_primes_cp.4a9b85e92c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cp\nfrom `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__cps_montagne_primes`\nwhere cp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:15.245486Z", "completed_at": "2026-02-09T09:55:15.294385Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:15.396458Z", "completed_at": "2026-02-09T09:55:15.396473Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4303750991821289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_nesp_tech__dpts_montagne_factu_dpt.bd35b55bc5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dpt\nfrom `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__dpts_montagne_factu`\nwhere dpt is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:15.238002Z", "completed_at": "2026-02-09T09:55:15.287114Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:15.354986Z", "completed_at": "2026-02-09T09:55:15.354998Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.47519707679748535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_nesp_tech__cps_montagne_primes_montagne.fadca2dfe0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect montagne\nfrom `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__cps_montagne_primes`\nwhere montagne is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:15.252225Z", "completed_at": "2026-02-09T09:55:15.295632Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:15.399021Z", "completed_at": "2026-02-09T09:55:15.399033Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5132253170013428, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_nesp_tech__dpts_montagne_factu_montagne.6ab65cb727", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect montagne\nfrom `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__dpts_montagne_factu`\nwhere montagne is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:15.258026Z", "completed_at": "2026-02-09T09:55:15.296869Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:15.482977Z", "completed_at": "2026-02-09T09:55:15.482991Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5954861640930176, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_ref_nesp_tech__cps_montagne_primes_cp.eb36f8461c", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select cp as unique_field\n  from `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__cps_montagne_primes`\n  where cp is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:15.271630Z", "completed_at": "2026-02-09T09:55:15.298699Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:15.483731Z", "completed_at": "2026-02-09T09:55:15.483746Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.5941739082336426, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_nesp_tech__key_facturation_key_factu.048bdcc532", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect key_factu\nfrom `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__key_facturation`\nwhere key_factu is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:15.278304Z", "completed_at": "2026-02-09T09:55:15.299381Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:15.524731Z", "completed_at": "2026-02-09T09:55:15.524745Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.6358325481414795, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_nesp_tech__key_facturation_key_ref_inter.1d56f7b82b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect key_ref_inter\nfrom `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__key_facturation`\nwhere key_ref_inter is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:15.265476Z", "completed_at": "2026-02-09T09:55:15.305086Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:15.526617Z", "completed_at": "2026-02-09T09:55:15.526630Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6809568405151367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_ref_nesp_tech__dpts_montagne_factu_dpt.428a02da4b", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select dpt as unique_field\n  from `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__dpts_montagne_factu`\n  where dpt is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:15.287701Z", "completed_at": "2026-02-09T09:55:15.397183Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:15.571856Z", "completed_at": "2026-02-09T09:55:15.571868Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7123048305511475, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_nesp_tech__key_facturation_machine_clean.2892b72c20", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect machine_clean\nfrom `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__key_facturation`\nwhere machine_clean is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:15.300013Z", "completed_at": "2026-02-09T09:55:15.527702Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:15.825497Z", "completed_at": "2026-02-09T09:55:15.825513Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7243428230285645, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_nesp_tech__key_facturation_prod_factu.b6659c148d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect prod_factu\nfrom `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__key_facturation`\nwhere prod_factu is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:15.306021Z", "completed_at": "2026-02-09T09:55:15.570909Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:15.870271Z", "completed_at": "2026-02-09T09:55:15.870285Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7629578113555908, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_nesp_tech__key_facturation_tarif_factu.cd6c46326e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tarif_factu\nfrom `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__key_facturation`\nwhere tarif_factu is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.013178Z", "completed_at": "2026-02-09T09:55:16.053435Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.105212Z", "completed_at": "2026-02-09T09:55:16.105227Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.34226012229919434, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorders_category_id__category_id__ref_stg_yuman__workorders_categories_.c014c83acd", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select category_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\n    where category_id is not null\n),\n\nparent as (\n    select category_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders_categories`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.024872Z", "completed_at": "2026-02-09T09:55:16.078829Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.113805Z", "completed_at": "2026-02-09T09:55:16.113817Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3050363063812256, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_yuman_gcs__stock_articles", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- MODEL: fct_yuman__stocks\n-- PURPOSE: Suivis des stocks pi\u00e8ces Yuman par stock technicien et d\u00e9p\u00f4t journaliers\n-- AUTHOR: Cebrail AKSOY\n-- ============================================================================\n\nWITH \n-- ============================================================================\n-- 1. BASE DATA EXTRACTION\n-- ============================================================================\nfiltered_stocks as (\n\nSELECT\n    -- Attributs m\u00e9tier \n    reference, \n    designation, \n    nom_du_stock as stock,\n\n    -- Mesure\n    quantite, \n\n    -- Date\n    DATE(export_date) as stock_date,\n\n    -- M\u00e9tadonn\u00e9es d'ex\u00e9cution\n    CURRENT_TIMESTAMP() as dbt_updated_at,\n    'cb08451a-2004-4aaf-949e-f43cc89d5466' as dbt_invocation_id\n\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_yuman_gcs__stock_theorique`\n    WHERE reference is not null and nom_du_stock is not null\n)\n\nSELECT * \nFROM filtered_stocks", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_yuman_gcs__stock_articles`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.039018Z", "completed_at": "2026-02-09T09:55:16.091078Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.115410Z", "completed_at": "2026-02-09T09:55:16.115421Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.34557414054870605, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_nesp_tech__key_type_inter_type_code.6d79b5117f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect type_code\nfrom `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__key_type_inter`\nwhere type_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.045850Z", "completed_at": "2026-02-09T09:55:16.099236Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.124392Z", "completed_at": "2026-02-09T09:55:16.124408Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.4266633987426758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_nesp_tech__key_type_inter_type_inter_libelle.f367593ce2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect type_inter_libelle\nfrom `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__key_type_inter`\nwhere type_inter_libelle is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.030673Z", "completed_at": "2026-02-09T09:55:16.097879Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.117761Z", "completed_at": "2026-02-09T09:55:16.117773Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.43070387840270996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_unique_combination_of_columns_stg_yuman_gcs__stock_theorique_export_date___sdc_source_lineno.6cb5813f4f", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        export_date, _sdc_source_lineno\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman_gcs__stock_theorique`\n    group by export_date, _sdc_source_lineno\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.054082Z", "completed_at": "2026-02-09T09:55:16.111728Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.170105Z", "completed_at": "2026-02-09T09:55:16.170118Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.4278993606567383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_nesp_tech__facturation_interventions", "compiled": true, "compiled_code": "\n\nWITH inter AS (\n    -- Pr\u00e9paration des interventions :\n    -- - Ajout du flag mini_prev_bool\n    -- - Calcul du d\u00e9partement site \u00e0 partir du code postal\n    SELECT\n        int.*,\n\n        -- Flag indiquant si un article \"miniprev\" est pr\u00e9sent\n        IF(art.code_article IS NULL, FALSE, TRUE) AS mini_prev_bool,\n\n        -- Extraction du d\u00e9partement depuis le code postal\n        CAST(\n            SUBSTR(\n                LPAD(CAST(code_postal_site AS STRING), 5, '0'),\n                1,\n                2\n            ) AS INT64\n        ) AS dpt_site\n\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_nesp_tech__interventions` int\n\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_nesp_tech__articles` art\n        ON int.n_planning = art.n_planning\n       AND art.code_article = 'miniprev'\n\n    -- Filtrage temporel et m\u00e9tier\n    WHERE etat_intervention IN ('termin\u00e9e sign\u00e9e','signature diff\u00e9r\u00e9e')\n),\n\nmachines_clean AS (\n    -- R\u00e9f\u00e9rentiel machines normalis\u00e9es\n    SELECT\n        LOWER(nom_machine) AS nom_machine,\n        categorie_machine,\n        machine_clean\n    FROM `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__machines_clean`\n),\n\ndepartements_montagne AS (\n    -- Liste des d\u00e9partements factur\u00e9s en zone montagne\n    SELECT\n        CAST(dpt AS INT64) AS dpt\n    FROM `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__dpts_montagne_factu`\n    WHERE montagne = 1\n),\n\nref_type_inter AS (\n    -- R\u00e9f\u00e9rentiel de typologie d\u2019intervention (cl\u00e9 m\u00e9tier)\n    SELECT\n        CAST(type_code AS STRING) AS type_code,\n        CAST(repair_code_1 AS STRING) AS repair_code_1,\n        CAST(failure_code AS STRING) AS failure_code,\n        mini_prev_bool,\n        type_machine,\n        type_inter_libelle\n    FROM `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__key_type_inter`\n),\n\njoined AS (\n    -- Jointure centrale : attribution d\u2019un type d\u2019intervention facturable\n    SELECT\n        ma.machine_clean,\n        r.type_inter_libelle,\n        r.type_code,\n\n        -- Ajout d\u2019un suffixe Montagne si applicable\n        IF(dm.dpt IS NOT NULL, ' - Montagne', '') AS montagne_factu,\n\n        -- Construction de la cl\u00e9 de facturation\n        CONCAT(\n            r.type_code,\n            ' - ',\n            r.type_inter_libelle,\n            ' - ',\n            ma.machine_clean,\n            IF(dm.dpt IS NOT NULL, ' - Montagne', '')\n        ) AS key_factu,\n\n        i.n_planning,\n        i.type,\n        i.code_machine,\n        i.nom_machine,\n        i.repair_code_1,\n        i.failure_code,\n        i.mini_prev_bool,\n        i.dpt_site,\n        i.date_heure_fin,\n\n        -- Priorisation des r\u00e8gles de mapping via scoring\n        ROW_NUMBER() OVER (\n            PARTITION BY i.n_planning\n            ORDER BY\n                (CASE WHEN r.repair_code_1 IS NOT NULL THEN 16 ELSE 0 END) +\n                (CASE WHEN r.failure_code  IS NOT NULL THEN 8  ELSE 0 END) +\n                (CASE WHEN r.mini_prev_bool IS NOT NULL THEN 4 ELSE 0 END) +\n                (CASE WHEN r.type_machine  IS NOT NULL THEN 2 ELSE 0 END)\n            DESC\n        ) AS rn\n\n    FROM inter i\n\n    LEFT JOIN machines_clean ma\n        ON LOWER(i.nom_machine) = ma.nom_machine\n\n    LEFT JOIN ref_type_inter r\n        ON i.type = r.type_code\n       AND (i.repair_code_1 = r.repair_code_1 OR r.repair_code_1 IS NULL)\n       AND (i.failure_code = r.failure_code OR r.failure_code IS NULL)\n       AND (i.mini_prev_bool = r.mini_prev_bool OR r.mini_prev_bool IS NULL)\n       AND (ma.categorie_machine = r.type_machine OR r.type_machine IS NULL)\n\n    LEFT JOIN departements_montagne dm\n        ON i.dpt_site = dm.dpt\n),\n\nfinal AS (\n    -- Jointure avec la table de correspondance facturation\n    SELECT\n        j.n_planning,\n        j.type_inter_libelle,\n        j.key_factu,\n        kf.prod_factu,\n        kf.tarif_factu\n    FROM joined j\n\n    LEFT JOIN `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__key_facturation` kf\n        ON kf.key_ref_inter = j.key_factu\n\n    -- S\u00e9lection de la r\u00e8gle la plus prioritaire\n    WHERE j.rn = 1\n)\n\n-- ============================\n-- SELECT FINAL EXPLICITE\n-- ============================\nSELECT\n    n_planning,\n    type_inter_libelle,\n    key_factu,\n    prod_factu,\n    tarif_factu\nFROM final", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_nesp_tech__facturation_interventions`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.060060Z", "completed_at": "2026-02-09T09:55:16.113038Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.177026Z", "completed_at": "2026-02-09T09:55:16.177041Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.46949052810668945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_nesp_tech__machines_clean_machine_clean.9b050b470c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect machine_clean\nfrom `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__machines_clean`\nwhere machine_clean is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.068208Z", "completed_at": "2026-02-09T09:55:16.114729Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.219124Z", "completed_at": "2026-02-09T09:55:16.219136Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.4686605930328369, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_nesp_tech__machines_clean_nom_machine.e07861289a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nom_machine\nfrom `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__machines_clean`\nwhere nom_machine is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.073706Z", "completed_at": "2026-02-09T09:55:16.116247Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.219826Z", "completed_at": "2026-02-09T09:55:16.219841Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5105140209197998, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_ref_nesp_tech__machines_clean_nom_machine.a310d77c77", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select nom_machine as unique_field\n  from `evs-datastack-prod`.`prod_reference`.`ref_nesp_tech__machines_clean`\n  where nom_machine is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.080047Z", "completed_at": "2026-02-09T09:55:16.117055Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.260772Z", "completed_at": "2026-02-09T09:55:16.260786Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5501823425292969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_oracle_neshu__groupement_machine_device_group.b7ccc7bacb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_group\nfrom `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__groupement_machine`\nwhere device_group is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.093595Z", "completed_at": "2026-02-09T09:55:16.123647Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.262712Z", "completed_at": "2026-02-09T09:55:16.262728Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.591541051864624, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_oracle_neshu__vehicule_roadman", "compiled": true, "compiled_code": "\n\nselect \n    r.idresources as resources_vehicule_id,\n    r.code as vehicule_code,\n    r.resources_idresources as resources_roadman_id, \n    r.name as roadman_code,\n    r.created_at,\n    r.updated_at,\n    g.gea_code \nfrom `prod_staging.stg_oracle_neshu__resources` r\nleft join `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__roadman_gea` g \n    on g.roadman_code = r.name\nwhere r.idresources_type = 3", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__vehicule_roadman`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.085766Z", "completed_at": "2026-02-09T09:55:16.126555Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.347014Z", "completed_at": "2026-02-09T09:55:16.347025Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6352198123931885, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_oracle_neshu__groupement_machine_device_name.d7b80898ca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_name\nfrom `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__groupement_machine`\nwhere device_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.106212Z", "completed_at": "2026-02-09T09:55:16.170771Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.349801Z", "completed_at": "2026-02-09T09:55:16.349813Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.6650981903076172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_oracle_neshu__roadman_gea_roadman_code.821eb0e0f4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect roadman_code\nfrom `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__roadman_gea`\nwhere roadman_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.099832Z", "completed_at": "2026-02-09T09:55:16.169321Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.349070Z", "completed_at": "2026-02-09T09:55:16.349082Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.7101812362670898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_oracle_neshu__roadman_gea_gea_code.486a4f1e6c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect gea_code\nfrom `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__roadman_gea`\nwhere gea_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.118566Z", "completed_at": "2026-02-09T09:55:16.347651Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.605018Z", "completed_at": "2026-02-09T09:55:16.605034Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7295525074005127, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_oracle_neshu__valo_machine_capacite_device_group.2c5ceeae33", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_group\nfrom `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__valo_machine_capacite`\nwhere device_group is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.171418Z", "completed_at": "2026-02-09T09:55:16.475614Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.733548Z", "completed_at": "2026-02-09T09:55:16.733561Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7606503963470459, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_oracle_neshu__valo_machine_capacite_product_code.1333e96e14", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_code\nfrom `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__valo_machine_capacite`\nwhere product_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.832751Z", "completed_at": "2026-02-09T09:55:16.877780Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.925211Z", "completed_at": "2026-02-09T09:55:16.925229Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.33937764167785645, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_oracle_neshu__valo_machine_capacite_quantite.4f86698dfa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantite\nfrom `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__valo_machine_capacite`\nwhere quantite is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.842445Z", "completed_at": "2026-02-09T09:55:16.890278Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.932167Z", "completed_at": "2026-02-09T09:55:16.932179Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.29926204681396484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__cp_metropole_Code_Postal.0356e1fc65", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Code_Postal\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_metropole`\nwhere Code_Postal is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.850048Z", "completed_at": "2026-02-09T09:55:16.897281Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.934909Z", "completed_at": "2026-02-09T09:55:16.934921Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.38507652282714844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__dpt_metropole_Departement.3c351e6222", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Departement\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__dpt_metropole`\nwhere Departement is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.857583Z", "completed_at": "2026-02-09T09:55:16.905393Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.935769Z", "completed_at": "2026-02-09T09:55:16.935781Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.3859531879425049, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__machine_clean_Machine_Brut.ceef954725", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Machine_Brut\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__machine_clean`\nwhere Machine_Brut is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.863067Z", "completed_at": "2026-02-09T09:55:16.916698Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.937270Z", "completed_at": "2026-02-09T09:55:16.937285Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.42813587188720703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__machine_clean_famille_neshu.0a22381e35", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect famille_neshu\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__machine_clean`\nwhere famille_neshu is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.872696Z", "completed_at": "2026-02-09T09:55:16.931185Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:16.945365Z", "completed_at": "2026-02-09T09:55:16.945379Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.427199125289917, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_ref_yuman__machine_clean_Machine_Brut.033bf2c401", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select Machine_Brut as unique_field\n  from `evs-datastack-prod`.`prod_reference`.`ref_yuman__machine_clean`\n  where Machine_Brut is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.879611Z", "completed_at": "2026-02-09T09:55:16.933651Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.037149Z", "completed_at": "2026-02-09T09:55:17.037165Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4700958728790283, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__cp_tech_cp_depart_int.1b4b77c02d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cp_depart_int\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_tech`\nwhere cp_depart_int is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.885195Z", "completed_at": "2026-02-09T09:55:16.934317Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.037814Z", "completed_at": "2026-02-09T09:55:17.037826Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.5119757652282715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__cp_tech_cp_depart_texte.00a98e1658", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cp_depart_texte\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_tech`\nwhere cp_depart_texte is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.892193Z", "completed_at": "2026-02-09T09:55:16.936449Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.123793Z", "completed_at": "2026-02-09T09:55:17.123808Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5122556686401367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__cp_tech_cp_final_int.288a2ba1f4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cp_final_int\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_tech`\nwhere cp_final_int is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.899703Z", "completed_at": "2026-02-09T09:55:16.937929Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.164820Z", "completed_at": "2026-02-09T09:55:17.164838Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5538163185119629, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__cp_tech_cp_final_texte.d6b7d11241", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cp_final_texte\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_tech`\nwhere cp_final_texte is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.906148Z", "completed_at": "2026-02-09T09:55:16.938585Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.166656Z", "completed_at": "2026-02-09T09:55:17.166672Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.5937490463256836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__cp_tech_libelle_cp.c4aa5a2041", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect libelle_cp\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_tech`\nwhere libelle_cp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.911601Z", "completed_at": "2026-02-09T09:55:16.987657Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.209541Z", "completed_at": "2026-02-09T09:55:17.209556Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6360077857971191, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__cp_tech_nom_departement.ef0dca4aed", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nom_departement\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_tech`\nwhere nom_departement is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.918514Z", "completed_at": "2026-02-09T09:55:16.988393Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.211340Z", "completed_at": "2026-02-09T09:55:17.211351Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.6701128482818604, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__cp_tech_num_departement_texte.751d020def", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect num_departement_texte\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_tech`\nwhere num_departement_texte is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.926026Z", "completed_at": "2026-02-09T09:55:17.030757Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.213390Z", "completed_at": "2026-02-09T09:55:17.213403Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.7067661285400391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__cp_tech_region_tech.7a4ee11a21", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect region_tech\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_tech`\nwhere region_tech is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:16.939311Z", "completed_at": "2026-02-09T09:55:17.208625Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.426693Z", "completed_at": "2026-02-09T09:55:17.426709Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7310364246368408, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__tarification_clean_KEY.2b49d3a4de", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect KEY\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__tarification_clean`\nwhere KEY is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:17.031434Z", "completed_at": "2026-02-09T09:55:17.299398Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.556977Z", "completed_at": "2026-02-09T09:55:17.556990Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7596368789672852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__tarification_clean_Montant.f1c516c949", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Montant\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__tarification_clean`\nwhere Montant is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:17.653234Z", "completed_at": "2026-02-09T09:55:17.699801Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.742451Z", "completed_at": "2026-02-09T09:55:17.742467Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.38532376289367676, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_ref_yuman__cp_tech_cp_depart_int.d6a5969a3a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select cp_depart_int as unique_field\n  from `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_tech`\n  where cp_depart_int is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:17.661592Z", "completed_at": "2026-02-09T09:55:17.708923Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.754923Z", "completed_at": "2026-02-09T09:55:17.754968Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3835568428039551, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_ref_yuman__cp_tech_cp_depart_texte.561497fd6a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select cp_depart_texte as unique_field\n  from `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_tech`\n  where cp_depart_texte is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:17.668606Z", "completed_at": "2026-02-09T09:55:17.714680Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.756330Z", "completed_at": "2026-02-09T09:55:17.756342Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.35038256645202637, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_yuman__demands_workorders_enriched", "compiled": true, "compiled_code": "\n\n-- =====================================================================\n-- Model: int_yuman__demands_workorders_enriched\n-- Description:\n--   Vue unifi\u00e9e des demandes d'intervention et des interventions\n--   enrichie avec les informations clients, sites, mat\u00e9riels et utilisateurs.\n--   Ce mod\u00e8le sert de base interm\u00e9diaire (int) entre les donn\u00e9es staging\n--   et les mod\u00e8les marts m\u00e9tier.\n-- =====================================================================\n\n-- =======================\n-- CTE 1 : Demandes d'intervention\n-- =======================\nwith workorder_demands as (\n    select\n        demand_id,\n        workorder_id,\n        material_id,\n        site_id,\n        client_id,\n        user_id,\n        demand_description,\n        demand_status,\n        demand_reject_comment,\n        created_at as demand_created_at,\n        updated_at as demand_updated_at,\n        demand_category_id\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\n),\n\n-- =======================\n-- CTE 2 : Cat\u00e9gories de demandes\n-- =======================\nworkorder_demands_categories as (\n    select\n        demand_category_id,\n        demand_category_name\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands_categories`\n),\n\n-- =======================\n-- CTE 3 : Interventions (workorders)\n-- =======================\nworkorders as (\n    select\n        workorder_id,\n        technician_id,\n        workorder_number,\n        workorder_category,\n        workorder_type,\n        workorder_status,\n        workorder_title,\n        workorder_description,\n        workorder_report,\n        workorder_technician_name,\n        workorder_date_creation,\n        workorder_motif_non_intervention,\n        workorder_detail_non_intervention,\n        workorder_raison_mise_en_pause,\n        workorder_explication_mise_en_pause,\n        workorder_necessite_intervenir,\n        workorder_si_non_pourquoi,\n        date_planned,\n        date_started,\n        date_done\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\n),\n\n-- =======================\n-- CTE 4 : Clients\n-- =======================\nclients as (\n    select\n        client_id,\n        partner_name,\n        client_code,\n        client_name,\n        client_category,\n        is_active as client_is_active\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients`\n),\n\n-- =======================\n-- CTE 5 : Sites\n-- =======================\nsites as (\n    select\n        site_id,\n        site_code,\n        site_name,\n        site_address,\n        site_postal_code\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\n),\n\n-- =======================\n-- CTE 6 : Mat\u00e9riels\n-- =======================\nmaterials as (\n    select\n        material_id,\n        material_name,\n        material_serial_number,\n        material_brand,\n        material_description,\n        material_in_service_date,\n        category_id\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`\n),\n\n-- =======================\n-- CTE 7 : Cat\u00e9gories de mat\u00e9riels\n-- =======================\nmaterials_categories as (\n    select\n        category_id,\n        category_name as material_category\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials_categories`\n),\n\n-- =======================\n-- CTE 8 : Utilisateurs\n-- =======================\nusers as (\n    select\n        user_id,\n        manager_id,\n        user_name,\n        user_type,\n        is_manager_as_technician\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__users`\n),\n\n-- =======================\n-- CTE 9 : Mapping techniciens - agences\n-- =======================\ntech_agence_mapping as (\n    select\n        nom,\n        prenom,\n        agence,\n        equipe\n    from `evs-datastack-prod`.`prod_reference`.`ref_yuman__tech_agence`\n)\n\n-- =======================\n-- FINAL SELECT : Assemblage des donn\u00e9es\n-- =======================\nselect\n    -- === Demandes d'intervention ===\n    wd.demand_id,\n    wd.workorder_id,\n    wd.material_id,\n    wd.site_id,\n    wd.client_id,\n    wd.user_id,\n    wd.demand_description,\n    wd.demand_status,\n    wd.demand_reject_comment,\n    wd.demand_created_at,\n    wd.demand_updated_at,\n\n    -- === Cat\u00e9gorie demande ===\n    wdc.demand_category_name,\n\n    -- === Interventions ===\n    wo.technician_id,\n    wo.workorder_number,\n    wo.workorder_category,\n    wo.workorder_type,\n    wo.workorder_status,\n    wo.workorder_title,\n    wo.workorder_description,\n    wo.workorder_report,\n    wo.workorder_technician_name,\n    wo.workorder_date_creation,\n    wo.workorder_motif_non_intervention,\n    wo.workorder_detail_non_intervention,\n    wo.workorder_raison_mise_en_pause,\n    wo.workorder_explication_mise_en_pause,\n    wo.workorder_necessite_intervenir,\n    wo.workorder_si_non_pourquoi,\n    wo.date_planned,\n    wo.date_started,\n    wo.date_done,\n\n    -- === Clients ===\n    cl.partner_name,\n    cl.client_code,\n    cl.client_name,\n    cl.client_category,\n    cl.client_is_active,\n\n    -- === Sites ===\n    s.site_code,\n    s.site_name,\n    s.site_address,\n    s.site_postal_code,\n\n    -- === Mat\u00e9riels ===\n    m.material_name,\n    m.material_serial_number,\n    m.material_brand,\n    m.material_description,\n    m.material_in_service_date,\n\n    -- === Cat\u00e9gories de mat\u00e9riels ===\n    mc.material_category,\n\n    -- === Utilisateurs ===\n    u.manager_id,\n    u.user_name,\n    u.user_type,\n    u.is_manager_as_technician,\n\n    -- === Agence du technicien (via mapping) ===\n    tam.agence as technician_agency_stock,\n    tam.equipe as technician_equipe\n\nfrom workorder_demands wd\nleft join workorder_demands_categories wdc\n    on wd.demand_category_id = wdc.demand_category_id\n\nfull join workorders wo\n    on wd.workorder_id = wo.workorder_id\n\nleft join clients cl\n    on wd.client_id = cl.client_id\n\nleft join sites s\n    on wd.site_id = s.site_id\n\nleft join materials m\n    on wd.material_id = m.material_id\n\nleft join materials_categories mc\n    on m.category_id = mc.category_id\n\nleft join users u\n    on wd.user_id = u.user_id\n\nleft join tech_agence_mapping tam\n    on UPPER(TRIM(REGEXP_REPLACE(wo.workorder_technician_name, r'\\[INACTIF\\]\\s*', ''))) = \n       UPPER(TRIM(tam.nom || ' ' || tam.prenom))", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_yuman__demands_workorders_enriched`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:17.685102Z", "completed_at": "2026-02-09T09:55:17.740048Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.759596Z", "completed_at": "2026-02-09T09:55:17.759611Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.38799142837524414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__tech_agence_equipe.7d6b2c4631", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect equipe\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__tech_agence`\nwhere equipe is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:17.678778Z", "completed_at": "2026-02-09T09:55:17.741090Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.761629Z", "completed_at": "2026-02-09T09:55:17.761644Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.43291234970092773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__tech_agence_agence.8dfdfc78fb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect agence\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__tech_agence`\nwhere agence is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:17.694279Z", "completed_at": "2026-02-09T09:55:17.743134Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.769852Z", "completed_at": "2026-02-09T09:55:17.769867Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.4297769069671631, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__tech_agence_nom.7412555376", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nom\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__tech_agence`\nwhere nom is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:17.701298Z", "completed_at": "2026-02-09T09:55:17.755646Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.854203Z", "completed_at": "2026-02-09T09:55:17.854217Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4697535037994385, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__tech_agence_prenom.e1a98e0826", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect prenom\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__tech_agence`\nwhere prenom is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:17.715408Z", "completed_at": "2026-02-09T09:55:17.758807Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.902938Z", "completed_at": "2026-02-09T09:55:17.902980Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5091710090637207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__technicien_clean_TECHNICIEN.95ff6d83a2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect TECHNICIEN\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__technicien_clean`\nwhere TECHNICIEN is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:17.709580Z", "completed_at": "2026-02-09T09:55:17.758021Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.861705Z", "completed_at": "2026-02-09T09:55:17.861724Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.5529358386993408, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_ref_yuman__technicien_clean_EQUIPE.ca1bade4fe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect EQUIPE\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__technicien_clean`\nwhere EQUIPE is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:17.728150Z", "completed_at": "2026-02-09T09:55:17.760358Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.945290Z", "completed_at": "2026-02-09T09:55:17.945309Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.5511579513549805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_fct_gac__sinistres_sg_n_de_sinistre.ad92ef022c", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select n_de_sinistre as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`fct_gac__sinistres_sg`\n  where n_de_sinistre is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:17.722458Z", "completed_at": "2026-02-09T09:55:17.761011Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.947127Z", "completed_at": "2026-02-09T09:55:17.947139Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5938272476196289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_gac__sinistres_sg_date_sinistre.a6ba2e19bf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_sinistre\nfrom `evs-datastack-prod`.`prod_marts`.`fct_gac__sinistres_sg`\nwhere date_sinistre is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:17.734962Z", "completed_at": "2026-02-09T09:55:17.762298Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:17.947857Z", "completed_at": "2026-02-09T09:55:17.947869Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6299126148223877, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_fct_gac__sinistres_sg_reference_gac.73868576b1", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select reference_gac as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`fct_gac__sinistres_sg`\n  where reference_gac is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:17.743707Z", "completed_at": "2026-02-09T09:55:17.854797Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:18.034016Z", "completed_at": "2026-02-09T09:55:18.034028Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.6652817726135254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_lcdp__company_company_id.bfaaf61f88", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_lcdp__company`\nwhere company_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:17.749325Z", "completed_at": "2026-02-09T09:55:17.855460Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:18.076125Z", "completed_at": "2026-02-09T09:55:18.076141Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6983129978179932, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_oracle_lcdp__company_company_id.45a964919b", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select company_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_oracle_lcdp__company`\n  where company_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:17.762904Z", "completed_at": "2026-02-09T09:55:18.031255Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:18.288534Z", "completed_at": "2026-02-09T09:55:18.288551Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7301802635192871, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_lcdp__device_device_id.7cc6f3cf42", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_lcdp__device`\nwhere device_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:17.856217Z", "completed_at": "2026-02-09T09:55:18.161326Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:18.378117Z", "completed_at": "2026-02-09T09:55:18.378129Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7497491836547852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_oracle_lcdp__device_device_id.86a168c9c7", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select device_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_oracle_lcdp__device`\n  where device_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:18.474218Z", "completed_at": "2026-02-09T09:55:18.513830Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:18.569760Z", "completed_at": "2026-02-09T09:55:18.569778Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.3936166763305664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_lcdp__product_product_id.42e90d53c1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_lcdp__product`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:18.481803Z", "completed_at": "2026-02-09T09:55:18.523792Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:18.579201Z", "completed_at": "2026-02-09T09:55:18.579217Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3924705982208252, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_oracle_lcdp__product_product_id.b679fa6eb4", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select product_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_oracle_lcdp__product`\n  where product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:18.492181Z", "completed_at": "2026-02-09T09:55:18.542496Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:18.586722Z", "completed_at": "2026-02-09T09:55:18.586738Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.34937071800231934, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__label_has_task_idlabel.a7ab2fd7da", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_task`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:18.498392Z", "completed_at": "2026-02-09T09:55:18.549786Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:18.589499Z", "completed_at": "2026-02-09T09:55:18.589511Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3981480598449707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__label_has_task_idtask.d2b1b18bad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_task`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:18.505834Z", "completed_at": "2026-02-09T09:55:18.568309Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:18.592822Z", "completed_at": "2026-02-09T09:55:18.592834Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.43949389457702637, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__label_has_task_idlabel__idlabel__ref_stg_oracle_lcdp__label_.cf72d1b73b", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_task`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:18.514581Z", "completed_at": "2026-02-09T09:55:18.579898Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:18.684276Z", "completed_at": "2026-02-09T09:55:18.684288Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.4402430057525635, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__label_has_task_idtask__idtask__ref_stg_oracle_lcdp__task_.a48979bf0f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idtask as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_task`\n    where idtask is not null\n),\n\nparent as (\n    select idtask as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:18.524491Z", "completed_at": "2026-02-09T09:55:18.587436Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:18.727016Z", "completed_at": "2026-02-09T09:55:18.727029Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4831721782684326, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_lcdp__pointage", "compiled": true, "compiled_code": "\n\nWITH\nresources_roadman AS (\n    SELECT\n        thr.idtask,\n        MIN(r.idresources) AS idresources_roadman,\n        MIN(r.code) AS code_roadman\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_resources` thr\n    JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__resources` r\n        ON thr.idresources = r.idresources\n       AND r.idresources_type = 2 -- Resources Roadman\n    GROUP BY thr.idtask\n),\npointage AS (\n    SELECT\n        t.idtask,\n        t.iddevice,\n        t.idcompany_peer AS idcompany,\n        ts.code AS status_code,\n        t.real_start_date AS date_pointage,\n        la.code AS label_code,\n        t.created_at,\n        t.updated_at,\n        t.extracted_at\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task` t\n    JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_task` lht ON t.idtask = lht.idtask\n    JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label` la ON lht.idlabel = la.idlabel AND la.idlabel in (2685,2686)  -- START_DAY & END_DAY uniquement\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_status` ts ON t.idtask_status = ts.idtask_status\n    WHERE t.idtask_type = 194 -- TASK TYPE POINTAGE\n      AND t.code_status_record = '1' -- Enregistrement actif\n),\npointage_resources AS (\n    SELECT\n        p.*,\n        r.idresources_roadman,\n        r.code_roadman\n    FROM pointage p\n    LEFT JOIN resources_roadman r ON p.idtask = r.idtask\n)\n\n-- SELECT FINAL\nSELECT\n    idtask as task_id,\n    idcompany as company_id,\n    idresources_roadman as resources_roadman_id,\n    code_roadman as roadman_code,\n    status_code,\n    label_code,\n    date_pointage as date_pointage,\n    DATE(date_pointage) as date_pointage_jour,\n    created_at,\n    updated_at,\n    extracted_at\nFROM pointage_resources\nWHERE idresources_roadman is not null", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__pointage`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:18.530188Z", "completed_at": "2026-02-09T09:55:18.588097Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:18.728311Z", "completed_at": "2026-02-09T09:55:18.728323Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5242609977722168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__task_has_resources_idresources.5e8532e7f7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:18.536469Z", "completed_at": "2026-02-09T09:55:18.590605Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:18.735641Z", "completed_at": "2026-02-09T09:55:18.735654Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.5639753341674805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__task_has_resources_idtask.1acd33e6ec", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_resources`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:18.551885Z", "completed_at": "2026-02-09T09:55:18.591540Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:18.777704Z", "completed_at": "2026-02-09T09:55:18.777719Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5637626647949219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__task_has_resources_idtask__idtask__ref_stg_oracle_lcdp__task_.9f1ada7245", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idtask as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_resources`\n    where idtask is not null\n),\n\nparent as (\n    select idtask as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:18.544715Z", "completed_at": "2026-02-09T09:55:18.592233Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:18.778373Z", "completed_at": "2026-02-09T09:55:18.778385Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.6059081554412842, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__task_has_resources_idresources__idresources__ref_stg_oracle_lcdp__resources_.9c864b7fb7", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idresources as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_resources`\n    where idresources is not null\n),\n\nparent as (\n    select idresources as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__resources`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:18.559041Z", "completed_at": "2026-02-09T09:55:18.593434Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:18.779141Z", "completed_at": "2026-02-09T09:55:18.779154Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6399135589599609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_lcdp__chargement_tasks", "compiled": true, "compiled_code": "\n\nwith chargement_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.iddevice as device_id,\n        t.idcompany_peer as company_id,\n        t.idlocation as location_id,\n        t.idproduct_source as product_source_id,\n        t.type_product_source as product_source_type,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_destination as product_destination_type,\n        thp.idproduct as product_id,\n\n        -- Codes\n        c.code as company_code,\n        d.code as device_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n        la.code as load_type_code,\n\n        -- Informations m\u00e9tier\n        l.access_info as task_location_info,\n        t.real_start_date as task_start_date,\n\n        -- Informations de conditionnement\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity as base_unit_quantity,\n        thp.net_price as product_unit_price_task,\n        p.purchase_unit_price as product_unit_price_latest,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as load_quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) * p.purchase_unit_price as load_valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_product` thp on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company` c on c.idcompany = t.idcompany_peer\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__device` d on d.iddevice = t.iddevice\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__product` p on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__location` l on l.idlocation = t.idlocation\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_task` lht on t.idtask = lht.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label` la on lht.idlabel = la.idlabel\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_status` ts on t.idtask_status = ts.idtask_status\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 13 -- CHARGEMENT MACHINE\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.iddevice, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source, t.idlocation,\n        t.idproduct_destination, t.type_product_destination,\n        thp.idproduct,\n        c.code, d.code, p.code,\n        ts.code, la.code,\n        l.access_info, t.real_start_date,\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity,\n        thp.net_price,\n        p.purchase_unit_price,\n        t.updated_at, t.created_at, t.extracted_at\n),\n\nressources_roadman as (\n    select\n        thr.idtask,\n        min(r.idresources) as roadman_id,\n        min(r.code) as roadman_code\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_resources` thr\n    join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__resources` r on r.idresources = thr.idresources\n    where r.idresources_type = 2\n    group by thr.idtask\n),\n\nressources_vehicle as (\n    select\n        thr.idtask,\n        min(r.idresources) as vehicle_id,\n        min(r.code) as vehicle_code\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_resources` thr\n    join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__resources` r on r.idresources = thr.idresources\n    where r.idresources_type = 3\n    group by thr.idtask\n),\n\nchargement_enrichi as (\n    select\n        cb.*,\n        rr.roadman_id,\n        rr.roadman_code,\n        rv.vehicle_id,\n        rv.vehicle_code\n    from chargement_base cb\n    left join ressources_roadman rr on cb.task_id = rr.idtask\n    left join ressources_vehicle rv on cb.task_id = rv.idtask\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    device_id,\n    company_id,\n    product_id,\n    location_id,\n    product_source_id,\n    product_destination_id,\n    roadman_id,\n    vehicle_id,\n\n    -- Codes\n    company_code,\n    device_code,\n    product_code,\n    roadman_code,\n    vehicle_code,\n    task_status_code,\n    load_type_code,\n\n    -- Infos m\u00e9tier\n    product_source_type,\n    product_destination_type,\n    task_location_info,\n    task_start_date,\n\n    unit_coeff_multi,\n    unit_coeff_div,\n    base_unit_quantity,\n    product_unit_price_task,\n    product_unit_price_latest,\n\n    -- M\u00e9triques\n    load_quantity,\n    load_valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom chargement_enrichi\n\n\n  where updated_at >= (\n      select max(updated_at) - interval 1 day\n      from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__chargement_tasks`\n  )\n", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__chargement_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:18.570544Z", "completed_at": "2026-02-09T09:55:18.683579Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:18.823551Z", "completed_at": "2026-02-09T09:55:18.823563Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.6750950813293457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_lcdp__commande_interne", "compiled": true, "compiled_code": "\n\nwith commande_interne_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_source as product_source_id,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_source as product_source_type,\n        t.type_product_destination as product_destination_type,\n\n        -- Codes (source et destination)\n        case\n            when t.type_product_source = 'COMPANY' then cs.code\n            when t.type_product_source = 'RESOURCES' then rs.code\n        end as source_code,\n        case\n            when t.type_product_destination = 'COMPANY' then cd.code\n            when t.type_product_destination = 'RESOURCES' then rd.code\n        end as destination_code,\n\n        p.code as product_code,\n        ts.code as task_status_code,\n        la.code as label_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- Informations de conditionnement\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity as base_unit_quantity,\n        thp.net_price as product_unit_price_task,\n        p.purchase_unit_price as product_unit_price_latest,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * p.purchase_unit_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_product` thp\n        on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__product` p\n        on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_status` ts\n        on t.idtask_status = ts.idtask_status\n\n    -- Source = COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company` cs\n        on t.idproduct_source = cs.idcompany\n       and t.type_product_source = 'COMPANY'\n\n    -- Source = RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__resources` rs\n        on t.idproduct_source = rs.idresources\n       and t.type_product_source = 'RESOURCES'\n\n    -- Destination = COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company` cd\n        on t.idproduct_destination = cd.idcompany\n       and t.type_product_destination = 'COMPANY'\n\n    -- Destination = RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__resources` rd\n        on t.idproduct_destination = rd.idresources\n       and t.type_product_destination = 'RESOURCES'\n\n    -- Jointures pour le filtrage sur labels t\u00e9l\u00e9m\u00e9trie\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_task` lht\n        on t.idtask = lht.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label` la\n        on lht.idlabel = la.idlabel\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_family` lf\n        on la.idlabel_family = lf.idlabel_family\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 132  -- LIVRAISON INTERNE\n        and lf.code = 'STATUT_LIVRAISON'\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product,\n        t.idtask,\n        t.idcompany_peer,\n        thp.idproduct,\n        t.idproduct_source,\n        t.type_product_source,\n        t.idproduct_destination,\n        t.type_product_destination,\n        cs.code, rs.code, cd.code, rd.code,\n        p.code, ts.code, la.code,\n        t.real_start_date,\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity,\n        thp.net_price,\n        p.purchase_unit_price,\n        t.updated_at, t.created_at, t.extracted_at\n),\n\ndedup as (\n    select\n        *,\n        row_number() over (\n            partition by task_product_id\n            order by\n                case when label_code = 'LIVRE' then 1 else 2 end\n        ) as rn\n    from commande_interne_base\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_source_id,\n    product_source_type,\n    product_destination_id,\n    product_destination_type,\n\n    -- Codes\n    source_code,\n    destination_code,\n    product_code,\n    task_status_code,\n    label_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- Infos de conditionnement\n    unit_coeff_multi,\n    unit_coeff_div,\n    base_unit_quantity,\n    product_unit_price_task,\n    product_unit_price_latest,\n\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom dedup\nwhere rn = 1\n  and source_code is not null\n  and destination_code is not null", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__commande_interne`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:18.580842Z", "completed_at": "2026-02-09T09:55:18.727628Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:18.866571Z", "completed_at": "2026-02-09T09:55:18.866587Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.7173490524291992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_lcdp__ecart_inventaire_tasks", "compiled": true, "compiled_code": "\n\nwith ecart_inventaire_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_source as product_source_id,\n        t.type_product_source as product_source_type,\n\n        -- Codes\n        case\n            when t.type_product_source = 'COMPANY' then cs.code\n            when t.type_product_source = 'RESOURCES' then r.code\n        end as source_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- Informations de conditionnement\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity as base_unit_quantity,\n        thp.net_price as product_unit_price_task,\n        p.purchase_unit_price as product_unit_price_latest,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * p.purchase_unit_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_product` thp on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__product` p on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_status` ts on t.idtask_status = ts.idtask_status\n\n    -- jointure company pour la source si COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company` cs\n        on t.idproduct_source = cs.idcompany\n       and t.type_product_source = 'COMPANY'\n\n    -- jointure resources pour la source si RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__resources` r\n        on t.idproduct_source = r.idresources\n       and t.type_product_source = 'RESOURCES'\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 163 -- ECART INVENTAIRE\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source,\n        thp.idproduct,\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity,\n        thp.net_price,\n        p.purchase_unit_price,\n        cs.code, r.code, p.code, ts.code,\n        t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_source_id,\n    product_source_type,\n\n    -- Codes\n    source_code,\n    product_code,\n    task_status_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- Infos de conditionnement\n    unit_coeff_multi,\n    unit_coeff_div,\n    base_unit_quantity,\n    product_unit_price_task,\n    product_unit_price_latest,\n\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom ecart_inventaire_base\nwhere source_code is not null", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__ecart_inventaire_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:18.594083Z", "completed_at": "2026-02-09T09:55:18.822890Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:19.122665Z", "completed_at": "2026-02-09T09:55:19.122677Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7452902793884277, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_lcdp__inventaire_tasks", "compiled": true, "compiled_code": "\n\nwith inventaire_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_source as product_source_id,\n        t.type_product_source as product_source_type,\n\n        -- Codes\n        case\n            when t.type_product_source = 'COMPANY' then cs.code\n            when t.type_product_source = 'RESOURCES' then r.code\n        end as source_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- Informations de conditionnement\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity as base_unit_quantity,\n        thp.net_price as product_unit_price_task,\n        p.purchase_unit_price as product_unit_price_latest,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * p.purchase_unit_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_product` thp on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__product` p on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_status` ts on t.idtask_status = ts.idtask_status\n\n    -- jointure company pour la source si COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company` cs\n        on t.idproduct_source = cs.idcompany\n       and t.type_product_source = 'COMPANY'\n\n    -- jointure resources pour la source si RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__resources` r\n        on t.idproduct_source = r.idresources\n       and t.type_product_source = 'RESOURCES'\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 162 -- INVENTAIRE\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source,\n        thp.idproduct,\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity,\n        thp.net_price,\n        p.purchase_unit_price,\n        cs.code, r.code, p.code, ts.code,\n        t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_source_id,\n    product_source_type,\n\n    -- Codes\n    source_code,\n    product_code,\n    task_status_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- Infos de conditionnement\n    unit_coeff_multi,\n    unit_coeff_div,\n    base_unit_quantity,\n    product_unit_price_task,\n    product_unit_price_latest,\n\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom inventaire_base\nwhere source_code is not null", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__inventaire_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:18.728939Z", "completed_at": "2026-02-09T09:55:18.994136Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:19.210575Z", "completed_at": "2026-02-09T09:55:19.210587Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7608091831207275, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_lcdp__livraison_interne_tasks", "compiled": true, "compiled_code": "\n\nwith mouvement_interne_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_source as product_source_id,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_source as product_source_type,\n        t.type_product_destination as product_destination_type,\n\n        -- Codes (source et destination)\n        case\n            when t.type_product_source = 'COMPANY' then cs.code\n            when t.type_product_source = 'RESOURCES' then rs.code\n        end as source_code,\n\n        case\n            when t.type_product_destination = 'COMPANY' then cd.code\n            when t.type_product_destination = 'RESOURCES' then rd.code\n        end as destination_code,\n\n        p.code as product_code,\n        ts.code as task_status_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- Informations de conditionnement\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity as base_unit_quantity,\n        thp.net_price as product_unit_price_task,\n        p.purchase_unit_price as product_unit_price_latest,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * p.purchase_unit_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_product` thp\n        on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__product` p\n        on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_status` ts\n        on t.idtask_status = ts.idtask_status\n\n    -- Source = COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company` cs\n        on t.idproduct_source = cs.idcompany\n       and t.type_product_source = 'COMPANY'\n\n    -- Source = RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__resources` rs\n        on t.idproduct_source = rs.idresources\n       and t.type_product_source = 'RESOURCES'\n\n    -- Destination = COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company` cd\n        on t.idproduct_destination = cd.idcompany\n       and t.type_product_destination = 'COMPANY'\n\n    -- Destination = RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__resources` rd\n        on t.idproduct_destination = rd.idresources\n       and t.type_product_destination = 'RESOURCES'\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 161 -- LIVRAISONS INTERNE\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source,\n        t.idproduct_destination, t.type_product_destination,\n        thp.idproduct,\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity,\n        thp.net_price,\n        p.purchase_unit_price,\n        cs.code, rs.code, cd.code, rd.code,\n        p.code, ts.code,\n        t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_source_id,\n    product_source_type,\n    product_destination_id,\n    product_destination_type,\n\n    -- Codes\n    source_code,\n    destination_code,\n    product_code,\n    task_status_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- Infos de conditionnement\n    unit_coeff_multi,\n    unit_coeff_div,\n    base_unit_quantity,\n    product_unit_price_task,\n    product_unit_price_latest,\n\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom mouvement_interne_base\nwhere source_code is not null\n  and destination_code is not null", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__livraison_interne_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:19.319762Z", "completed_at": "2026-02-09T09:55:19.350394Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:19.404131Z", "completed_at": "2026-02-09T09:55:19.404145Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.2976646423339844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_lcdp__telemetry_tasks", "compiled": true, "compiled_code": "\n\nwith telemetry_tasks as (\n    select\n        -- PK naturelle de task_has_product\n        thp.idtask_has_product as task_product_id,\n\n        -- IDs business\n        t.idtask as task_id,\n        t.iddevice as device_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idlocation as location_id,\n\n        -- Codes m\u00e9tier pour les jointures futures\n        d.code as device_code,\n        thp.code as product_code,\n        c.code as company_code,\n\n        -- Donn\u00e9es m\u00e9tier\n        c.name as company_name,\n        l.access_info as task_location_info,\n\n        -- Dates business\n        t.real_start_date as task_start_date,\n\n        -- M\u00e9trique business\n        CAST(1 AS INT64) AS telemetry_quantity,  -- 1 T\u00e2che = 1 unit\u00e9 de t\u00e9l\u00e9m\u00e9trie\n\n        -- Timestamps techniques pour l'incr\u00e9ment\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task` t\n\n    -- Jointure obligatoire pour r\u00e9cup\u00e9rer les produits\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_product` thp\n        on thp.idtask = t.idtask\n\n    -- Jointures pour enrichissement\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company` c\n        on c.idcompany = t.idcompany_peer\n\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__device` d\n        on d.iddevice = t.iddevice\n\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__location` l\n        on l.idlocation = t.idlocation\n\n    -- Jointures pour le filtrage sur labels t\u00e9l\u00e9m\u00e9trie\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_has_task` lht\n        on t.idtask = lht.idtask\n\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label` la\n        on lht.idlabel = la.idlabel\n\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__label_family` lf\n        on la.idlabel_family = lf.idlabel_family\n\n    where 1=1\n        -- Filtres business critiques\n        and t.idtask_status in (1, 4)  -- FAIT et VALIDE uniquement\n        and t.code_status_record = '1'   -- Enregistrement actif (string)\n        and t.idtask_type = 3           -- Type t\u00e9l\u00e9m\u00e9trie\n        and lf.code = 'TELEM_SOURCE'    -- Label famille t\u00e9l\u00e9m\u00e9trie source\n\n        -- Filtre qualit\u00e9 donn\u00e9es\n        and t.real_start_date is not null  -- \u00c9viter les t\u00e2ches sans date de d\u00e9but\n)\n\nselect * from telemetry_tasks\n\n\n    where updated_at >= (\n        select max(updated_at) - interval 1 day\n        from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__telemetry_tasks`\n    )\n", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__telemetry_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:19.308397Z", "completed_at": "2026-02-09T09:55:19.351786Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:19.405772Z", "completed_at": "2026-02-09T09:55:19.405783Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.3906106948852539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_lcdp__livraison_tasks", "compiled": true, "compiled_code": "\n\nwith livraison_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_source as product_source_id,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_source as product_source_type,\n        t.type_product_destination as product_destination_type,\n\n        -- Codes\n        c.code as company_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- Informations de conditionnement\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity as base_unit_quantity,\n        thp.net_price as product_unit_price_task,\n        p.purchase_unit_price as product_unit_price_latest,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * p.purchase_unit_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_product` thp on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company` c on c.idcompany = t.idcompany_peer\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__product` p on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_status` ts on t.idtask_status = ts.idtask_status\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 101 -- BON LIVRAISON\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source,\n        t.idproduct_destination, t.type_product_destination,\n        thp.idproduct,\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity,\n        thp.net_price,\n        p.purchase_unit_price,\n        c.code, p.code,\n        ts.code, t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_source_id,\n    product_destination_id,\n    product_source_type,\n    product_destination_type,\n\n    -- Codes\n    company_code,\n    product_code,\n    task_status_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- Infos de conditionnement\n    unit_coeff_multi,\n    unit_coeff_div,\n    base_unit_quantity,\n    product_unit_price_task,\n    product_unit_price_latest,\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom livraison_base", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__livraison_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:19.314598Z", "completed_at": "2026-02-09T09:55:19.352525Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:19.407021Z", "completed_at": "2026-02-09T09:55:19.407035Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4386458396911621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_lcdp__reception_tasks", "compiled": true, "compiled_code": "\n\nwith reception_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_destination as product_destination_type,\n\n        -- Codes\n        cd.code as destination_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- Informations de conditionnement\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity as base_unit_quantity,\n        thp.net_price as product_unit_price_task,\n        p.purchase_unit_price as product_unit_price_latest,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * p.purchase_unit_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_product` thp\n        on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__product` p\n        on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_status` ts\n        on t.idtask_status = ts.idtask_status\n\n    -- Destination = COMPANY uniquement\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company` cd\n        on t.idproduct_destination = cd.idcompany\n       and t.type_product_destination = 'COMPANY'\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 121 -- BON RECEPTION\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.idcompany_peer,\n        t.idproduct_destination, t.type_product_destination,\n        thp.idproduct,\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity,\n        thp.net_price,\n        p.purchase_unit_price,\n        cd.code,\n        p.code, ts.code,\n        t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_destination_id,\n    product_destination_type,\n\n    -- Codes\n    destination_code,\n    product_code,\n    task_status_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- Infos de conditionnement\n    unit_coeff_multi,\n    unit_coeff_div,\n    base_unit_quantity,\n    product_unit_price_task,\n    product_unit_price_latest,\n\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom reception_base", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__reception_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:19.334349Z", "completed_at": "2026-02-09T09:55:19.390396Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:19.416424Z", "completed_at": "2026-02-09T09:55:19.416439Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3929269313812256, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_lcdp__task_has_product_idtask_has_product.8a195878ba", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_has_product\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_product`\nwhere idtask_has_product is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:19.342197Z", "completed_at": "2026-02-09T09:55:19.406372Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:19.512719Z", "completed_at": "2026-02-09T09:55:19.512731Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.4393928050994873, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__task_has_product_idcompany_peer__idcompany__ref_stg_oracle_lcdp__company_.17f30a9e87", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_peer as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_product`\n    where idcompany_peer is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:19.353197Z", "completed_at": "2026-02-09T09:55:19.413638Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:19.513661Z", "completed_at": "2026-02-09T09:55:19.513674Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.43579530715942383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__task_has_product_idproduct__idproduct__ref_stg_oracle_lcdp__product_.b8ef0e6a23", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idproduct as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_product`\n    where idproduct is not null\n),\n\nparent as (\n    select idproduct as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__product`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:19.359733Z", "completed_at": "2026-02-09T09:55:19.415013Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:19.561461Z", "completed_at": "2026-02-09T09:55:19.561473Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.47830724716186523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_lcdp__task_has_product_idtask__idtask__ref_stg_oracle_lcdp__task_.cb82de2c5e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idtask as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_product`\n    where idtask is not null\n),\n\nparent as (\n    select idtask as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:19.367500Z", "completed_at": "2026-02-09T09:55:19.415625Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:19.562778Z", "completed_at": "2026-02-09T09:55:19.562789Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5208785533905029, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_lcdp__task_has_product_idtask_has_product.9766f5d887", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_has_product as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_lcdp__task_has_product`\n  where idtask_has_product is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:19.385336Z", "completed_at": "2026-02-09T09:55:19.418479Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:19.605657Z", "completed_at": "2026-02-09T09:55:19.605675Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.517484188079834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__appro_tasks_task_id.bf4222bc8f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__appro_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:19.373865Z", "completed_at": "2026-02-09T09:55:19.417361Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:19.605023Z", "completed_at": "2026-02-09T09:55:19.605035Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.603252649307251, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__appro_tasks_created_at.98de0ed7cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__appro_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:19.380166Z", "completed_at": "2026-02-09T09:55:19.419202Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:19.606415Z", "completed_at": "2026-02-09T09:55:19.606430Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.6013278961181641, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__appro_tasks_extracted_at.a132ced3cb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__appro_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:19.393371Z", "completed_at": "2026-02-09T09:55:19.460261Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:19.607091Z", "completed_at": "2026-02-09T09:55:19.607102Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6416394710540771, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__appro_tasks_task_start_date.e7a334d098", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__appro_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:19.398959Z", "completed_at": "2026-02-09T09:55:19.470191Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:19.608727Z", "completed_at": "2026-02-09T09:55:19.608740Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.6633548736572266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__appro_tasks_updated_at.466e3e68a7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__appro_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:19.408173Z", "completed_at": "2026-02-09T09:55:19.562159Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:19.737704Z", "completed_at": "2026-02-09T09:55:19.737717Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.7046029567718506, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_lcdp__appro_tasks_task_id.5723015bfa", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__appro_tasks`\n  where task_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:19.462326Z", "completed_at": "2026-02-09T09:55:19.610674Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:19.991303Z", "completed_at": "2026-02-09T09:55:19.991323Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7336709499359131, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_unique_combination_of_columns_dim_oracle_neshu__contract_company_id.73a6310d39", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        company_id\n    from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__contract`\n    group by company_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:19.514429Z", "completed_at": "2026-02-09T09:55:19.739638Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:20.036704Z", "completed_at": "2026-02-09T09:55:20.036719Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7513289451599121, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__contract_contract_id.28d4af45b3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contract_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__contract`\nwhere contract_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.134595Z", "completed_at": "2026-02-09T09:55:20.168544Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:20.220048Z", "completed_at": "2026-02-09T09:55:20.220061Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.38085293769836426, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__contract_created_at.5dc61f7cd8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__contract`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.143214Z", "completed_at": "2026-02-09T09:55:20.169851Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:20.227353Z", "completed_at": "2026-02-09T09:55:20.227366Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.3802170753479004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__contract_is_active.9600c93d58", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect is_active\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__contract`\nwhere is_active is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.170479Z", "completed_at": "2026-02-09T09:55:20.175859Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:20.228022Z", "completed_at": "2026-02-09T09:55:20.228041Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.2868838310241699, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbt_warehouse.snap_oracle_neshu__company", "compiled": true, "compiled_code": "\n\n\n\nWITH source_table AS (\n\n    SELECT *\n    FROM `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company`\n\n)\n\nSELECT\n    -- Identit\u00e9\n    company_id,\n    company_type_id,\n    company_code,\n    company_name,\n    company_type,\n\n    -- Organisation / classification\n    region,\n    sector,\n    sector_code,\n    activity_sector,\n    employee_range,\n\n    -- Mod\u00e8le \u00e9conomique & relation client\n    company_economic_model,\n    client_status,\n    key_account,\n\n    -- Offres / options\n    katiers,\n    remote_work,\n    proadman,\n    gsm,\n    badge,\n    recycling,\n\n    -- Statut\n    is_active,\n\n    -- Localisation\n    address1,\n    address2,\n    city,\n    postal_code,\n    country,\n\n    -- M\u00e9tadonn\u00e9es source\n    created_at,\n    updated_at\n\nFROM source_table\n", "relation_name": "`evs-datastack-prod`.`snapshots`.`snap_oracle_neshu__company`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.150766Z", "completed_at": "2026-02-09T09:55:20.188260Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:20.235563Z", "completed_at": "2026-02-09T09:55:20.235576Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4274404048919678, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__contract_updated_at.f826ba71d3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__contract`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.159008Z", "completed_at": "2026-02-09T09:55:20.195435Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:20.237601Z", "completed_at": "2026-02-09T09:55:20.237613Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.42511487007141113, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_oracle_neshu__contract_contract_id.2498b48ad2", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select contract_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__contract`\n  where contract_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.196045Z", "completed_at": "2026-02-09T09:55:20.201347Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:20.238312Z", "completed_at": "2026-02-09T09:55:20.238323Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.3727688789367676, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbt_warehouse.snap_oracle_neshu__device", "compiled": true, "compiled_code": "\n\n\n\nWITH source_table AS (\n  SELECT *\n  FROM `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`\n)\nSELECT\n    device_id,\n    device_iddevice,\n    device_type_id,\n    company_id,\n    location_id,\n    device_code,\n    device_name,\n    company_code,              -- \u2713 TRACKED for changes\n    company_name,\n    device_brand,              -- \u2713 TRACKED for changes\n    device_gamme,\n    device_category,\n    device_economic_model,      -- \u2713 TRACKED for changes\n    device_location,            -- \u2713 TRACKED for changes\n    is_active,\n    last_installation_date,\n    created_at,\n    updated_at\nFROM source_table\n", "relation_name": "`evs-datastack-prod`.`snapshots`.`snap_oracle_neshu__device`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.176641Z", "completed_at": "2026-02-09T09:55:20.229017Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:20.332056Z", "completed_at": "2026-02-09T09:55:20.332067Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.46843814849853516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__company_company_id.2286b3d824", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company`\nwhere company_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.182104Z", "completed_at": "2026-02-09T09:55:20.234758Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:20.374183Z", "completed_at": "2026-02-09T09:55:20.374195Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5096592903137207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_oracle_neshu__company_company_id.d6aabe0e95", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select company_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company`\n  where company_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.189672Z", "completed_at": "2026-02-09T09:55:20.238916Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:20.506879Z", "completed_at": "2026-02-09T09:55:20.506893Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5118069648742676, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__machines_yuman_maintenance_base", "compiled": true, "compiled_code": "-- int_oracle_neshu__machines_yuman_maintenance_base.sql\n\n\n\n-- LISTE MACHINE DLOG filtr\u00e9 & clean\nWITH liste_machine_oracle AS (\n    SELECT\n      d.device_id,\n      CONCAT('NESH_', d.device_code) AS device_code,\n      d.device_name,\n      CONCAT('NESH_', company_code) AS company_code,\n      d.company_name,\n      d.last_installation_date,\n      d.created_at as device_created_at,\n      d.updated_at as device_updated_at\n    FROM `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device` d\n    WHERE is_active\n      AND device_type_id IN (1, 2)\n      AND REGEXP_CONTAINS(company_code, r'^CN[0-9]{4}$')\n      AND device_name in ('MOMENTO 100', 'GEMINI 200', 'MOMENTO 200', 'MINITOWER GEMINI', 'MINITOWER MOMENTO',\n        'SBS MOMENTO 100', 'TOWER GEMINI', 'TOWER MOMENTO', 'MILANO LYO FTS120',\n        'MILANO GRAIN FTS60E', 'MILANO GRAIN FTS60E + MODULO', 'BLUSODA', 'BLUSODA GAZ',\n        'TOWER BLUSODA', 'TOWER BLUSODA GAZ', 'MILANO LYO FTS120 + MODULO',\n        'BLUSODA', 'TOWER ONE GAZ', 'OPTIBEANX12 + MODULO', 'OPTIBEAN X 12', 'OPTIBEAN X 12 TS','OPTIBEANX12TS + MODULO','OPTIBEANX12TS + MODULO','OPTIBEAN 12')\n),\n-- LISTE MACHINE YUMAN ENRICHI CLIENT / SITE filtr\u00e9 & clean\nyuman_materials_clean  AS (\n    SELECT \n        ym.material_id,\n        ym.material_description,\n        ym.material_name,\n        ym.material_brand,\n        ym.material_serial_number,\n        ycat.category_name,\n        ym.material_in_service_date,\n        ym.created_at,\n        ym.updated_at,\n        yc.client_id,\n        yc.client_code,\n        yc.client_name,\n        yc.client_category,\n        yc.partner_name,\n        ys.site_id,\n        ys.site_code,\n        ys.site_postal_code\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials` ym\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites` ys \n        ON ym.site_id = ys.site_id\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients` yc \n        ON ys.client_id = yc.client_id\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials_categories` ycat \n        ON ycat.category_id = ym.category_id\n    WHERE partner_name = 'NESHU'\n      AND site_code NOT IN (\n            \"NESH_DEPOTATELIERBORDEAUX\", \"NESH_DEPOTATELIERLYON\", \"NESH_DEPOTATELIERMARSEILLE\",\n            \"NESH_DEPOTATELIERRUNGIS\", \"NESH_DEPOTATELIERSTRASBOURG\", \"NESH_DEPOTBORDEAUX\",\n            \"NESH_DEPOTLYON\", \"NESH_DEPOTMARSEILLE\", \"NESH_DEPOTPERIMES\", \"NESH_DEPOTREBUS\",\n            \"NESH_DEPOTRUNGIS\", \"NESH_DEPOTSTRASBOURG\", \"NESH_RELYON\", \"NESH_RERUNGIS\", \"NESH_STOCKNUNSHEN\"\n        )\n      AND material_name NOT LIKE '%GENERIQUE NESHU%'\n      AND material_serial_number not in \n      ('NESH_MA00226', 'NESH_MA00227', 'NESH_MA00247', 'NESH_MA00248', 'NESH_MA00249',\n      'NESH_MA00250', 'NESH_MA00251', 'NESH_MA00252', 'NESH_MA00253', 'NESH_MA00254',\n      'NESH_MA00193', 'NESH_MA00194', 'NESH_MA00195', 'NESH_MA00196', 'NESH_MA00197',\n      'NESH_MA00198', 'NESH_MA00199', 'NESH_MA00200', 'NESH_MA00201', 'NESH_MA00202',\n      'NESH_MA00203', 'NESH_MA00204', 'NESH_MA00205', 'NESH_MA00206', 'NESH_MA00207',\n      'NESH_MA00208', 'NESH_MA00209', 'NESH_MA00210', 'NESH_MA00211', 'NESH_MA00212',\n      'NESH_MA00213', 'NESH_MA00214', 'NESH_MA00215', 'NESH_MA00228', 'NESH_MA00229',\n      'NESH_MA00230', 'NESH_MA00231', 'NESH_MA00232', 'NESH_MA00233', 'NESH_MA00234',\n      'NESH_MA00235', 'NESH_MA00236', 'NESH_MA00237', 'NESH_MA00238', 'NESH_MA00239',\n      'NESH_MA00240', 'NESH_MA00241', 'NESH_MA00242', 'NESH_MA00244', 'NESH_MA00245',\n      'NESH_MA00246', 'NESH_MA00256', 'NESH_MA00257', 'NESH_MA00258', 'NESH_MA00259',\n      'NESH_MA00260', 'NESH_MA00261', 'NESH_MA00262', 'NESH_MA00263', 'NESH_MA00264',\n      'NESH_MA00265', 'NESH_MA00266', 'NESH_MA00270', 'NESH_MA00216', 'NESH_MA00217',\n      'NESH_MA00220', 'NESH_MA00221', 'NESH_MA00222', 'NESH_MA00223', 'NESH_MA00181',\n      'NESH_MA00182', 'NESH_MA00184', 'NESH_MA00185', 'NESH_MA00183', 'NESH_MA00186',\n      'NESH_MA00187', 'NESH_AS00401', 'NESH_AS00403', 'NESH_AS00393', 'NESH_AS00557',\n      'NESH_AS00558', 'NESH_AS00242', 'NESH_AS00241', 'NESH_AS00562', 'NESH_AS00559',\n      'NESH_AS00070', 'NESH_AS00568', 'NESH_AS00563', 'NESH_AS00561', 'NESH_AS00560',\n      'NESH_AS00317', 'NESH_AS00314', 'NESH_MA00136', 'NESH_AS00011', 'NESH_AS00012',\n      'NESH_MA00170', 'NESH_AS00004')\n),\n-- JOINTURE ENTRE LA LISTE MACHINE DLOG avec les donn\u00e9es YUMAN\nmerged_materials_dlog_yuman AS (\n    SELECT \n        lo.device_id,\n        lo.device_code,\n        lo.device_name,\n        lo.company_code,\n        lo.company_name,\n        lo.last_installation_date,\n        lo.device_created_at,\n        lo.device_updated_at,\n        ym.material_id,\n        ym.material_serial_number,\n        ym.material_name,\n        ym.client_id,\n        ym.client_code,\n        ym.client_name,\n        ym.client_category,\n        ym.site_id,\n        ym.site_code,\n        ym.site_postal_code,\n        ym.created_at AS material_created_at,\n        ym.updated_at AS material_updated_at\n    FROM liste_machine_oracle lo\n    LEFT JOIN yuman_materials_clean ym\n        ON lo.device_code = ym.material_serial_number and lo.company_code = ym.client_code\n)\nSELECT * from merged_materials_dlog_yuman", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__machines_yuman_maintenance_base`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.207502Z", "completed_at": "2026-02-09T09:55:20.240141Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:20.507638Z", "completed_at": "2026-02-09T09:55:20.507654Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5921461582183838, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__device_device_id.51db00e9ef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`\nwhere device_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.202006Z", "completed_at": "2026-02-09T09:55:20.240816Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:20.508312Z", "completed_at": "2026-02-09T09:55:20.508324Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.5938723087310791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__device_company_id.e17a3c2fb4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`\nwhere company_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.212978Z", "completed_at": "2026-02-09T09:55:20.247013Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:20.511150Z", "completed_at": "2026-02-09T09:55:20.511163Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6279854774475098, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_dim_oracle_neshu__device_company_id__company_id__ref_dim_oracle_neshu__company_.72b98eee1b", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select company_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`\n    where company_id is not null\n),\n\nparent as (\n    select company_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.220688Z", "completed_at": "2026-02-09T09:55:20.331369Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:20.513972Z", "completed_at": "2026-02-09T09:55:20.513985Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.6639370918273926, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_oracle_neshu__device_device_id.cbb3e59fc9", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select device_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`\n  where device_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.229674Z", "completed_at": "2026-02-09T09:55:20.506227Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:20.601434Z", "completed_at": "2026-02-09T09:55:20.601446Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.7014157772064209, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__valorisation_parc_machines", "compiled": true, "compiled_code": "\n\nWITH \n-- \u00c9tape 0 : Filtrer les clients actifs NESHU (company_code = \"CN\" + 4 chiffres)\ncompanies_filtered AS (\n  SELECT \n    company_id,\n    company_code\n  FROM `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company`\n  WHERE \n    is_active = TRUE\n    AND company_type = \"CLIENTNESHU\"\n    AND REGEXP_CONTAINS(company_code, r'^CN[0-9]{4}$')\n),\n-- \u00c9tape 1 : R\u00e9cup\u00e9rer les machines actives par client filtr\u00e9es\nactive_devices AS (\n  SELECT \n    d.device_id,\n    d.company_id,\n    cf.company_code,\n    d.device_name\n  FROM `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device` d\n  INNER JOIN companies_filtered cf\n    ON d.company_id = cf.company_id\n  WHERE \n    d.is_active = TRUE \n    AND d.device_iddevice IS NULL\n    AND d.device_name IN (\n      SELECT DISTINCT device_name \n      FROM `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__groupement_machine`\n    )\n),\n\n-- \u00c9tape 2 : Mapper chaque device avec son device_group\ndevices_with_group AS (\n  SELECT \n    ad.device_id,\n    ad.company_id,\n    ad.company_code,\n    ad.device_name,\n    gm.device_group\n  FROM active_devices ad\n  INNER JOIN `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__groupement_machine` gm\n    ON ad.device_name = gm.device_name\n),\n\n-- \u00c9tape 3 : Joindre avec la table de valorisation\ndevices_with_products AS (\n  SELECT \n    dwg.device_id,\n    dwg.company_id,\n    dwg.company_code,\n    dwg.device_name,\n    dwg.device_group,\n    vm.product_code,\n    vm.quantite\n  FROM devices_with_group dwg\n  LEFT JOIN `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__valo_machine_capacite` vm\n    ON LOWER(dwg.device_group) = LOWER(vm.device_group)\n),\n\n-- \u00c9tape 4 : Joindre avec la table produit pour obtenir les prix\ndevices_with_prices AS (\n  SELECT \n    dwp.device_id,\n    dwp.company_id,\n    dwp.company_code,\n    dwp.device_name,\n    dwp.device_group,\n    dwp.product_code,\n    dwp.quantite,\n    p.purchase_unit_price,\n    (dwp.quantite * p.purchase_unit_price) AS valorisation_produit\n  FROM devices_with_products dwp\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product` p\n    ON dwp.product_code = p.product_code\n),\n\n-- \u00c9tape 5 : Calculer la valorisation totale par machine (device)\nvalorisation_by_device AS (\n  SELECT \n    device_id,\n    device_name,\n    device_group,\n    SUM(valorisation_produit) AS valorisation_totale_machine\n  FROM devices_with_prices\n  GROUP BY device_id, device_name, device_group\n),\n\nfinal_result AS (\n-- R\u00e9sultat final : regroup\u00e9 par device_name / device_group\nSELECT\n  device_name,\n  device_group,\n  COUNT(device_id) AS nombre_machines,\n  ROUND(SUM(valorisation_totale_machine), 2) AS valorisation_totale_machine\nFROM valorisation_by_device\nGROUP BY device_name, device_group\n)\n\n-- Ajout m\u00e9tadonn\u00e9es dbt\nSELECT \n    device_name,\n    device_group,\n    nombre_machines,\n    valorisation_totale_machine,\n    -- M\u00e9tadonn\u00e9es d'ex\u00e9cution\n    CURRENT_TIMESTAMP() as dbt_updated_at,\n    'cb08451a-2004-4aaf-949e-f43cc89d5466' as dbt_invocation_id\nFROM final_result", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__valorisation_parc_machines`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.241468Z", "completed_at": "2026-02-09T09:55:20.511818Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:20.728290Z", "completed_at": "2026-02-09T09:55:20.728302Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7356274127960205, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__product_product_id.d69a3b14d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.375160Z", "completed_at": "2026-02-09T09:55:20.602104Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:20.817791Z", "completed_at": "2026-02-09T09:55:20.817802Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7630422115325928, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_oracle_neshu__product_product_id.ba747134a3", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select product_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product`\n  where product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.954992Z", "completed_at": "2026-02-09T09:55:21.003383Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.051303Z", "completed_at": "2026-02-09T09:55:21.051319Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.35309457778930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_task_idlabel.231c8d8c24", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.962925Z", "completed_at": "2026-02-09T09:55:21.018649Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.057810Z", "completed_at": "2026-02-09T09:55:21.057825Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.39281368255615234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_task_idtask.dd0526ea2b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.968571Z", "completed_at": "2026-02-09T09:55:21.019817Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.060073Z", "completed_at": "2026-02-09T09:55:21.060085Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.43602681159973145, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_task_idlabel__idlabel__ref_stg_oracle_neshu__label_.993fbf412b", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.977176Z", "completed_at": "2026-02-09T09:55:21.020559Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.060702Z", "completed_at": "2026-02-09T09:55:21.060717Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4337623119354248, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_task_idtask__idtask__ref_stg_oracle_neshu__task_.518c9e509c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idtask as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task`\n    where idtask is not null\n),\n\nparent as (\n    select idtask as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.985213Z", "completed_at": "2026-02-09T09:55:21.027973Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.068673Z", "completed_at": "2026-02-09T09:55:21.068688Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.4822568893432617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__commande_interne", "compiled": true, "compiled_code": "\n\nwith commande_interne_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_source as product_source_id,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_source as product_source_type,\n        t.type_product_destination as product_destination_type,\n\n        -- Codes (source et destination)\n        case \n            when t.type_product_source = 'COMPANY' then cs.code\n            when t.type_product_source = 'RESOURCES' then rs.code\n        end as source_code,\n        case \n            when t.type_product_destination = 'COMPANY' then cd.code\n            when t.type_product_destination = 'RESOURCES' then rd.code\n        end as destination_code,\n\n        p.code as product_code,\n        ts.code as task_status_code,\n        la.code as label_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- Informations de conditionnement\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity as base_unit_quantity,\n        thp.net_price as product_unit_price_task,\n        p.purchase_unit_price as product_unit_price_latest,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * p.purchase_unit_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp \n        on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p \n        on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts \n        on t.idtask_status = ts.idtask_status\n\n    -- Source = COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` cs \n        on t.idproduct_source = cs.idcompany \n       and t.type_product_source = 'COMPANY'\n\n    -- Source = RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` rs \n        on t.idproduct_source = rs.idresources\n       and t.type_product_source = 'RESOURCES'\n\n    -- Destination = COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` cd \n        on t.idproduct_destination = cd.idcompany \n       and t.type_product_destination = 'COMPANY'\n\n    -- Destination = RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` rd \n        on t.idproduct_destination = rd.idresources\n       and t.type_product_destination = 'RESOURCES'\n\n    -- Jointures pour le filtrage sur labels t\u00e9l\u00e9m\u00e9trie\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task` lht\n        on t.idtask = lht.idtask   \n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` la\n        on lht.idlabel = la.idlabel  \n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf\n        on la.idlabel_family = lf.idlabel_family\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 132  -- LIVRAISON INTERNE\n        and lf.code = 'STATUT_LIVRAISON'\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, \n        t.idtask, \n        t.idcompany_peer,\n        thp.idproduct, \n        t.idproduct_source, \n        t.type_product_source,\n        t.idproduct_destination, \n        t.type_product_destination,\n        cs.code, rs.code, cd.code, rd.code,\n        p.code, ts.code, la.code,\n        t.real_start_date,\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity,\n        thp.net_price,\n        p.purchase_unit_price,\n        t.updated_at, t.created_at, t.extracted_at\n),\n\ndedup as (\n    select\n        *,\n        row_number() over (\n            partition by task_product_id\n            order by \n                case when label_code = 'LIVRE' then 1 else 2 end\n        ) as rn\n    from commande_interne_base\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_source_id,\n    product_source_type,\n    product_destination_id,\n    product_destination_type,\n\n    -- Codes\n    source_code,\n    destination_code,\n    product_code,\n    task_status_code,\n    label_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- Infos de conditionnement\n    unit_coeff_multi,\n    unit_coeff_div,\n    base_unit_quantity,\n    product_unit_price_task,\n    product_unit_price_latest,\n\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom dedup\nwhere rn = 1\n  and source_code is not null\n  and destination_code is not null", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:20.992571Z", "completed_at": "2026-02-09T09:55:21.028715Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.069338Z", "completed_at": "2026-02-09T09:55:21.069349Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.5243611335754395, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__ecart_inventaire_tasks", "compiled": true, "compiled_code": "\n\nwith ecart_inventaire_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_source as product_source_id,\n        t.type_product_source as product_source_type,\n\n        -- Codes\n        case \n            when t.type_product_source = 'COMPANY' then cs.code\n            when t.type_product_source = 'RESOURCES' then r.code\n        end as source_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- Informations de conditionnement\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity as base_unit_quantity,\n        thp.net_price as product_unit_price_task,\n        p.purchase_unit_price as product_unit_price_latest,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * p.purchase_unit_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts on t.idtask_status = ts.idtask_status\n\n    -- jointure company pour la source si COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` cs \n        on t.idproduct_source = cs.idcompany \n       and t.type_product_source = 'COMPANY'\n\n    -- jointure resources pour la source si RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` r \n        on t.idproduct_source = r.idresources\n       and t.type_product_source = 'RESOURCES'\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 163 -- ECART INVENTAIRE\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source,\n        thp.idproduct,\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity,\n        thp.net_price,\n        p.purchase_unit_price,\n        cs.code, r.code, p.code, ts.code,\n        t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_source_id,\n    product_source_type,\n\n    -- Codes\n    source_code,\n    product_code,\n    task_status_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- Infos de conditionnement\n    unit_coeff_multi,\n    unit_coeff_div,\n    base_unit_quantity,\n    product_unit_price_task,\n    product_unit_price_latest,\n\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom ecart_inventaire_base\nwhere source_code is not null", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.005024Z", "completed_at": "2026-02-09T09:55:21.058730Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.165069Z", "completed_at": "2026-02-09T09:55:21.165082Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.48090314865112305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__inter_techinique_tasks", "compiled": true, "compiled_code": "\n\nwith inter_base as (\n\n    select\n        -- Identifiants\n        t.idtask as task_id,\n        t.iddevice as device_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n\n        -- Codes\n        c.code as company_code,\n        d.code as device_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n        la.code as label_code,\n        lf.code as label_family_code,\n\n        -- Informations m\u00e9tier\n        t.real_start_date as task_start_date,\n        t.real_end_date as task_end_date,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` c on c.idcompany = t.idcompany_peer\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device` d on d.iddevice = t.iddevice\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task` lht on t.idtask = lht.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` la on lht.idlabel = la.idlabel\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf on la.idlabel_family = lf.idlabel_family\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts on t.idtask_status = ts.idtask_status\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 131 -- INTERVENTION TECHNIQUE\n        and t.real_start_date is not null\n)\n\nselect\n    -- Identifiants\n    task_id,\n    device_id,\n    company_id,\n    product_id,\n\n    -- Codes\n    company_code,\n    device_code,\n    product_code,\n    task_status_code,\n\n    -- Pivot des labels\n    max(case when label_family_code = 'Statut inter' then label_code end) as statut_inter,\n    max(case when label_family_code = 'DC04' then label_code end) as dc04,\n    max(case when label_family_code = 'MISSION_TYPE' then label_code end) as mission_type,\n    max(case when label_family_code = 'Objet intervent' then label_code end) as objet_intervent,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n    task_end_date,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom inter_base\ngroup by\n    task_id, device_id, company_id, product_id,\n    company_code, device_code, product_code, task_status_code,\n    task_start_date, task_end_date, updated_at, created_at, extracted_at\nHAVING MAX(CASE WHEN label_family_code = 'Objet intervent' THEN label_code END) = 'OC04'", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.012686Z", "completed_at": "2026-02-09T09:55:21.059442Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.166372Z", "completed_at": "2026-02-09T09:55:21.166384Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5231266021728516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__inventaire_tasks", "compiled": true, "compiled_code": "\n\nwith inventaire_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_source as product_source_id,\n        t.type_product_source as product_source_type,\n\n        -- Codes\n        case \n            when t.type_product_source = 'COMPANY' then cs.code\n            when t.type_product_source = 'RESOURCES' then r.code\n        end as source_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- Informations de conditionnement\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity as base_unit_quantity,\n        thp.net_price as product_unit_price_task,\n        p.purchase_unit_price as product_unit_price_latest,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * p.purchase_unit_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts on t.idtask_status = ts.idtask_status\n\n    -- jointure company pour la source si COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` cs \n        on t.idproduct_source = cs.idcompany \n       and t.type_product_source = 'COMPANY'\n\n    -- jointure resources pour la source si RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` r \n        on t.idproduct_source = r.idresources\n       and t.type_product_source = 'RESOURCES'\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 162 -- INVENTAIRE\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source,\n        thp.idproduct,\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity,\n        thp.net_price,\n        p.purchase_unit_price,\n        cs.code, r.code, p.code, ts.code,\n        t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_source_id,\n    product_source_type,\n\n    -- Codes\n    source_code,\n    product_code,\n    task_status_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- Infos de conditionnement\n    unit_coeff_multi,\n    unit_coeff_div,\n    base_unit_quantity,\n    product_unit_price_task,\n    product_unit_price_latest,\n\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom inventaire_base\nwhere source_code is not null", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.022754Z", "completed_at": "2026-02-09T09:55:21.079273Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.343035Z", "completed_at": "2026-02-09T09:55:21.343050Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5249323844909668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__livraison_interne_tasks", "compiled": true, "compiled_code": "\n\nwith mouvement_interne_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_source as product_source_id,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_source as product_source_type,\n        t.type_product_destination as product_destination_type,\n\n        -- Codes (source et destination)\n        case \n            when t.type_product_source = 'COMPANY' then cs.code\n            when t.type_product_source = 'RESOURCES' then rs.code\n        end as source_code,\n\n        case \n            when t.type_product_destination = 'COMPANY' then cd.code\n            when t.type_product_destination = 'RESOURCES' then rd.code\n        end as destination_code,\n\n        p.code as product_code,\n        ts.code as task_status_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- Informations de conditionnement\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity as base_unit_quantity,\n        thp.net_price as product_unit_price_task,\n        p.purchase_unit_price as product_unit_price_latest,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * p.purchase_unit_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp \n        on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p \n        on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts \n        on t.idtask_status = ts.idtask_status\n\n    -- Source = COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` cs \n        on t.idproduct_source = cs.idcompany \n       and t.type_product_source = 'COMPANY'\n\n    -- Source = RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` rs \n        on t.idproduct_source = rs.idresources\n       and t.type_product_source = 'RESOURCES'\n\n    -- Destination = COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` cd \n        on t.idproduct_destination = cd.idcompany \n       and t.type_product_destination = 'COMPANY'\n\n    -- Destination = RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` rd \n        on t.idproduct_destination = rd.idresources\n       and t.type_product_destination = 'RESOURCES'\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 161 -- LIVRAISONS INTERNE\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source,\n        t.idproduct_destination, t.type_product_destination,\n        thp.idproduct,\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity,\n        thp.net_price,\n        p.purchase_unit_price,\n        cs.code, rs.code, cd.code, rd.code,\n        p.code, ts.code,\n        t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_source_id,\n    product_source_type,\n    product_destination_id,\n    product_destination_type,\n\n    -- Codes\n    source_code,\n    destination_code,\n    product_code,\n    task_status_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- Infos de conditionnement\n    unit_coeff_multi,\n    unit_coeff_div,\n    base_unit_quantity,\n    product_unit_price_task,\n    product_unit_price_latest,\n\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom mouvement_interne_base\nwhere source_code is not null\n  and destination_code is not null", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.030633Z", "completed_at": "2026-02-09T09:55:21.070553Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.342242Z", "completed_at": "2026-02-09T09:55:21.342255Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5657150745391846, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__livraison_tasks", "compiled": true, "compiled_code": "\n\nwith livraison_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_source as product_source_id,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_source as product_source_type,\n        t.type_product_destination as product_destination_type,\n\n        -- Codes\n        c.code as company_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- Informations de conditionnement\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity as base_unit_quantity,\n        thp.net_price as product_unit_price_task,\n        p.purchase_unit_price as product_unit_price_latest,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * p.purchase_unit_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` c on c.idcompany = t.idcompany_peer\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts on t.idtask_status = ts.idtask_status\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 101 -- BON LIVRAISON\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source,\n        t.idproduct_destination, t.type_product_destination,\n        thp.idproduct,\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity,\n        thp.net_price,\n        p.purchase_unit_price,\n        c.code, p.code,\n        ts.code, t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_source_id,\n    product_destination_id,\n    product_source_type,\n    product_destination_type,\n\n    -- Codes\n    company_code,\n    product_code,\n    task_status_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- Infos de conditionnement\n    unit_coeff_multi,\n    unit_coeff_div,\n    base_unit_quantity,\n    product_unit_price_task,\n    product_unit_price_latest,\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom livraison_base", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.036046Z", "completed_at": "2026-02-09T09:55:21.080253Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.344335Z", "completed_at": "2026-02-09T09:55:21.344351Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.6065857410430908, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__reception_tasks", "compiled": true, "compiled_code": "\n\nwith reception_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_destination as product_destination_type,\n\n        -- Codes\n        cd.code as destination_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- Informations de conditionnement\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity as base_unit_quantity,\n        thp.net_price as product_unit_price_task,\n        p.purchase_unit_price as product_unit_price_latest,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * p.purchase_unit_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp \n        on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p \n        on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts \n        on t.idtask_status = ts.idtask_status\n\n    -- Destination = COMPANY uniquement\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` cd\n        on t.idproduct_destination = cd.idcompany \n       and t.type_product_destination = 'COMPANY'\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 121 -- BON RECEPTION\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.idcompany_peer,\n        t.idproduct_destination, t.type_product_destination,\n        thp.idproduct,\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity,\n        thp.net_price,\n        p.purchase_unit_price,\n        cd.code,\n        p.code, ts.code,\n        t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_destination_id,\n    product_destination_type,\n\n    -- Codes\n    destination_code,\n    product_code,\n    task_status_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- Infos de conditionnement\n    unit_coeff_multi,\n    unit_coeff_div,\n    base_unit_quantity,\n    product_unit_price_task,\n    product_unit_price_latest,\n\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom reception_base", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.043673Z", "completed_at": "2026-02-09T09:55:21.121481Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.344979Z", "completed_at": "2026-02-09T09:55:21.344990Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6402833461761475, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__telemetry_tasks", "compiled": true, "compiled_code": "\n\nwith telemetry_tasks as (\n    select\n        -- PK naturelle de task_has_product\n        thp.idtask_has_product as task_product_id,\n        \n        -- IDs business\n        t.idtask as task_id,\n        t.iddevice as device_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idlocation as location_id,\n        \n        -- Codes m\u00e9tier pour les jointures futures\n        d.code as device_code,\n        thp.code as product_code,\n        c.code as company_code,\n        \n        -- Donn\u00e9es m\u00e9tier\n        c.name as company_name,\n        l.access_info as task_location_info,\n        \n        -- Dates business\n        t.real_start_date as task_start_date,\n        \n        -- M\u00e9trique business\n        CAST(1 AS INT64) AS telemetry_quantity,  -- 1 T\u00e2che = 1 unit\u00e9 de t\u00e9l\u00e9m\u00e9trie\n        \n        -- Timestamps techniques pour l'incr\u00e9ment\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n        \n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    \n    -- Jointure obligatoire pour r\u00e9cup\u00e9rer les produits\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp\n        on thp.idtask = t.idtask\n    \n    -- Jointures pour enrichissement\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` c\n        on c.idcompany = t.idcompany_peer\n        \n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device` d\n        on d.iddevice = t.iddevice\n        \n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location` l\n        on l.idlocation = t.idlocation\n    \n    -- Jointures pour le filtrage sur labels t\u00e9l\u00e9m\u00e9trie\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task` lht\n        on t.idtask = lht.idtask\n        \n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` la\n        on lht.idlabel = la.idlabel\n        \n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf\n        on la.idlabel_family = lf.idlabel_family\n    \n    where 1=1\n        -- Filtres business critiques\n        and t.idtask_status in (1, 4)  -- FAIT et VALIDE uniquement\n        and t.code_status_record = '1'   -- Enregistrement actif (string)\n        and t.idtask_type = 3           -- Type t\u00e9l\u00e9m\u00e9trie\n        and lf.code = 'TELEM_SOURCE'    -- Label famille t\u00e9l\u00e9m\u00e9trie source\n        \n        -- Filtre qualit\u00e9 donn\u00e9es\n        and t.real_start_date is not null  -- \u00c9viter les t\u00e2ches sans date de d\u00e9but\n)\n\nselect * from telemetry_tasks\n\n\n    where updated_at >= (\n        select max(updated_at) - interval 1 day\n        from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\n    )\n", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.052061Z", "completed_at": "2026-02-09T09:55:21.165692Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.388808Z", "completed_at": "2026-02-09T09:55:21.388820Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.6714890003204346, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__task_has_product_idtask_has_product.d3f98a1a05", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_has_product\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product`\nwhere idtask_has_product is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.061356Z", "completed_at": "2026-02-09T09:55:21.250353Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.432522Z", "completed_at": "2026-02-09T09:55:21.432537Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6933023929595947, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_has_product_idcompany_peer__idcompany__ref_stg_oracle_neshu__company_.9958fec509", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_peer as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product`\n    where idcompany_peer is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.071300Z", "completed_at": "2026-02-09T09:55:21.343660Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.476723Z", "completed_at": "2026-02-09T09:55:21.476738Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7329168319702148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_has_product_idproduct__idproduct__ref_stg_oracle_neshu__product_.0304257578", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idproduct as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product`\n    where idproduct is not null\n),\n\nparent as (\n    select idproduct as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.250980Z", "completed_at": "2026-02-09T09:55:21.435452Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.692629Z", "completed_at": "2026-02-09T09:55:21.692641Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7655942440032959, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_has_product_idtask__idtask__ref_stg_oracle_neshu__task_.e57798c3a4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idtask as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product`\n    where idtask is not null\n),\n\nparent as (\n    select idtask as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.790479Z", "completed_at": "2026-02-09T09:55:21.845248Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.881213Z", "completed_at": "2026-02-09T09:55:21.881235Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.38734936714172363, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__task_has_product_idtask_has_product.3f7428b52a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_has_product as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product`\n  where idtask_has_product is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.797822Z", "completed_at": "2026-02-09T09:55:21.846109Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.882083Z", "completed_at": "2026-02-09T09:55:21.882096Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.388033390045166, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__chargement_tasks", "compiled": true, "compiled_code": "\n\nwith chargement_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.iddevice as device_id,\n        t.idcompany_peer as company_id,\n        t.idlocation as location_id,\n        t.idproduct_source as product_source_id,\n        t.type_product_source as product_source_type,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_destination as product_destination_type,\n        thp.idproduct as product_id,\n\n        -- Codes\n        c.code as company_code,\n        d.code as device_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n        la.code as load_type_code,\n\n        -- Informations m\u00e9tier\n        l.access_info as task_location_info,\n        t.real_start_date as task_start_date,\n\n        -- Informations de conditionnement\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity as base_unit_quantity,\n        thp.net_price as product_unit_price_task,\n        p.purchase_unit_price as product_unit_price_latest,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as load_quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) * p.purchase_unit_price as load_valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` c on c.idcompany = t.idcompany_peer\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device` d on d.iddevice = t.iddevice\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location` l on l.idlocation = t.idlocation\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task` lht on t.idtask = lht.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` la on lht.idlabel = la.idlabel\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts on t.idtask_status = ts.idtask_status\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 13 -- CHARGEMENT MACHINE\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.iddevice, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source, t.idlocation,\n        t.idproduct_destination, t.type_product_destination,\n        thp.idproduct,\n        c.code, d.code, p.code,\n        ts.code, la.code,\n        l.access_info, t.real_start_date,\n        thp.unit_coeff_multi,\n        thp.unit_coeff_div,\n        thp.real_quantity,\n        thp.net_price,\n        p.purchase_unit_price,\n        t.updated_at, t.created_at, t.extracted_at\n),\n\nressources_roadman as (\n    select \n        thr.idtask, \n        min(r.idresources) as roadman_id,\n        min(r.code) as roadman_code\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources` thr\n    join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` r on r.idresources = thr.idresources\n    where r.idresources_type = 2\n    group by thr.idtask\n),\n\nressources_vehicle as (\n    select \n        thr.idtask, \n        min(r.idresources) as vehicle_id,\n        min(r.code) as vehicle_code\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources` thr\n    join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` r on r.idresources = thr.idresources\n    where r.idresources_type = 3\n    group by thr.idtask\n),\n\nchargement_enrichi as (\n    select \n        cb.*,\n        rr.roadman_id,\n        rr.roadman_code,\n        rv.vehicle_id,\n        rv.vehicle_code\n    from chargement_base cb\n    left join ressources_roadman rr on cb.task_id = rr.idtask\n    left join ressources_vehicle rv on cb.task_id = rv.idtask\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    device_id,\n    company_id,\n    product_id,\n    location_id,\n    product_source_id,\n    product_destination_id,\n    roadman_id,\n    vehicle_id,\n\n    -- Codes\n    company_code,\n    device_code,\n    product_code,\n    roadman_code,\n    vehicle_code,\n    task_status_code,\n    load_type_code,\n\n    -- Infos m\u00e9tier\n    product_source_type,\n    product_destination_type,\n    task_location_info,\n    task_start_date,\n\n    unit_coeff_multi,\n    unit_coeff_div,\n    base_unit_quantity,\n    product_unit_price_task,\n    product_unit_price_latest,\n\n    -- M\u00e9triques\n    load_quantity,\n    load_valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom chargement_enrichi\n\n\n  where updated_at >= (\n      select max(updated_at) - interval 1 day\n      from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\n  )\n", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.808459Z", "completed_at": "2026-02-09T09:55:21.852510Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.890130Z", "completed_at": "2026-02-09T09:55:21.890146Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.3861548900604248, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__pointage", "compiled": true, "compiled_code": "\n\nWITH \nresources_roadman AS (\n    SELECT \n        thr.idtask, \n        MIN(r.idresources) AS idresources_roadman, \n        MIN(r.code) AS code_roadman\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources` thr\n    JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` r \n        ON thr.idresources = r.idresources \n       AND r.idresources_type = 2 -- Resources Roadman\n    GROUP BY thr.idtask\n),\npointage AS (\n    SELECT\n        t.idtask,\n        t.iddevice,\n        t.idcompany_peer AS idcompany,\n        ts.code AS status_code,\n        t.real_start_date AS date_pointage,\n        la.code AS label_code,\n        t.created_at,\n        t.updated_at,\n        t.extracted_at\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task` lht ON t.idtask = lht.idtask\n    JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` la ON lht.idlabel = la.idlabel AND la.idlabel in (2685,2686)  -- START_DAY & END_DAY uniquement\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts ON t.idtask_status = ts.idtask_status\n    WHERE t.idtask_type = 194 -- TASK TYPE POINTAGE\n      AND t.code_status_record = '1' -- Enregistrement actif\n),\npointage_resources AS (\n    SELECT \n        p.*,\n        r.idresources_roadman,\n        r.code_roadman\n    FROM pointage p\n    LEFT JOIN resources_roadman r ON p.idtask = r.idtask\n)\n \n-- SELECT FINAL\nSELECT\n    idtask as task_id,\n    idcompany as company_id,\n    idresources_roadman as resources_roadman_id,\n    code_roadman as roadman_code,\n    status_code,\n    label_code,\n    date_pointage as date_pointage,\n    DATE(date_pointage) as date_pointage_jour,\n    created_at,\n    updated_at,\n    extracted_at\nFROM pointage_resources\nWHERE idresources_roadman is not null", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__pointage`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.820354Z", "completed_at": "2026-02-09T09:55:21.854342Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.896799Z", "completed_at": "2026-02-09T09:55:21.896810Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.42770886421203613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__task_has_resources_idtask.c853c7eb7b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.826979Z", "completed_at": "2026-02-09T09:55:21.860256Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.897471Z", "completed_at": "2026-02-09T09:55:21.897487Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.4688560962677002, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_has_resources_idresources__idresources__ref_stg_oracle_neshu__resources_.27237e11eb", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idresources as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources`\n    where idresources is not null\n),\n\nparent as (\n    select idresources as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.814738Z", "completed_at": "2026-02-09T09:55:21.863803Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.905156Z", "completed_at": "2026-02-09T09:55:21.905169Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5217380523681641, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__task_has_resources_idresources.5afdfd82d8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.838571Z", "completed_at": "2026-02-09T09:55:21.882716Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:21.908585Z", "completed_at": "2026-02-09T09:55:21.908596Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.47338032722473145, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_has_resources_idtask__idtask__ref_stg_oracle_neshu__task_.50dbc0d63f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idtask as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources`\n    where idtask is not null\n),\n\nparent as (\n    select idtask as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.847565Z", "completed_at": "2026-02-09T09:55:21.896166Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:22.034849Z", "completed_at": "2026-02-09T09:55:22.034862Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5164127349853516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_oracle_neshu__pa_business_review", "compiled": true, "compiled_code": "\n\nSELECT\n    -- Identifiants\n    pa.task_id,\n    pa.company_id,\n    pa.device_id,\n    pa.company_code,\n\n    -- Company\n    c.company_name,\n    CONCAT(c.company_name, ' - ', pa.company_code) AS company_info,\n\n    -- Device\n    d.device_brand,\n    d.device_code,\n    CONCAT(d.device_brand, ' - ', d.device_code) AS device_info,\n\n    -- Contexte temporel\n    pa.task_start_date,\n    DATE(pa.task_start_date) AS task_start_date_day,\n    pa.task_end_date,\n\n    -- Statut\n    pa.task_status_code,\n    CASE WHEN pa.task_status_code = 'FAIT' THEN 1 ELSE 0 END AS mission_faite,\n    CASE WHEN pa.task_status_code IN ('PREVU', 'FAIT', 'ENCOURS') THEN 1 ELSE 0 END AS mission_prevue,\n\n    -- M\u00e9tadonn\u00e9es dbt\n    CURRENT_TIMESTAMP() as dbt_updated_at,\n    'cb08451a-2004-4aaf-949e-f43cc89d5466' as dbt_invocation_id\n\nFROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks` pa\nJOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device` d \n    ON pa.device_id = d.device_id\nJOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company` c \n    ON pa.company_id = c.company_id\nWHERE DATE(pa.task_start_date) >= '2025-01-01'\n    AND pa.task_status_code != 'ANNULE'", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.855066Z", "completed_at": "2026-02-09T09:55:21.904529Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:22.127690Z", "completed_at": "2026-02-09T09:55:22.127704Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5571589469909668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__appro_tasks_created_at.2224651e8c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.864476Z", "completed_at": "2026-02-09T09:55:21.906424Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:22.169633Z", "completed_at": "2026-02-09T09:55:22.169651Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5580954551696777, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__appro_tasks_extracted_at.11b43558e3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.870021Z", "completed_at": "2026-02-09T09:55:21.907926Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:22.172345Z", "completed_at": "2026-02-09T09:55:22.172361Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.6411194801330566, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__appro_tasks_task_id.afbab212ea", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.875494Z", "completed_at": "2026-02-09T09:55:21.907162Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:22.171557Z", "completed_at": "2026-02-09T09:55:22.171572Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6415598392486572, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__appro_tasks_task_start_date.8e28b8d3b2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.883400Z", "completed_at": "2026-02-09T09:55:22.035508Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:22.217587Z", "completed_at": "2026-02-09T09:55:22.217603Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.6673414707183838, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__appro_tasks_updated_at.297f723da2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.890801Z", "completed_at": "2026-02-09T09:55:22.036106Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:22.259589Z", "completed_at": "2026-02-09T09:55:22.259600Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.683971643447876, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__appro_tasks_task_id.27c5ab3d17", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`\n  where task_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:21.898229Z", "completed_at": "2026-02-09T09:55:22.128461Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:22.303712Z", "completed_at": "2026-02-09T09:55:22.303724Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7264020442962646, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu_gcs__stock_products_date_system.8fb446f793", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_system\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu_gcs__stock_products`\nwhere date_system is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:22.120361Z", "completed_at": "2026-02-09T09:55:22.304345Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:22.562225Z", "completed_at": "2026-02-09T09:55:22.562237Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7506017684936523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu_gcs__stock_products_file_datetime.c28506060e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect file_datetime\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu_gcs__stock_products`\nwhere file_datetime is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:22.617901Z", "completed_at": "2026-02-09T09:55:22.665841Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:22.702024Z", "completed_at": "2026-02-09T09:55:22.702042Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.3388209342956543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu_gcs__stock_products_id_entity.ddabc813f3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id_entity\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu_gcs__stock_products`\nwhere id_entity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:22.629731Z", "completed_at": "2026-02-09T09:55:22.672552Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:22.708884Z", "completed_at": "2026-02-09T09:55:22.708900Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.38212132453918457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__clients_client_id.bb975d2fa4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect client_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__clients`\nwhere client_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:22.624142Z", "completed_at": "2026-02-09T09:55:22.674336Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:22.714901Z", "completed_at": "2026-02-09T09:55:22.714915Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.4257946014404297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu_gcs__stock_products_product_code.0878e32c8a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_code\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu_gcs__stock_products`\nwhere product_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:22.638285Z", "completed_at": "2026-02-09T09:55:22.680749Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:22.717831Z", "completed_at": "2026-02-09T09:55:22.717846Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.38418030738830566, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_yuman__clients_client_id.12116495a3", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select client_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_yuman__clients`\n  where client_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:22.643676Z", "completed_at": "2026-02-09T09:55:22.682176Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:22.726866Z", "completed_at": "2026-02-09T09:55:22.726880Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.4300987720489502, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__materials_material_id.8e2898dbe5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect material_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials`\nwhere material_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:22.651481Z", "completed_at": "2026-02-09T09:55:22.695848Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:22.728481Z", "completed_at": "2026-02-09T09:55:22.728493Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.42887258529663086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__materials_site_id.614d463e6e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect site_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials`\nwhere site_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:22.657717Z", "completed_at": "2026-02-09T09:55:22.707784Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:22.772182Z", "completed_at": "2026-02-09T09:55:22.772195Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.47071313858032227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_yuman__materials_material_id.a2c990b4a9", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select material_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials`\n  where material_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:22.667467Z", "completed_at": "2026-02-09T09:55:22.717105Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:22.816975Z", "completed_at": "2026-02-09T09:55:22.816988Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5105490684509277, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__materials_clients_client_id.307466ae21", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect client_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials_clients`\nwhere client_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:22.675221Z", "completed_at": "2026-02-09T09:55:22.726080Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:22.860565Z", "completed_at": "2026-02-09T09:55:22.860580Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5523004531860352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__materials_clients_material_id.65161533d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect material_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials_clients`\nwhere material_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:22.689077Z", "completed_at": "2026-02-09T09:55:22.729105Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:22.950552Z", "completed_at": "2026-02-09T09:55:22.950564Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.5503513813018799, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_yuman__materials_clients_material_id.3293b73ed8", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select material_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials_clients`\n  where material_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:22.683506Z", "completed_at": "2026-02-09T09:55:22.729686Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:22.992601Z", "completed_at": "2026-02-09T09:55:22.992616Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5932128429412842, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__materials_clients_site_id.00254a1aa0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect site_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials_clients`\nwhere site_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:22.696545Z", "completed_at": "2026-02-09T09:55:22.773016Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:23.035835Z", "completed_at": "2026-02-09T09:55:23.035847Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.634300947189331, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__sites_client_id.cd8fb92b93", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect client_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`\nwhere client_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:22.702702Z", "completed_at": "2026-02-09T09:55:22.814866Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:23.036490Z", "completed_at": "2026-02-09T09:55:23.036505Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.6577026844024658, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__sites_site_id.d284592881", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect site_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`\nwhere site_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:22.709646Z", "completed_at": "2026-02-09T09:55:22.859786Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:23.080388Z", "completed_at": "2026-02-09T09:55:23.080400Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6996855735778809, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_dim_yuman__materials_site_id__site_id__ref_dim_yuman__sites_.73849dcc87", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select site_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials`\n    where site_id is not null\n),\n\nparent as (\n    select site_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:22.718539Z", "completed_at": "2026-02-09T09:55:22.901841Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:23.081166Z", "completed_at": "2026-02-09T09:55:23.081178Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7285034656524658, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_dim_yuman__sites_client_id__client_id__ref_dim_yuman__clients_.3c8b8aee42", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select client_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`\n    where client_id is not null\n),\n\nparent as (\n    select client_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__clients`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:22.943970Z", "completed_at": "2026-02-09T09:55:23.125101Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:23.381506Z", "completed_at": "2026-02-09T09:55:23.381519Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.750330924987793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_yuman__sites_site_id.97c9826437", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select site_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`\n  where site_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:23.435762Z", "completed_at": "2026-02-09T09:55:23.486347Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:23.523432Z", "completed_at": "2026-02-09T09:55:23.523449Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.38222312927246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_nesp_tech__delais_interventions_delai_jours_debut.72c3dd4512", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect delai_jours_debut\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_nesp_tech__delais_interventions`\nwhere delai_jours_debut is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:23.444549Z", "completed_at": "2026-02-09T09:55:23.493090Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:23.530606Z", "completed_at": "2026-02-09T09:55:23.530618Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.38094639778137207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_nesp_tech__delais_interventions_delai_jours_fin.b2c2056b70", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect delai_jours_fin\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_nesp_tech__delais_interventions`\nwhere delai_jours_fin is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:23.450777Z", "completed_at": "2026-02-09T09:55:23.494902Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:23.536758Z", "completed_at": "2026-02-09T09:55:23.536778Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.3827197551727295, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_nesp_tech__delais_interventions_n_planning.20f8e5a6ee", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect n_planning\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_nesp_tech__delais_interventions`\nwhere n_planning is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:23.463234Z", "completed_at": "2026-02-09T09:55:23.503861Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:23.545376Z", "completed_at": "2026-02-09T09:55:23.545389Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.34677839279174805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_unique_combination_of_columns_int_mssql_sage__pnl_bu_numero_ecriture_comptable__numero_plan_analytique__numero_ligne_analytique.4a294695b2", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        numero_ecriture_comptable, numero_plan_analytique, numero_ligne_analytique\n    from `evs-datastack-prod`.`prod_intermediate`.`int_mssql_sage__pnl_bu`\n    group by numero_ecriture_comptable, numero_plan_analytique, numero_ligne_analytique\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:23.458186Z", "completed_at": "2026-02-09T09:55:23.504487Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:23.546017Z", "completed_at": "2026-02-09T09:55:23.546032Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3921070098876953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_mssql_sage__pnl_bu_kpis", "compiled": true, "compiled_code": "\n\nWITH scenarios AS (\n  SELECT 'AVEC_PROVISIONS_CP' AS scenario\n  UNION ALL\n  SELECT 'SANS_PROVISIONS_CP'\n),\n\nbase AS (\n  SELECT\n    s.scenario,\n    EXTRACT(YEAR FROM f.date_facturation) AS annee,\n    EXTRACT(MONTH FROM f.date_facturation) AS mois,\n    COALESCE(f.code_analytique_bu, 'BU_NON_RENSEIGNEE') AS bu,\n    f.macro_categorie_pnl_bu,\n    f.numero_compte_general,\n    f.montant_analytique_signe\n  FROM `evs-datastack-prod`.`prod_intermediate`.`int_mssql_sage__pnl_bu` f\n  CROSS JOIN scenarios s\n  WHERE f.is_missing_analytical = FALSE\n    AND EXTRACT(YEAR FROM f.date_facturation) >= 2023\n    AND (\n      s.scenario = 'AVEC_PROVISIONS_CP'\n      OR (\n        s.scenario = 'SANS_PROVISIONS_CP'\n        AND f.numero_compte_general NOT IN ('645800', '641200')\n      )\n    )\n),\n\nkpi_mensuel AS (\n  SELECT\n    scenario,\n    annee,\n    mois,\n    bu,\n\n    SUM(CASE WHEN macro_categorie_pnl_bu = \"Chiffre d'Affaires\"\n        THEN montant_analytique_signe ELSE 0 END) AS chiffre_affaire,\n\n    SUM(CASE WHEN macro_categorie_pnl_bu = 'Consommation MP & SSTT'\n        THEN montant_analytique_signe ELSE 0 END) AS consommation_mp_sstt,\n\n    SUM(CASE WHEN macro_categorie_pnl_bu = 'Masse Salariale'\n        THEN montant_analytique_signe ELSE 0 END) AS masse_salariale,\n\n    SUM(CASE WHEN macro_categorie_pnl_bu = 'Frais Directs & Amortissements'\n        THEN montant_analytique_signe ELSE 0 END) AS frais_directs_amortissements\n\n  FROM base\n  GROUP BY scenario, annee, mois, bu\n),\n\nkpi_calcule AS (\n  SELECT\n    scenario,\n    annee,\n    mois,\n    bu,\n\n    chiffre_affaire,\n    consommation_mp_sstt,\n    masse_salariale,\n    frais_directs_amortissements,\n\n    chiffre_affaire + consommation_mp_sstt AS marge_brute,\n    chiffre_affaire\n      + consommation_mp_sstt\n      + masse_salariale\n      + frais_directs_amortissements AS marge_nette\n  FROM kpi_mensuel\n),\nkpi_ytd AS (\n  SELECT\n    *,\n\n    SUM(chiffre_affaire) OVER (PARTITION BY scenario, annee, bu ORDER BY mois) AS chiffre_affaire_ytd,\n    SUM(consommation_mp_sstt) OVER (PARTITION BY scenario, annee, bu ORDER BY mois) AS consommation_mp_sstt_ytd,\n    SUM(masse_salariale) OVER (PARTITION BY scenario, annee, bu ORDER BY mois) AS masse_salariale_ytd,\n    SUM(frais_directs_amortissements) OVER (PARTITION BY scenario, annee, bu ORDER BY mois) AS frais_directs_amortissements_ytd,\n    SUM(marge_brute) OVER (PARTITION BY scenario, annee, bu ORDER BY mois) AS marge_brute_ytd,\n    SUM(marge_nette) OVER (PARTITION BY scenario, annee, bu ORDER BY mois) AS marge_nette_ytd\n\n  FROM kpi_calcule\n),\nkpi_enrichi AS (\n  SELECT\n    *,\n\n    -- N-1 mensuel\n    LAG(chiffre_affaire) OVER (PARTITION BY scenario, bu, mois ORDER BY annee) AS chiffre_affaire_n_1,\n    LAG(consommation_mp_sstt) OVER (PARTITION BY scenario, bu, mois ORDER BY annee) AS consommation_mp_sstt_n_1,\n    LAG(masse_salariale) OVER (PARTITION BY scenario, bu, mois ORDER BY annee) AS masse_salariale_n_1,\n    LAG(frais_directs_amortissements) OVER (PARTITION BY scenario, bu, mois ORDER BY annee) AS frais_directs_amortissements_n_1,\n    LAG(marge_brute) OVER (PARTITION BY scenario, bu, mois ORDER BY annee) AS marge_brute_n_1,\n    LAG(marge_nette) OVER (PARTITION BY scenario, bu, mois ORDER BY annee) AS marge_nette_n_1,\n\n    -- \u2705 N-1 YTD (SAFE \u2014 plus d\u2019imbrication)\n    LAG(chiffre_affaire_ytd) OVER (PARTITION BY scenario, bu, mois ORDER BY annee) AS chiffre_affaire_ytd_n_1,\n    LAG(consommation_mp_sstt_ytd) OVER (PARTITION BY scenario, bu, mois ORDER BY annee) AS consommation_mp_sstt_ytd_n_1,\n    LAG(masse_salariale_ytd) OVER (PARTITION BY scenario, bu, mois ORDER BY annee) AS masse_salariale_ytd_n_1,\n    LAG(frais_directs_amortissements_ytd) OVER (PARTITION BY scenario, bu, mois ORDER BY annee) AS frais_directs_amortissements_ytd_n_1,\n    LAG(marge_brute_ytd) OVER (PARTITION BY scenario, bu, mois ORDER BY annee) AS marge_brute_ytd_n_1,\n    LAG(marge_nette_ytd) OVER (PARTITION BY scenario, bu, mois ORDER BY annee) AS marge_nette_ytd_n_1\n\n  FROM kpi_ytd\n),\nkpi_long AS (\n  SELECT\n    scenario,\n    annee,\n    mois,\n    bu,\n    kpi,\n    valeur,\n    valeur_ytd,\n    valeur_n_1,\n    valeur_ytd_n_1\n  FROM kpi_enrichi\n  UNPIVOT (\n    (valeur, valeur_ytd, valeur_n_1, valeur_ytd_n_1)\n    FOR kpi IN (\n      (chiffre_affaire, chiffre_affaire_ytd, chiffre_affaire_n_1, chiffre_affaire_ytd_n_1) AS 'CA',\n      (consommation_mp_sstt, consommation_mp_sstt_ytd, consommation_mp_sstt_n_1, consommation_mp_sstt_ytd_n_1) AS 'CONSOMMATION_MP_SSTT',\n      (masse_salariale, masse_salariale_ytd, masse_salariale_n_1, masse_salariale_ytd_n_1) AS 'MASSE_SALARIALE',\n      (frais_directs_amortissements, frais_directs_amortissements_ytd, frais_directs_amortissements_n_1, frais_directs_amortissements_ytd_n_1) AS 'FRAIS_DIRECTS_AMORTISSEMENTS',\n      (marge_brute, marge_brute_ytd, marge_brute_n_1, marge_brute_ytd_n_1) AS 'MARGE_BRUTE',\n      (marge_nette, marge_nette_ytd, marge_nette_n_1, marge_nette_ytd_n_1) AS 'MARGE_NETTE'\n    )\n  )\n)\n\nSELECT\n  l.scenario,\n  l.annee,\n  l.mois,\n  l.bu,\n  l.kpi,\n\n  l.valeur,\n  l.valeur_ytd,\n  l.valeur_n_1,\n  l.valeur_ytd_n_1,\n\n  -- % du CA\n  SAFE_DIVIDE(l.valeur, ca.valeur) AS pct_du_ca,\n  SAFE_DIVIDE(l.valeur_ytd, ca.valeur_ytd) AS pct_du_ca_ytd,\n  SAFE_DIVIDE(l.valeur_n_1, ca.valeur_n_1) AS pct_du_ca_n_1,\n  SAFE_DIVIDE(l.valeur_ytd_n_1, ca.valeur_ytd_n_1) AS pct_du_ca_n_1_ytd,\n\n  -- \u00c9carts mensuels\n  l.valeur - l.valeur_n_1 AS ecart_n_vs_n_1,\n  SAFE_DIVIDE(l.valeur - l.valeur_n_1, l.valeur_n_1) AS evolution_pct,\n\n  -- KPI YTD\n  l.valeur_ytd - l.valeur_ytd_n_1 AS ecart_n_vs_n_1_ytd,\n  SAFE_DIVIDE(l.valeur_ytd - l.valeur_ytd_n_1, l.valeur_ytd_n_1) AS evolution_pct_ytd,\n\n  -- M\u00e9tadonn\u00e9es dbt\n  CURRENT_TIMESTAMP() as dbt_updated_at,\n  'cb08451a-2004-4aaf-949e-f43cc89d5466' as dbt_invocation_id\nFROM kpi_long l\nLEFT JOIN kpi_long ca\n  ON  l.scenario = ca.scenario\n  AND l.annee = ca.annee\n  AND l.mois = ca.mois\n  AND l.bu = ca.bu\n  AND ca.kpi = 'CA'\nWHERE l.annee >= 2024\nORDER BY annee, mois, bu, kpi", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_mssql_sage__pnl_bu_kpis`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:23.473261Z", "completed_at": "2026-02-09T09:55:23.522080Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:23.548550Z", "completed_at": "2026-02-09T09:55:23.548562Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.43169689178466797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_mssql_sage__pnl_bu_date_facturation.072017c216", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_facturation\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_mssql_sage__pnl_bu`\nwhere date_facturation is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:23.480114Z", "completed_at": "2026-02-09T09:55:23.522780Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:23.549788Z", "completed_at": "2026-02-09T09:55:23.549799Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.4725229740142822, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_mssql_sage__pnl_bu_numero_compte_general.410db49e3d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect numero_compte_general\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_mssql_sage__pnl_bu`\nwhere numero_compte_general is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:23.487999Z", "completed_at": "2026-02-09T09:55:23.542674Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:23.635232Z", "completed_at": "2026-02-09T09:55:23.635244Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5128664970397949, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_mssql_sage__pnl_bu_numero_ecriture_comptable.67eb14ebb7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect numero_ecriture_comptable\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_mssql_sage__pnl_bu`\nwhere numero_ecriture_comptable is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:23.496451Z", "completed_at": "2026-02-09T09:55:23.544704Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:23.683758Z", "completed_at": "2026-02-09T09:55:23.683778Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5523591041564941, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_nesp_tech__pieces_detachees_pricing_date_fin.8a6c9fc166", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_fin\nfrom `evs-datastack-prod`.`prod_marts`.`fct_nesp_tech__pieces_detachees_pricing`\nwhere date_fin is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:23.505250Z", "completed_at": "2026-02-09T09:55:23.547288Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:23.729377Z", "completed_at": "2026-02-09T09:55:23.729393Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.8197672367095947, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_nesp_tech__pieces_detachees_pricing_n_planning.c9b45eb0a7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect n_planning\nfrom `evs-datastack-prod`.`prod_marts`.`fct_nesp_tech__pieces_detachees_pricing`\nwhere n_planning is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:23.516599Z", "completed_at": "2026-02-09T09:55:23.547881Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:23.770481Z", "completed_at": "2026-02-09T09:55:23.770500Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.8357326984405518, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_yuman_gcs__stock_articles_reference.f996334348", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect reference\nfrom `evs-datastack-prod`.`prod_marts`.`fct_yuman_gcs__stock_articles`\nwhere reference is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:23.510688Z", "completed_at": "2026-02-09T09:55:23.549172Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:23.772516Z", "completed_at": "2026-02-09T09:55:23.772528Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.8881895542144775, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_nesp_tech__pieces_detachees_pricing_n_tech.8f52927bd2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect n_tech\nfrom `evs-datastack-prod`.`prod_marts`.`fct_nesp_tech__pieces_detachees_pricing`\nwhere n_tech is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:23.531250Z", "completed_at": "2026-02-09T09:55:23.634528Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:23.858302Z", "completed_at": "2026-02-09T09:55:23.858316Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.9102175235748291, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_nesp_tech__facturation_interventions_n_planning.63a3af25c8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect n_planning\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_nesp_tech__facturation_interventions`\nwhere n_planning is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:23.524114Z", "completed_at": "2026-02-09T09:55:23.635820Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:23.859092Z", "completed_at": "2026-02-09T09:55:23.859107Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.9590809345245361, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_yuman_gcs__stock_articles_stock_date.f39c724228", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stock_date\nfrom `evs-datastack-prod`.`prod_marts`.`fct_yuman_gcs__stock_articles`\nwhere stock_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:23.537587Z", "completed_at": "2026-02-09T09:55:23.725784Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:23.902376Z", "completed_at": "2026-02-09T09:55:23.902392Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.9939968585968018, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__vehicule_roadman_created_at.6f262f3192", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__vehicule_roadman`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:23.678576Z", "completed_at": "2026-02-09T09:55:23.945657Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:24.453825Z", "completed_at": "2026-02-09T09:55:24.453838Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 1.002805471420288, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__vehicule_roadman_resources_vehicule_id.c3f73dffe0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect resources_vehicule_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__vehicule_roadman`\nwhere resources_vehicule_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:24.509530Z", "completed_at": "2026-02-09T09:55:24.559531Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:24.599060Z", "completed_at": "2026-02-09T09:55:24.599078Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.33738279342651367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__vehicule_roadman_vehicule_code.1a54576616", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect vehicule_code\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__vehicule_roadman`\nwhere vehicule_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:24.515581Z", "completed_at": "2026-02-09T09:55:24.560203Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:24.600975Z", "completed_at": "2026-02-09T09:55:24.600987Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.3803825378417969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_oracle_neshu__vehicule_roadman_resources_vehicule_id.a8759e0a08", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select resources_vehicule_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__vehicule_roadman`\n  where resources_vehicule_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:24.522290Z", "completed_at": "2026-02-09T09:55:24.566735Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:24.607106Z", "completed_at": "2026-02-09T09:55:24.607121Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.3866398334503174, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_oracle_neshu__vehicule_roadman_roadman_code.4131c40746", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select roadman_code as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__vehicule_roadman`\n  where roadman_code is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:24.530444Z", "completed_at": "2026-02-09T09:55:24.586474Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:24.617131Z", "completed_at": "2026-02-09T09:55:24.617146Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.34514832496643066, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_oracle_neshu__vehicule_roadman_vehicule_code.e20213783a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select vehicule_code as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__vehicule_roadman`\n  where vehicule_code is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:24.539119Z", "completed_at": "2026-02-09T09:55:24.592807Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:24.619180Z", "completed_at": "2026-02-09T09:55:24.619192Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3844611644744873, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_yuman__workorder_pricing", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- MODEL: fct_yuman__workorder_pricing\n-- PURPOSE: Determine automatic pricing for technical interventions from Yuman\n-- AUTHOR: Cebrail AKSOY\n-- UPDATED: 2026-02-09 09:54:45.179332+00:00\n-- ============================================================================\n\nWITH \n-- ============================================================================\n-- 1. BASE DATA EXTRACTION\n-- ============================================================================\nbase_workorders AS (\n  SELECT\n    demand_id,\n    workorder_id,\n    material_id,\n    site_id,\n    client_id,\n    technician_id,\n    manager_id,\n    demand_description,\n    demand_status,\n    demand_created_at,\n    demand_updated_at,\n    demand_category_name,\n    workorder_number,\n    workorder_category,\n    workorder_status,\n    workorder_technician_name,\n    workorder_date_creation,\n    workorder_motif_non_intervention,\n    workorder_detail_non_intervention,\n    workorder_raison_mise_en_pause,\n    workorder_explication_mise_en_pause,\n    date_planned,\n    date_started,\n    date_done,\n    partner_name,\n    client_code,\n    client_name,\n    client_category,\n    client_is_active,\n    site_code,\n    site_name,\n    site_address,\n    site_postal_code,\n    material_serial_number,\n    technician_equipe,\n\n    -- Normalize workorder type\n    LOWER(COALESCE(\n      workorder_category,\n      CASE\n        WHEN workorder_type = 'Reactive' THEN 'curatif'\n        WHEN workorder_type = 'Preventive' THEN 'pr\u00e9ventif'\n        WHEN workorder_type = 'Installation' THEN 'installation'\n        ELSE workorder_type\n      END\n    )) AS workorder_type_raw,\n\n    -- Normalize machine category\n    LOWER(TRIM(CASE\n      WHEN material_category IS NOT NULL THEN material_category\n      WHEN LOWER(client_name) LIKE '%generique%' THEN CONCAT(partner_name, '_GENERIQUE')\n      WHEN partner_name = 'AUUM' THEN 'MGZ'\n      WHEN partner_name = 'TWYD' THEN 'FONTAINE TWYD'\n      WHEN partner_name = 'EXPRESSO' THEN 'MILANO'\n      WHEN partner_name = 'NESHU' THEN 'MILANO'\n      WHEN partner_name = 'BRITA' THEN 'viv t 85 c2-tg-i-cu ce'\n      WHEN partner_name = 'DAAN' THEN 'lave-vaisselle'\n      WHEN partner_name = 'NU' THEN 'frigo nu'\n      ELSE NULL  \n    END)) AS machine_raw,\n\n    -- Postal code correction\n    CASE\n      WHEN site_postal_code IS NULL OR site_postal_code = '00000' THEN (\n        SELECT code_postal\n        FROM UNNEST(REGEXP_EXTRACT_ALL(demand_description, r'\\b\\d{5}\\b')) AS code_postal\n        WHERE NOT REGEXP_CONTAINS(\n          LEFT(demand_description, STRPOS(demand_description, code_postal)-1),\n          r'(?i)N\u00b0\\s*$|interventions?\\s*$'\n        )\n        LIMIT 1\n      )\n      ELSE REGEXP_EXTRACT(site_address, r'\\b(\\d{5})\\b')\n    END AS postal_code_site,\n\n    -- Billing indicator\n    CASE\n      WHEN workorder_status = 'Closed'\n        AND workorder_motif_non_intervention IS NULL\n        AND workorder_detail_non_intervention IS NULL\n      THEN TRUE\n      ELSE FALSE\n    END AS a_facturer\n\n  FROM `evs-datastack-prod`.`prod_intermediate`.`int_yuman__demands_workorders_enriched`\n),\n\n-- ============================================================================\n-- 2. REFERENCE TABLES\n-- ============================================================================\nref_type_inter AS (\n  SELECT \n    LOWER(Type_intervention_Brut) AS workorder_type_raw,\n    LOWER(TYPE_INTER) AS workorder_type_clean\n  FROM `evs-datastack-prod`.`prod_reference`.`ref_yuman__type_inter_clean`\n),\n\nref_machine AS (\n  SELECT machine_raw, machine_clean\n  FROM (\n    SELECT \n      LOWER(TRIM(Machine_Brut)) AS machine_raw,\n      LOWER(TRIM(MACHINE)) AS machine_clean,\n      ROW_NUMBER() OVER(PARTITION BY LOWER(TRIM(Machine_Brut)) ORDER BY MACHINE) AS rn\n    FROM `evs-datastack-prod`.`prod_reference`.`ref_yuman__machine_clean`\n  )\n  WHERE rn = 1\n),\n\nref_cp_metropole AS (\n  SELECT Code_Postal, Metropole\n  FROM `evs-datastack-prod`.`prod_reference`.`ref_yuman__cp_metropole`\n),\n\nref_dpt_metropole AS (\n  SELECT Departement, Metropole\n  FROM `evs-datastack-prod`.`prod_reference`.`ref_yuman__dpt_metropole`\n),\n\nref_tarification AS (\n  SELECT\n    LOWER(CONCAT(\n      TYPE_INTER, '_',\n      MACHINE, '_',\n      MARQUE, '_',\n      Type_tarif, '_',\n      CAST(METROPOLE AS STRING)\n    )) AS key_tarif,\n    Montant,\n    PROD\n  FROM `evs-datastack-prod`.`prod_reference`.`ref_yuman__tarification_clean`\n),\n\n-- ============================================================================\n-- 3. ENRICHMENT & NORMALIZATION\n-- ============================================================================\nworkorders_enriched AS (\n  SELECT\n    w.*,\n    COALESCE(ti.workorder_type_clean, w.workorder_type_raw) AS workorder_type_clean,\n    COALESCE(m.machine_clean, w.machine_raw) AS machine_clean,\n    COALESCE(cp.Metropole, dp.Metropole) AS metropole_city,\n    CASE\n      WHEN w.postal_code_site IS NULL THEN 1\n      WHEN cp.Code_Postal IS NOT NULL THEN 1\n      WHEN dp.Departement IS NOT NULL THEN 1\n      ELSE 0\n    END AS metropole,\n    ROW_NUMBER() OVER(PARTITION BY w.workorder_id ORDER BY w.date_done) AS rn\n  FROM base_workorders w\n  LEFT JOIN ref_type_inter ti ON w.workorder_type_raw = ti.workorder_type_raw\n  LEFT JOIN ref_machine m ON w.machine_raw = m.machine_raw\n  LEFT JOIN ref_cp_metropole cp ON w.postal_code_site = cp.Code_Postal\n  LEFT JOIN ref_dpt_metropole dp ON LEFT(w.postal_code_site, 2) = dp.Departement\n),\n\n-- ============================================================================\n-- 4. DEDUPLICATION & RECURRENCE CALCULATION\n-- ============================================================================\nworkorders_dedup AS (\n  SELECT\n    *,\n    CASE\n      WHEN postal_code_site IS NULL THEN 1\n      ELSE COUNT(\n        CASE WHEN a_facturer THEN site_id END\n      ) OVER (PARTITION BY site_id, DATE(date_done))\n    END AS reccurence\n  FROM workorders_enriched\n),\n\n-- ============================================================================\n-- 5. PRICING TYPE DETERMINATION\n-- ============================================================================\nworkorders_with_tarif AS (\n  SELECT\n    *,\n    CASE\n      WHEN postal_code_site IS NULL THEN 'Tarif normal'\n      WHEN partner_name IN ('AUUM', 'FONTAINCO', 'TWYD', 'NESHU', 'NU', 'DAANTECH', 'EXPRESSO', 'DAAN') THEN\n        CASE\n          WHEN reccurence < 5 THEN 'Tarif normal'\n          WHEN reccurence BETWEEN 5 AND 20 THEN 'Remise niv1'\n          ELSE 'Remise niv2'\n        END\n      WHEN partner_name IN ('BRITA', 'FONTAINCO') THEN\n        CASE\n          WHEN reccurence < 2 THEN 'Tarif normal'\n          WHEN reccurence BETWEEN 2 AND 5 THEN 'Remise niv1'\n          ELSE 'Remise niv2'\n        END\n      ELSE 'Tarif normal'\n    END AS type_tarif\n  FROM workorders_dedup\n),\n\n-- ============================================================================\n-- 6. FINAL JOIN WITH TARIFF TABLE\n-- ============================================================================\nfinal_result AS (\n  SELECT\n    w.*,\n    t.Montant,\n    t.PROD,\n    LOWER(CONCAT(\n      w.workorder_type_clean, '_',\n      w.machine_clean, '_',\n      w.partner_name, '_',\n      w.type_tarif, '_',\n      CAST(w.metropole AS STRING)\n    )) AS key_tarif_used\n  FROM workorders_with_tarif w\n  LEFT JOIN ref_tarification t\n    ON LOWER(CONCAT(\n      w.workorder_type_clean, '_',\n      w.machine_clean, '_',\n      w.partner_name, '_',\n      w.type_tarif, '_',\n      CAST(w.metropole AS STRING)\n    )) = t.key_tarif\n)\n\n-- ============================================================================\n-- 7. FINAL SELECT (CLEAN OUTPUT)\n-- ============================================================================\nSELECT\n  demand_id,\n  workorder_id,\n  material_id,\n  site_id,\n  client_id,\n  technician_id,\n  manager_id,\n  demand_description,\n  demand_status,\n  demand_created_at,\n  demand_updated_at,\n  demand_category_name,\n  workorder_number,\n  workorder_category,\n  workorder_status,\n  workorder_technician_name,\n  workorder_date_creation,\n  workorder_motif_non_intervention,\n  workorder_detail_non_intervention,\n  workorder_raison_mise_en_pause,\n  workorder_explication_mise_en_pause,\n  date_planned,\n  date_started,\n  date_done,\n  partner_name,\n  client_code,\n  client_name,\n  client_category,\n  client_is_active,\n  site_code,\n  site_name,\n  site_address,\n  postal_code_site as site_postal_code,\n  material_serial_number,\n  workorder_type_raw,\n  machine_raw,\n\n  -- Renamed metrics and keys\n  workorder_type_clean,\n  machine_clean,\n  metropole             AS metropolitan,\n  metropole_city,\n  technician_equipe,\n  reccurence            AS recurrence_count,\n  type_tarif            AS pricing_type,\n  key_tarif_used        AS pricing_key_used,\n  a_facturer            AS to_invoice,\n  Montant               AS amount,\n  PROD                  AS prod_number,\n  CASE\n    WHEN Montant IS NOT NULL AND a_facturer = TRUE THEN 'VALIDATED'\n    WHEN Montant IS NULL AND a_facturer = TRUE THEN 'MISSING_TARIF'\n    ELSE 'NOT_BILLABLE'\n  END as billing_validation_status\n\nFROM final_result", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_pricing`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:24.552362Z", "completed_at": "2026-02-09T09:55:24.599662Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:24.662509Z", "completed_at": "2026-02-09T09:55:24.662524Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.4248981475830078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__pointage_date_pointage.a67439fee4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_pointage\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__pointage`\nwhere date_pointage is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:24.546029Z", "completed_at": "2026-02-09T09:55:24.600347Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:24.663757Z", "completed_at": "2026-02-09T09:55:24.663768Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.46991920471191406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__pointage_company_id.b5f06d2892", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__pointage`\nwhere company_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:24.561638Z", "completed_at": "2026-02-09T09:55:24.614738Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:24.706410Z", "completed_at": "2026-02-09T09:55:24.706422Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5066318511962891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__pointage_date_pointage_jour.f5827062b6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_pointage_jour\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__pointage`\nwhere date_pointage_jour is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:24.568393Z", "completed_at": "2026-02-09T09:55:24.616271Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:24.756052Z", "completed_at": "2026-02-09T09:55:24.756067Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.549058198928833, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__pointage_task_id.1779dca835", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__pointage`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:24.573899Z", "completed_at": "2026-02-09T09:55:24.617726Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:24.756766Z", "completed_at": "2026-02-09T09:55:24.756777Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.5497105121612549, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__chargement_tasks_created_at.1d6716d5b3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__chargement_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:24.580024Z", "completed_at": "2026-02-09T09:55:24.618506Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:24.799156Z", "completed_at": "2026-02-09T09:55:24.799167Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.589444637298584, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__chargement_tasks_extracted_at.5b043039e5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__chargement_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:24.587207Z", "completed_at": "2026-02-09T09:55:24.620166Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:24.841225Z", "completed_at": "2026-02-09T09:55:24.841237Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.6302051544189453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__chargement_tasks_product_id.22de4386cd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__chargement_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:24.593562Z", "completed_at": "2026-02-09T09:55:24.663149Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:24.842739Z", "completed_at": "2026-02-09T09:55:24.842751Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.659808874130249, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__chargement_tasks_task_id.2854f7842c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__chargement_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:24.601593Z", "completed_at": "2026-02-09T09:55:24.747906Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:24.927419Z", "completed_at": "2026-02-09T09:55:24.927432Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.6975593566894531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__chargement_tasks_task_product_id.2535ce79ec", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__chargement_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:24.607735Z", "completed_at": "2026-02-09T09:55:24.755431Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:24.970295Z", "completed_at": "2026-02-09T09:55:24.970308Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7407116889953613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__chargement_tasks_task_start_date.28397138e5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__chargement_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:24.748729Z", "completed_at": "2026-02-09T09:55:24.970927Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:25.227550Z", "completed_at": "2026-02-09T09:55:25.227562Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7418735027313232, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__chargement_tasks_updated_at.efc923f7ed", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__chargement_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:25.325863Z", "completed_at": "2026-02-09T09:55:25.375429Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:25.417170Z", "completed_at": "2026-02-09T09:55:25.417185Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.339202880859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_lcdp__chargement_tasks_task_product_id.9e96accc67", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__chargement_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:25.333306Z", "completed_at": "2026-02-09T09:55:25.377191Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:25.424030Z", "completed_at": "2026-02-09T09:55:25.424049Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.33984947204589844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__commande_interne_created_at.a1e99bfef7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__commande_interne`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:25.342079Z", "completed_at": "2026-02-09T09:55:25.389626Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:25.427721Z", "completed_at": "2026-02-09T09:55:25.427733Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.34746885299682617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__commande_interne_destination_code.698f2b367f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect destination_code\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__commande_interne`\nwhere destination_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:25.349557Z", "completed_at": "2026-02-09T09:55:25.409114Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:25.435779Z", "completed_at": "2026-02-09T09:55:25.435793Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.34644246101379395, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__commande_interne_extracted_at.60b691cc98", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__commande_interne`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:25.356455Z", "completed_at": "2026-02-09T09:55:25.409927Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:25.437248Z", "completed_at": "2026-02-09T09:55:25.437262Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.38699913024902344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__commande_interne_product_id.981384862c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__commande_interne`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:25.363539Z", "completed_at": "2026-02-09T09:55:25.417837Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:25.480606Z", "completed_at": "2026-02-09T09:55:25.480618Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.42629504203796387, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__commande_interne_source_code.9ffcc1ac35", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect source_code\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__commande_interne`\nwhere source_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:25.370316Z", "completed_at": "2026-02-09T09:55:25.424801Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:25.523607Z", "completed_at": "2026-02-09T09:55:25.523621Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4689164161682129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__commande_interne_task_id.a40d2bb83c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__commande_interne`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:25.377788Z", "completed_at": "2026-02-09T09:55:25.426531Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:25.531165Z", "completed_at": "2026-02-09T09:55:25.531181Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5095846652984619, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__commande_interne_task_product_id.3e75cf22f6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__commande_interne`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:25.383301Z", "completed_at": "2026-02-09T09:55:25.427145Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:25.531803Z", "completed_at": "2026-02-09T09:55:25.531814Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.550225019454956, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__commande_interne_task_start_date.c7904d40ae", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__commande_interne`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:25.391007Z", "completed_at": "2026-02-09T09:55:25.434236Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:25.573297Z", "completed_at": "2026-02-09T09:55:25.573314Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.5486600399017334, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__commande_interne_updated_at.84ed1ace71", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__commande_interne`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:25.403680Z", "completed_at": "2026-02-09T09:55:25.436544Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:25.575803Z", "completed_at": "2026-02-09T09:55:25.575813Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.591559648513794, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__ecart_inventaire_tasks_created_at.6b692b7358", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__ecart_inventaire_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:25.396255Z", "completed_at": "2026-02-09T09:55:25.479915Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:25.660672Z", "completed_at": "2026-02-09T09:55:25.660683Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6351549625396729, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_lcdp__commande_interne_task_product_id.30b15794df", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__commande_interne`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:25.410538Z", "completed_at": "2026-02-09T09:55:25.481313Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:25.702722Z", "completed_at": "2026-02-09T09:55:25.702734Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6715750694274902, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__ecart_inventaire_tasks_extracted_at.f7d757339f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__ecart_inventaire_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:25.418474Z", "completed_at": "2026-02-09T09:55:25.529416Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:25.704232Z", "completed_at": "2026-02-09T09:55:25.704244Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7055456638336182, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__ecart_inventaire_tasks_product_id.6728a17b2e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__ecart_inventaire_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:25.428369Z", "completed_at": "2026-02-09T09:55:25.575135Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:25.873567Z", "completed_at": "2026-02-09T09:55:25.873580Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7427456378936768, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__ecart_inventaire_tasks_task_id.3b394be939", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__ecart_inventaire_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:25.524334Z", "completed_at": "2026-02-09T09:55:25.871141Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:26.048704Z", "completed_at": "2026-02-09T09:55:26.048716Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7530715465545654, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__ecart_inventaire_tasks_task_product_id.3bc438232b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__ecart_inventaire_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:26.144874Z", "completed_at": "2026-02-09T09:55:26.183177Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:26.223828Z", "completed_at": "2026-02-09T09:55:26.223845Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.3827526569366455, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__ecart_inventaire_tasks_task_start_date.e41f3de37c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__ecart_inventaire_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:26.154599Z", "completed_at": "2026-02-09T09:55:26.197326Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:26.245017Z", "completed_at": "2026-02-09T09:55:26.245033Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.33899617195129395, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__ecart_inventaire_tasks_updated_at.2e099148d3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__ecart_inventaire_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:26.164007Z", "completed_at": "2026-02-09T09:55:26.223072Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:26.256307Z", "completed_at": "2026-02-09T09:55:26.256319Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.3462064266204834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_lcdp__ecart_inventaire_tasks_task_product_id.960479f31e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__ecart_inventaire_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:26.170393Z", "completed_at": "2026-02-09T09:55:26.231549Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:26.299456Z", "completed_at": "2026-02-09T09:55:26.299475Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.3469357490539551, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__inventaire_tasks_created_at.97a5de7bfd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__inventaire_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:26.178091Z", "completed_at": "2026-02-09T09:55:26.232412Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:26.300912Z", "completed_at": "2026-02-09T09:55:26.300924Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3866596221923828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__inventaire_tasks_extracted_at.2cf71b6140", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__inventaire_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:26.184922Z", "completed_at": "2026-02-09T09:55:26.238295Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:26.301550Z", "completed_at": "2026-02-09T09:55:26.301566Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.42761874198913574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__inventaire_tasks_product_id.cdd0a95735", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__inventaire_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:26.191109Z", "completed_at": "2026-02-09T09:55:26.245721Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:26.344210Z", "completed_at": "2026-02-09T09:55:26.344226Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.46714115142822266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__inventaire_tasks_task_id.172df9055c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__inventaire_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:26.198016Z", "completed_at": "2026-02-09T09:55:26.246861Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:26.346155Z", "completed_at": "2026-02-09T09:55:26.346166Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5089950561523438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__inventaire_tasks_task_product_id.215049d50e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__inventaire_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:26.204792Z", "completed_at": "2026-02-09T09:55:26.247626Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:26.346775Z", "completed_at": "2026-02-09T09:55:26.346785Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5500876903533936, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__inventaire_tasks_task_start_date.bb931297db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__inventaire_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:26.209978Z", "completed_at": "2026-02-09T09:55:26.254453Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:26.352621Z", "completed_at": "2026-02-09T09:55:26.352634Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.5919055938720703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__inventaire_tasks_updated_at.b8a1a532db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__inventaire_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:26.217566Z", "completed_at": "2026-02-09T09:55:26.257038Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:26.354169Z", "completed_at": "2026-02-09T09:55:26.354181Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.587151288986206, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_lcdp__inventaire_tasks_task_product_id.a6cfaf6c3e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__inventaire_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:26.224674Z", "completed_at": "2026-02-09T09:55:26.300302Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:26.398030Z", "completed_at": "2026-02-09T09:55:26.398041Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6415591239929199, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__livraison_interne_tasks_created_at.74a7970dbf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__livraison_interne_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:26.233173Z", "completed_at": "2026-02-09T09:55:26.344870Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:26.565785Z", "completed_at": "2026-02-09T09:55:26.565798Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6842668056488037, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__livraison_interne_tasks_extracted_at.524548caca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__livraison_interne_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:26.239396Z", "completed_at": "2026-02-09T09:55:26.345547Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:26.566469Z", "completed_at": "2026-02-09T09:55:26.566481Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7192671298980713, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__livraison_interne_tasks_product_id.483071902a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__livraison_interne_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:26.248909Z", "completed_at": "2026-02-09T09:55:26.354749Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:26.739534Z", "completed_at": "2026-02-09T09:55:26.739548Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7574436664581299, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__livraison_interne_tasks_task_id.964edb813d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__livraison_interne_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:26.347417Z", "completed_at": "2026-02-09T09:55:26.737415Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:26.883480Z", "completed_at": "2026-02-09T09:55:26.883497Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7624976634979248, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__livraison_interne_tasks_task_product_id.a4f5c6ac0b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__livraison_interne_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:26.980642Z", "completed_at": "2026-02-09T09:55:27.014118Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:27.062123Z", "completed_at": "2026-02-09T09:55:27.062144Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.39388513565063477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__livraison_interne_tasks_task_start_date.558e096d0e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__livraison_interne_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:26.988656Z", "completed_at": "2026-02-09T09:55:27.026337Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:27.070477Z", "completed_at": "2026-02-09T09:55:27.070493Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.3874800205230713, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__livraison_interne_tasks_updated_at.6c30cc75bb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__livraison_interne_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.002318Z", "completed_at": "2026-02-09T09:55:27.062765Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:27.136096Z", "completed_at": "2026-02-09T09:55:27.136108Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.3104548454284668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_lcdp__livraison_interne_tasks_task_product_id.fdfe3a778c", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__livraison_interne_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.008602Z", "completed_at": "2026-02-09T09:55:27.063558Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:27.137536Z", "completed_at": "2026-02-09T09:55:27.137552Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.34886646270751953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__telemetry_tasks_created_at.48ecffec4b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__telemetry_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.014757Z", "completed_at": "2026-02-09T09:55:27.069837Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:27.138292Z", "completed_at": "2026-02-09T09:55:27.138307Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3896188735961914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__telemetry_tasks_extracted_at.c0e32aa750", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__telemetry_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.028702Z", "completed_at": "2026-02-09T09:55:27.077117Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:27.181437Z", "completed_at": "2026-02-09T09:55:27.181452Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4303889274597168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__telemetry_tasks_task_id.e7fea3bcb4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__telemetry_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.021267Z", "completed_at": "2026-02-09T09:55:27.085044Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:27.182937Z", "completed_at": "2026-02-09T09:55:27.182967Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.47287416458129883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__telemetry_tasks_product_id.605078c6fa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__telemetry_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.035633Z", "completed_at": "2026-02-09T09:55:27.085758Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:27.183647Z", "completed_at": "2026-02-09T09:55:27.183662Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.511584997177124, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__telemetry_tasks_task_product_id.c1136834f1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__telemetry_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.041196Z", "completed_at": "2026-02-09T09:55:27.086746Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:27.184350Z", "completed_at": "2026-02-09T09:55:27.184364Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5531527996063232, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__telemetry_tasks_task_start_date.0178993e8b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__telemetry_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.047105Z", "completed_at": "2026-02-09T09:55:27.088106Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:27.191792Z", "completed_at": "2026-02-09T09:55:27.191804Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.5951173305511475, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__telemetry_tasks_updated_at.592165f17d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__telemetry_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.054691Z", "completed_at": "2026-02-09T09:55:27.136800Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:27.194181Z", "completed_at": "2026-02-09T09:55:27.194194Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.6379256248474121, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_lcdp__telemetry_tasks_task_product_id.57f7484a74", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__telemetry_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.064224Z", "completed_at": "2026-02-09T09:55:27.138912Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:27.319881Z", "completed_at": "2026-02-09T09:55:27.319894Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6227033138275146, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__livraison_tasks_created_at.21f1d09d15", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__livraison_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.071415Z", "completed_at": "2026-02-09T09:55:27.182237Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:27.361997Z", "completed_at": "2026-02-09T09:55:27.362010Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6641414165496826, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__livraison_tasks_extracted_at.2614cae2fe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__livraison_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.077799Z", "completed_at": "2026-02-09T09:55:27.184933Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:27.446992Z", "completed_at": "2026-02-09T09:55:27.447007Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7072649002075195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__livraison_tasks_product_id.f08c2f0a73", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__livraison_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.088832Z", "completed_at": "2026-02-09T09:55:27.193330Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:27.531864Z", "completed_at": "2026-02-09T09:55:27.531876Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7411339282989502, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__livraison_tasks_task_id.de4d8ef095", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__livraison_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.185582Z", "completed_at": "2026-02-09T09:55:27.532485Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:27.707440Z", "completed_at": "2026-02-09T09:55:27.707452Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7480413913726807, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__livraison_tasks_task_product_id.e1bbb2bd6d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__livraison_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.757178Z", "completed_at": "2026-02-09T09:55:27.821957Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:27.868973Z", "completed_at": "2026-02-09T09:55:27.868987Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.41719555854797363, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__livraison_tasks_task_start_date.254eec8e79", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__livraison_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.811667Z", "completed_at": "2026-02-09T09:55:27.849293Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:27.890666Z", "completed_at": "2026-02-09T09:55:27.890682Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.42275214195251465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__livraison_tasks_updated_at.e776e3efa4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__livraison_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.824688Z", "completed_at": "2026-02-09T09:55:27.882129Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:27.954856Z", "completed_at": "2026-02-09T09:55:27.954873Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.30504512786865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_lcdp__livraison_tasks_task_product_id.355882531f", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__livraison_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.830793Z", "completed_at": "2026-02-09T09:55:27.889814Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:27.956922Z", "completed_at": "2026-02-09T09:55:27.956934Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.346604585647583, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__reception_tasks_created_at.404deb1528", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__reception_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.843864Z", "completed_at": "2026-02-09T09:55:27.891433Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:27.998649Z", "completed_at": "2026-02-09T09:55:27.998663Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3873884677886963, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__reception_tasks_product_id.3ee1eb3249", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__reception_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.837279Z", "completed_at": "2026-02-09T09:55:27.897333Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.000657Z", "completed_at": "2026-02-09T09:55:28.000669Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.47204089164733887, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__reception_tasks_extracted_at.1059a5279c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__reception_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.849890Z", "completed_at": "2026-02-09T09:55:27.898084Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.001316Z", "completed_at": "2026-02-09T09:55:28.001327Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.4708425998687744, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__reception_tasks_task_id.9603eab6d4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__reception_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.862708Z", "completed_at": "2026-02-09T09:55:27.904811Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.002232Z", "completed_at": "2026-02-09T09:55:28.002248Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5105867385864258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__reception_tasks_task_start_date.9688626255", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__reception_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.856035Z", "completed_at": "2026-02-09T09:55:27.905776Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.002932Z", "completed_at": "2026-02-09T09:55:28.002964Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5527963638305664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__reception_tasks_task_product_id.1ff01359ec", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__reception_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.869611Z", "completed_at": "2026-02-09T09:55:27.955495Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.055611Z", "completed_at": "2026-02-09T09:55:28.055623Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.5888862609863281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_lcdp__reception_tasks_updated_at.8c88622df8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__reception_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.876629Z", "completed_at": "2026-02-09T09:55:27.956191Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.056288Z", "completed_at": "2026-02-09T09:55:28.056303Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5865538120269775, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_lcdp__reception_tasks_task_product_id.839584ea5a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_lcdp__reception_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.882994Z", "completed_at": "2026-02-09T09:55:27.957713Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.098574Z", "completed_at": "2026-02-09T09:55:28.098586Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6221864223480225, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_snap_oracle_neshu__company_company_id.2068c4bbe1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom `evs-datastack-prod`.`snapshots`.`snap_oracle_neshu__company`\nwhere company_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.892190Z", "completed_at": "2026-02-09T09:55:28.004386Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.310151Z", "completed_at": "2026-02-09T09:55:28.310168Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6663351058959961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_snap_oracle_neshu__company_dbt_scd_id.91a7906afe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dbt_scd_id\nfrom `evs-datastack-prod`.`snapshots`.`snap_oracle_neshu__company`\nwhere dbt_scd_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.899315Z", "completed_at": "2026-02-09T09:55:28.005126Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.310814Z", "completed_at": "2026-02-09T09:55:28.310825Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7465949058532715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_snap_oracle_neshu__company_dbt_scd_id.c79fb3aced", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select dbt_scd_id as unique_field\n  from `evs-datastack-prod`.`snapshots`.`snap_oracle_neshu__company`\n  where dbt_scd_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:27.948128Z", "completed_at": "2026-02-09T09:55:28.013025Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.311624Z", "completed_at": "2026-02-09T09:55:28.311637Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7458221912384033, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_snap_oracle_neshu__device_dbt_scd_id.39f7d4ed32", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dbt_scd_id\nfrom `evs-datastack-prod`.`snapshots`.`snap_oracle_neshu__device`\nwhere dbt_scd_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:28.005868Z", "completed_at": "2026-02-09T09:55:28.313088Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.570685Z", "completed_at": "2026-02-09T09:55:28.570698Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.753000020980835, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_snap_oracle_neshu__device_device_id.513485a549", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `evs-datastack-prod`.`snapshots`.`snap_oracle_neshu__device`\nwhere device_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:28.578038Z", "completed_at": "2026-02-09T09:55:28.642322Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.689763Z", "completed_at": "2026-02-09T09:55:28.689781Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.4596586227416992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_snap_oracle_neshu__device_dbt_scd_id.269fd19cb3", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select dbt_scd_id as unique_field\n  from `evs-datastack-prod`.`snapshots`.`snap_oracle_neshu__device`\n  where dbt_scd_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:28.653262Z", "completed_at": "2026-02-09T09:55:28.656987Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.704423Z", "completed_at": "2026-02-09T09:55:28.704443Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.24573850631713867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbt_warehouse.snap_oracle_neshu__valo_parc_machines", "compiled": true, "compiled_code": "\n\n\n\nSELECT \n  TIMESTAMP(DATE_TRUNC(CURRENT_DATE(), MONTH)) as snapshot_month,  -- \u2705 Ajout de TIMESTAMP()\n  device_name,\n  device_group,\n  nombre_machines,\n  valorisation_totale_machine\nFROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__valorisation_parc_machines`\n", "relation_name": "`evs-datastack-prod`.`snapshots`.`snap_oracle_neshu__valo_parc_machines`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:28.630965Z", "completed_at": "2026-02-09T09:55:28.658457Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.710683Z", "completed_at": "2026-02-09T09:55:28.710698Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.46367573738098145, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__machines_yuman_maintenance_base_device_code.a8d1d80e51", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_code\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__machines_yuman_maintenance_base`\nwhere device_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:28.643581Z", "completed_at": "2026-02-09T09:55:28.697751Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.775495Z", "completed_at": "2026-02-09T09:55:28.775512Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.3388845920562744, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__machines_yuman_maintenance_base_device_id.eb5ccd792d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__machines_yuman_maintenance_base`\nwhere device_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:28.664803Z", "completed_at": "2026-02-09T09:55:28.711863Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.862586Z", "completed_at": "2026-02-09T09:55:28.862598Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.38529515266418457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__valorisation_parc_machines_device_name.d0e9413d98", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_name\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__valorisation_parc_machines`\nwhere device_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:28.659108Z", "completed_at": "2026-02-09T09:55:28.713370Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.863869Z", "completed_at": "2026-02-09T09:55:28.863881Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4277358055114746, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__valorisation_parc_machines_device_group.4a8a9df545", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_group\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__valorisation_parc_machines`\nwhere device_group is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:28.677464Z", "completed_at": "2026-02-09T09:55:28.726738Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.864734Z", "completed_at": "2026-02-09T09:55:28.864746Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5078790187835693, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_destination_code.60865e1142", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect destination_code\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere destination_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:28.670615Z", "completed_at": "2026-02-09T09:55:28.712677Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.863240Z", "completed_at": "2026-02-09T09:55:28.863255Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.5097208023071289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_created_at.49335f4f3a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:28.682837Z", "completed_at": "2026-02-09T09:55:28.727436Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.865495Z", "completed_at": "2026-02-09T09:55:28.865510Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5509703159332275, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_extracted_at.9d5f1d0c81", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:28.691252Z", "completed_at": "2026-02-09T09:55:28.776356Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.909808Z", "completed_at": "2026-02-09T09:55:28.909820Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.5453290939331055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_product_id.422706e73d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:28.699036Z", "completed_at": "2026-02-09T09:55:28.819372Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.917905Z", "completed_at": "2026-02-09T09:55:28.917917Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.6268010139465332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_source_code.806024b65d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect source_code\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere source_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:28.705232Z", "completed_at": "2026-02-09T09:55:28.860668Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:28.918582Z", "completed_at": "2026-02-09T09:55:28.918598Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6206331253051758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_task_id.feb7a19392", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:28.714133Z", "completed_at": "2026-02-09T09:55:28.866862Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:29.129285Z", "completed_at": "2026-02-09T09:55:29.129297Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.663398027420044, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_task_product_id.acafb99a38", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:28.719795Z", "completed_at": "2026-02-09T09:55:28.867588Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:29.129968Z", "completed_at": "2026-02-09T09:55:29.129980Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7048606872558594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_task_start_date.863ef2a87e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:28.769938Z", "completed_at": "2026-02-09T09:55:28.910507Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:29.131470Z", "completed_at": "2026-02-09T09:55:29.131482Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7459921836853027, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_updated_at.bfec986bee", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:28.911189Z", "completed_at": "2026-02-09T09:55:29.215121Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:29.390488Z", "completed_at": "2026-02-09T09:55:29.390501Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7561712265014648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__ecart_inventaire_tasks_created_at.7d0fcea0cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:29.395811Z", "completed_at": "2026-02-09T09:55:29.466460Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:29.511377Z", "completed_at": "2026-02-09T09:55:29.511398Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.45613598823547363, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__ecart_inventaire_tasks_extracted_at.3521403fea", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:29.408294Z", "completed_at": "2026-02-09T09:55:29.476396Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:29.525640Z", "completed_at": "2026-02-09T09:55:29.525654Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.4660522937774658, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__ecart_inventaire_tasks_product_id.7f8ffacb68", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:29.456788Z", "completed_at": "2026-02-09T09:55:29.495273Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:29.533248Z", "completed_at": "2026-02-09T09:55:29.533262Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.42446136474609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__ecart_inventaire_tasks_task_id.a45f2ce08b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:29.467089Z", "completed_at": "2026-02-09T09:55:29.517961Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:29.590073Z", "completed_at": "2026-02-09T09:55:29.590086Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.4249711036682129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__ecart_inventaire_tasks_task_product_id.e6945505d5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:29.477640Z", "completed_at": "2026-02-09T09:55:29.534012Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:29.681884Z", "completed_at": "2026-02-09T09:55:29.681906Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3897898197174072, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__ecart_inventaire_tasks_task_start_date.6192042d8e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:29.482979Z", "completed_at": "2026-02-09T09:55:29.535175Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:29.683855Z", "completed_at": "2026-02-09T09:55:29.683867Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4314553737640381, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__ecart_inventaire_tasks_updated_at.a93b91f4db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:29.496744Z", "completed_at": "2026-02-09T09:55:29.582605Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:29.686500Z", "completed_at": "2026-02-09T09:55:29.686511Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.5131607055664062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__ecart_inventaire_tasks_task_product_id.0895448e86", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:29.490190Z", "completed_at": "2026-02-09T09:55:29.535864Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:29.685711Z", "completed_at": "2026-02-09T09:55:29.685726Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5149078369140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__commande_interne_task_product_id.b43ba28698", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:29.502221Z", "completed_at": "2026-02-09T09:55:29.596074Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:29.688844Z", "completed_at": "2026-02-09T09:55:29.688856Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5515413284301758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_oracle_neshu__machines_maintenance_tracking", "compiled": true, "compiled_code": "-- fct_oracle_neshu__machines_maintenance_tracking.sql\n\n\nWITH machines_base AS (\n    SELECT * FROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__machines_yuman_maintenance_base`\n),\n\n-- INTERVENTIONS YUMAN (toutes, pas de filtre ici)\nall_workorders AS (\n    SELECT \n        wd.demand_id, \n        wd.workorder_id,\n        wd.material_id, \n        wd.demand_status,\n        wdc.demand_category_name, \n        wo.date_planned,\n        wo.date_done, \n        wo.workorder_type, \n        wo.workorder_status\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands` wd\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands_categories` wdc\n        ON wd.demand_category_id = wdc.demand_category_id\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders` wo\n        ON wd.workorder_id = wo.workorder_id\n),\n\n-- ENRICHISSEMENT : Ajouter les interventions AUX machines (LEFT JOIN)\nworkorder_enrichi AS (\n    SELECT \n        mb.*,\n        wo.demand_id,\n        wo.workorder_id,\n        wo.demand_status,\n        wo.demand_category_name,\n        wo.date_planned,\n        wo.date_done,\n        wo.workorder_type,\n        wo.workorder_status\n    FROM machines_base mb\n    LEFT JOIN all_workorders wo\n        ON mb.material_id = wo.material_id\n),\n\n-- LISTE INTERVENTION PREV DLOG\nintervention_prev_dlog AS (\n    SELECT \n        CONCAT('NESH_', device_code) AS device_code, \n        MAX(task_end_date) AS last_preventive_date\n    FROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\n    WHERE dc04 = 'DC0402'\n        AND task_status_code = 'FAIT'\n    GROUP BY device_code\n),\n\n-- AJOUT PREV DLOG DANS LA LISTE DES INTERVENTION YUMAN\nmaterial_enrichi AS (\n    SELECT \n        we.*, \n        ipd.last_preventive_date \n    FROM workorder_enrichi we\n    LEFT JOIN intervention_prev_dlog ipd\n        ON we.material_serial_number = ipd.device_code\n),\n\n-- CALCUL DU RETARD PAR MACHINE\ncalcul_retard AS (\n    SELECT\n        device_id,\n        material_id,\n        device_code,\n        material_serial_number,\n        last_installation_date,\n        device_name,\n        company_code,\n        company_name,\n        client_code,\n        client_name,\n        client_category,\n        site_postal_code,\n        demand_status,\n        date_planned,\n        material_created_at,\n        \n        -- D\u00e9terminer la derni\u00e8re pr\u00e9ventive de la source 1 (Yuman)\n        MAX(CASE \n            WHEN (workorder_type = 'Preventive' OR demand_category_name = 'PREVENTIVE PROG - NESHU') \n                AND workorder_status = 'Closed' \n            THEN date_done \n            ELSE NULL \n        END) OVER (PARTITION BY material_id) AS derniere_preventive_source1,\n        \n        -- R\u00e9cup\u00e9rer la pr\u00e9ventive externe (source 2 - DLOG)\n        MAX(last_preventive_date) OVER (PARTITION BY material_id) AS derniere_preventive_source2,\n        \n        -- Date du jour\n        CURRENT_TIMESTAMP() AS today\n        \n    FROM material_enrichi\n),\n\n-- LOGIQUE PRINCIPALE DE CALCUL\nretard_final AS (\n    SELECT DISTINCT\n        device_id,\n        material_id,\n        device_code,\n        material_serial_number,\n        last_installation_date,\n        device_name,\n        company_code,\n        company_name,\n        client_code,\n        client_name,\n        client_category,\n        site_postal_code,\n        demand_status,\n        date_planned,\n        material_created_at,\n        \n        -- CAS 1: Machine install\u00e9e depuis moins de 13 mois\n        CASE\n            WHEN last_installation_date > TIMESTAMP_SUB(today, INTERVAL 395 DAY) THEN\n                FALSE\n            \n            -- CAS 2: Machine ancienne sans aucune pr\u00e9ventive\n            WHEN derniere_preventive_source1 IS NULL AND derniere_preventive_source2 IS NULL THEN\n                TRUE\n            \n            -- CAS 3: Machine avec pr\u00e9ventives - v\u00e9rifier si retard > 365 jours\n            ELSE\n                CASE\n                    WHEN GREATEST(\n                        COALESCE(derniere_preventive_source1, TIMESTAMP('1900-01-01')),\n                        COALESCE(derniere_preventive_source2, TIMESTAMP('1900-01-01'))\n                    ) < TIMESTAMP_SUB(today, INTERVAL 365 DAY)\n                    THEN TRUE\n                    ELSE FALSE\n                END\n        END AS retard_bol,\n        \n        -- CALCUL DU D\u00c9LAI\n        CASE\n            -- CAS 1: Machine r\u00e9cente (< 13 mois)\n            WHEN last_installation_date > TIMESTAMP_SUB(today, INTERVAL 395 DAY) THEN\n                TIMESTAMP_DIFF(TIMESTAMP_ADD(last_installation_date, INTERVAL 395 DAY), today, DAY)\n            \n            -- CAS 2: Aucune pr\u00e9ventive\n            WHEN derniere_preventive_source1 IS NULL AND derniere_preventive_source2 IS NULL THEN\n                -TIMESTAMP_DIFF(today, TIMESTAMP_ADD(last_installation_date, INTERVAL 365 DAY), DAY)\n            \n            -- CAS 3: Avec pr\u00e9ventives\n            ELSE\n                CASE\n                    WHEN TIMESTAMP_DIFF(today, GREATEST(\n                        COALESCE(derniere_preventive_source1, TIMESTAMP('1900-01-01')),\n                        COALESCE(derniere_preventive_source2, TIMESTAMP('1900-01-01'))\n                    ), DAY) > 365\n                    THEN -(TIMESTAMP_DIFF(today, GREATEST(\n                        COALESCE(derniere_preventive_source1, TIMESTAMP('1900-01-01')),\n                        COALESCE(derniere_preventive_source2, TIMESTAMP('1900-01-01'))\n                    ), DAY) - 365)\n                    ELSE 365 - TIMESTAMP_DIFF(today, GREATEST(\n                        COALESCE(derniere_preventive_source1, TIMESTAMP('1900-01-01')),\n                        COALESCE(derniere_preventive_source2, TIMESTAMP('1900-01-01'))\n                    ), DAY)\n                END\n        END AS retard_delai,\n        \n        -- SOURCE DE LA DERNI\u00c8RE PR\u00c9VENTIVE\n        CASE\n            WHEN last_installation_date > TIMESTAMP_SUB(today, INTERVAL 395 DAY) THEN\n                'aucune'\n            WHEN derniere_preventive_source1 IS NULL AND derniere_preventive_source2 IS NULL THEN\n                'aucune'\n            WHEN derniere_preventive_source2 IS NULL OR \n                (derniere_preventive_source1 IS NOT NULL AND derniere_preventive_source1 > derniere_preventive_source2) THEN\n                'yuman'\n            ELSE\n                'dlog'\n        END AS source_last_preventive,\n        \n        today\n        \n    FROM calcul_retard\n),\n\n-- D\u00c9DUPLICATION: Garder une seule ligne par machine\ndeduplique AS (\n    SELECT\n        * EXCEPT(today),\n        ROW_NUMBER() OVER (\n            PARTITION BY material_serial_number \n            ORDER BY \n                retard_bol ASC,                -- Les machines non en retard d'abord (FALSE avant TRUE)\n                material_created_at DESC,      -- Si les 2 non en retard : la plus r\u00e9cente\n                retard_delai ASC               -- Si les 2 en retard : le plus grand d\u00e9lai (n\u00e9gatif donc ASC)\n        ) AS rn\n    FROM retard_final\n),\n\n-- R\u00c9SULTAT RETARD DEDUPLIQU\u00c9\nresultat_retard AS (\n    SELECT\n        device_id,\n        material_id,\n        device_code,\n        material_serial_number,\n        last_installation_date,\n        device_name,\n        company_code,\n        company_name,\n        client_code,\n        client_name,\n        client_category,\n        site_postal_code,\n        retard_bol,\n        retard_delai,\n        source_last_preventive,\n        material_created_at\n    FROM deduplique\n    WHERE rn = 1\n),\n\n-- DEMANDES D'INTERVENTION YUMAN OUVERTES & PLANIFI\u00c9ES\ndi_data AS (\n    SELECT \n        wd.material_id,\n        wo.date_planned,\n        wd.created_at AS demand_created_at,  -- R\u00e9cup\u00e9rer la date de cr\u00e9ation\n        CASE\n            WHEN wd.demand_status = 'Open' THEN 'Ouvert'\n            WHEN wo.workorder_status = 'Scheduled' THEN 'Planifie'\n            ELSE 'Aucune'\n        END AS status_inter\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands` wd\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands_categories` wdc\n        ON wd.demand_category_id = wdc.demand_category_id\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders` wo\n        ON wd.workorder_id = wo.workorder_id\n    WHERE wdc.demand_category_name = 'PREVENTIVE PROG - NESHU' \n        AND (wd.demand_status = 'Open' OR wo.workorder_status = 'Scheduled')\n),\n\n-- JOIN INTERM\u00c9DIAIRE\njoined_data AS (\n    SELECT\n        rr.device_id,\n        rr.device_code,\n        rr.device_name,\n        rr.company_code,\n        rr.company_name,\n        rr.last_installation_date,\n        rr.material_id,\n        rr.material_serial_number,\n        rr.client_code,\n        rr.client_name,\n        rr.client_category,\n        rr.site_postal_code,\n        rr.retard_bol,\n        rr.retard_delai,\n        rr.source_last_preventive,\n        rr.material_created_at,\n        di.status_inter,\n        di.date_planned,\n        di.demand_created_at\n    FROM resultat_retard rr\n    LEFT JOIN di_data di\n        ON rr.material_id = di.material_id\n),\n\n-- D\u00c9DUPLICATION PAR DEVICE_ID (garder la DI la plus r\u00e9cente)\ndeduplicated AS (\n    SELECT\n        *,\n        ROW_NUMBER() OVER (\n            PARTITION BY device_id\n            ORDER BY demand_created_at DESC NULLS LAST  -- Les plus r\u00e9centes d'abord, NULL \u00e0 la fin\n        ) AS rn\n    FROM joined_data\n),\n\n-- ENRICHISSEMENT FINAL\nfinal AS (\n    SELECT\n        device_id,\n        device_code,\n        device_name,\n        company_code,\n        company_name,\n        last_installation_date AS device_last_installation_date,\n        material_id,\n        material_serial_number,\n        client_code,\n        client_name,\n        client_category,\n        site_postal_code,\n        retard_bol,\n        retard_delai,\n        source_last_preventive,\n        COALESCE(status_inter, 'Aucune') AS status_inter,\n        date_planned,\n        material_created_at,\n\n        -- M\u00e9tadonn\u00e9es dbt\n        CURRENT_TIMESTAMP() as dbt_updated_at,\n        'cb08451a-2004-4aaf-949e-f43cc89d5466' as dbt_invocation_id\n\n    FROM deduplicated\n    WHERE rn = 1  -- Ne garder qu'une ligne par device_id\n)\n\nSELECT * FROM final", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:29.512884Z", "completed_at": "2026-02-09T09:55:29.638723Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:29.739285Z", "completed_at": "2026-02-09T09:55:29.739298Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.5901641845703125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inter_techinique_tasks_company_id.963bf0b41a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\nwhere company_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:29.526616Z", "completed_at": "2026-02-09T09:55:29.684460Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:29.783992Z", "completed_at": "2026-02-09T09:55:29.784006Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.5853407382965088, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inter_techinique_tasks_device_id.a4926002cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\nwhere device_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:29.520460Z", "completed_at": "2026-02-09T09:55:29.685087Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:29.826159Z", "completed_at": "2026-02-09T09:55:29.826171Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.6278529167175293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inter_techinique_tasks_created_at.23cf274781", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:29.536569Z", "completed_at": "2026-02-09T09:55:29.687185Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:29.910448Z", "completed_at": "2026-02-09T09:55:29.910464Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6614348888397217, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inter_techinique_tasks_extracted_at.ebb7615afa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:29.584372Z", "completed_at": "2026-02-09T09:55:29.738558Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:29.954301Z", "completed_at": "2026-02-09T09:55:29.954314Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.6984610557556152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inter_techinique_tasks_task_id.2ab30c87a3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:29.590960Z", "completed_at": "2026-02-09T09:55:29.740703Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:29.997795Z", "completed_at": "2026-02-09T09:55:29.997806Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7400646209716797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inter_techinique_tasks_task_start_date.4d976b328e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:29.731096Z", "completed_at": "2026-02-09T09:55:29.954993Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:30.170492Z", "completed_at": "2026-02-09T09:55:30.170505Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7506294250488281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inter_techinique_tasks_updated_at.75a6fbc88b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:30.219979Z", "completed_at": "2026-02-09T09:55:30.293327Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:30.337452Z", "completed_at": "2026-02-09T09:55:30.337473Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.4996333122253418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__inter_techinique_tasks_task_id.e6fbe5979b", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\n  where task_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:30.271478Z", "completed_at": "2026-02-09T09:55:30.303529Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:30.347022Z", "completed_at": "2026-02-09T09:55:30.347038Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.5565531253814697, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inventaire_tasks_created_at.e03cda86f7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:30.279558Z", "completed_at": "2026-02-09T09:55:30.310671Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:30.347810Z", "completed_at": "2026-02-09T09:55:30.347825Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.515103816986084, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inventaire_tasks_extracted_at.ce6508aabf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:30.293966Z", "completed_at": "2026-02-09T09:55:30.344975Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:30.421282Z", "completed_at": "2026-02-09T09:55:30.421299Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.44166088104248047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inventaire_tasks_product_id.315d649f9b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:30.304355Z", "completed_at": "2026-02-09T09:55:30.348604Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:30.515458Z", "completed_at": "2026-02-09T09:55:30.515472Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3995168209075928, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inventaire_tasks_task_id.12d8825475", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:30.311348Z", "completed_at": "2026-02-09T09:55:30.349281Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:30.516183Z", "completed_at": "2026-02-09T09:55:30.516199Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4413161277770996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inventaire_tasks_task_product_id.40c0d72097", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:30.318371Z", "completed_at": "2026-02-09T09:55:30.368152Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:30.517182Z", "completed_at": "2026-02-09T09:55:30.517195Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.4807586669921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inventaire_tasks_task_start_date.6ab0a21e68", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:30.332025Z", "completed_at": "2026-02-09T09:55:30.411747Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:30.520167Z", "completed_at": "2026-02-09T09:55:30.520182Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5168919563293457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__inventaire_tasks_task_product_id.6de7c4abb7", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:30.325713Z", "completed_at": "2026-02-09T09:55:30.420597Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:30.528061Z", "completed_at": "2026-02-09T09:55:30.528074Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5679531097412109, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inventaire_tasks_updated_at.ed499f687b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:30.339875Z", "completed_at": "2026-02-09T09:55:30.514734Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:30.572816Z", "completed_at": "2026-02-09T09:55:30.572831Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.5546600818634033, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_interne_tasks_created_at.c6d4b559be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:30.355058Z", "completed_at": "2026-02-09T09:55:30.517972Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:30.700327Z", "completed_at": "2026-02-09T09:55:30.700345Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.587249755859375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_interne_tasks_product_id.84345d9252", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:30.349898Z", "completed_at": "2026-02-09T09:55:30.519428Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:30.701934Z", "completed_at": "2026-02-09T09:55:30.701971Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6298468112945557, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_interne_tasks_extracted_at.931738aaac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:30.363078Z", "completed_at": "2026-02-09T09:55:30.520953Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:30.702729Z", "completed_at": "2026-02-09T09:55:30.702741Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6694157123565674, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_interne_tasks_task_id.3d326d6d80", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:30.412385Z", "completed_at": "2026-02-09T09:55:30.528694Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:30.785830Z", "completed_at": "2026-02-09T09:55:30.785867Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7053835391998291, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_interne_tasks_task_product_id.4515c1033a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:30.421931Z", "completed_at": "2026-02-09T09:55:30.573407Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:30.831579Z", "completed_at": "2026-02-09T09:55:30.831597Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7482197284698486, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_interne_tasks_task_start_date.a2d90a847c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:30.521676Z", "completed_at": "2026-02-09T09:55:30.788224Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:30.964207Z", "completed_at": "2026-02-09T09:55:30.964224Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7674458026885986, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_interne_tasks_updated_at.40f144213d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.053325Z", "completed_at": "2026-02-09T09:55:31.125008Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:31.157887Z", "completed_at": "2026-02-09T09:55:31.157902Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.5422439575195312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_tasks_created_at.d2d3de44aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.113849Z", "completed_at": "2026-02-09T09:55:31.135266Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:31.178036Z", "completed_at": "2026-02-09T09:55:31.178053Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.5017745494842529, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_tasks_product_id.8522aad15d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.108172Z", "completed_at": "2026-02-09T09:55:31.136008Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:31.179504Z", "completed_at": "2026-02-09T09:55:31.179517Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.5511806011199951, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_tasks_extracted_at.175de36255", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.128286Z", "completed_at": "2026-02-09T09:55:31.178809Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:31.293216Z", "completed_at": "2026-02-09T09:55:31.293230Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.3903818130493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_tasks_task_id.aed5d7619e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.136599Z", "completed_at": "2026-02-09T09:55:31.187011Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:31.341737Z", "completed_at": "2026-02-09T09:55:31.341751Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3900926113128662, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_tasks_task_product_id.e3b9b08f8d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.150303Z", "completed_at": "2026-02-09T09:55:31.193782Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:31.343787Z", "completed_at": "2026-02-09T09:55:31.343800Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.47098565101623535, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_tasks_updated_at.4ae155633f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.144848Z", "completed_at": "2026-02-09T09:55:31.187606Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:31.343055Z", "completed_at": "2026-02-09T09:55:31.343067Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4731254577636719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_tasks_task_start_date.341a694abf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.158549Z", "completed_at": "2026-02-09T09:55:31.242148Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:31.344648Z", "completed_at": "2026-02-09T09:55:31.344659Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5035214424133301, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__livraison_interne_tasks_task_product_id.cca996b12e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.164262Z", "completed_at": "2026-02-09T09:55:31.250437Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:31.354792Z", "completed_at": "2026-02-09T09:55:31.354808Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5474483966827393, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__livraison_tasks_task_product_id.011a4e9629", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.172439Z", "completed_at": "2026-02-09T09:55:31.293962Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:31.397833Z", "completed_at": "2026-02-09T09:55:31.397845Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.5364811420440674, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__reception_tasks_created_at.8083bcc7e8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.181292Z", "completed_at": "2026-02-09T09:55:31.342407Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:31.441595Z", "completed_at": "2026-02-09T09:55:31.441607Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5768110752105713, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__reception_tasks_extracted_at.ec88db7302", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.188252Z", "completed_at": "2026-02-09T09:55:31.345307Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:31.526005Z", "completed_at": "2026-02-09T09:55:31.526017Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.619326114654541, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__reception_tasks_product_id.aa8ad941b0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.244175Z", "completed_at": "2026-02-09T09:55:31.354172Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:31.569533Z", "completed_at": "2026-02-09T09:55:31.569544Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.6991541385650635, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__reception_tasks_task_product_id.af91258a78", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.194453Z", "completed_at": "2026-02-09T09:55:31.346691Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:31.568757Z", "completed_at": "2026-02-09T09:55:31.568769Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.7033798694610596, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__reception_tasks_task_id.73ba57ad4f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.294681Z", "completed_at": "2026-02-09T09:55:31.440899Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:31.657546Z", "completed_at": "2026-02-09T09:55:31.657562Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7306549549102783, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__reception_tasks_task_start_date.eb50f49146", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.347503Z", "completed_at": "2026-02-09T09:55:31.613618Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:31.829978Z", "completed_at": "2026-02-09T09:55:31.829991Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.768444299697876, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__reception_tasks_updated_at.2d211b0f61", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.877664Z", "completed_at": "2026-02-09T09:55:31.948775Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:31.991483Z", "completed_at": "2026-02-09T09:55:31.991503Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.5056045055389404, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__reception_tasks_task_product_id.bf4c38de57", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.884630Z", "completed_at": "2026-02-09T09:55:31.949366Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:31.992222Z", "completed_at": "2026-02-09T09:55:31.992237Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.5052351951599121, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__telemetry_tasks_created_at.ef85effe50", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.892465Z", "completed_at": "2026-02-09T09:55:31.957910Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:31.999501Z", "completed_at": "2026-02-09T09:55:31.999514Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.5136995315551758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__telemetry_tasks_extracted_at.5c3a5f7ac5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.950001Z", "completed_at": "2026-02-09T09:55:31.998711Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:32.117786Z", "completed_at": "2026-02-09T09:55:32.117802Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.3952372074127197, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__telemetry_tasks_product_id.04e1d8477d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.958532Z", "completed_at": "2026-02-09T09:55:32.008889Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:32.169552Z", "completed_at": "2026-02-09T09:55:32.169568Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.4365353584289551, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__telemetry_tasks_task_id.2a5854e826", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.971151Z", "completed_at": "2026-02-09T09:55:32.015579Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:32.171583Z", "completed_at": "2026-02-09T09:55:32.171595Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.43456482887268066, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__telemetry_tasks_task_start_date.66646fa50e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.964255Z", "completed_at": "2026-02-09T09:55:32.009590Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:32.170935Z", "completed_at": "2026-02-09T09:55:32.170969Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.518892765045166, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__telemetry_tasks_task_product_id.3c6e38ed4d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.978058Z", "completed_at": "2026-02-09T09:55:32.025331Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:32.172482Z", "completed_at": "2026-02-09T09:55:32.172495Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5182065963745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__telemetry_tasks_updated_at.8d8d17e88a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.985560Z", "completed_at": "2026-02-09T09:55:32.031929Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:32.174765Z", "completed_at": "2026-02-09T09:55:32.174777Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5449488162994385, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__telemetry_tasks_task_product_id.4d229c656f", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:31.993815Z", "completed_at": "2026-02-09T09:55:32.118625Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:32.183215Z", "completed_at": "2026-02-09T09:55:32.183227Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.5386426448822021, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_oracle_neshu__chargement_par_quinzaine", "compiled": true, "compiled_code": "-- models/fct_chargement_quinzaine.sql\n\n\nWITH base AS (\n    SELECT\n        p.product_type,\n        cm.company_code,\n        EXTRACT(YEAR FROM cm.task_start_date) AS annee_chgt,\n        FLOOR(\n            DATE_DIFF(\n                DATE(cm.task_start_date),\n                DATE_TRUNC(\n                    DATE_TRUNC(DATE(cm.task_start_date), YEAR),\n                    WEEK(MONDAY)\n                ),\n                DAY\n            ) / 14\n        ) + 1 AS quinzaine_chgt,\n        cm.load_quantity\n    FROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks` cm\n    LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product` p\n        ON cm.product_id = p.product_id\n    WHERE cm.task_start_date >= TIMESTAMP(\n        DATETIME_SUB(CURRENT_DATETIME(), INTERVAL 24 MONTH)\n    )\n)\nSELECT\n    product_type,\n    company_code,\n    annee_chgt,\n    quinzaine_chgt,\n    SUM(load_quantity) AS quantite_chargee,\n    -- M\u00e9tadonn\u00e9es dbt\n    CURRENT_TIMESTAMP() as dbt_updated_at,\n    'cb08451a-2004-4aaf-949e-f43cc89d5466' as dbt_invocation_id\nFROM base\nGROUP BY\n    product_type,\n    company_code,\n    annee_chgt,\n    quinzaine_chgt\nORDER BY\n    product_type,\n    company_code,\n    annee_chgt,\n    quinzaine_chgt", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__chargement_par_quinzaine`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:32.000264Z", "completed_at": "2026-02-09T09:55:32.170197Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:32.267384Z", "completed_at": "2026-02-09T09:55:32.267398Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.581017017364502, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_oracle_neshu__chargement_vs_conso", "compiled": true, "compiled_code": "\n\n-- -----------------------------------------------------------------------------------\n-- CTE 1 : R\u00e9cup\u00e9ration des passages APPRO avec leur passage pr\u00e9c\u00e9dent\n-- Utilisation de LAG pour identifier la p\u00e9riode sur laquelle agr\u00e9ger les t\u00e9l\u00e9metries.\n-- -----------------------------------------------------------------------------------\nWITH passage_avec_suivant AS (\n  SELECT \n    device_id,\n    task_start_date,\n    rm.roadman_code AS roadman_code,\n    LAG(task_start_date) OVER (\n      PARTITION BY device_id \n      ORDER BY task_start_date\n    ) AS date_passage_precedent\n  FROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks` ta\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__vehicule_roadman` rm\n    ON rm.resources_vehicule_id = ta.product_source_id\n  WHERE task_start_date >= '2025-01-01'\n    AND task_status_code = 'FAIT'\n),\n-- -----------------------------------------------------------------------------------\n-- CTE 2 : Agr\u00e9gations des quantit\u00e9s consomm\u00e9es (t\u00e9l\u00e9metries)\n-- Les t\u00e9l\u00e9metries sont prises entre le passage pr\u00e9c\u00e9dent et le passage actuel.\n-- Filtre HAVING pour supprimer les lignes vides (product_type NULL & somme = 0).\n-- -----------------------------------------------------------------------------------\ntelemetry_agg AS (\n  SELECT\n    pa.device_id,\n    pa.task_start_date,\n    p.product_type,\n    COALESCE(SUM(t.telemetry_quantity), 0) AS q_consommee\n  FROM passage_avec_suivant pa\n  LEFT JOIN `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks` t\n    ON pa.device_id = t.device_id\n    AND t.task_start_date BETWEEN \n          COALESCE(pa.date_passage_precedent, TIMESTAMP('2024-12-30 00:00:00'))\n      AND pa.task_start_date\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product` p\n    ON t.product_id = p.product_id\n  GROUP BY 1,2,3\n  HAVING p.product_type IS NOT NULL OR SUM(t.telemetry_quantity) > 0\n),\n\n-- -----------------------------------------------------------------------------------\n-- CTE 3 : Agr\u00e9gations des quantit\u00e9s charg\u00e9es\n-- Les chargements sont associ\u00e9s au passage APPRO via une jointure sur la DATE.\n-- -----------------------------------------------------------------------------------\nchargement_agg AS (\n  SELECT\n    pa.device_id,\n    pa.task_start_date,\n    p.product_type,\n    COALESCE(SUM(cm.load_quantity), 0) AS q_chargee\n  FROM passage_avec_suivant pa\n  LEFT JOIN `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`  cm\n    ON pa.device_id = cm.device_id\n    AND DATE(pa.task_start_date) = DATE(cm.task_start_date)\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product` p\n    ON cm.product_id = p.product_id\n  GROUP BY 1,2,3\n  HAVING p.product_type IS NOT NULL OR SUM(cm.load_quantity) > 0\n)\n\n-- -----------------------------------------------------------------------------------\n-- Final : Fusion telemetry + chargement via FULL JOIN\n-- On r\u00e9cup\u00e8re aussi roadman & date passage pr\u00e9c\u00e9dent depuis la CTE initiale.\n-- -----------------------------------------------------------------------------------\nSELECT\n  COALESCE(t.device_id, c.device_id) AS device_id,\n  DATE(COALESCE(t.task_start_date, c.task_start_date)) AS date_debut_passage_appro,\n  MIN(COALESCE(t.task_start_date, c.task_start_date)) AS task_start_date_min,\n  MIN(pa.date_passage_precedent) AS date_passage_precedent,\n  MAX(pa.roadman_code) AS roadman_code,\n  COALESCE(t.product_type, c.product_type) AS product_type,\n  sum(COALESCE(t.q_consommee, 0)) AS q_consommee,\n  max(COALESCE(c.q_chargee, 0)) AS q_chargee,\n\n  -- M\u00e9tadonn\u00e9es dbt\n  CURRENT_TIMESTAMP() as dbt_updated_at,\n  'cb08451a-2004-4aaf-949e-f43cc89d5466' as dbt_invocation_id\nFROM telemetry_agg t\nFULL JOIN chargement_agg c\n  ON t.device_id = c.device_id\n  AND t.task_start_date = c.task_start_date\n  AND t.product_type = c.product_type\nLEFT JOIN passage_avec_suivant pa\n  ON pa.device_id = COALESCE(t.device_id, c.device_id)\n  AND pa.task_start_date = COALESCE(t.task_start_date, c.task_start_date)\nGROUP BY\n  device_id,\n  date_debut_passage_appro,\n  product_type", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__chargement_vs_conso`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:32.010505Z", "completed_at": "2026-02-09T09:55:32.173428Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:32.352571Z", "completed_at": "2026-02-09T09:55:32.352583Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6658101081848145, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_oracle_neshu__conso_business_review", "compiled": true, "compiled_code": "\n\nWITH telemetry_data AS (\n  SELECT \n    -- IDs\n    t.company_id,\n    t.device_id,\n    t.location_id,\n    t.product_id,\n    \n    -- Company\n    c.company_code,\n    c.company_name,\n\n    -- Localisation\n    COALESCE(NULLIF(t.task_location_info, ''), d.device_location) AS location,\n\n    -- Machine\n    d.device_code AS device_serial_number,\n    d.device_name,\n    d.device_brand,\n    d.device_economic_model,\n\n    -- Produit\n    p.product_name,\n    p.product_brand,\n    p.product_family,\n    p.product_group,\n    p.product_type,\n\n    -- Contexte\n    DATE(t.task_start_date) AS consumption_date,\n    'TELEMETRIE' AS data_source,\n\n    -- Mesure\n    SUM(t.telemetry_quantity) AS quantity\n    \n  FROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks` t\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device` d \n    ON t.device_id = d.device_id\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product` p \n    ON t.product_id = p.product_id\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company` c\n    ON t.company_id = c.company_id\n  GROUP BY \n    t.company_id, t.device_id, t.location_id, t.product_id,\n    c.company_code, c.company_name,\n    COALESCE(NULLIF(t.task_location_info, ''), d.device_location),\n    d.device_code, d.device_name, d.device_brand, d.device_economic_model,\n    p.product_name, p.product_brand, p.product_family, p.product_group, p.product_type,\n    DATE(t.task_start_date)\n),\nchargement_data AS (\n  SELECT \n    -- IDs\n    l.company_id,\n    l.device_id,\n    l.location_id,\n    l.product_id,\n    \n    -- Company\n    c.company_code,\n    c.company_name,\n\n    -- Localisation\n    COALESCE(NULLIF(l.task_location_info, ''), d.device_location) AS location,\n\n    -- Machine\n    d.device_code AS device_serial_number,\n    d.device_name,\n    d.device_brand,\n    d.device_economic_model,\n\n    -- Produit\n    p.product_name,\n    p.product_brand,\n    p.product_family,\n    p.product_group,\n    p.product_type,\n\n    -- Contexte\n    DATE(l.task_start_date) AS consumption_date,\n    'CHARGEMENT' AS data_source,\n\n    -- Quantit\u00e9 (ajust\u00e9e selon le produit)\n    SUM(\n      CASE\n        WHEN p.product_name LIKE '%GOBELET%RAME 50%' THEN l.load_quantity * 50\n        WHEN p.product_name LIKE '%GOBELET%RAME DE 30%' THEN l.load_quantity * 30\n        WHEN p.product_name LIKE '%GOBELET%RAME 35%' THEN l.load_quantity * 35\n        WHEN p.product_name LIKE '%MELANG%BTE 200%' THEN l.load_quantity * 200\n        WHEN p.product_name LIKE '%MELANGEUR%BTE 200%' THEN l.load_quantity * 200\n        WHEN p.product_name LIKE '%MELANGEUR%BTE 100%' THEN l.load_quantity * 100\n        WHEN p.product_name LIKE '%BEGHIN SAY 300%' THEN l.load_quantity * 300\n        WHEN p.product_name LIKE '%CARTON DE 500%' THEN l.load_quantity * 500\n        WHEN p.product_name LIKE '%DISTRIBUTEUR 300 SUCRES%' THEN l.load_quantity * 300\n        WHEN p.product_name LIKE '%SUCRE BATONNET 100%' THEN l.load_quantity * 100\n        WHEN p.product_name LIKE '%SUCRE BTE 300%' THEN l.load_quantity * 300\n        WHEN p.product_name LIKE '%NESPRESSO MELANGEURS EN BAMBOU INDI%' THEN l.load_quantity * 100\n        ELSE l.load_quantity\n      END\n    ) AS quantity\n\n  FROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks` l\n  INNER JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device` d \n    ON l.device_id = d.device_id\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product` p \n    ON l.product_id = p.product_id\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company` c\n    ON l.company_id = c.company_id\n  WHERE l.task_status_code in ('FAIT','VALIDE')\n  GROUP BY \n    l.company_id, l.device_id, l.location_id, l.product_id,\n    COALESCE(NULLIF(l.task_location_info, ''), d.device_location), c.company_code, c.company_name,\n    d.device_code, d.device_name, d.device_brand, d.device_economic_model,\n    p.product_name, p.product_brand, p.product_family, p.product_group, p.product_type,\n    DATE(l.task_start_date)\n),\nlivraison_data AS (\n  SELECT\n    -- IDs\n    lt.company_id,\n    NULL AS device_id,\n    NULL AS location_id,\n    lt.product_id,\n\n    -- Company\n    c.company_code,\n    c.company_name,\n\n    -- Localisation (fixe)\n    'LIVRAISON' AS location,\n\n    -- Machine (fixe)\n    'LIVRAISON' AS device_serial_number,\n    'LIVRAISON' AS device_name,\n    'LIVRAISON' AS device_brand,\n    'LIVRAISON' AS device_economic_model,\n\n    -- Produit\n    p.product_name,\n    p.product_brand,\n    p.product_family,\n    p.product_group,\n    p.product_type,\n\n    -- Contexte\n    DATE(lt.task_start_date) AS consumption_date,\n    'LIVRAISON' AS data_source,\n\n    -- Quantit\u00e9 (ajust\u00e9e selon le produit)\n    SUM(\n      CASE\n        WHEN p.product_name LIKE '%GOBELET%RAME 50%' THEN lt.quantity * 50\n        WHEN p.product_name LIKE '%GOBELET%RAME DE 30%' THEN lt.quantity * 30\n        WHEN p.product_name LIKE '%GOBELET%RAME 35%' THEN lt.quantity * 35\n        WHEN p.product_name LIKE '%MELANG%BTE 200%' THEN lt.quantity * 200\n        WHEN p.product_name LIKE '%MELANGEUR%BTE 200%' THEN lt.quantity * 200\n        WHEN p.product_name LIKE '%MELANGEUR%BTE 100%' THEN lt.quantity * 100\n        WHEN p.product_name LIKE '%BEGHIN SAY 300%' THEN lt.quantity * 300\n        WHEN p.product_name LIKE '%CARTON DE 500%' THEN lt.quantity * 500\n        WHEN p.product_name LIKE '%DISTRIBUTEUR 300 SUCRES%' THEN lt.quantity * 300\n        WHEN p.product_name LIKE '%SUCRE BATONNET 100%' THEN lt.quantity * 100\n        WHEN p.product_name LIKE '%SUCRE BTE 300%' THEN lt.quantity * 300\n        WHEN p.product_name LIKE '%NESPRESSO MELANGEURS EN BAMBOU INDI%' THEN lt.quantity * 100\n        ELSE lt.quantity\n      END\n    ) AS quantity\n\n  FROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks` lt\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product` p \n    ON lt.product_id = p.product_id\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company` c\n    ON lt.company_id = c.company_id\n  WHERE lt.task_status_code in ('FAIT','VALIDE')\n  AND p.product_type in ('THE','CAFE CAPS','CHOCOLATS VAN HOUTEN','BOISSONS GOURMANDES','ACCESSOIRES')\n  GROUP BY \n    lt.company_id, lt.product_id,\n    p.product_name, p.product_brand, p.product_family, p.product_group, p.product_type, c.company_code, c.company_name,\n    DATE(lt.task_start_date)\n),\n-- Version optimis\u00e9e : remplace combined_data + donnees_filtrees\ncombined_and_filtered_data AS (\n\n  -- Cas particulier : machine AS00446 chez CN1046\n  SELECT *\n  FROM chargement_data\n  WHERE device_serial_number = 'AS00446'\n    AND company_code = 'CN1046'\n    AND consumption_date < '2025-08-28'\n    AND product_type IN ('THE','CAFE CAPS','CHOCOLATS VAN HOUTEN')\n\n  UNION ALL\n\n  SELECT *\n  FROM telemetry_data\n  WHERE device_serial_number = 'AS00446'\n    AND company_code = 'CN1046'\n    AND consumption_date >= '2025-08-28'\n\n  UNION ALL\n\n  -- TELEMETRIE avec filtres\n  SELECT *\n  FROM telemetry_data\n  WHERE product_type IN ('BOISSONS GOURMANDES', 'CAFE CAPS', 'CAFENOIR', 'INDEFINI', 'THE', 'SNACKING', 'BOISSONS FRAICHES', 'CHOCOLATS VAN HOUTEN')\n    AND NOT (\n      device_brand IN ('NESTLE','ANIMO')\n      AND (device_economic_model NOT IN ('Participatif valeurs','Participatif unit\u00e9s','Payant') OR device_economic_model IS NULL)\n      AND product_type = 'THE'\n    )\n    AND NOT (company_code = 'CN1071' AND product_type = 'THE')\n    AND NOT (device_serial_number = 'AS00446' AND company_code = 'CN1046') \n\n\n  UNION ALL\n\n  -- CHARGEMENT avec tous les filtres consolid\u00e9s\n  SELECT *\n  FROM chargement_data\n  WHERE (\n    (device_brand = 'NESPRESSO'\n     AND (device_economic_model NOT IN ('Participatif valeurs','Participatif unit\u00e9s','Payant') OR device_economic_model IS NULL)\n     AND product_type IN ('THE','CAFE CAPS')\n     AND (company_code <> 'CN1070' OR consumption_date >= '2025-03-01'))\n    OR (device_brand IN ('NESTLE','ANIMO')\n        AND (device_economic_model NOT IN ('Participatif valeurs','Participatif unit\u00e9s','Payant') OR device_economic_model IS NULL)\n        AND product_type = 'THE')\n    OR (device_brand IN ('NESPRESSO','NESTLE','ANIMO')\n        AND product_type = 'CHOCOLATS VAN HOUTEN')\n    OR (product_type = 'ACCESSOIRES')\n    OR (company_code = 'CN1071' AND product_type = 'THE')\n    AND NOT (device_serial_number = 'AS00446' AND company_code = 'CN1046') \n  )\n\n  UNION ALL\n\n  -- LIVRAISON (tous les enregistrements)\n  SELECT *\n  FROM livraison_data\n)\n\n\nSELECT \n  -- Identifiants\n  company_id,\n  device_id,\n  location_id,\n  product_id,\n  \n  -- Company\n  company_code,\n  company_name,\n\n  -- Localisation\n  location,\n\n  -- Machine\n  device_serial_number,\n  device_name,\n  device_brand,\n  device_economic_model,\n\n-- Produit\n  product_name,\n  CASE\n    WHEN product_brand = 'BARRYCALLEBAUT' THEN 'VAN HOUTEN'\n    ELSE product_brand\n  END AS product_brand,\n  product_family,\n  product_group,\n  product_type,\n\n  -- Contexte\n  consumption_date,\n  data_source,\n\n  -- Mesure\n  quantity,\n\n  -- M\u00e9tadonn\u00e9es d'ex\u00e9cution\n  CURRENT_TIMESTAMP() as dbt_updated_at,\n  'cb08451a-2004-4aaf-949e-f43cc89d5466' as dbt_invocation_id\n\nFROM combined_and_filtered_data", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:32.019607Z", "completed_at": "2026-02-09T09:55:32.174126Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:32.353279Z", "completed_at": "2026-02-09T09:55:32.353291Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.6661016941070557, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__chargement_tasks_created_at.099654dbc5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:32.025965Z", "completed_at": "2026-02-09T09:55:32.175434Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:32.436781Z", "completed_at": "2026-02-09T09:55:32.436796Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.7083630561828613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__chargement_tasks_extracted_at.7247f9f7e5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:32.159965Z", "completed_at": "2026-02-09T09:55:32.226406Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:32.482256Z", "completed_at": "2026-02-09T09:55:32.482269Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7300019264221191, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__chargement_tasks_product_id.97e92b8f9e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:32.177522Z", "completed_at": "2026-02-09T09:55:32.482871Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:32.659026Z", "completed_at": "2026-02-09T09:55:32.659038Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7771213054656982, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__chargement_tasks_task_id.dbf995a952", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:32.713728Z", "completed_at": "2026-02-09T09:55:32.778478Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:32.838267Z", "completed_at": "2026-02-09T09:55:32.838278Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.4771740436553955, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__chargement_tasks_task_start_date.18b12689c3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:32.707534Z", "completed_at": "2026-02-09T09:55:32.777844Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:32.837618Z", "completed_at": "2026-02-09T09:55:32.837631Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.5198025703430176, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__chargement_tasks_task_product_id.22016f77c7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:32.723014Z", "completed_at": "2026-02-09T09:55:32.786880Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:32.846529Z", "completed_at": "2026-02-09T09:55:32.846545Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.5270674228668213, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__chargement_tasks_updated_at.cfb1806175", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:32.779718Z", "completed_at": "2026-02-09T09:55:32.845270Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:32.958865Z", "completed_at": "2026-02-09T09:55:32.958879Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.4110424518585205, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__chargement_tasks_task_product_id.f02aff9a5d", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:32.788172Z", "completed_at": "2026-02-09T09:55:32.853266Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.009615Z", "completed_at": "2026-02-09T09:55:33.009631Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.4098329544067383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_oracle_neshu__appro", "compiled": true, "compiled_code": "\n\n-- Un seul pointage par jour et par roadman\nWITH pointage_unique_par_jour AS (\n    SELECT\n        task_id,\n        company_id,\n        resources_roadman_id,\n        roadman_code,\n        status_code,\n        label_code,\n        DATE(date_pointage) AS date_jour,\n        created_at,\n        updated_at,\n        extracted_at,\n        MIN(CASE \n            WHEN FORMAT_TIMESTAMP('%H:%M:%S', date_pointage) >= '03:00:00' THEN date_pointage\n        END) AS premier_pointage\n    FROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__pointage`\n    WHERE label_code = 'START_DAY'\n    GROUP BY task_id, company_id, resources_roadman_id, roadman_code, status_code, label_code, DATE(date_pointage), created_at, updated_at, extracted_at \n),\npointage_min_par_jour AS (\n    SELECT\n        p.*,\n        ROW_NUMBER() OVER (\n            PARTITION BY\n                p.resources_roadman_id,\n                p.date_jour\n            ORDER BY\n                p.premier_pointage\n        ) AS rn\n    FROM pointage_unique_par_jour p\n),\nPointage_final_table as (\nSELECT\n    task_id as task_id,\n    company_id as company_id,\n    resources_roadman_id as resources_roadman_id,\n    roadman_code as roadman_code,\n    status_code,\n    label_code,\n    date_jour as date_pointage_jour,\n    premier_pointage as date_pointage,\n    created_at,\n    updated_at,\n    extracted_at\nFROM pointage_min_par_jour\nWHERE rn = 1 and resources_roadman_id IS NOT NULL\n),\nresources_roadman AS (\n    SELECT \n        thr.idtask, \n        MIN(r.idresources) AS resources_roadman_id, \n        MIN(r.code) AS roadman_code\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources` thr\n    JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` r \n        ON thr.IDRESOURCES = r.IDRESOURCES \n       AND r.IDRESOURCES_TYPE = 2\n    GROUP BY thr.IDTASK\n),\npassage_appro as (\nSELECT \n  pa.task_id,\n  pa.device_id,\n  pa.company_id,\n  pa.product_source_id,\n  r.resources_roadman_id,\n  pa.product_destination_id,\n  pa.product_source_type,\n  pa.product_destination_type,\n  pa.company_code,\n  c.name as company_name,\n  c.name || ' - ' || pa.company_code AS company_info,\n  d.code as device_code,\n  d.name as device_name,\n  d.name || ' - ' || d.code AS device_info,\n  g.gea_code,\n  r.roadman_code,\n  pa.task_location_info,\n  CASE \n    WHEN pa.task_status_code IN ('FAIT', 'ENCOURS') THEN 'FAIT'\n    ELSE pa.task_status_code\n  END AS task_status_code,\n  p.date_pointage,\n  p.date_pointage_jour,\n   DATE(task_start_date) AS start_date_day,\n  pa.task_start_date,\n  pa.task_end_date,\n  -- Dur\u00e9e brute (audit)\n  pa.task_end_date - pa.task_start_date AS passage_duration_interval,\n    -- M\u00e9trique BI\n    CASE \n      WHEN pa.task_start_date IS NOT NULL \n      AND pa.task_end_date IS NOT NULL\n      AND pa.task_status_code = 'FAIT'\n      THEN TIMESTAMP_DIFF(\n            pa.task_end_date,\n            pa.task_start_date,\n            SECOND\n          ) / 60.0\n    END AS passage_duration_min,\n    CASE \n      WHEN pa.task_start_date IS NOT NULL \n      AND pa.task_end_date IS NOT NULL\n      AND pa.task_status_code = 'FAIT'\n      THEN TIMESTAMP_DIFF(\n            pa.task_end_date,\n            pa.task_start_date,\n            SECOND\n          ) / 3600.0\n    END AS passage_duration_hours,\n    CASE WHEN pa.task_status_code in ('FAIT', 'ENCOURS') THEN 1 ELSE 0 END AS is_done,\n    CASE WHEN pa.task_status_code IN ('PREVU', 'FAIT', 'ENCOURS') THEN 1 ELSE 0 END AS is_planned,\n    CASE \n      WHEN p.date_pointage IS NULL THEN 1\n      ELSE 0\n      END AS pointage_missing_flag,\n  pa.created_at,\n  pa.updated_at \nFROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks` pa\n\nLEFT JOIN resources_roadman r \n  ON pa.task_id = r.idtask\n\nLEFT JOIN `evs-datastack-prod`.`prod_reference`.`ref_oracle_neshu__roadman_gea` g \n  ON g.roadman_code = r.roadman_code\n\nLEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` c \n  ON pa.company_id = c.idcompany\n\nLEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device` d \n  ON pa.device_id = d.iddevice\n\nLEFT JOIN Pointage_final_table p \n  ON p.date_pointage_jour = DATE(pa.task_start_date) \n AND p.resources_roadman_id = r.resources_roadman_id\n\nWHERE r.resources_roadman_id is not null\n),\npassage_with_metrics AS (\n  SELECT \n    pa.*,\n    -- Derni\u00e8re task_end_date du roadman pour ce jour (statut FAIT uniquement)\n    MAX(CASE WHEN pa.task_status_code = 'FAIT' THEN pa.task_end_date END) \n      OVER (\n        PARTITION BY pa.resources_roadman_id, DATE(pa.task_start_date)\n        ORDER BY pa.task_end_date\n        ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING\n      ) AS last_task_end_of_day,\n    \n    -- Utilise date_pointage si disponible, sinon premi\u00e8re task_start_date du jour\n    COALESCE(\n      pa.date_pointage,\n      FIRST_VALUE(pa.task_start_date) OVER (\n        PARTITION BY pa.resources_roadman_id, DATE(pa.task_start_date)\n        ORDER BY pa.task_start_date\n        ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING\n      )\n    ) AS effective_work_start,\n    \n    -- Nombre de passages du roadman ce jour\n    COUNT(*) OVER (\n      PARTITION BY pa.resources_roadman_id, DATE(pa.task_start_date)\n    ) AS daily_task_count,\n    \n    -- Temps moyen par passage du roadman ce jour\n    AVG(TIMESTAMP_DIFF(pa.task_end_date, pa.task_start_date, MINUTE)) OVER (\n      PARTITION BY pa.resources_roadman_id, DATE(pa.task_start_date)\n    ) AS avg_passage_duration_day,\n    \n    -- Num\u00e9ro de passage dans la journ\u00e9e\n    ROW_NUMBER() OVER (\n      PARTITION BY pa.resources_roadman_id, DATE(pa.task_start_date)\n      ORDER BY pa.task_start_date\n    ) AS passage_rank_of_day,\n    \n    -- \ud83d\udcca NOUVEAUX CALCULS DE TAUX --\n    \n    -- Compteurs pour le roadman ce jour\n    SUM(pa.is_done) OVER (\n      PARTITION BY pa.resources_roadman_id, DATE(pa.task_start_date)\n    ) AS done_count_roadman_day,\n    \n    SUM(pa.is_planned) OVER (\n      PARTITION BY pa.resources_roadman_id, DATE(pa.task_start_date)\n    ) AS planned_count_roadman_day,\n    \n    -- Taux de r\u00e9alisation du roadman ce jour\n    SAFE_DIVIDE(\n      SUM(pa.is_done) OVER (\n        PARTITION BY pa.resources_roadman_id, DATE(pa.task_start_date)\n      ),\n      SUM(pa.is_planned) OVER (\n        PARTITION BY pa.resources_roadman_id, DATE(pa.task_start_date)\n      )\n    ) AS taux_realisation_roadman_day,\n    \n    -- Taux de r\u00e9alisation global du jour (tous roadmen)\n    SAFE_DIVIDE(\n      SUM(pa.is_done) OVER (PARTITION BY DATE(pa.task_start_date)),\n      SUM(pa.is_planned) OVER (PARTITION BY DATE(pa.task_start_date))\n    ) AS taux_realisation_global_day\n    \n  FROM passage_appro pa\n),\n -- Calcul de work_duration_min\npassage_work_duration AS (\nSELECT \n  *,\n  -- Calcul du work_duration en minutes (brut)\n  TIMESTAMP_DIFF(last_task_end_of_day, effective_work_start, MINUTE) AS work_duration_min_raw,\n  \n  -- Calcul du work_duration en minutes (nettoy\u00e9)\n  CASE \n    WHEN TIMESTAMP_DIFF(last_task_end_of_day, effective_work_start, MINUTE) > 720 THEN NULL  -- > 12h = suspect\n    WHEN TIMESTAMP_DIFF(last_task_end_of_day, effective_work_start, MINUTE) < 0 THEN NULL    -- n\u00e9gatif = erreur\n    WHEN last_task_end_of_day IS NULL OR effective_work_start IS NULL THEN NULL\n    ELSE TIMESTAMP_DIFF(last_task_end_of_day, effective_work_start, MINUTE)\n  END AS work_duration_min\nFROM passage_with_metrics\n)\n-- Final table\nSELECT\n  -- 1\ufe0f\u20e3 IDs\n  task_id,\n  device_id,\n  company_id,\n  resources_roadman_id,\n\n  -- 2\ufe0f\u20e3 Attributs\n  company_info,\n  device_info,\n  roadman_code,\n  gea_code,\n  task_status_code,\n\n  -- 3\ufe0f\u20e3 Dates / Temps\n  date_pointage,\n  date_pointage_jour,\n  start_date_day,\n  task_start_date,\n  task_end_date,\n  last_task_end_of_day,\n  effective_work_start,\n\n  -- 4\ufe0f\u20e3 Mesures / KPI\n  is_planned,\n  is_done,\n  passage_rank_of_day,\n  daily_task_count,\n  avg_passage_duration_day,\n  passage_duration_interval,\n  passage_duration_min,\n  passage_duration_hours,\n  work_duration_min_raw,\n  work_duration_min,\n  pointage_missing_flag,\n    to_hex(md5(cast(coalesce(cast(company_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(start_date_day as string), '_dbt_utils_surrogate_key_null_') as string))) AS client_jour_key,\n\n  CASE\n    WHEN is_done = 1 THEN 1\n    ELSE 0\n  END AS passage_client_done,\n  \n  -- \ud83d\udcca Nouveaux KPI taux de r\u00e9alisation\n  done_count_roadman_day,\n  planned_count_roadman_day,\n  taux_realisation_roadman_day,\n  taux_realisation_global_day,\n\n  -- 5\ufe0f\u20e3 M\u00e9tadonn\u00e9es\n  created_at,\n  updated_at,\n\n  -- M\u00e9tadonn\u00e9es dbt\n  CURRENT_TIMESTAMP() as dbt_updated_at,\n  'cb08451a-2004-4aaf-949e-f43cc89d5466' as dbt_invocation_id\n\nFROM passage_work_duration", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__appro`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:32.798441Z", "completed_at": "2026-02-09T09:55:32.853893Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.010381Z", "completed_at": "2026-02-09T09:55:33.010396Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4511899948120117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__pointage_company_id.91d277facb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__pointage`\nwhere company_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:32.814142Z", "completed_at": "2026-02-09T09:55:32.854763Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.011739Z", "completed_at": "2026-02-09T09:55:33.011758Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.49251246452331543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__pointage_date_pointage.dbdc56042f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_pointage\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__pointage`\nwhere date_pointage is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:32.823488Z", "completed_at": "2026-02-09T09:55:32.861292Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.012418Z", "completed_at": "2026-02-09T09:55:33.012430Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5333366394042969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__pointage_date_pointage_jour.18fb728311", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_pointage_jour\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__pointage`\nwhere date_pointage_jour is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:32.828972Z", "completed_at": "2026-02-09T09:55:32.867836Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.013246Z", "completed_at": "2026-02-09T09:55:33.013258Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5756683349609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__pointage_task_id.8ff4fe5cef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__pointage`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:32.838871Z", "completed_at": "2026-02-09T09:55:33.007175Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.067387Z", "completed_at": "2026-02-09T09:55:33.067412Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.60286545753479, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_company_code.4dd651bc02", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_code\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere company_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:32.847193Z", "completed_at": "2026-02-09T09:55:33.011032Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.153178Z", "completed_at": "2026-02-09T09:55:33.153194Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.5980234146118164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_company_info.8eeabe00a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_info\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere company_info is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:32.855492Z", "completed_at": "2026-02-09T09:55:33.013916Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.238575Z", "completed_at": "2026-02-09T09:55:33.238588Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.6388254165649414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_device_id.cb546c4a7e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere device_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:32.868896Z", "completed_at": "2026-02-09T09:55:33.016658Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.282173Z", "completed_at": "2026-02-09T09:55:33.282189Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6812548637390137, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_mission_faite.4c914d3f47", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mission_faite\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere mission_faite is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:32.862748Z", "completed_at": "2026-02-09T09:55:33.017315Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.282817Z", "completed_at": "2026-02-09T09:55:33.282829Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7244822978973389, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_device_info.08be705635", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_info\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere device_info is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:32.959647Z", "completed_at": "2026-02-09T09:55:33.070467Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.327514Z", "completed_at": "2026-02-09T09:55:33.327526Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7580399513244629, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_mission_prevue.79cb0b2a32", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mission_prevue\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere mission_prevue is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:33.018098Z", "completed_at": "2026-02-09T09:55:33.326223Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.501578Z", "completed_at": "2026-02-09T09:55:33.501589Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7701678276062012, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_task_id.b47f804afa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:33.547811Z", "completed_at": "2026-02-09T09:55:33.620130Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.670353Z", "completed_at": "2026-02-09T09:55:33.670375Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.4686777591705322, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_task_start_date.8dceb0b3e4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:33.555775Z", "completed_at": "2026-02-09T09:55:33.622277Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.678633Z", "completed_at": "2026-02-09T09:55:33.678645Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.517338752746582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_task_status_code.b0aa10d1d0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_status_code\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere task_status_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:33.564501Z", "completed_at": "2026-02-09T09:55:33.644127Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.682177Z", "completed_at": "2026-02-09T09:55:33.682190Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.5200405120849609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_oracle_neshu__pa_business_review_device_id__device_id__ref_dim_oracle_neshu__device_.94d4d49600", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select device_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\n    where device_id is not null\n),\n\nparent as (\n    select device_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:33.622880Z", "completed_at": "2026-02-09T09:55:33.680083Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.754517Z", "completed_at": "2026-02-09T09:55:33.754530Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.39551377296447754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_fct_oracle_neshu__pa_business_review_task_id.e6a4a507a2", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\n  where task_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:33.629219Z", "completed_at": "2026-02-09T09:55:33.682779Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.805481Z", "completed_at": "2026-02-09T09:55:33.805497Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.4476749897003174, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.accepted_values_fct_mssql_sage__pnl_bu_kpis_kpi__CA__CONSOMMATION_MP_SSTT__MASSE_SALARIALE__FRAIS_DIRECTS_AMORTISSEMENTS__MARGE_BRUTE__MARGE_NETTE.434fe9b843", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        kpi as value_field,\n        count(*) as n_records\n\n    from `evs-datastack-prod`.`prod_marts`.`fct_mssql_sage__pnl_bu_kpis`\n    group by kpi\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'CA','CONSOMMATION_MP_SSTT','MASSE_SALARIALE','FRAIS_DIRECTS_AMORTISSEMENTS','MARGE_BRUTE','MARGE_NETTE'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:33.651565Z", "completed_at": "2026-02-09T09:55:33.697315Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.848062Z", "completed_at": "2026-02-09T09:55:33.848075Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.4872596263885498, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_mssql_sage__pnl_bu_kpis_bu.219339b384", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect bu\nfrom `evs-datastack-prod`.`prod_marts`.`fct_mssql_sage__pnl_bu_kpis`\nwhere bu is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:33.645934Z", "completed_at": "2026-02-09T09:55:33.698029Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.848821Z", "completed_at": "2026-02-09T09:55:33.848833Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.48908233642578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_mssql_sage__pnl_bu_kpis_annee.d861fe609d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect annee\nfrom `evs-datastack-prod`.`prod_marts`.`fct_mssql_sage__pnl_bu_kpis`\nwhere annee is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:33.664885Z", "completed_at": "2026-02-09T09:55:33.699768Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.851327Z", "completed_at": "2026-02-09T09:55:33.851338Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5635814666748047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_mssql_sage__pnl_bu_kpis_scenario.36bac5bed0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect scenario\nfrom `evs-datastack-prod`.`prod_marts`.`fct_mssql_sage__pnl_bu_kpis`\nwhere scenario is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:33.658694Z", "completed_at": "2026-02-09T09:55:33.698762Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.850678Z", "completed_at": "2026-02-09T09:55:33.850689Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5726914405822754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_mssql_sage__pnl_bu_kpis_mois.b4cabe9344", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mois\nfrom `evs-datastack-prod`.`prod_marts`.`fct_mssql_sage__pnl_bu_kpis`\nwhere mois is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:33.671056Z", "completed_at": "2026-02-09T09:55:33.795554Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:33.853081Z", "completed_at": "2026-02-09T09:55:33.853093Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.6009900569915771, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_yuman__workorder_delais_neshu", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- MODEL: fct_yuman__workorder_delais_neshu\n-- PURPOSE: Determiner les delais des inter (notamment curative) pas partenaire\n-- AUTHOR: Etienne BOULINIER\n-- ============================================================================\n\nWITH adjusted_dates AS (\n    -- Calculer la date de r\u00e9f\u00e9rence (ajouter 1 jour si l'heure d\u00e9passe 16h)\n    select\n    \tsfp.workorder_id as sfp_numero,\n        coalesce(TIMESTAMP(sfp.workorder_date_creation),sfp.demand_created_at) as date_creation_initial,\n        sfp.date_done as date_fin,\n        CASE\n          WHEN EXTRACT(TIME FROM COALESCE(TIMESTAMP(sfp.workorder_date_creation), sfp.demand_created_at)) > '16:00:00'\n            THEN TIMESTAMP(DATE(COALESCE(TIMESTAMP(sfp.workorder_date_creation), sfp.demand_created_at)) + 1)\n          ELSE COALESCE(TIMESTAMP(sfp.workorder_date_creation), sfp.demand_created_at)\n        END AS date_creation_ref\n    FROM `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_pricing` sfp\n),\ndates_range AS (\n  SELECT\n    ad.sfp_numero,\n    ad.date_creation_initial,\n    ad.date_fin,\n    ad.date_creation_ref,\n    date_jour\n  FROM adjusted_dates ad,\n  UNNEST(\n    GENERATE_DATE_ARRAY(\n      DATE(ad.date_creation_ref),\n      DATE(ad.date_fin),\n      INTERVAL 1 DAY\n    )\n  ) AS date_jour\n),\njours_feries as (\nselect * from `evs-datastack-prod`.`prod_reference`.`ref_general__feries_metropole`  \n),\nfamille_machine as (\nselect \n  Machine_Brut,\n  MACHINE,\n  famille_neshu\nfrom `evs-datastack-prod`.`prod_reference`.`ref_yuman__machine_clean`\n),\njours_ouvrables AS (\n    -- Filtrer les jours ouvr\u00e9s (exclure week-ends et jours f\u00e9ri\u00e9s)\n    select\n    \tdr.sfp_numero,\n        dr.date_creation_initial,\n        dr.date_fin,\n        dr.date_creation_ref,\n        dr.date_jour,\n        jf.date_ferie\n    FROM\n        dates_range dr\n    LEFT JOIN jours_feries jf ON dr.date_jour = jf.date_ferie\n    WHERE\n        EXTRACT(DAYOFWEEK FROM dr.date_jour) NOT IN (1, 7)-- Exclure samedi (7) et dimanche (1)\n        AND jf.date_ferie IS null -- Exclure jours f\u00e9ri\u00e9s\n),\ndelai_calcul AS (\n    -- Calculer le nombre total de jours ouvr\u00e9s entre date_creation_ref et date_fin\n    select\n    \tjo.sfp_numero,\n        jo.date_creation_initial,\n        jo.date_fin,\n        jo.date_creation_ref,\n        COUNT(jo.date_jour)-1 AS delai_jours_ouvres\n    FROM\n        jours_ouvrables jo\n    GROUP BY\n        jo.sfp_numero,jo.date_creation_initial, jo.date_fin, jo.date_creation_ref\n),\n-- R\u00e9sultat final CTE\nfinal_table as (\n  select sfp.*,dc.date_creation_ref,dc.delai_jours_ouvres,\n    (case when dc.delai_jours_ouvres = 0 then 'J+0,5'\n    \t  when dc.delai_jours_ouvres = 1 and extract(time from date_creation_ref) > '12:00:00' and extract(time from date_fin) < '12:00:00' then 'J+0,5'\n    \t  when dc.delai_jours_ouvres = 1 then 'J+1'\n    \t  when dc.delai_jours_ouvres = 2 then 'J+2'\n    \t  when dc.delai_jours_ouvres > 2 then 'J++'\n    \t  else 'ERREUR'\n   \tEND) as type_delai,\n  fm.famille_neshu\nfrom `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_pricing` sfp\nleft join delai_calcul dc on dc.sfp_numero = sfp.workorder_id\nleft join famille_machine fm on fm.Machine_Brut = sfp.machine_raw)\n--where extract(month from sfp.date_done) = 11 and extract(year from sfp.date_done) = 2025)\n-- SELECT REQUETE GLOBALE\nselect * from final_table", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_delais_neshu`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:33.690675Z", "completed_at": "2026-02-09T09:55:33.849428Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:34.032663Z", "completed_at": "2026-02-09T09:55:34.032685Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.5922830104827881, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_yuman__workorder_pricing_material_id__material_id__ref_dim_yuman__materials_.ed56aeb83a", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select material_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_pricing`\n    where material_id is not null\n),\n\nparent as (\n    select material_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:33.683451Z", "completed_at": "2026-02-09T09:55:33.850019Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:34.035695Z", "completed_at": "2026-02-09T09:55:34.035707Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.636462926864624, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_yuman__workorder_pricing_client_id__client_id__ref_dim_yuman__clients_.21ac718d59", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select client_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_pricing`\n    where client_id is not null\n),\n\nparent as (\n    select client_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__clients`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:33.700475Z", "completed_at": "2026-02-09T09:55:33.894126Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:34.120817Z", "completed_at": "2026-02-09T09:55:34.120832Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6759960651397705, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_yuman__workorder_pricing_site_id__site_id__ref_dim_yuman__sites_.c702139d38", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select site_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_pricing`\n    where site_id is not null\n),\n\nparent as (\n    select site_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:33.749299Z", "completed_at": "2026-02-09T09:55:33.907651Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:34.165222Z", "completed_at": "2026-02-09T09:55:34.165234Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7137980461120605, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_fct_yuman__workorder_pricing_demand_id.76643d2143", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select demand_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_pricing`\n  where demand_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:33.799834Z", "completed_at": "2026-02-09T09:55:33.909286Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:34.167181Z", "completed_at": "2026-02-09T09:55:34.167192Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.7410030364990234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_fct_yuman__workorder_pricing_workorder_id.0674558cf3", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select workorder_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_pricing`\n  where workorder_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:33.896012Z", "completed_at": "2026-02-09T09:55:34.166538Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:34.300884Z", "completed_at": "2026-02-09T09:55:34.300901Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7738595008850098, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_accepted_range_snap_oracle_neshu__valo_parc_machines_nombre_machines__0.495e667d3d", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `evs-datastack-prod`.`snapshots`.`snap_oracle_neshu__valo_parc_machines`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not nombre_machines >= 0\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:34.388236Z", "completed_at": "2026-02-09T09:55:34.462587Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:34.512670Z", "completed_at": "2026-02-09T09:55:34.512686Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.5399303436279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_accepted_range_snap_oracle_neshu__valo_parc_machines_valorisation_totale_machine__0.aa579e0ad9", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `evs-datastack-prod`.`snapshots`.`snap_oracle_neshu__valo_parc_machines`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not valorisation_totale_machine >= 0\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:34.408058Z", "completed_at": "2026-02-09T09:55:34.470428Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:34.516307Z", "completed_at": "2026-02-09T09:55:34.516322Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.4610130786895752, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_snap_oracle_neshu__valo_parc_machines_device_group.280a157893", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_group\nfrom `evs-datastack-prod`.`snapshots`.`snap_oracle_neshu__valo_parc_machines`\nwhere device_group is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:34.400025Z", "completed_at": "2026-02-09T09:55:34.471039Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:34.516961Z", "completed_at": "2026-02-09T09:55:34.516973Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.5170068740844727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_unique_combination_of_columns_snap_oracle_neshu__valo_parc_machines_snapshot_month__device_name__device_group.3e70d50cb6", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        snapshot_month, device_name, device_group\n    from (select * from `evs-datastack-prod`.`snapshots`.`snap_oracle_neshu__valo_parc_machines` where dbt_valid_to IS NULL) dbt_subquery\n    group by snapshot_month, device_name, device_group\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:34.463891Z", "completed_at": "2026-02-09T09:55:34.515631Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:34.584894Z", "completed_at": "2026-02-09T09:55:34.584908Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.4392893314361572, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_snap_oracle_neshu__valo_parc_machines_device_name.91d34e5321", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_name\nfrom `evs-datastack-prod`.`snapshots`.`snap_oracle_neshu__valo_parc_machines`\nwhere device_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:34.472398Z", "completed_at": "2026-02-09T09:55:34.518982Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:34.680449Z", "completed_at": "2026-02-09T09:55:34.680464Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.4375331401824951, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_snap_oracle_neshu__valo_parc_machines_nombre_machines.3a8532d90a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nombre_machines\nfrom `evs-datastack-prod`.`snapshots`.`snap_oracle_neshu__valo_parc_machines`\nwhere nombre_machines is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:34.485216Z", "completed_at": "2026-02-09T09:55:34.525702Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:34.682365Z", "completed_at": "2026-02-09T09:55:34.682377Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.4371178150177002, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_snap_oracle_neshu__valo_parc_machines_valorisation_totale_machine.8e209b9d72", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect valorisation_totale_machine\nfrom `evs-datastack-prod`.`snapshots`.`snap_oracle_neshu__valo_parc_machines`\nwhere valorisation_totale_machine is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:34.500185Z", "completed_at": "2026-02-09T09:55:34.535134Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:34.685227Z", "completed_at": "2026-02-09T09:55:34.685238Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5096285343170166, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.accepted_values_fct_oracle_neshu__machines_maintenance_tracking_status_inter__Ouvert__Planifie__Aucune.808c90cc4e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status_inter as value_field,\n        count(*) as n_records\n\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\n    group by status_inter\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Ouvert','Planifie','Aucune'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:34.479757Z", "completed_at": "2026-02-09T09:55:34.531631Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:34.683085Z", "completed_at": "2026-02-09T09:55:34.683102Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.5226712226867676, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_snap_oracle_neshu__valo_parc_machines_snapshot_month.997eae1351", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect snapshot_month\nfrom `evs-datastack-prod`.`snapshots`.`snap_oracle_neshu__valo_parc_machines`\nwhere snapshot_month is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:34.492325Z", "completed_at": "2026-02-09T09:55:34.534358Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:34.684522Z", "completed_at": "2026-02-09T09:55:34.684534Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.5533385276794434, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.accepted_values_fct_oracle_neshu__machines_maintenance_tracking_source_last_preventive__yuman__dlog__aucune.ac417d2f59", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        source_last_preventive as value_field,\n        count(*) as n_records\n\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\n    group by source_last_preventive\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'yuman','dlog','aucune'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:34.507493Z", "completed_at": "2026-02-09T09:55:34.584230Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:34.695322Z", "completed_at": "2026-02-09T09:55:34.695338Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.5970077514648438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_company_code.0cdf0f5a6b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_code\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere company_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:34.519888Z", "completed_at": "2026-02-09T09:55:34.683864Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:34.824711Z", "completed_at": "2026-02-09T09:55:34.824727Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.5824718475341797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_company_name.3bf8fed65d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_name\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere company_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:34.526346Z", "completed_at": "2026-02-09T09:55:34.685818Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:34.950707Z", "completed_at": "2026-02-09T09:55:34.950719Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.6263022422790527, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_device_code.21e30b32f5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_code\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere device_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:34.577547Z", "completed_at": "2026-02-09T09:55:34.694630Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:34.952307Z", "completed_at": "2026-02-09T09:55:34.952319Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6640501022338867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_device_id.980098d686", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere device_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:34.674440Z", "completed_at": "2026-02-09T09:55:34.781455Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:34.998590Z", "completed_at": "2026-02-09T09:55:34.998602Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.6947872638702393, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_device_name.27263a7181", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_name\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere device_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:34.627770Z", "completed_at": "2026-02-09T09:55:34.823985Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:35.000010Z", "completed_at": "2026-02-09T09:55:35.000023Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7453305721282959, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_device_last_installation_date.2fb83a6c11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_last_installation_date\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere device_last_installation_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:34.687363Z", "completed_at": "2026-02-09T09:55:34.996500Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:35.130330Z", "completed_at": "2026-02-09T09:55:35.130342Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 1.0001494884490967, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_retard_bol.1a01596ee3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect retard_bol\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere retard_bol is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:35.219352Z", "completed_at": "2026-02-09T09:55:35.547686Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:35.589853Z", "completed_at": "2026-02-09T09:55:35.589871Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.7180736064910889, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_retard_delai.90bc56ccbd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect retard_delai\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere retard_delai is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:35.227752Z", "completed_at": "2026-02-09T09:55:35.554114Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:35.596000Z", "completed_at": "2026-02-09T09:55:35.596015Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.7592916488647461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_source_last_preventive.00eb8f212a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect source_last_preventive\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere source_last_preventive is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:35.235002Z", "completed_at": "2026-02-09T09:55:35.569182Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:35.606977Z", "completed_at": "2026-02-09T09:55:35.606991Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.7744464874267578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_status_inter.169cfdb158", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status_inter\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere status_inter is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:35.549015Z", "completed_at": "2026-02-09T09:55:35.597561Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:35.713331Z", "completed_at": "2026-02-09T09:55:35.713343Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.6958167552947998, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_fct_oracle_neshu__machines_maintenance_tracking_device_id.259a568a16", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select device_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\n  where device_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:35.556474Z", "completed_at": "2026-02-09T09:55:35.604254Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:35.722576Z", "completed_at": "2026-02-09T09:55:35.722590Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.7356138229370117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__chargement_par_quinzaine_annee_chgt.872c094731", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect annee_chgt\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__chargement_par_quinzaine`\nwhere annee_chgt is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:35.562076Z", "completed_at": "2026-02-09T09:55:35.604850Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:35.723366Z", "completed_at": "2026-02-09T09:55:35.723378Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.7770082950592041, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__chargement_par_quinzaine_company_code.09099161b9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_code\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__chargement_par_quinzaine`\nwhere company_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:35.577286Z", "completed_at": "2026-02-09T09:55:35.614552Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:35.773864Z", "completed_at": "2026-02-09T09:55:35.773875Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.7361690998077393, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__chargement_par_quinzaine_quinzaine_chgt.9856c146f2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quinzaine_chgt\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__chargement_par_quinzaine`\nwhere quinzaine_chgt is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:35.569824Z", "completed_at": "2026-02-09T09:55:35.608756Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:35.773197Z", "completed_at": "2026-02-09T09:55:35.773214Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.8210229873657227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__chargement_par_quinzaine_product_type.87bdc4c469", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_type\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__chargement_par_quinzaine`\nwhere product_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:35.582875Z", "completed_at": "2026-02-09T09:55:35.670502Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:35.776270Z", "completed_at": "2026-02-09T09:55:35.776283Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.8202195167541504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__chargement_vs_conso_date_debut_passage_appro.87d98d26b5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect date_debut_passage_appro\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__chargement_vs_conso`\nwhere date_debut_passage_appro is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:35.590540Z", "completed_at": "2026-02-09T09:55:35.713964Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:35.784160Z", "completed_at": "2026-02-09T09:55:35.784172Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.8486127853393555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__chargement_vs_conso_device_id.56da0b7aaf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__chargement_vs_conso`\nwhere device_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:35.599188Z", "completed_at": "2026-02-09T09:55:35.772526Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:35.911115Z", "completed_at": "2026-02-09T09:55:35.911131Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.5853126049041748, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__chargement_vs_conso_product_type.47904ade26", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_type\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__chargement_vs_conso`\nwhere product_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:35.609472Z", "completed_at": "2026-02-09T09:55:35.775486Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:35.954930Z", "completed_at": "2026-02-09T09:55:35.954966Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.6256475448608398, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.accepted_values_fct_oracle_neshu__conso_business_review_data_source__TELEMETRIE__CHARGEMENT__LIVRAISON.5ec7a388a7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        data_source as value_field,\n        count(*) as n_records\n\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n    group by data_source\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'TELEMETRIE','CHARGEMENT','LIVRAISON'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:35.617502Z", "completed_at": "2026-02-09T09:55:35.782038Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:35.997607Z", "completed_at": "2026-02-09T09:55:35.997619Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6679153442382812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.accepted_values_fct_oracle_neshu__conso_business_review_product_type__THE__CAFE_CAPS__CHOCOLATS_VAN_HOUTEN__BOISSONS_GOURMANDES__ACCESSOIRES__CAFENOIR__INDEFINI__SNACKING__BOISSONS_FRAICHES.09a104a84b", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        product_type as value_field,\n        count(*) as n_records\n\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n    group by product_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'THE','CAFE CAPS','CHOCOLATS VAN HOUTEN','BOISSONS GOURMANDES','ACCESSOIRES','CAFENOIR','INDEFINI','SNACKING','BOISSONS FRAICHES'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:35.714592Z", "completed_at": "2026-02-09T09:55:35.867962Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:36.084408Z", "completed_at": "2026-02-09T09:55:36.084420Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.6928369998931885, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_accepted_range_fct_oracle_neshu__conso_business_review_consumption_date__current_date____2020_01_01_.5aa992f77c", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not consumption_date >= '2020-01-01'\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not consumption_date <= current_date()\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:35.724292Z", "completed_at": "2026-02-09T09:55:35.911748Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:36.086547Z", "completed_at": "2026-02-09T09:55:36.086558Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7339267730712891, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.device_id_required_except_livraison.acb84a4429", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n\nwhere not((device_id IS NOT NULL) OR (data_source = 'LIVRAISON'))\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:35.776962Z", "completed_at": "2026-02-09T09:55:36.083017Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:36.217212Z", "completed_at": "2026-02-09T09:55:36.217224Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.766697883605957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_company_code.5a6eede86e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_code\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere company_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:36.302871Z", "completed_at": "2026-02-09T09:55:36.373939Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:36.405874Z", "completed_at": "2026-02-09T09:55:36.405888Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.5664324760437012, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_company_id.ce47b5568c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere company_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:36.314347Z", "completed_at": "2026-02-09T09:55:36.383714Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:36.425468Z", "completed_at": "2026-02-09T09:55:36.425487Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.4969980716705322, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_company_name.6beef2cb38", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_name\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere company_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:36.364970Z", "completed_at": "2026-02-09T09:55:36.399155Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:36.436670Z", "completed_at": "2026-02-09T09:55:36.436682Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.5046982765197754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_consumption_date.a8716670d9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect consumption_date\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere consumption_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:36.377523Z", "completed_at": "2026-02-09T09:55:36.427552Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:36.539066Z", "completed_at": "2026-02-09T09:55:36.539079Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.43474411964416504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_data_source.af5248f6f7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect data_source\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere data_source is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:36.392046Z", "completed_at": "2026-02-09T09:55:36.429598Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:36.548734Z", "completed_at": "2026-02-09T09:55:36.548749Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.47413110733032227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_dbt_updated_at.15c85805ca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dbt_updated_at\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere dbt_updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:36.384388Z", "completed_at": "2026-02-09T09:55:36.428372Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:36.540481Z", "completed_at": "2026-02-09T09:55:36.540492Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.5170071125030518, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_dbt_invocation_id.50b356c305", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dbt_invocation_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere dbt_invocation_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:36.400453Z", "completed_at": "2026-02-09T09:55:36.480019Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:36.598356Z", "completed_at": "2026-02-09T09:55:36.598368Z"}], "thread_id": "Thread-12 (worker)", "execution_time": 0.4677114486694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_product_id.8da405d6c4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:36.406548Z", "completed_at": "2026-02-09T09:55:36.495118Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:36.599264Z", "completed_at": "2026-02-09T09:55:36.599276Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.5095715522766113, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_product_name.08b08915c7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_name\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere product_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:36.420266Z", "completed_at": "2026-02-09T09:55:36.539837Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:36.609342Z", "completed_at": "2026-02-09T09:55:36.609355Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.544705867767334, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_quantity.b59694399a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantity\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:36.412717Z", "completed_at": "2026-02-09T09:55:36.537621Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:36.602092Z", "completed_at": "2026-02-09T09:55:36.602104Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.594482421875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_product_type.e47220660c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_type\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere product_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:36.430206Z", "completed_at": "2026-02-09T09:55:36.591354Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:36.736406Z", "completed_at": "2026-02-09T09:55:36.736422Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.581669807434082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_oracle_neshu__conso_business_review_company_id__company_id__ref_dim_oracle_neshu__company_.f366f159ac", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select company_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n    where company_id is not null\n),\n\nparent as (\n    select company_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:36.487335Z", "completed_at": "2026-02-09T09:55:36.601462Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:36.823346Z", "completed_at": "2026-02-09T09:55:36.823361Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.6198592185974121, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_oracle_neshu__conso_business_review_product_id__product_id__ref_dim_oracle_neshu__product_.8d74866c2a", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:36.480680Z", "completed_at": "2026-02-09T09:55:36.600704Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:36.822688Z", "completed_at": "2026-02-09T09:55:36.822699Z"}], "thread_id": "Thread-10 (worker)", "execution_time": 0.6636843681335449, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_oracle_neshu__conso_business_review_device_id__device_id__ref_dim_oracle_neshu__device_.28a6562f85", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select device_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n    where device_id is not null\n),\n\nparent as (\n    select device_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:36.541106Z", "completed_at": "2026-02-09T09:55:36.733842Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:36.909716Z", "completed_at": "2026-02-09T09:55:36.909729Z"}], "thread_id": "Thread-14 (worker)", "execution_time": 0.6849558353424072, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_consumption_record.1740417b5a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        company_id, device_id, product_id, location_id, location, consumption_date, data_source\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n    group by company_id, device_id, product_id, location_id, location, consumption_date, data_source\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:36.592023Z", "completed_at": "2026-02-09T09:55:36.737993Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:36.954177Z", "completed_at": "2026-02-09T09:55:36.954189Z"}], "thread_id": "Thread-13 (worker)", "execution_time": 0.7321960926055908, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__appro_resources_roadman_id.dc6a93d531", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect resources_roadman_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__appro`\nwhere resources_roadman_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:36.602717Z", "completed_at": "2026-02-09T09:55:36.865106Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:36.997471Z", "completed_at": "2026-02-09T09:55:36.997483Z"}], "thread_id": "Thread-16 (worker)", "execution_time": 0.7546000480651855, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__appro_task_id.a27ca57827", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__appro`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:37.084691Z", "completed_at": "2026-02-09T09:55:37.198711Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:37.211323Z", "completed_at": "2026-02-09T09:55:37.211340Z"}], "thread_id": "Thread-9 (worker)", "execution_time": 0.5195357799530029, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_fct_oracle_neshu__appro_task_id.0a8c5dd256", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__appro`\n  where task_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:37.132796Z", "completed_at": "2026-02-09T09:55:37.199481Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:37.213323Z", "completed_at": "2026-02-09T09:55:37.213335Z"}], "thread_id": "Thread-15 (worker)", "execution_time": 0.47881293296813965, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_yuman__workorder_delais_neshu_client_id__client_id__ref_dim_yuman__clients_.d087bc885e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select client_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_delais_neshu`\n    where client_id is not null\n),\n\nparent as (\n    select client_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__clients`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:37.183744Z", "completed_at": "2026-02-09T09:55:37.212056Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:37.214550Z", "completed_at": "2026-02-09T09:55:37.214565Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.430156946182251, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_yuman__workorder_delais_neshu_material_id__material_id__ref_dim_yuman__materials_.0c6f62d93b", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select material_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_delais_neshu`\n    where material_id is not null\n),\n\nparent as (\n    select material_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:37.200140Z", "completed_at": "2026-02-09T09:55:37.255687Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:37.342218Z", "completed_at": "2026-02-09T09:55:37.342232Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.3439459800720215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_fct_yuman__workorder_delais_neshu_demand_id.0cbb695c5d", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select demand_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_delais_neshu`\n  where demand_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:37.192068Z", "completed_at": "2026-02-09T09:55:37.212704Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:37.258225Z", "completed_at": "2026-02-09T09:55:37.258237Z"}], "thread_id": "Thread-11 (worker)", "execution_time": 0.3864128589630127, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_yuman__workorder_delais_neshu_site_id__site_id__ref_dim_yuman__sites_.71af699e42", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select site_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_delais_neshu`\n    where site_id is not null\n),\n\nparent as (\n    select site_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-09T09:55:37.205271Z", "completed_at": "2026-02-09T09:55:37.257547Z"}, {"name": "execute", "started_at": "2026-02-09T09:55:37.343027Z", "completed_at": "2026-02-09T09:55:37.343042Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.3849494457244873, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_fct_yuman__workorder_delais_neshu_workorder_id.af9d57d961", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select workorder_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`fct_yuman__workorder_delais_neshu`\n  where workorder_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 48.46885585784912, "args": {"show_all_deprecations": false, "log_format": "default", "favor_state": false, "profiles_dir": "/home/runner/work/dbt_transform/dbt_transform", "require_generic_test_arguments_property": true, "use_colors_file": true, "target": "prod", "log_path": "/home/runner/work/dbt_transform/dbt_transform/logs", "log_level": "info", "compile": true, "defer": false, "indirect_selection": "eager", "validate_macro_args": false, "introspect": true, "cache_selected_only": false, "send_anonymous_usage_stats": false, "static_parser": true, "log_format_file": "debug", "source_freshness_run_project_hooks": true, "macro_debugging": false, "empty_catalog": false, "populate_cache": true, "log_level_file": "debug", "vars": {}, "require_nested_cumulative_type_params": false, "require_batched_execution_for_custom_microbatch_strategy": false, "require_explicit_package_overrides_for_builtin_materializations": true, "require_unique_project_resource_names": false, "use_colors": true, "exclude": [], "warn_error_options": {"error": [], "warn": [], "silence": []}, "select": [], "invocation_command": "dbt docs generate --target prod", "project_dir": "/home/runner/work/dbt_transform/dbt_transform", "partial_parse_file_diff": true, "static": false, "use_fast_test_edges": false, "version_check": true, "write_json": true, "require_yaml_configuration_for_mf_time_spines": false, "printer_width": 80, "require_ref_searches_node_package_before_root": false, "state_modified_compare_vars": false, "which": "generate", "strict_mode": false, "log_file_max_bytes": 10485760, "print": true, "partial_parse": true, "skip_nodes_if_on_run_start_fails": false, "state_modified_compare_more_unrendered_values": false, "quiet": false, "upload_to_artifacts_ingest_api": false, "require_all_warnings_handled_by_warn_error": false, "require_resource_names_without_spaces": true, "show_resource_report": false}}
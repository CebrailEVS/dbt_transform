{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.11.0b3", "generated_at": "2025-10-20T12:24:12.977795Z", "invocation_id": "d3de9015-62df-4f1d-842a-4581ffa711ee", "invocation_started_at": "2025-10-20T12:24:03.774353Z", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.684473Z", "completed_at": "2025-10-20T12:24:07.715159Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.735783Z", "completed_at": "2025-10-20T12:24:07.735803Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06753253936767578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__company", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_company`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idcompany as int64) as idcompany,\n        cast(company_idcompany as int64) as company_idcompany,\n        cast(idcompany_type as int64) as idcompany_type,\n        cast(idcontact_creation as int64) as idcontact_creation,\n        cast(idcontact_modification as int64) as idcontact_modification,\n        \n        -- Colonnes texte\n        code,\n        code_status_record,\n        name,\n        siret,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.700205Z", "completed_at": "2025-10-20T12:24:07.730854Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.738408Z", "completed_at": "2025-10-20T12:24:07.738424Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06971383094787598, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__company_has_location", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_company_has_location`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlocation as int64) as idlocation,\n        cast(idcompany as int64) as idcompany,\n        cast(idlocation_type as int64) as idlocation_type,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_has_location`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.706611Z", "completed_at": "2025-10-20T12:24:07.736539Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.743085Z", "completed_at": "2025-10-20T12:24:07.743101Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07078075408935547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__company_type", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_company_type`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idcompany_type as int64) as idcompany_type,\n        \n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_type`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.710916Z", "completed_at": "2025-10-20T12:24:07.737257Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.744473Z", "completed_at": "2025-10-20T12:24:07.744489Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0733940601348877, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__contact", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_contact`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idcontact as int64) as idcontact,\n        cast(idcompany as int64) as idcompany,\n        \n        -- Colonnes texte\n        code,\n        first_name,\n        last_name,\n        email,\n        name,\n        mobile,\n        phone,\n        qualite,\n        code_status_record,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contact`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.726727Z", "completed_at": "2025-10-20T12:24:07.739662Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.748344Z", "completed_at": "2025-10-20T12:24:07.748355Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07372140884399414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idlabel_family as int64) as idlabel_family,\n        \n        -- Colonnes texte\n        code,\n\n        -- Bolean\n        cast(system as boolean) as is_system,\n        cast(enabled as boolean) as is_enabled,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.715985Z", "completed_at": "2025-10-20T12:24:07.738980Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.747696Z", "completed_at": "2025-10-20T12:24:07.747710Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07769441604614258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__contract", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select\n        cast(idcontract as int64) as idcontract,\n        idcontract_type,\n        idcompany_self,\n        idcompany_financial,\n        idcompany_peer,\n        idcontact_creation,\n        idcontact_modification,\n        code,\n        name,\n        code_status_record,\n        xml,\n        original_start_date,\n        original_end_date,\n        current_end_date,\n        termination_date,\n        creation_date,\n        modification_date,\n        _sdc_extracted_at,\n        _sdc_deleted_at\n    from `evs-datastack-prod`.`prod_raw`.`evs_contract`\n),\n\n\nparsed_data as (\n    select\n        cast(idcontract as int64) as idcontract,\n        \n        -- nombre_collab \u2192 conversion en entier\n        cast(nullif(trim(nombre_collab), '') as int64) as nombre_collab,\n\n        -- garder la valeur brute telle quelle\n        trim(engagement) as engagement_raw,\n\n        -- version nettoy\u00e9e num\u00e9rique\n        case\n            when upper(trim(engagement)) = 'AUCUN' then 0\n            else cast(\n                regexp_replace(regexp_extract(engagement, r'[\\d\\s]+'), r'\\s+', '') as int64\n            )\n        end as engagement_clean,\n\n        timestamp(extracted_at) as parsed_extracted_at\n    from `evs-datastack-prod`.`prod_raw`.`evs_contract_parsed`\n),\n\ncleaned_data as (\n    select\n        -- Colonnes de evs_contract\n        cast(c.idcontract as int64) as idcontract,\n        cast(c.idcontract_type as int64) as idcontract_type,\n        cast(c.idcompany_self as int64) as idcompany_self,\n        cast(c.idcompany_financial as int64) as idcompany_financial,\n        cast(c.idcompany_peer as int64) as idcompany_peer,\n        cast(c.idcontact_creation as int64) as idcontact_creation,\n        cast(c.idcontact_modification as int64) as idcontact_modification,\n        \n        c.code,\n        c.name,\n        c.code_status_record,\n        -- Colonnes enrichies depuis evs_contract_parsed\n        p.nombre_collab,\n        p.engagement_raw,\n        p.engagement_clean,\n\n        timestamp(c.original_start_date) as original_start_date,\n        timestamp(c.original_end_date) as original_end_date,\n        timestamp(c.current_end_date) as current_end_date,\n        timestamp(c.termination_date) as termination_date,\n\n        timestamp(p.parsed_extracted_at) as parsed_extracted_at,\n        timestamp(c.creation_date) as created_at,\n        timestamp(coalesce(c.modification_date, c.creation_date)) as updated_at,\n        timestamp(c._sdc_extracted_at) as extracted_at,\n        timestamp(c._sdc_deleted_at) as deleted_at,\n\n    from source_data c\n    left join parsed_data p using (idcontract)\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contract`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.720982Z", "completed_at": "2025-10-20T12:24:07.743799Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.751987Z", "completed_at": "2025-10-20T12:24:07.751999Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.08010482788085938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__device", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_device`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(iddevice as int64) as iddevice,\n        cast(device_iddevice as int64) as device_iddevice,\n        cast(iddevice_type as int64) as iddevice_type,\n        cast(idmodel as int64) as idmodel,\n        cast(idcompany_customer as int64) as idcompany_customer,\n        cast(idcompany_supplier as int64) as idcompany_supplier,\n        cast(idcompany_owner as int64) as idcompany_owner,\n        cast(idcontact_creation as int64) as idcontact_creation,\n        cast(idcontact_modification as int64) as idcontact_modification,\n        cast(idlocation as int64) as idlocation,\n        \n        -- Colonnes texte\n        code,\n        name,\n        serial,\n        code_status_record,\n\n        -- Date li\u00e9e \u00e0 la machine\n        timestamp(last_installation_date) as last_installation_date,\n        timestamp(purchase_date) as purchase_date,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.731498Z", "completed_at": "2025-10-20T12:24:07.745067Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.752693Z", "completed_at": "2025-10-20T12:24:07.752703Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06838321685791016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label_family", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label_family`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel_family as int64) as idlabel_family,\n        \n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.774716Z", "completed_at": "2025-10-20T12:24:07.792005Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.809599Z", "completed_at": "2025-10-20T12:24:07.809616Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0603334903717041, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label_has_company", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label_has_company`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idcompany as int64) as idcompany,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_company`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.781229Z", "completed_at": "2025-10-20T12:24:07.804810Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.817088Z", "completed_at": "2025-10-20T12:24:07.817101Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05880856513977051, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label_has_contract", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label_has_contract`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idcontract as int64) as idcontract,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_contract`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.787603Z", "completed_at": "2025-10-20T12:24:07.810223Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.821551Z", "completed_at": "2025-10-20T12:24:07.821567Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05986642837524414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label_has_device", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label_has_device`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(iddevice as int64) as iddevice,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_device`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.792701Z", "completed_at": "2025-10-20T12:24:07.816081Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.822895Z", "completed_at": "2025-10-20T12:24:07.822908Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0611119270324707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label_has_product", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label_has_product`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idproduct as int64) as idproduct,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.797272Z", "completed_at": "2025-10-20T12:24:07.817813Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.823763Z", "completed_at": "2025-10-20T12:24:07.823779Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.062204837799072266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label_has_resources", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label_has_resources`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idresources as int64) as idresources,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_resources`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.801111Z", "completed_at": "2025-10-20T12:24:07.818539Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.826926Z", "completed_at": "2025-10-20T12:24:07.826940Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06393218040466309, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__label_has_task", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_label_has_task`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlabel as int64) as idlabel,\n        cast(idtask as int64) as idtask,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.805699Z", "completed_at": "2025-10-20T12:24:07.822112Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.830563Z", "completed_at": "2025-10-20T12:24:07.830574Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.06282782554626465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__location", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_location`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idlocation as int64) as idlocation,\n        \n        -- Colonnes texte\n        name,\n        access_info,\n        address1,\n        address2,\n        address3,\n        postal,\n        city,\n        country,\n        code,\n        code_status_record,\n        longitude,\n        latitude,\n        altitude,\n\n        -- Dates et timestamps\n        timestamp(localisation_date) as localisation_date,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.810944Z", "completed_at": "2025-10-20T12:24:07.826354Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.833930Z", "completed_at": "2025-10-20T12:24:07.833941Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06518197059631348, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__product", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_product`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idproduct as int64) as idproduct,\n        cast(idproduct_type as int64) as idproduct_type,\n        cast(idcompany_supplier as int64) as idcompany_supplier,\n        cast(idcontact_creation as int64) as idcontact_creation,\n        cast(idcontact_modification as int64) as idcontact_modification,\n        \n        -- Colonnes texte\n        code,\n        name,\n        commercial_name,\n        code_status_record,\n\n        -- Colonnes num\u00e9riques\n        cast(purchase_unit_price as float64) as purchase_unit_price,\n        cast(average_purchase_price as float64) as average_purchase_price,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.853280Z", "completed_at": "2025-10-20T12:24:07.869416Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.892787Z", "completed_at": "2025-10-20T12:24:07.892810Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06719565391540527, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__product_type", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_product_type`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idproduct_type as int64) as idproduct_type,\n        \n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at, \n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product_type`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.859376Z", "completed_at": "2025-10-20T12:24:07.888126Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.903745Z", "completed_at": "2025-10-20T12:24:07.903760Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0693979263305664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__resources", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_resources`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idresources as int64) as idresources,\n        cast(idresources_type as int64) as idresources_type,\n        cast(resources_idresources as int64) as resources_idresources,\n        cast(idcompany as int64) as idcompany,\n        cast(idcompany_storehouse as int64) as idcompany_storehouse,\n        cast(idlocation as int64) as idlocation,\n        cast(idcontact as int64) as idcontact,\n        cast(idcontact_creation as int64) as idcontact_creation,\n        cast(idcontact_modification as int64) as idcontact_modification,\n        \n        -- Colonnes texte\n        code,\n        name,\n        code_status_record,\n\n        -- Colonnes num\u00e9riques\n        cast(cost as float64) as cost,\n    \n        -- Timestamps harmonis\u00e9s\n        timestamp(arrival) as arrival,\n        timestamp(departure) as departure,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.865541Z", "completed_at": "2025-10-20T12:24:07.897473Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.907085Z", "completed_at": "2025-10-20T12:24:07.907101Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.067230224609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__resources_type", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_resources_type`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idresources_type as int64) as idresources_type,\n        \n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources_type`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.870019Z", "completed_at": "2025-10-20T12:24:07.898546Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.908478Z", "completed_at": "2025-10-20T12:24:07.908490Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06998682022094727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__task", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_task`\n),\n\ncleaned_data as (\n    select\n        -- IDs (cl\u00e9s primaires et \u00e9trang\u00e8res)\n        cast(idtask as int64) as idtask,\n        cast(task_idtask as int64) as task_idtask,\n        cast(idtask_type as int64) as idtask_type,\n        cast(idtask_status as int64) as idtask_status,\n        cast(iddevice as int64) as iddevice,\n        cast(idcompany_peer as int64) as idcompany_peer,\n        cast(idlocation as int64) as idlocation,\n        cast(idcontact as int64) as idcontact,\n        cast(idproduct_source as int64) as idproduct_source,\n        cast(idproduct_destination as int64) as idproduct_destination,\n\n        -- Colonnes texte et types\n        type_product_source,\n        type_product_destination,\n\n        -- Colonne num\u00e9rique\n        spantime as spantime, -- dur\u00e9e de la t\u00e2che en minute\n        CAST(code_status_record AS STRING) as code_status_record, -- status record (1 = valid\u00e9, 0 ou -1 possiblement inactif/desactiv\u00e9 : \u00e0 confirmer)\n        \n        -- Date de la tache\n        timestamp(real_start_date) as real_start_date,\n        timestamp(real_end_date) as real_end_date,\n        timestamp(planed_start_date) as planed_start_date,\n        timestamp(planed_end_date) as planed_end_date,\n        \n        -- Timestamps harmonis\u00e9s\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at, -- Use COALESCE to ensure updated_at is never null, falling back to creation_date\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data\n\n    where updated_at >= (\n        select max(updated_at) - interval 1 day\n        from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n    )\n", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.883434Z", "completed_at": "2025-10-20T12:24:07.903058Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.909821Z", "completed_at": "2025-10-20T12:24:07.909836Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07068204879760742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__task_status", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_task_status`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idtask_status as int64) as idtask_status,\n\n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.888826Z", "completed_at": "2025-10-20T12:24:07.907786Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.916285Z", "completed_at": "2025-10-20T12:24:07.916312Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07369780540466309, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__task_type", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_task_type`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idtask_type as int64) as idtask_type,\n\n        -- Colonnes texte\n        code,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(modification_date) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n)\n\nselect * from cleaned_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_type`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.893633Z", "completed_at": "2025-10-20T12:24:07.909173Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.917100Z", "completed_at": "2025-10-20T12:24:07.917114Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.06957840919494629, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__clients", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`yuman_clients`\n),\n\nbase_clients as (\n    select\n        id as client_id,\n        partner_id, \n        code as client_code,\n        name as client_name,\n        address as client_address,       \n        active as is_active,\n        SAFE.PARSE_JSON(_embed_fields) as embed_fields,\n        TIMESTAMP(created_at) as created_at,\n        TIMESTAMP(updated_at) as updated_at,\n        TIMESTAMP(_sdc_extracted_at) as extracted_at,\n        TIMESTAMP(_sdc_deleted_at) as deleted_at\n    from source_data\n    where id is not null\n),\n\njson_parsed as (\n    select\n        client_id,\n        client_code,\n        client_name,\n        updated_at,\n        JSON_EXTRACT_SCALAR(item, '$.name') as field_name,\n        JSON_EXTRACT_SCALAR(item, '$.value') as field_value\n    from base_clients,\n    UNNEST(JSON_EXTRACT_ARRAY(embed_fields)) as item\n),\n\nextracted_fields as (\n    select\n        client_id,\n        client_code,\n        client_name,\n        updated_at,\n        field_name,\n        field_value\n    from json_parsed\n    where field_name is not null\n),\n\npivoted as (\n    select\n        bc.client_id,\n        bc.partner_id,\n        bc.client_code,\n        bc.client_name,\n        MAX(IF(ef.field_name = 'CATEGORIE CLIENT EVS', ef.field_value, NULL)) as client_category,\n        bc.client_address,\n        bc.is_active,\n        bc.created_at,\n        bc.updated_at,\n        bc.extracted_at,\n        bc.deleted_at\n    from base_clients bc\n    left join extracted_fields ef on ef.client_id = bc.client_id\n    group by \n        bc.client_id, bc.client_code, bc.client_name, bc.client_address,\n        bc.partner_id, bc.is_active,\n        bc.created_at, bc.updated_at, bc.extracted_at, bc.deleted_at\n),\n\n-- Ajout du nom du partenaire via self join\nwith_partner_name as (\n    select \n        p.*,\n        partner.client_name as partner_name\n    from pivoted p\n    left join pivoted partner on p.partner_id = partner.client_id\n),\n\nfinal as (\n    select * from with_partner_name\n    where client_id is not null\n)\n--Titre chang\u00e9\nselect \n    client_id,\n    partner_id,\n    partner_name,\n    client_code,\n    client_name,\n    client_category,\n    client_address,\n    is_active,\n    created_at,\n    updated_at,\n    extracted_at,\n    deleted_at\nfrom final", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__clients`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.899173Z", "completed_at": "2025-10-20T12:24:07.910541Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.919796Z", "completed_at": "2025-10-20T12:24:07.919807Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06694173812866211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__materials", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`yuman_materials`\n),\n\ncleaned_materials as (\n    select\n        id as material_id,\n        site_id,\n        category_id, \n        name as material_name,\n        serial_number as material_serial_number,\n        brand as material_brand,\n        description as material_description,\n        in_service_date as material_in_service_date,      \n        timestamp(created_at) as created_at,\n        timestamp(updated_at) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n    from source_data\n    where id is not null\n)\n\nselect * from cleaned_materials", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.939202Z", "completed_at": "2025-10-20T12:24:07.956820Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.967245Z", "completed_at": "2025-10-20T12:24:07.967268Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.061846256256103516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__materials_categories", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`yuman_material_categories`\n),\n\ncleaned_material_categories as (\n    select\n        id as category_id,\n        name as category_name,   \n        TIMESTAMP(created_at) as created_at,\n        TIMESTAMP(updated_at) as updated_at,\n        TIMESTAMP(_sdc_extracted_at) as extracted_at,\n        TIMESTAMP(_sdc_deleted_at) as deleted_at\n    from source_data\n    where id is not null\n)\n\nselect * from cleaned_material_categories", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__materials_categories`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.948635Z", "completed_at": "2025-10-20T12:24:07.967971Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.982922Z", "completed_at": "2025-10-20T12:24:07.982936Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05839395523071289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__products", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`yuman_products`\n),\n\ncleaned_products as (\n    select\n        id as product_id,\n        reference as product_code,\n        designation as product_name,\n        product_type as product_type,\n        brand as product_brand,\n        unit as product_unit,\n        purchase_price as product_purchase_price,\n        sale_price as product_sale_price,    \n        active as is_active,\n        TIMESTAMP(created_at) as created_at,\n        TIMESTAMP(updated_at) as updated_at,\n        TIMESTAMP(_sdc_extracted_at) as extracted_at,\n        TIMESTAMP(_sdc_deleted_at) as deleted_at\n    from source_data\n    where id is not null\n)\n\nselect * from cleaned_products", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__products`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.952649Z", "completed_at": "2025-10-20T12:24:07.977363Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.986571Z", "completed_at": "2025-10-20T12:24:07.986583Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06036996841430664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__purchase_orders", "compiled": true, "compiled_code": "\n\nwith src as (\n  select * from `evs-datastack-prod`.`prod_raw`.`yuman_purchase_orders`\n),\n\n-- Normalisation / typage des champs ent\u00eate\npo_base as (\n  select\n    SAFE_CAST(id AS INT64)                            as purchase_order_id,\n    number                                           as purchase_order_number,\n    status                                           as purchase_order_satus,\n    invoice_status                              as purchase_order_invoice_status,\n    title                                           as purchase_order_title,\n    description                                      as order_description,\n    TIMESTAMP(creation_date)                         as creation_date,\n    TIMESTAMP(expected_delivery_date)                as expected_delivery_date,\n    TIMESTAMP(created_at)                             as order_created_at,\n    TIMESTAMP(updated_at)                             as order_updated_at,\n    SAFE_CAST(vat AS FLOAT64)                        as order_vat,\n    SAFE_CAST(subtotal AS FLOAT64)                   as order_subtotal,\n    SAFE_CAST(total AS FLOAT64)                      as order_total,\n    SAFE_CAST(manager_id AS INT64)                   as manager_id,\n    SAFE_CAST(quote_id AS INT64)                     as quote_id,\n    SAFE_CAST(supplier_id AS INT64)                  as supplier_id,\n    delivery_address,\n    TIMESTAMP(_sdc_extracted_at)                     as extracted_at,\n    SAFE_CAST(_sdc_sequence AS INT64)                as sdc_sequence,\n    lines\n  from src\n  where id is not null\n),\n\n-- Explode JSON array 'lines' : chaque item devient une ligne\nlines_exploded as (\n  select\n    pb.*,\n    item\n  from po_base pb,\n  unnest(\n    -- JSON_EXTRACT_ARRAY ne supporte pas nulls ; SAFE.PARSE_JSON \u00e9vite les erreurs\n    COALESCE(JSON_EXTRACT_ARRAY(SAFE.PARSE_JSON(lines)), []) \n  ) as item\n),\n\n-- Extraction des champs de chaque item JSON\nline_parsed as (\n  select\n    purchase_order_id,\n    purchase_order_number,\n    purchase_order_satus,\n    purchase_order_invoice_status,\n    purchase_order_title,\n    order_description,\n    creation_date,\n    expected_delivery_date,\n    order_created_at,\n    order_updated_at,\n    order_vat,\n    order_subtotal,\n    order_total,\n    manager_id,\n    quote_id,\n    supplier_id,\n    delivery_address,\n    extracted_at,\n    sdc_sequence,\n\n    -- champs ligne\n    SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.id') AS INT64)                 as purchase_order_line_id,\n    JSON_EXTRACT_SCALAR(item, '$.reference')                             as line_reference,\n    JSON_EXTRACT_SCALAR(item, '$.description')                           as line_description,\n    SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.quantity') AS FLOAT64)        as quantity,\n    JSON_EXTRACT_SCALAR(item, '$.unit')                                  as unit,\n    SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.quantity_received') AS FLOAT64) as quantity_received,\n    SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.unit_price') AS FLOAT64)      as unit_price,\n    SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.vat') AS FLOAT64)             as line_vat,\n    SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.subtotal') AS FLOAT64)        as line_subtotal,\n    SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.product_id') AS INT64)        as product_id,\n    SAFE_DIVIDE(\n      SAFE_CAST(JSON_EXTRACT_SCALAR(item, '$.subtotal_received.cents') AS INT64), \n      100\n    ) as subtotal_received_eur,\n    JSON_EXTRACT_SCALAR(item, '$.subtotal_received.currency_iso')        as subtotal_received_currency,\n    TIMESTAMP(JSON_EXTRACT_SCALAR(item, '$.created_at'))                 as line_created_at,\n    TIMESTAMP(JSON_EXTRACT_SCALAR(item, '$.updated_at'))                 as line_updated_at\n  from lines_exploded\n)\n\nselect\n  -- ent\u00eate commande (utile pour jointures et analyses)\n  purchase_order_id,\n  purchase_order_number,\n  purchase_order_satus,\n  purchase_order_invoice_status,\n  purchase_order_title,\n  order_description,\n  creation_date,\n  expected_delivery_date,\n  order_created_at,\n  order_updated_at,\n  order_vat,\n  order_subtotal,\n  order_total,\n  manager_id,\n  quote_id,\n  supplier_id,\n  delivery_address,\n\n  -- champs ligne (une ligne par item)\n  purchase_order_line_id,\n  line_reference,\n  line_description,\n  quantity,\n  unit,\n  quantity_received,\n  unit_price,\n  line_vat,\n  line_subtotal,\n  product_id,\n  subtotal_received_eur,\n  subtotal_received_currency,\n  line_created_at,\n  line_updated_at,\n\n  -- m\u00e9tadatas\n  extracted_at,\n  sdc_sequence\n\nfrom line_parsed\n-- si certaines commandes ont lines null on peut garder une ligne (optionnel) :\nwhere purchase_order_line_id is not null", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__purchase_orders`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.958861Z", "completed_at": "2025-10-20T12:24:07.982245Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.988805Z", "completed_at": "2025-10-20T12:24:07.988821Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.061749935150146484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__sites", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * from `evs-datastack-prod`.`prod_raw`.`yuman_sites`\n),\n\nextracted_postal_code as (\n    select\n        *,\n        (\n            select JSON_EXTRACT_SCALAR(value, '$.value')\n            from unnest(JSON_EXTRACT_ARRAY(_embed_fields)) as value\n            where JSON_EXTRACT_SCALAR(value, '$.name') = 'CODE POSTAL'\n            limit 1\n        ) as raw_code_postal\n    from source_data\n),\n\ncleaned as (\n    select\n        id as site_id,\n        client_id,\n        agency_id,\n        code as site_code,\n        name as site_name,\n        address as site_address,\n        -- Nettoyage du code postal : suppression du \".0\", puis cast en texte\n        regexp_replace(raw_code_postal, r'\\.0$', '') as site_postal_code,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at,\n        cast(_sdc_extracted_at as timestamp) as extracted_at,\n        cast(_sdc_deleted_at as timestamp) as deleted_at\n    from extracted_postal_code\n)\n\nselect * from cleaned", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.963248Z", "completed_at": "2025-10-20T12:24:07.985655Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.992636Z", "completed_at": "2025-10-20T12:24:07.992648Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.06424880027770996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__users", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * from `evs-datastack-prod`.`prod_raw`.`yuman_users`\n),\n\ncleaned_users as (\n    select\n        id as user_id,\n        manager_id, -- ID du manager de l'utilisateur\n        name as user_name,\n        email as user_email,\n        user_type as user_type,\n        phone as user_phone,\n        manager_as_technician as is_manager_as_technician,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at,\n        cast(_sdc_extracted_at as timestamp) as extracted_at,\n        cast(_sdc_deleted_at as timestamp) as deleted_at\n    from source_data\n)\n\nselect * from cleaned_users", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__users`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.973646Z", "completed_at": "2025-10-20T12:24:07.987498Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.995521Z", "completed_at": "2025-10-20T12:24:07.995532Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.058573246002197266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__workorder_demands_categories", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * from `evs-datastack-prod`.`prod_raw`.`yuman_workorder_demands_categories`\n),\n\ncleaned_categories as (\n    select\n        id as demand_category_id,\n        name as demand_category_name,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at,\n        cast(_sdc_extracted_at as timestamp) as extracted_at,\n        cast(_sdc_deleted_at as timestamp) as deleted_at\n    from source_data\n)\n\nselect * from cleaned_categories", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands_categories`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.978091Z", "completed_at": "2025-10-20T12:24:07.988161Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.996113Z", "completed_at": "2025-10-20T12:24:07.996125Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.05947160720825195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__workorder_products", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`yuman_workorders`\n),\n\nworkorder_products_unnested as (\n    select\n        wo.id as workorder_id,\n        cast(json_extract_scalar(product, '$.id') as int64) as workorder_product_id,\n        cast(json_extract_scalar(product, '$.product_id') as int64) as product_id,\n        json_extract_scalar(product, '$.product_reference') as product_reference,\n        json_extract_scalar(product, '$.product_designation') as product_designation,\n        cast(json_extract_scalar(product, '$.quantity') as float64) as product_quantity,\n        timestamp(json_extract_scalar(product, '$.created_at')) as product_created_at,\n        timestamp(json_extract_scalar(product, '$.updated_at')) as product_updated_at\n    from source_data wo,\n    unnest(json_extract_array(wo._embed_products)) as product\n),\n\nfinal as (\n    select\n        workorder_product_id,\n        workorder_id,\n        product_id,\n        product_reference,\n        product_designation,\n        product_quantity,\n        product_created_at,\n        product_updated_at\n    from workorder_products_unnested\n)\n\nselect * from final", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:07.968632Z", "completed_at": "2025-10-20T12:24:07.989387Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:07.998872Z", "completed_at": "2025-10-20T12:24:07.998884Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06444549560546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__workorder_demands", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`yuman_workorder_demands`\n),\n\ncleaned_workorder_demdands as (\n    select\n        id as demand_id,\n        workorder_id,\n        material_id,\n        site_id,\n        client_id,\n        user_id,\n        cast(contact_id as int64) as contact_id,\n        category_id as demand_category_id,\n        description as demand_description,\n        status as demand_status,\n        reject_comment as demand_reject_comment,\n        TIMESTAMP(created_at) as created_at,\n        TIMESTAMP(updated_at) as updated_at,\n        TIMESTAMP(_sdc_extracted_at) as extracted_at,\n        TIMESTAMP(_sdc_deleted_at) as deleted_at\n    from source_data\n    where id is not null\n)\n\nselect * from cleaned_workorder_demdands", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.030834Z", "completed_at": "2025-10-20T12:24:08.034540Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.042662Z", "completed_at": "2025-10-20T12:24:08.042686Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.04297947883605957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.cp_metropole", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.017490Z", "completed_at": "2025-10-20T12:24:08.035108Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.044087Z", "completed_at": "2025-10-20T12:24:08.044099Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05914163589477539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__workorders", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * \n    from `evs-datastack-prod`.`prod_raw`.`yuman_workorders`\n),\n\nbase_workorders as (\n    select\n    -- IDs and foreign keys\n        id as workorder_id,\n        site_id,\n        client_id,\n        technician_id,\n        manager_id,\n        category_id,\n        contact_id,\n    -- Workorder details\n        number as workorder_number,\n        workorder_type,\n        _embed_category_name as workorder_category,\n        status as workorder_status,\n        title as workorder_title,\n        description as workorder_description,\n        report as workorder_report,\n        _embed_technician_name as workorder_technician_name,\n        time_taken as workorder_time_taken,\n    -- JSON\n        SAFE.PARSE_JSON(_embed_fields) as embed_fields,\n    -- Dates\n        TIMESTAMP(date_planned) as date_planned,\n        TIMESTAMP(date_started) as date_started,\n        TIMESTAMP(date_done) as date_done,\n        TIMESTAMP(created_at) as created_at,\n        TIMESTAMP(updated_at) as updated_at,\n        TIMESTAMP(_sdc_extracted_at) as extracted_at,\n        TIMESTAMP(_sdc_deleted_at) as deleted_at\n    from source_data\n),\n\njson_parsed as (\n    select\n        *,\n        -- Extraction des champs sp\u00e9cifiques depuis le JSON array\n        (\n            select field\n            from unnest(json_extract_array(embed_fields)) as field\n            where json_extract_scalar(field, '$.name') = 'DATE DE CREATION'\n        ) as date_creation_field,\n        \n        (\n            select field\n            from unnest(json_extract_array(embed_fields)) as field\n            where json_extract_scalar(field, '$.name') = 'MOTIF DE NON INTERVENTION'\n        ) as motif_non_intervention_field,\n        \n        (\n            select field\n            from unnest(json_extract_array(embed_fields)) as field\n            where json_extract_scalar(field, '$.name') = 'NON INTERVENTION : DETAIL/AUTRE MOTIF'\n        ) as detail_non_intervention_field,\n        \n        (\n            select field\n            from unnest(json_extract_array(embed_fields)) as field\n            where json_extract_scalar(field, '$.name') = 'RAISON MISE EN PAUSE'\n        ) as raison_pause_field,\n        \n        (\n            select field\n            from unnest(json_extract_array(embed_fields)) as field\n            where json_extract_scalar(field, '$.name') = 'EXPLICATION MISE EN PAUSE'\n        ) as explication_pause_field,\n        \n        (\n            select field\n            from unnest(json_extract_array(embed_fields)) as field\n            where json_extract_scalar(field, '$.name') = \"NECESSITE D\\'INTERVENIR\"\n        ) as necessite_intervenir_field,\n        \n        (\n            select field\n            from unnest(json_extract_array(embed_fields)) as field\n            where json_extract_scalar(field, '$.name') = 'SI NON POURQUOI ?'\n        ) as si_non_pourquoi_field\n        \n    from base_workorders\n),\n\nfinal as (\n    select\n        -- Colonnes de base\n        workorder_id,\n        site_id,\n        client_id,\n        technician_id,\n        manager_id,\n        category_id,\n        contact_id,\n        workorder_number,\n        workorder_type,\n        workorder_category,\n        workorder_status,\n        workorder_title,\n        workorder_description,\n        workorder_report,\n        workorder_technician_name,\n        workorder_time_taken,\n\n        -- Champs extraits du JSON avec nettoyage\n        case \n            when json_extract_scalar(date_creation_field, '$.value') is not null\n            then safe.parse_date('%d/%m/%Y', json_extract_scalar(date_creation_field, '$.value'))\n        end as workorder_date_creation,\n        \n        json_extract_scalar(motif_non_intervention_field, '$.value') as workorder_motif_non_intervention,\n        json_extract_scalar(detail_non_intervention_field, '$.value') as workorder_detail_non_intervention,\n        json_extract_scalar(raison_pause_field, '$.value') as workorder_raison_mise_en_pause,\n        json_extract_scalar(explication_pause_field, '$.value') as workorder_explication_mise_en_pause,\n        json_extract_scalar(necessite_intervenir_field, '$.value') as workorder_necessite_intervenir,\n        json_extract_scalar(si_non_pourquoi_field, '$.value') as workorder_si_non_pourquoi,\n        \n        -- Dates\n        date_planned,\n        date_started,\n        date_done,\n        created_at,\n        updated_at,\n        extracted_at,\n        deleted_at\n        \n    from json_parsed\n)\n\nselect * from final", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.036919Z", "completed_at": "2025-10-20T12:24:08.038798Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.049716Z", "completed_at": "2025-10-20T12:24:08.049731Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04751420021057129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.cps_tech", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.026100Z", "completed_at": "2025-10-20T12:24:08.043466Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.053678Z", "completed_at": "2025-10-20T12:24:08.053693Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.05462384223937988, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_yuman__workorders_categories", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select * from `evs-datastack-prod`.`prod_raw`.`yuman_workorder_categories`\n),\n\ncleaned_categories as (\n    select\n        id as category_id,\n        name as category_name,\n        cast(created_at as timestamp) as created_at,\n        cast(updated_at as timestamp) as updated_at,\n        cast(_sdc_extracted_at as timestamp) as extracted_at,\n        cast(_sdc_deleted_at as timestamp) as deleted_at\n    from source_data\n)\n\nselect * from cleaned_categories", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders_categories`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.040166Z", "completed_at": "2025-10-20T12:24:08.041978Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.052952Z", "completed_at": "2025-10-20T12:24:08.052963Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.04514789581298828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.dpt_metropole", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.044712Z", "completed_at": "2025-10-20T12:24:08.046530Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.060074Z", "completed_at": "2025-10-20T12:24:08.060087Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.04737114906311035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.machines_clean", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.047141Z", "completed_at": "2025-10-20T12:24:08.049084Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.060805Z", "completed_at": "2025-10-20T12:24:08.060816Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.049623727798461914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.marque_clean", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.050474Z", "completed_at": "2025-10-20T12:24:08.052361Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.063382Z", "completed_at": "2025-10-20T12:24:08.063392Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.050553083419799805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.tarification_ref_clean", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.089253Z", "completed_at": "2025-10-20T12:24:08.091696Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.107449Z", "completed_at": "2025-10-20T12:24:08.107468Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06704092025756836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.tech_piece_agence_mapping", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.092326Z", "completed_at": "2025-10-20T12:24:08.094446Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.120850Z", "completed_at": "2025-10-20T12:24:08.120868Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06906437873840332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.techniciens_clean", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.095824Z", "completed_at": "2025-10-20T12:24:08.097767Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.126807Z", "completed_at": "2025-10-20T12:24:08.126821Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06996774673461914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.type_inter_clean", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.099667Z", "completed_at": "2025-10-20T12:24:08.101598Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.143166Z", "completed_at": "2025-10-20T12:24:08.143180Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07145214080810547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbt_warehouse.valo_parc_machine", "compiled": null, "compiled_code": null, "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.102215Z", "completed_at": "2025-10-20T12:24:08.146575Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.156012Z", "completed_at": "2025-10-20T12:24:08.156024Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.08001232147216797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_source_unique_combination_of_columns_mssql_sage_dbo_f_ecriturea_ec_no__n_analytique__ea_ligne.d6b0f7b301", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        ec_no, n_analytique, ea_ligne\n    from `evs-datastack-prod`.`prod_raw`.`dbo_f_ecriturea`\n    group by ec_no, n_analytique, ea_ligne\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.121632Z", "completed_at": "2025-10-20T12:24:08.151556Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.159138Z", "completed_at": "2025-10-20T12:24:08.159151Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.08162093162536621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_mssql_sage_dbo_f_ecriturea_cb_marq.7d3e1176b7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cb_marq\nfrom `evs-datastack-prod`.`prod_raw`.`dbo_f_ecriturea`\nwhere cb_marq is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.132423Z", "completed_at": "2025-10-20T12:24:08.152438Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.159837Z", "completed_at": "2025-10-20T12:24:08.159849Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.0824117660522461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_mssql_sage_dbo_f_ecriturec_ec_no.714fd67ceb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ec_no\nfrom `evs-datastack-prod`.`prod_raw`.`dbo_f_ecriturec`\nwhere ec_no is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.137822Z", "completed_at": "2025-10-20T12:24:08.156777Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.161988Z", "completed_at": "2025-10-20T12:24:08.162000Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.08576345443725586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_company_has_location_idcompany.d2e7a813ca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_raw`.`evs_company_has_location`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.177197Z", "completed_at": "2025-10-20T12:24:08.204565Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.214608Z", "completed_at": "2025-10-20T12:24:08.214627Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0747687816619873, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_company_has_location_idlocation.e1aaef8e8b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation\nfrom `evs-datastack-prod`.`prod_raw`.`evs_company_has_location`\nwhere idlocation is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.189547Z", "completed_at": "2025-10-20T12:24:08.206214Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.221068Z", "completed_at": "2025-10-20T12:24:08.221083Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07442355155944824, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_company_idcompany.c223201709", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_raw`.`evs_company`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.184397Z", "completed_at": "2025-10-20T12:24:08.207519Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.226991Z", "completed_at": "2025-10-20T12:24:08.227005Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07708215713500977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_company_has_location_idlocation_type.b7ffe23a12", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation_type\nfrom `evs-datastack-prod`.`prod_raw`.`evs_company_has_location`\nwhere idlocation_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.198065Z", "completed_at": "2025-10-20T12:24:08.215204Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.237476Z", "completed_at": "2025-10-20T12:24:08.237494Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07730603218078613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_company_type_idcompany_type.11fcffba5d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany_type\nfrom `evs-datastack-prod`.`prod_raw`.`evs_company_type`\nwhere idcompany_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.208220Z", "completed_at": "2025-10-20T12:24:08.236746Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.244251Z", "completed_at": "2025-10-20T12:24:08.244267Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.06978702545166016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_contact_idcontact.d426a1c13e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontact\nfrom `evs-datastack-prod`.`prod_raw`.`evs_contact`\nwhere idcontact is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.215888Z", "completed_at": "2025-10-20T12:24:08.242566Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.249636Z", "completed_at": "2025-10-20T12:24:08.249647Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.06161832809448242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_contract_idcontract.f730c61b9d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontract\nfrom `evs-datastack-prod`.`prod_raw`.`evs_contract`\nwhere idcontract is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.221804Z", "completed_at": "2025-10-20T12:24:08.244856Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.251006Z", "completed_at": "2025-10-20T12:24:08.251021Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06293821334838867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_contract_parsed_idcontract.34a4825dee", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontract\nfrom `evs-datastack-prod`.`prod_raw`.`evs_contract_parsed`\nwhere idcontract is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.229130Z", "completed_at": "2025-10-20T12:24:08.245617Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.253580Z", "completed_at": "2025-10-20T12:24:08.253590Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.05905270576477051, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_device_iddevice.d62f2bee11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect iddevice\nfrom `evs-datastack-prod`.`prod_raw`.`evs_device`\nwhere iddevice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.265691Z", "completed_at": "2025-10-20T12:24:08.287959Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.298256Z", "completed_at": "2025-10-20T12:24:08.298279Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06944751739501953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_family_idlabel_family.76e2fc3d22", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel_family\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_family`\nwhere idlabel_family is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.274685Z", "completed_at": "2025-10-20T12:24:08.297012Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.316567Z", "completed_at": "2025-10-20T12:24:08.316587Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07609295845031738, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_company_idcompany.9fb5a691bb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_company`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.279869Z", "completed_at": "2025-10-20T12:24:08.297644Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.317213Z", "completed_at": "2025-10-20T12:24:08.317225Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07746338844299316, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_company_idlabel.84c84e0808", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_company`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.289928Z", "completed_at": "2025-10-20T12:24:08.315545Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.328058Z", "completed_at": "2025-10-20T12:24:08.328071Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07479739189147949, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_contract_idcontract.34f534407d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontract\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_contract`\nwhere idcontract is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.298979Z", "completed_at": "2025-10-20T12:24:08.327409Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.335406Z", "completed_at": "2025-10-20T12:24:08.335421Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.0713949203491211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_contract_idlabel.1500ee3c29", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_contract`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.305087Z", "completed_at": "2025-10-20T12:24:08.328743Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.336823Z", "completed_at": "2025-10-20T12:24:08.336836Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.059510231018066406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_device_iddevice.67fa8a09c3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect iddevice\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_device`\nwhere iddevice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.310445Z", "completed_at": "2025-10-20T12:24:08.333860Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.340829Z", "completed_at": "2025-10-20T12:24:08.340842Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06293630599975586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_device_idlabel.7913e12518", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_device`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.320521Z", "completed_at": "2025-10-20T12:24:08.336103Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.342211Z", "completed_at": "2025-10-20T12:24:08.342227Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.0635993480682373, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_product_idlabel.5191f399c0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_product`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.357686Z", "completed_at": "2025-10-20T12:24:08.378970Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.394821Z", "completed_at": "2025-10-20T12:24:08.394838Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07418632507324219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_product_idproduct.6048527bb0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_product`\nwhere idproduct is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.366206Z", "completed_at": "2025-10-20T12:24:08.386334Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.406349Z", "completed_at": "2025-10-20T12:24:08.406366Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07253861427307129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_resources_idlabel.eabdfa7bbf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_resources`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.371372Z", "completed_at": "2025-10-20T12:24:08.392733Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.413364Z", "completed_at": "2025-10-20T12:24:08.413379Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07491588592529297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_resources_idresources.701adf32da", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.380205Z", "completed_at": "2025-10-20T12:24:08.405615Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.418169Z", "completed_at": "2025-10-20T12:24:08.418182Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07356071472167969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_task_idlabel.9722fba510", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_task`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.387637Z", "completed_at": "2025-10-20T12:24:08.416695Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.425476Z", "completed_at": "2025-10-20T12:24:08.425489Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.06900167465209961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_has_task_idtask.407d48dbcb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label_has_task`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.395466Z", "completed_at": "2025-10-20T12:24:08.417535Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.426085Z", "completed_at": "2025-10-20T12:24:08.426096Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07100725173950195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_label_idlabel.725504fd88", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_raw`.`evs_label`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.400648Z", "completed_at": "2025-10-20T12:24:08.421175Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.429513Z", "completed_at": "2025-10-20T12:24:08.429530Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06202363967895508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_location_idlocation.252e77f735", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation\nfrom `evs-datastack-prod`.`prod_raw`.`evs_location`\nwhere idlocation is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.407749Z", "completed_at": "2025-10-20T12:24:08.424765Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.431539Z", "completed_at": "2025-10-20T12:24:08.431550Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06444478034973145, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_product_idproduct.0e5cc2ab70", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct\nfrom `evs-datastack-prod`.`prod_raw`.`evs_product`\nwhere idproduct is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.446978Z", "completed_at": "2025-10-20T12:24:08.471128Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.490440Z", "completed_at": "2025-10-20T12:24:08.490459Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0761258602142334, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_product_type_idproduct_type.2e7c2d534c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct_type\nfrom `evs-datastack-prod`.`prod_raw`.`evs_product_type`\nwhere idproduct_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.454019Z", "completed_at": "2025-10-20T12:24:08.478141Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.496575Z", "completed_at": "2025-10-20T12:24:08.496588Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07561993598937988, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_resources_idresources.04add56fa5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_raw`.`evs_resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.463129Z", "completed_at": "2025-10-20T12:24:08.484637Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.504157Z", "completed_at": "2025-10-20T12:24:08.504170Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07402253150939941, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_resources_type_idresources_type.c0ade33349", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources_type\nfrom `evs-datastack-prod`.`prod_raw`.`evs_resources_type`\nwhere idresources_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.471914Z", "completed_at": "2025-10-20T12:24:08.498424Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.510748Z", "completed_at": "2025-10-20T12:24:08.510760Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0752401351928711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_task_has_product_idtask_has_product.52f463d476", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_has_product\nfrom `evs-datastack-prod`.`prod_raw`.`evs_task_has_product`\nwhere idtask_has_product is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.479570Z", "completed_at": "2025-10-20T12:24:08.504838Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.514980Z", "completed_at": "2025-10-20T12:24:08.514992Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.06955361366271973, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_task_has_resources_idresources.6896d0d7f1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_raw`.`evs_task_has_resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.485262Z", "completed_at": "2025-10-20T12:24:08.508064Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.516407Z", "completed_at": "2025-10-20T12:24:08.516423Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.06639599800109863, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_task_has_resources_idtask.3c6bbcc3c8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_raw`.`evs_task_has_resources`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.491369Z", "completed_at": "2025-10-20T12:24:08.511491Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.517880Z", "completed_at": "2025-10-20T12:24:08.517892Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06568241119384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_task_idtask.d1aa0b27a5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_raw`.`evs_task`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.499074Z", "completed_at": "2025-10-20T12:24:08.514372Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.521117Z", "completed_at": "2025-10-20T12:24:08.521133Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06275272369384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_task_status_idtask_status.2b475b6b56", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_status\nfrom `evs-datastack-prod`.`prod_raw`.`evs_task_status`\nwhere idtask_status is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.538425Z", "completed_at": "2025-10-20T12:24:08.561167Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.584039Z", "completed_at": "2025-10-20T12:24:08.584059Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07143712043762207, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_oracle_neshu_evs_task_type_idtask_type.d7f9ba800f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_type\nfrom `evs-datastack-prod`.`prod_raw`.`evs_task_type`\nwhere idtask_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.544649Z", "completed_at": "2025-10-20T12:24:08.561821Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.584803Z", "completed_at": "2025-10-20T12:24:08.584815Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0714726448059082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_clients_id.94442bf14b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_clients`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.550899Z", "completed_at": "2025-10-20T12:24:08.568178Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.590541Z", "completed_at": "2025-10-20T12:24:08.590557Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07275032997131348, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_material_categories_id.4ef54c952f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_material_categories`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.562415Z", "completed_at": "2025-10-20T12:24:08.591312Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.603190Z", "completed_at": "2025-10-20T12:24:08.603202Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07311773300170898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_materials_id.ef8e1020be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_materials`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.578906Z", "completed_at": "2025-10-20T12:24:08.593144Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.604427Z", "completed_at": "2025-10-20T12:24:08.604438Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.0615077018737793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_purchase_orders_id.3eb709d1c8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_purchase_orders`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.568825Z", "completed_at": "2025-10-20T12:24:08.592211Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.603808Z", "completed_at": "2025-10-20T12:24:08.603819Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07576394081115723, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_materials_site_id.f462c1646e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect site_id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_materials`\nwhere site_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.573723Z", "completed_at": "2025-10-20T12:24:08.596089Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.605687Z", "completed_at": "2025-10-20T12:24:08.605703Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07316040992736816, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_products_id.9d76ec0f24", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_products`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.585531Z", "completed_at": "2025-10-20T12:24:08.602493Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.607730Z", "completed_at": "2025-10-20T12:24:08.607741Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.061957359313964844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_sites_client_id.6e84614dea", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect client_id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_sites`\nwhere client_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.632743Z", "completed_at": "2025-10-20T12:24:08.647232Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.674031Z", "completed_at": "2025-10-20T12:24:08.674058Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07081246376037598, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_users_id.d5dd93c383", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_users`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.627343Z", "completed_at": "2025-10-20T12:24:08.653082Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.674976Z", "completed_at": "2025-10-20T12:24:08.674992Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07367134094238281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_sites_id.cc7391839c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_sites`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.638504Z", "completed_at": "2025-10-20T12:24:08.654409Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.681243Z", "completed_at": "2025-10-20T12:24:08.681256Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0738520622253418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_workorder_categories_id.481d28172c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_workorder_categories`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.648057Z", "completed_at": "2025-10-20T12:24:08.680543Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.688795Z", "completed_at": "2025-10-20T12:24:08.688807Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07196712493896484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_workorder_demands_categories_id.a8a4d3d9e4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_workorder_demands_categories`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.666631Z", "completed_at": "2025-10-20T12:24:08.683156Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.692805Z", "completed_at": "2025-10-20T12:24:08.692817Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.06242632865905762, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_mssql_sage_dbo_f_ecriturea_cb_marq.ce4c2c11f4", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select cb_marq as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`dbo_f_ecriturea`\n  where cb_marq is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.661488Z", "completed_at": "2025-10-20T12:24:08.682386Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.692190Z", "completed_at": "2025-10-20T12:24:08.692201Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07535982131958008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_workorders_id.e6c047d2a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_workorders`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.655032Z", "completed_at": "2025-10-20T12:24:08.683902Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.693435Z", "completed_at": "2025-10-20T12:24:08.693451Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07946467399597168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_not_null_yuman_api_yuman_workorder_demands_id.2951fa446c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom `evs-datastack-prod`.`prod_raw`.`yuman_workorder_demands`\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.675670Z", "completed_at": "2025-10-20T12:24:08.689677Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.697557Z", "completed_at": "2025-10-20T12:24:08.697572Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06414985656738281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_mssql_sage_dbo_f_ecriturec_ec_no.6925cf7be5", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select ec_no as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`dbo_f_ecriturec`\n  where ec_no is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.716831Z", "completed_at": "2025-10-20T12:24:08.739219Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.762154Z", "completed_at": "2025-10-20T12:24:08.762173Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07049703598022461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_company_idcompany.6df2f6792e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcompany as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_company`\n  where idcompany is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.722648Z", "completed_at": "2025-10-20T12:24:08.739806Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.763806Z", "completed_at": "2025-10-20T12:24:08.763822Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07269763946533203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_company_type_idcompany_type.56f35aae37", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcompany_type as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_company_type`\n  where idcompany_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.731828Z", "completed_at": "2025-10-20T12:24:08.751109Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.770367Z", "completed_at": "2025-10-20T12:24:08.770383Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0718545913696289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_contact_idcontact.d870dc347d", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcontact as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_contact`\n  where idcontact is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.740450Z", "completed_at": "2025-10-20T12:24:08.769669Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.777926Z", "completed_at": "2025-10-20T12:24:08.777943Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07245445251464844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_contract_idcontract.00683b26ea", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcontract as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_contract`\n  where idcontract is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.746167Z", "completed_at": "2025-10-20T12:24:08.771204Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.779270Z", "completed_at": "2025-10-20T12:24:08.779281Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07287168502807617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_contract_parsed_idcontract.88000e1326", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcontract as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_contract_parsed`\n  where idcontract is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.751889Z", "completed_at": "2025-10-20T12:24:08.774277Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.782667Z", "completed_at": "2025-10-20T12:24:08.782679Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07559776306152344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_device_iddevice.397252bea8", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select iddevice as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_device`\n  where iddevice is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.756869Z", "completed_at": "2025-10-20T12:24:08.777198Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.783978Z", "completed_at": "2025-10-20T12:24:08.783989Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06535601615905762, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_label_family_idlabel_family.52acfecf7e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlabel_family as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_label_family`\n  where idlabel_family is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.764583Z", "completed_at": "2025-10-20T12:24:08.778541Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.786603Z", "completed_at": "2025-10-20T12:24:08.786618Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.0661158561706543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_label_idlabel.f4f4d52728", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlabel as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_label`\n  where idlabel is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.804691Z", "completed_at": "2025-10-20T12:24:08.825145Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.844197Z", "completed_at": "2025-10-20T12:24:08.844217Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0699300765991211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_location_idlocation.e07de44c8b", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlocation as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_location`\n  where idlocation is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.811056Z", "completed_at": "2025-10-20T12:24:08.832237Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.845951Z", "completed_at": "2025-10-20T12:24:08.845962Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07135629653930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_product_idproduct.56c841c209", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idproduct as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_product`\n  where idproduct is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.818880Z", "completed_at": "2025-10-20T12:24:08.845112Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.861352Z", "completed_at": "2025-10-20T12:24:08.861365Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07074975967407227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_product_type_idproduct_type.f77e407933", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idproduct_type as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_product_type`\n  where idproduct_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.825783Z", "completed_at": "2025-10-20T12:24:08.851762Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.864692Z", "completed_at": "2025-10-20T12:24:08.864707Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07154178619384766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_resources_idresources.65588abfd8", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idresources as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_resources`\n  where idresources is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.839003Z", "completed_at": "2025-10-20T12:24:08.860715Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.866422Z", "completed_at": "2025-10-20T12:24:08.866434Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.06580233573913574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_task_has_product_idtask_has_product.b9af110684", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_has_product as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_task_has_product`\n  where idtask_has_product is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.834072Z", "completed_at": "2025-10-20T12:24:08.862121Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.870317Z", "completed_at": "2025-10-20T12:24:08.870332Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07609009742736816, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_resources_type_idresources_type.94e4b1617f", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idresources_type as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_resources_type`\n  where idresources_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.846659Z", "completed_at": "2025-10-20T12:24:08.867732Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.876999Z", "completed_at": "2025-10-20T12:24:08.877011Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06737971305847168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_task_idtask.e261c356e9", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_task`\n  where idtask is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.852422Z", "completed_at": "2025-10-20T12:24:08.867089Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.876399Z", "completed_at": "2025-10-20T12:24:08.876411Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06862187385559082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_task_status_idtask_status.b176cc0c5b", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_status as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_task_status`\n  where idtask_status is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.891562Z", "completed_at": "2025-10-20T12:24:08.907600Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.925828Z", "completed_at": "2025-10-20T12:24:08.925847Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0736229419708252, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_oracle_neshu_evs_task_type_idtask_type.3b8b3b9ff6", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_type as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`evs_task_type`\n  where idtask_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.900023Z", "completed_at": "2025-10-20T12:24:08.923940Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.934774Z", "completed_at": "2025-10-20T12:24:08.934788Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07136368751525879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_clients_id.ac9ad6b2fc", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_clients`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.914001Z", "completed_at": "2025-10-20T12:24:08.933271Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.948318Z", "completed_at": "2025-10-20T12:24:08.948331Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06680512428283691, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_materials_id.627fc0bbcf", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_materials`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.908221Z", "completed_at": "2025-10-20T12:24:08.934024Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.949604Z", "completed_at": "2025-10-20T12:24:08.949616Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0721437931060791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_material_categories_id.8e8a025d0a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_material_categories`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.919022Z", "completed_at": "2025-10-20T12:24:08.940269Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.952478Z", "completed_at": "2025-10-20T12:24:08.952490Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.06521773338317871, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_products_id.0797f24444", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_products`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.926573Z", "completed_at": "2025-10-20T12:24:08.948954Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.956768Z", "completed_at": "2025-10-20T12:24:08.956780Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.06659841537475586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_purchase_orders_id.1a3a583089", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_purchase_orders`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.935453Z", "completed_at": "2025-10-20T12:24:08.953166Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.962695Z", "completed_at": "2025-10-20T12:24:08.962707Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06428360939025879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_sites_id.c7e2661f2f", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_sites`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.941047Z", "completed_at": "2025-10-20T12:24:08.957462Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:08.966801Z", "completed_at": "2025-10-20T12:24:08.966812Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06756424903869629, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_users_id.9323495945", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_users`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.977957Z", "completed_at": "2025-10-20T12:24:08.999540Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.018333Z", "completed_at": "2025-10-20T12:24:09.018347Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0656893253326416, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_workorder_categories_id.ae2a36c8ed", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_workorder_categories`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.985878Z", "completed_at": "2025-10-20T12:24:09.011847Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.025571Z", "completed_at": "2025-10-20T12:24:09.025587Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0710439682006836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_workorder_demands_categories_id.d7d762a90b", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_workorder_demands_categories`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:08.993801Z", "completed_at": "2025-10-20T12:24:09.017577Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.026915Z", "completed_at": "2025-10-20T12:24:09.026929Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0703880786895752, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_workorder_demands_id.61272d2b5b", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_workorder_demands`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.000812Z", "completed_at": "2025-10-20T12:24:09.019814Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.037090Z", "completed_at": "2025-10-20T12:24:09.037102Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07179832458496094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.source_unique_yuman_api_yuman_workorders_id.cf3a021d13", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select id as unique_field\n  from `evs-datastack-prod`.`prod_raw`.`yuman_workorders`\n  where id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.005760Z", "completed_at": "2025-10-20T12:24:09.026132Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.040018Z", "completed_at": "2025-10-20T12:24:09.040031Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07255363464355469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__company_idcompany.a1f4fb5739", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.012637Z", "completed_at": "2025-10-20T12:24:09.036409Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.044059Z", "completed_at": "2025-10-20T12:24:09.044076Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.06986236572265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__company_idcompany.f25c2833cc", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcompany as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n  where idcompany is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.020505Z", "completed_at": "2025-10-20T12:24:09.040629Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.050040Z", "completed_at": "2025-10-20T12:24:09.050051Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06505322456359863, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__company_has_location_idcompany.ed01157bcd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_has_location`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.029882Z", "completed_at": "2025-10-20T12:24:09.044726Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.052072Z", "completed_at": "2025-10-20T12:24:09.052088Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.061095476150512695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__company_has_location_idlocation.a2b189f3f3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_has_location`\nwhere idlocation is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.066028Z", "completed_at": "2025-10-20T12:24:09.090914Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.107267Z", "completed_at": "2025-10-20T12:24:09.107287Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07769274711608887, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__company_has_location_idlocation_type.9d6f83a35c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_has_location`\nwhere idlocation_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.072993Z", "completed_at": "2025-10-20T12:24:09.105252Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.113715Z", "completed_at": "2025-10-20T12:24:09.113729Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07689380645751953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__company_has_location_idcompany__idcompany__ref_stg_oracle_neshu__company_.801bad8c2d", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_has_location`\n    where idcompany is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.084727Z", "completed_at": "2025-10-20T12:24:09.107891Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.127007Z", "completed_at": "2025-10-20T12:24:09.127020Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07745718955993652, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__company_type_idcompany_type.7432808513", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_type`\nwhere idcompany_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.092171Z", "completed_at": "2025-10-20T12:24:09.114340Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.132350Z", "completed_at": "2025-10-20T12:24:09.132362Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07772064208984375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__company_idcompany_type__idcompany_type__ref_stg_oracle_neshu__company_type_.945a4fb37c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_type as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n    where idcompany_type is not null\n),\n\nparent as (\n    select idcompany_type as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_type`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.100153Z", "completed_at": "2025-10-20T12:24:09.120192Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.133564Z", "completed_at": "2025-10-20T12:24:09.133578Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.0804438591003418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__company_type_idcompany_type.d5392ad073", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcompany_type as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_type`\n  where idcompany_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.108521Z", "completed_at": "2025-10-20T12:24:09.132912Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.139282Z", "completed_at": "2025-10-20T12:24:09.139319Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.0763239860534668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__contact_idcontact.257cd1bcbe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontact\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contact`\nwhere idcontact is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.115120Z", "completed_at": "2025-10-20T12:24:09.134442Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.141994Z", "completed_at": "2025-10-20T12:24:09.142010Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06798386573791504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__contact_idcompany__idcompany__ref_stg_oracle_neshu__company_.2dd653d1ee", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contact`\n    where idcompany is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.121776Z", "completed_at": "2025-10-20T12:24:09.137788Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.146067Z", "completed_at": "2025-10-20T12:24:09.146080Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06532883644104004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__contact_idcontact.fc71eec394", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcontact as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contact`\n  where idcontact is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.168784Z", "completed_at": "2025-10-20T12:24:09.184441Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.206405Z", "completed_at": "2025-10-20T12:24:09.206417Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07724595069885254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__label_idlabel.9ab3749a9c", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlabel as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\n  where idlabel is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.175520Z", "completed_at": "2025-10-20T12:24:09.192191Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.213543Z", "completed_at": "2025-10-20T12:24:09.213560Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07681012153625488, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__contract_idcontract.fd3fe25c02", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontract\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contract`\nwhere idcontract is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.160463Z", "completed_at": "2025-10-20T12:24:09.183824Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.205700Z", "completed_at": "2025-10-20T12:24:09.205719Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.08355474472045898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_idlabel.f0d32bb28d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.185040Z", "completed_at": "2025-10-20T12:24:09.214273Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.229698Z", "completed_at": "2025-10-20T12:24:09.229715Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07901239395141602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__contract_idcompany_peer__idcompany__ref_stg_oracle_neshu__company_.8ccff45442", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_peer as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contract`\n    where idcompany_peer is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.192922Z", "completed_at": "2025-10-20T12:24:09.221371Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.231153Z", "completed_at": "2025-10-20T12:24:09.231168Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07953810691833496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__contract_idcontract.7b7904e17e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idcontract as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contract`\n  where idcontract is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.199020Z", "completed_at": "2025-10-20T12:24:09.224913Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.233144Z", "completed_at": "2025-10-20T12:24:09.233156Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.0691843032836914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__device_iddevice.27e0db8158", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect iddevice\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\nwhere iddevice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.207146Z", "completed_at": "2025-10-20T12:24:09.230278Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.237476Z", "completed_at": "2025-10-20T12:24:09.237491Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06588625907897949, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__device_idcompany_customer__idcompany__ref_stg_oracle_neshu__company_.b388815945", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_customer as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\n    where idcompany_customer is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.214992Z", "completed_at": "2025-10-20T12:24:09.232498Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.240837Z", "completed_at": "2025-10-20T12:24:09.240850Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06792378425598145, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__device_idcompany_owner__idcompany__ref_stg_oracle_neshu__company_.e812fc7be1", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_owner as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\n    where idcompany_owner is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.254899Z", "completed_at": "2025-10-20T12:24:09.280195Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.299801Z", "completed_at": "2025-10-20T12:24:09.299829Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.08047366142272949, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__device_idcompany_supplier__idcompany__ref_stg_oracle_neshu__company_.44ccca01df", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_supplier as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\n    where idcompany_supplier is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.262944Z", "completed_at": "2025-10-20T12:24:09.286074Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.300552Z", "completed_at": "2025-10-20T12:24:09.300564Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.08122754096984863, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__device_iddevice.0ca29b8e9a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select iddevice as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\n  where iddevice is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.268962Z", "completed_at": "2025-10-20T12:24:09.287106Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.301361Z", "completed_at": "2025-10-20T12:24:09.301376Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.08148860931396484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_family_idlabel_family.da97b662a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel_family\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family`\nwhere idlabel_family is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.280978Z", "completed_at": "2025-10-20T12:24:09.308636Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.326490Z", "completed_at": "2025-10-20T12:24:09.326504Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08045125007629395, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__label_family_idlabel_family.bcaa4d9c71", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlabel_family as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family`\n  where idlabel_family is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.288371Z", "completed_at": "2025-10-20T12:24:09.318032Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.327941Z", "completed_at": "2025-10-20T12:24:09.327954Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.0817115306854248, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_company_idcompany.b2f23ed472", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcompany\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_company`\nwhere idcompany is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.294512Z", "completed_at": "2025-10-20T12:24:09.323551Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.330692Z", "completed_at": "2025-10-20T12:24:09.330704Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07186102867126465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_company_idlabel.1abe8b79c5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_company`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.302059Z", "completed_at": "2025-10-20T12:24:09.327231Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.334130Z", "completed_at": "2025-10-20T12:24:09.334146Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06718897819519043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_company_idcompany__idcompany__ref_stg_oracle_neshu__company_.66c4f4fc27", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_company`\n    where idcompany is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.309321Z", "completed_at": "2025-10-20T12:24:09.329311Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.337441Z", "completed_at": "2025-10-20T12:24:09.337453Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06834626197814941, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_company_idlabel__idlabel__ref_stg_oracle_neshu__label_.4081c7be89", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_company`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.358045Z", "completed_at": "2025-10-20T12:24:09.373406Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.397329Z", "completed_at": "2025-10-20T12:24:09.397351Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07860684394836426, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_contract_idcontract.dbb35a2666", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idcontract\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_contract`\nwhere idcontract is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.364254Z", "completed_at": "2025-10-20T12:24:09.381153Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.398266Z", "completed_at": "2025-10-20T12:24:09.398280Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07796239852905273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_contract_idlabel.6c3946bf93", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_contract`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.351513Z", "completed_at": "2025-10-20T12:24:09.381759Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.398945Z", "completed_at": "2025-10-20T12:24:09.398955Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0841515064239502, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_oracle_neshu__contract", "compiled": true, "compiled_code": "\n\nWITH contract_labels AS (\n  SELECT \n    c.idcontract as contract_id,\n    c.idcompany_peer as company_id,\n    c.code AS contract_code,\n    c.engagement_raw,\n    c.engagement_clean,\n    c.nombre_collab,\n    l.code AS label_code,\n    lf.code AS label_family_code,\n    c.original_start_date,\n    c.original_end_date,\n    c.current_end_date,\n    c.termination_date,\n    c.created_at,\n    c.updated_at\n  FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contract` c\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_contract` lhc \n    ON lhc.idcontract = c.idcontract AND lhc.idlabel IS NOT NULL\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` l \n    ON l.idlabel = lhc.idlabel\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf \n    ON lf.idlabel_family = l.idlabel_family\n),\n\naggregated_labels AS ( \n  SELECT\n    contract_id,\n    company_id,\n    contract_code,\n    engagement_raw,\n    engagement_clean,\n    nombre_collab,\n    original_start_date,\n    original_end_date,\n    current_end_date,\n    termination_date,\n    created_at,\n    updated_at,\n\n    -- pivot des familles de labels\n    MAX(CASE WHEN label_family_code = 'TRANCHE_COLLAB' THEN label_code END) AS employee_range,\n    MAX(CASE WHEN label_family_code = 'PROADMAN' THEN label_code END) AS proadman,\n    MAX(CASE WHEN label_family_code = 'REGION' THEN label_code END) AS region,\n    MAX(CASE WHEN label_family_code = 'TELETRAVAIL' THEN label_code END) AS teletravail,\n    MAX(CASE WHEN label_family_code = 'ISACTIVE' THEN label_code END) AS is_active\n\n  FROM contract_labels\n  GROUP BY\n    contract_id,\n    company_id,\n    contract_code,\n    engagement_raw,\n    engagement_clean,\n    nombre_collab,\n    original_start_date,\n    original_end_date,\n    current_end_date,\n    termination_date,\n    created_at,\n    updated_at\n),\n\naggreated_contract as (\n  SELECT\n    contract_id,\n    company_id,\n    contract_code,\n    engagement_raw,\n    engagement_clean,\n    nombre_collab,\n    CASE\n      WHEN LOWER(is_active) = 'yes' THEN TRUE\n      ELSE FALSE\n    END AS is_active,\n    original_start_date,\n    original_end_date,\n    current_end_date,\n    termination_date,\n    created_at,\n    updated_at\n  FROM aggregated_labels\n)\n\nSELECT\n  contract_id,\n  company_id,\n  contract_code,\n  engagement_raw,\n  engagement_clean,\n  nombre_collab,\n  is_active,\n  original_start_date,\n  original_end_date,\n  current_end_date,\n  termination_date,\n  created_at,\n  updated_at\nFROM (\n    SELECT *,\n           ROW_NUMBER() OVER (\n               PARTITION BY company_id\n               ORDER BY current_end_date DESC, original_start_date DESC, contract_id\n           ) as rn\n    FROM aggreated_contract\n    WHERE is_active = TRUE\n) subq\nWHERE rn = 1", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__contract`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.374084Z", "completed_at": "2025-10-20T12:24:09.405109Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.422476Z", "completed_at": "2025-10-20T12:24:09.422491Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0802919864654541, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_contract_idcontract__idcontract__ref_stg_oracle_neshu__contract_.e5b8eb3f0a", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcontract as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_contract`\n    where idcontract is not null\n),\n\nparent as (\n    select idcontract as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contract`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.382450Z", "completed_at": "2025-10-20T12:24:09.413937Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.423440Z", "completed_at": "2025-10-20T12:24:09.423455Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.08238911628723145, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_contract_idlabel__idlabel__ref_stg_oracle_neshu__label_.d7a7c60364", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_contract`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.392165Z", "completed_at": "2025-10-20T12:24:09.421707Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.427772Z", "completed_at": "2025-10-20T12:24:09.427787Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07500505447387695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_device_iddevice.c9592a7b37", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect iddevice\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_device`\nwhere iddevice is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.399610Z", "completed_at": "2025-10-20T12:24:09.424081Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.430784Z", "completed_at": "2025-10-20T12:24:09.430801Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06954836845397949, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_device_idlabel.2efbd34860", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_device`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.405862Z", "completed_at": "2025-10-20T12:24:09.425428Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.434288Z", "completed_at": "2025-10-20T12:24:09.434314Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07229781150817871, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_device_iddevice__iddevice__ref_stg_oracle_neshu__device_.3c06d4671c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select iddevice as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_device`\n    where iddevice is not null\n),\n\nparent as (\n    select iddevice as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.448667Z", "completed_at": "2025-10-20T12:24:09.471936Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.487620Z", "completed_at": "2025-10-20T12:24:09.487636Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07609128952026367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_device_idlabel__idlabel__ref_stg_oracle_neshu__label_.9d728f2f84", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_device`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.463085Z", "completed_at": "2025-10-20T12:24:09.479571Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.494912Z", "completed_at": "2025-10-20T12:24:09.494925Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0771017074584961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_product_idproduct.48b2a5d583", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_product`\nwhere idproduct is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.457828Z", "completed_at": "2025-10-20T12:24:09.480232Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.495610Z", "completed_at": "2025-10-20T12:24:09.495623Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.08112931251525879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_product_idlabel.c10c951091", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_product`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.472584Z", "completed_at": "2025-10-20T12:24:09.496223Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.514250Z", "completed_at": "2025-10-20T12:24:09.514263Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07730841636657715, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_product_idlabel__idlabel__ref_stg_oracle_neshu__label_.5b4fd68430", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_product`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.481497Z", "completed_at": "2025-10-20T12:24:09.510738Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.519343Z", "completed_at": "2025-10-20T12:24:09.519357Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07924866676330566, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_resources_idlabel.03938ed9d6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_resources`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.488244Z", "completed_at": "2025-10-20T12:24:09.513514Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.520610Z", "completed_at": "2025-10-20T12:24:09.520626Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.06188225746154785, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_resources_idresources.c45dd6d64e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.496880Z", "completed_at": "2025-10-20T12:24:09.517894Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.524813Z", "completed_at": "2025-10-20T12:24:09.524827Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06498908996582031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_resources_idlabel__idlabel__ref_stg_oracle_neshu__label_.e6142d2b42", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlabel as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_resources`\n    where idlabel is not null\n),\n\nparent as (\n    select idlabel as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.502954Z", "completed_at": "2025-10-20T12:24:09.518749Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.525443Z", "completed_at": "2025-10-20T12:24:09.525454Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.0657954216003418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_task_idlabel.231c8d8c24", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlabel\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task`\nwhere idlabel is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.540674Z", "completed_at": "2025-10-20T12:24:09.564816Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.581547Z", "completed_at": "2025-10-20T12:24:09.581566Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.08217191696166992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__label_has_task_idtask.dd0526ea2b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.553666Z", "completed_at": "2025-10-20T12:24:09.572550Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.594151Z", "completed_at": "2025-10-20T12:24:09.594175Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.08095598220825195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_oracle_neshu__device", "compiled": true, "compiled_code": "\n\nWITH device_labels AS (\n  SELECT \n    d.iddevice as device_id,\n    d.device_iddevice,\n    d.iddevice_type as device_type_id,\n    d.code AS device_code,\n    d.name AS device_name,\n    d.last_installation_date,\n    d.created_at,\n    d.updated_at,\n    d.idlocation as location_id,\n    d.idcompany_customer as company_id,\n    c.code AS company_code,\n    c.name AS company_name,\n    lo.access_info,\n    l.code AS label_code,\n    lf.code AS label_family_code\n  FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device` d\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_device` lhd \n    ON lhd.iddevice = d.iddevice AND lhd.idlabel IS NOT NULL\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` l \n    ON l.idlabel = lhd.idlabel\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf \n    ON lf.idlabel_family = l.idlabel_family\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` c \n    ON c.idcompany = d.idcompany_customer\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location` lo\n    ON lo.idlocation = d.idlocation\n  WHERE d.idcompany_customer IS NOT NULL\n),\naggregated_labels AS (\n  SELECT\n    device_id,\n    device_type_id,\n    device_iddevice,\n    company_id,\n    location_id,\n    device_code,\n    device_name,\n    company_code,\n    company_name,\n    access_info,\n    last_installation_date,\n    created_at,\n    updated_at,\n    MAX(CASE WHEN label_family_code = 'ETAT_MACHINE' THEN label_code END) AS device_state,\n    MAX(CASE WHEN label_family_code = 'STATUT_MATERIEL' THEN label_code END) AS device_material_status,\n    MAX(CASE WHEN label_family_code = 'ISACTIVE' THEN label_code END) AS is_active,\n    MAX(CASE WHEN label_family_code = 'GAMME' THEN label_code END) AS device_gamme,\n    MAX(CASE WHEN label_family_code = 'CATEGORIE' THEN label_code END) AS device_category,\n    MAX(CASE WHEN label_family_code = 'MARQUE' THEN label_code END) AS device_brand,\n    MAX(CASE WHEN label_family_code = 'MODECOMA' THEN label_code END) AS device_economic_model\n  FROM device_labels\n  GROUP BY\n    device_id,\n    device_type_id,\n    device_iddevice,\n    company_id,\n    location_id,\n    device_code,\n    device_name,\n    company_code,\n    company_name,\n    access_info,\n    last_installation_date,\n    created_at,\n    updated_at\n)\n\nSELECT\n  -- \ud83d\udd11 Identifiants\n  device_id,\n  device_iddevice,\n  device_type_id,\n  company_id,\n  location_id,\n\n  -- \ud83d\udcc7 Codes et noms\n  device_code,\n  device_name,\n  company_code,\n  company_name,\n\n  -- \ud83c\udff7\ufe0f Caract\u00e9ristiques machine\n  device_brand,\n  device_gamme,\n  device_category,\n  device_economic_model,\n\n  -- \ud83d\udccd Localisation\n  access_info as device_location,\n\n  -- \ud83c\udff7\ufe0f \u00c9tat et statu\n  CASE\n    WHEN LOWER(is_active) = 'yes' THEN TRUE\n    ELSE FALSE\n  END AS is_active,\n\n  -- \ud83d\udd52 Dates\n  last_installation_date,\n  created_at,\n  updated_at\nFROM aggregated_labels", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.548487Z", "completed_at": "2025-10-20T12:24:09.573125Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.594916Z", "completed_at": "2025-10-20T12:24:09.594934Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.08432149887084961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_oracle_neshu__company", "compiled": true, "compiled_code": "\n\nWITH company_labels AS (\n  SELECT \n    c.idcompany as company_id,\n    c.code AS company_code,\n    c.idcompany_type as company_type_id,\n    c.name AS company_name,\n    c.created_at,\n    c.updated_at,\n    l.code AS label_code,\n    lf.code AS label_family_code,\n    loc.address1,\n    loc.address2,\n    loc.city,\n    loc.postal AS postal_code,\n    loc.country\n  FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` c\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_company` lhc \n    ON lhc.idcompany = c.idcompany AND lhc.idlabel IS NOT NULL\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` l \n    ON l.idlabel = lhc.idlabel\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf \n    ON lf.idlabel_family = l.idlabel_family\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_has_location` chl\n    ON chl.idcompany = c.idcompany AND chl.idlocation_type = 1\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location` loc\n    ON loc.idlocation = chl.idlocation\n  WHERE ((c.idcompany_type IN (1,2,4,6))\n)),\naggregated_labels AS (\n  SELECT\n    company_id,\n    company_type_id,\n    company_code,\n    company_name,\n    created_at,\n    updated_at,\n    address1,\n    address2,\n    city,\n    postal_code,\n    country,\n    MAX(CASE WHEN label_family_code = 'TRANCHE_COLLAB' THEN label_code END) AS employee_range,\n    MAX(CASE WHEN label_family_code = 'PROADMAN' THEN label_code END) AS proadman,\n    MAX(CASE WHEN label_family_code = 'REGION' THEN label_code END) AS region,\n    MAX(CASE WHEN label_family_code = 'TELETRAVAIL' THEN label_code END) AS remote_work,\n    MAX(CASE WHEN label_family_code = 'SECTEUR_ACTVITE' THEN label_code END) AS sector,\n    MAX(CASE WHEN label_family_code = 'SECTEUR_DACTIVITE' THEN label_code END) AS activity_sector,\n    MAX(CASE WHEN label_family_code = 'RCOMM' THEN label_code END) AS commercial_rep,\n    MAX(CASE WHEN label_family_code = 'HORECA' THEN label_code END) AS horeca,\n    MAX(CASE WHEN label_family_code = 'GSM_TERRAIN' THEN label_code END) AS gsm,\n    MAX(CASE WHEN label_family_code = 'KATIERS' THEN label_code END) AS katiers,\n    MAX(CASE WHEN label_family_code = 'ISACTIVE' THEN label_code END) AS is_active,\n    MAX(CASE WHEN label_family_code = 'CODE_SECTEUR' THEN label_code END) AS sector_code,\n    MAX(CASE WHEN label_family_code = 'STATUT_CLIENT' THEN label_code END) AS client_status,\n    MAX(CASE WHEN label_family_code = 'Gestion reliquat' THEN label_code END) AS remainder_management,\n    MAX(CASE WHEN label_family_code = 'MODEENVOIFACTURE' THEN label_code END) AS invoice_delivery_mode,\n    MAX(CASE WHEN label_family_code = 'BADGE' THEN label_code END) AS badge,\n    MAX(CASE WHEN label_family_code = 'RECYCLAGE' THEN label_code END) AS recycling,\n    MAX(CASE WHEN label_family_code = 'TYPECOMPAGNIE' THEN label_code END) AS company_type,\n    MAX(CASE WHEN label_family_code = 'MODELEECOCLIENT' THEN label_code END) AS company_economic_model,\n    MAX(CASE WHEN label_family_code = 'BL_GRP' THEN label_code END) AS bl_group,\n    MAX(CASE WHEN label_family_code = 'KA' THEN label_code END) AS key_account\n  FROM company_labels\n  GROUP BY\n    company_id,\n    company_type_id,\n    company_code,\n    company_name,\n    created_at,\n    updated_at,\n    address1,\n    address2,\n    city,\n    postal_code,\n    country\n)\n\nSELECT\n  -- \ud83d\udd11 Identifiants\n  company_id,\n  company_type_id,\n\n  -- \ud83d\udcc7 Codes et noms\n  company_code,\n  company_name,\n\n  -- \ud83c\udfe2 Caract\u00e9ristiques entreprise\n  region,\n  sector,\n  sector_code,\n  activity_sector,\n  employee_range,\n  company_type,\n  company_economic_model,\n  client_status,\n  \n  CASE\n    WHEN LOWER(is_active) = 'yes' THEN TRUE\n    ELSE FALSE\n  END AS is_active,\n\n  -- \ud83d\udc65 Gestion commerciale\n  key_account,\n  katiers,\n\n  -- \ud83c\udfe8 Sp\u00e9cificit\u00e9s m\u00e9tier  \n  remote_work,\n\n  -- \ud83d\udd27 Services et options\n  proadman,\n  gsm,\n  badge,\n  recycling,\n\n  -- \ud83d\udccd Adresse\n  address1,\n  address2,\n  city,\n  postal_code,\n  country,\n\n  -- \ud83d\udd52 Dates\n  created_at,\n  updated_at\n\nFROM aggregated_labels", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.574360Z", "completed_at": "2025-10-20T12:24:09.604146Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.613930Z", "completed_at": "2025-10-20T12:24:09.613946Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07250618934631348, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__company_has_location_idlocation__idlocation__ref_stg_oracle_neshu__location_.a32b27875e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlocation as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company_has_location`\n    where idlocation is not null\n),\n\nparent as (\n    select idlocation as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.566441Z", "completed_at": "2025-10-20T12:24:09.595547Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.613162Z", "completed_at": "2025-10-20T12:24:09.613180Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08217644691467285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__location_idlocation.fc8389056b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idlocation\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location`\nwhere idlocation is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.588899Z", "completed_at": "2025-10-20T12:24:09.607715Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.615946Z", "completed_at": "2025-10-20T12:24:09.615958Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06254291534423828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__location_idlocation.1903e54c83", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idlocation as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location`\n  where idlocation is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.582222Z", "completed_at": "2025-10-20T12:24:09.610529Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.617283Z", "completed_at": "2025-10-20T12:24:09.617312Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.06921863555908203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__device_idlocation__idlocation__ref_stg_oracle_neshu__location_.4b2426f16b", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlocation as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\n    where idlocation is not null\n),\n\nparent as (\n    select idlocation as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.596212Z", "completed_at": "2025-10-20T12:24:09.614590Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.622991Z", "completed_at": "2025-10-20T12:24:09.623002Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06915450096130371, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_oracle_neshu__product", "compiled": true, "compiled_code": "\n\nWITH product_labels AS (\n  SELECT \n    p.idproduct as product_id,\n    p.idproduct_type as product_type_id,\n    p.code AS product_code,\n    p.name AS product_name,\n    p.purchase_unit_price AS purchase_unit_price,\n    -- Correction de created_at si idproduct = 1\n    CASE \n      WHEN p.idproduct = 1 AND p.created_at IS NULL THEN p.updated_at\n      ELSE p.created_at\n    END AS created_at,\n    p.updated_at,\n    l.code AS label_code,\n    lf.code AS label_family_code\n  FROM `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_product` lhp \n    ON lhp.idproduct = p.idproduct\n    AND lhp.idlabel IS NOT NULL\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` l \n    ON l.idlabel = lhp.idlabel\n  LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf \n    ON lf.idlabel_family = l.idlabel_family\n  WHERE p.idproduct_type IN (1, 5)\n    AND (\n      CASE \n        WHEN p.idproduct = 1 AND p.created_at IS NULL THEN p.updated_at\n        ELSE p.created_at\n      END\n    ) IS NOT NULL\n),\n\npivoted AS (\n  SELECT *\n  FROM product_labels\n  PIVOT (\n    MAX(label_code)\n    FOR label_family_code IN (\n      'MARQUEP' AS product_brand,\n      'PROPRIETAIRE' AS product_owner,\n      'FAMILLE' AS product_family, \n      'BIO' AS product_bio,\n      'GROUPE' AS product_group,\n      'LPTYPE' AS product_type_raw,\n      'ISACTIVE' AS isactive\n    )\n  )\n),\n\nfinal AS (\n  SELECT\n    product_id,\n    product_type_id,\n    product_code,\n    product_name,\n    purchase_unit_price,\n    product_brand,\n    product_owner,\n    product_family,\n    product_bio,\n    product_group,\n    product_type_raw,\n    -- convert isactive from string to boolean\n    CASE\n      WHEN LOWER(isactive) = 'yes' THEN TRUE\n      ELSE FALSE\n    END AS is_active,\n    created_at,\n    updated_at,\n    -- logique de typologie standardis\u00e9e\n    COALESCE(\n      CASE\n        WHEN product_id = 1 THEN 'INDEFINI'\n        WHEN product_family IN ('CAFE CAPSULES', 'CAFE CAPSULES PREMIUM') THEN 'CAFE CAPS'\n        WHEN product_family IN ('THE') THEN 'THE'\n        WHEN product_group = 'ACCESSOIRES' THEN 'ACCESSOIRES'\n        WHEN product_group = 'BOISSONS FRAICHES' THEN 'BOISSONS FRAICHES'\n        WHEN product_group = 'SNACKING' THEN 'SNACKING'\n        WHEN product_brand = 'VAN HOUTEN' AND product_code = 'VANHCHOC23' THEN 'CHOCOLATS VAN HOUTEN'\n        WHEN product_type_raw = 'BGOURMANDE' THEN 'BOISSONS GOURMANDES'\n        ELSE NULL\n      END,\n      NULLIF(TRIM(product_type_raw), ''),\n      'Non renseign\u00e9'\n    ) AS product_type\n  FROM pivoted\n),\n\nstandardized AS (\n  SELECT\n    product_id,\n    product_type_id,\n    product_code,\n    product_name,\n    purchase_unit_price,\n\n    -- FORCING champs \u00e0 'INDEFINI' si product_type est 'INDEFINI'\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_brand END AS product_brand,\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_owner END AS product_owner,\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_family END AS product_family,\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_bio END AS product_bio,\n    CASE WHEN product_type = 'INDEFINI' THEN 'INDEFINI' ELSE product_group END AS product_group,\n\n    product_type_raw,\n    is_active,\n    created_at,\n    updated_at,\n    product_type\n  FROM final\n)\n\nSELECT  \n  product_id,\n  product_type_id,\n  product_code,\n  product_name,\n  purchase_unit_price,\n  product_brand,\n  product_owner,\n  product_family,\n  product_bio,\n  product_group,\n  product_type,\n  is_active,\n  created_at,\n  updated_at\nFROM standardized", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.637565Z", "completed_at": "2025-10-20T12:24:09.660999Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.682724Z", "completed_at": "2025-10-20T12:24:09.682745Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0801842212677002, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__product_idproduct.2c91d8d9c3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product`\nwhere idproduct is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.645067Z", "completed_at": "2025-10-20T12:24:09.676951Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.699829Z", "completed_at": "2025-10-20T12:24:09.699849Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.08208394050598145, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_product_idproduct__idproduct__ref_stg_oracle_neshu__product_.f60b56a60c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idproduct as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_product`\n    where idproduct is not null\n),\n\nparent as (\n    select idproduct as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.653062Z", "completed_at": "2025-10-20T12:24:09.683491Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.701573Z", "completed_at": "2025-10-20T12:24:09.701586Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.08275389671325684, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__product_idproduct.ecd2622966", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idproduct as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product`\n  where idproduct is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.667784Z", "completed_at": "2025-10-20T12:24:09.699117Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.705549Z", "completed_at": "2025-10-20T12:24:09.705565Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07810044288635254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__product_idproduct_type__idproduct_type__ref_stg_oracle_neshu__product_type_.6fbc9b03a0", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idproduct_type as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product`\n    where idproduct_type is not null\n),\n\nparent as (\n    select idproduct_type as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product_type`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.662564Z", "completed_at": "2025-10-20T12:24:09.700526Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.709735Z", "completed_at": "2025-10-20T12:24:09.709750Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.08265256881713867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__product_type_idproduct_type.99ebe48fd1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idproduct_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product_type`\nwhere idproduct_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.677673Z", "completed_at": "2025-10-20T12:24:09.704598Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.713079Z", "completed_at": "2025-10-20T12:24:09.713092Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07886695861816406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__product_type_idproduct_type.9bdaa55835", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idproduct_type as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product_type`\n  where idproduct_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.684196Z", "completed_at": "2025-10-20T12:24:09.706324Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.715790Z", "completed_at": "2025-10-20T12:24:09.715802Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07493996620178223, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__resources_idresources.eb8d9bd2ca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.689419Z", "completed_at": "2025-10-20T12:24:09.709146Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.717061Z", "completed_at": "2025-10-20T12:24:09.717075Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06884145736694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__label_has_resources_idresources__idresources__ref_stg_oracle_neshu__resources_.400dad49ad", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idresources as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_resources`\n    where idresources is not null\n),\n\nparent as (\n    select idresources as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.735362Z", "completed_at": "2025-10-20T12:24:09.764509Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.781929Z", "completed_at": "2025-10-20T12:24:09.781951Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07804250717163086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__resources_idcompany__idcompany__ref_stg_oracle_neshu__company_.a03aed6b41", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`\n    where idcompany is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.745775Z", "completed_at": "2025-10-20T12:24:09.773533Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.794005Z", "completed_at": "2025-10-20T12:24:09.794026Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07621908187866211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__resources_idlocation__idlocation__ref_stg_oracle_neshu__location_.763e5415e9", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlocation as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`\n    where idlocation is not null\n),\n\nparent as (\n    select idlocation as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.753441Z", "completed_at": "2025-10-20T12:24:09.781264Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.795044Z", "completed_at": "2025-10-20T12:24:09.795056Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07502007484436035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__resources_idresources.20bf66b8cb", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idresources as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`\n  where idresources is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.758637Z", "completed_at": "2025-10-20T12:24:09.782542Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.799332Z", "completed_at": "2025-10-20T12:24:09.799344Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07830619812011719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__resources_type_idresources_type.9e5d062342", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources_type`\nwhere idresources_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.765927Z", "completed_at": "2025-10-20T12:24:09.795717Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.805774Z", "completed_at": "2025-10-20T12:24:09.805787Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.08016037940979004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__resources_idresources_type__idresources_type__ref_stg_oracle_neshu__resources_type_.0a90a13b3c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idresources_type as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`\n    where idresources_type is not null\n),\n\nparent as (\n    select idresources_type as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources_type`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.774524Z", "completed_at": "2025-10-20T12:24:09.796461Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.806404Z", "completed_at": "2025-10-20T12:24:09.806415Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07181406021118164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__resources_type_idresources_type.60d0042392", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idresources_type as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources_type`\n  where idresources_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.783168Z", "completed_at": "2025-10-20T12:24:09.800268Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.809737Z", "completed_at": "2025-10-20T12:24:09.809748Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.0744788646697998, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__task_has_product", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_task_has_product`\n),\n\ncleaned_data as (\n    select\n        -- IDs (cl\u00e9s primaires et \u00e9trang\u00e8res)\n        cast(idtask_has_product as int64) as idtask_has_product,\n        cast(idtask as int64) as idtask,\n        cast(idproduct as int64) as idproduct,\n        cast(idproduct_source as int64) as idproduct_source,\n        cast(idproduct_destination as int64) as idproduct_destination,\n        cast(idtax as int64) as idtax,\n        cast(idtask_has_product_associed as int64) as idtask_has_product_associed,\n        cast(iddevice as int64) as iddevice,\n        cast(idcompany_peer as int64) as idcompany_peer,\n        cast(idlocation as int64) as idlocation,\n\n        -- Colonnes texte et types\n        type_product_source,\n        type_product_destination,\n        code,\n        name,\n        cast(priceline_number as int64) as priceline_number,\n\n        -- Colonnes num\u00e9riques\n        cast(real_quantity as float64) as real_quantity,\n        cast(average_purchase_price as float64) as average_purchase_price,\n        cast(tax_rate as float64) as tax_rate,\n        cast(tax_amount as float64) as tax_amount,\n        cast(global_discount_amount as float64) as global_discount_amount,\n        cast(net_price as float64) as net_price,\n        cast(sale_amount_net_tax as float64) as sale_amount_net_tax,\n        cast(sale_amount_net as float64) as sale_amount_net,\n        cast(sale_unit_price as float64) as sale_unit_price,\n        cast(purchase_unit_price as float64) as purchase_unit_price,\n        cast(sale_amount_brut as float64) as sale_amount_brut,\n        cast(unit_coeff_multi as float64) as unit_coeff_multi,\n        cast(sale_unit_price_tax as float64) as sale_unit_price_tax,\n        cast(unit_coeff_div as float64) as unit_coeff_div,\n\n        -- Timestamps harmonis\u00e9s (standard DBT)\n        timestamp(creation_date) as created_at,\n        timestamp(coalesce(modification_date, creation_date)) as updated_at,\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n\n    from source_data\n),\n\n-- \u26a0\ufe0f S\u00e9curit\u00e9 de jointure pour \u00e9viter les orphelins\nfiltered_data as (\n    select c.*\n    from cleaned_data c\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n        on c.idtask = t.idtask\n)\n\nselect * from filtered_data\n\n    where updated_at >= (\n        select max(updated_at) - interval 1 day\n        from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product`\n    )\n", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.789562Z", "completed_at": "2025-10-20T12:24:09.805128Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.811737Z", "completed_at": "2025-10-20T12:24:09.811753Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07015228271484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.stg_oracle_neshu__task_has_resources", "compiled": true, "compiled_code": "\n\nwith source_data as (\n    select *\n    from `evs-datastack-prod`.`prod_raw`.`evs_task_has_resources`\n),\n\ncleaned_data as (\n    select\n        -- IDs convertis en BIGINT\n        cast(idtask as int64) as idtask,\n        cast(idresources as int64) as idresources,\n        cast(task_status as int64) as task_status,\n\n        -- Timestamps harmonis\u00e9s\n        timestamp(_sdc_extracted_at) as extracted_at,\n        timestamp(_sdc_deleted_at) as deleted_at\n        \n    from source_data\n),\n\n-- Synchro avec la table des t\u00e2ches pour \u00e9viter les orphelins\nfiltered_data as (\n    select cr.*\n    from cleaned_data cr\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n      on cr.idtask = t.idtask\n)\n\nselect * from filtered_data", "relation_name": "`evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.829804Z", "completed_at": "2025-10-20T12:24:09.860613Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.875044Z", "completed_at": "2025-10-20T12:24:09.875061Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07994604110717773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__task_idtask.2b9ac7a02d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.837020Z", "completed_at": "2025-10-20T12:24:09.861813Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.882691Z", "completed_at": "2025-10-20T12:24:09.882705Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07870364189147949, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_idcompany_peer__idcompany__ref_stg_oracle_neshu__company_.9ee5ef13e5", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_peer as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n    where idcompany_peer is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.843951Z", "completed_at": "2025-10-20T12:24:09.869289Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.888721Z", "completed_at": "2025-10-20T12:24:09.888741Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07867956161499023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_idcontact__idcontact__ref_stg_oracle_neshu__contact_.ded621d0d6", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcontact as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n    where idcontact is not null\n),\n\nparent as (\n    select idcontact as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__contact`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.854415Z", "completed_at": "2025-10-20T12:24:09.880926Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.891485Z", "completed_at": "2025-10-20T12:24:09.891501Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0775909423828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_iddevice__iddevice__ref_stg_oracle_neshu__device_.03aef0389f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select iddevice as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n    where iddevice is not null\n),\n\nparent as (\n    select iddevice as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.862571Z", "completed_at": "2025-10-20T12:24:09.890605Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.900018Z", "completed_at": "2025-10-20T12:24:09.900032Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07945823669433594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_idlocation__idlocation__ref_stg_oracle_neshu__location_.8b4be19759", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idlocation as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n    where idlocation is not null\n),\n\nparent as (\n    select idlocation as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.869930Z", "completed_at": "2025-10-20T12:24:09.892261Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.901396Z", "completed_at": "2025-10-20T12:24:09.901408Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.0749504566192627, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__task_idtask.d1f0e7ba99", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n  where idtask is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.875778Z", "completed_at": "2025-10-20T12:24:09.897288Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.905408Z", "completed_at": "2025-10-20T12:24:09.905420Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07137107849121094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__appro_tasks", "compiled": true, "compiled_code": "\n\nwith passage_appro_base as (\n\n    select\n        -- Identifiants\n        t.idtask as task_id,\n        t.iddevice as device_id,\n        t.idcompany_peer as company_id,\n        t.idproduct_source as product_source_id,\n        t.type_product_source as product_source_type,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_destination as product_destination_type,\n\n        -- Codes\n        c.code as company_code,\n\n        -- Infos m\u00e9tier\n        l.access_info as task_location_info,\n        t.real_start_date as task_start_date,\n        t.real_end_date as task_end_date,\n\n        -- Status\n        ts.code as task_status_code,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` c on c.idcompany = t.idcompany_peer\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts on t.idtask_status = ts.idtask_status\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location` l on l.idlocation = t.idlocation\n\n    where 1=1\n        and t.idtask_type = 32 -- PASSAGE APPROVISIONNEURS\n        and t.code_status_record = '1'\n        and t.real_start_date is not null\n\n    group by\n        t.idtask, t.iddevice, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source,\n        t.idproduct_destination, t.type_product_destination,\n        ts.code, c.code, l.access_info,\n        t.real_start_date, t.real_end_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_id,\n    device_id,\n    company_id,\n    product_source_id,\n    product_destination_id,\n\n    -- Codes\n    company_code,\n\n    -- Infos m\u00e9tier\n    product_source_type,\n    product_destination_type,\n    task_location_info,\n    task_status_code,\n    task_start_date,\n    task_end_date,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom passage_appro_base\n\n\n  where updated_at >= (\n      select max(updated_at) - interval 1 day\n      from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`\n  )\n", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.883452Z", "completed_at": "2025-10-20T12:24:09.900755Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.908733Z", "completed_at": "2025-10-20T12:24:09.908749Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06503987312316895, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__task_status_idtask_status.fb3f3fc34e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_status\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status`\nwhere idtask_status is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.930629Z", "completed_at": "2025-10-20T12:24:09.950608Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.971124Z", "completed_at": "2025-10-20T12:24:09.971136Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06865072250366211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__task_status_idtask_status.6822490986", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_status as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status`\n  where idtask_status is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.925464Z", "completed_at": "2025-10-20T12:24:09.950000Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.970436Z", "completed_at": "2025-10-20T12:24:09.970455Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07136130332946777, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_idtask_status__idtask_status__ref_stg_oracle_neshu__task_status_.8e6c31af0d", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idtask_status as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n    where idtask_status is not null\n),\n\nparent as (\n    select idtask_status as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.938385Z", "completed_at": "2025-10-20T12:24:09.958426Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.977373Z", "completed_at": "2025-10-20T12:24:09.977386Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0720369815826416, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_yuman__clients", "compiled": true, "compiled_code": "\n\nSELECT \n-- Informations Client \nclient_id,\npartner_name\nclient_code,\nclient_name,\nclient_category,\nclient_address,\nis_active as client_is_active,\ncreated_at,\nupdated_at\n\nFROM `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients` ym", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_yuman__clients`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.944033Z", "completed_at": "2025-10-20T12:24:09.971691Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.984765Z", "completed_at": "2025-10-20T12:24:09.984781Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07315468788146973, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__task_type_idtask_type.30b55370e2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_type\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_type`\nwhere idtask_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.951330Z", "completed_at": "2025-10-20T12:24:09.978004Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.985669Z", "completed_at": "2025-10-20T12:24:09.985680Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07194042205810547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__clients_client_id.2396172faf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect client_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients`\nwhere client_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.959037Z", "completed_at": "2025-10-20T12:24:09.979189Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.988830Z", "completed_at": "2025-10-20T12:24:09.988841Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07403254508972168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_idtask_type__idtask_type__ref_stg_oracle_neshu__task_type_.b77e854b8e", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idtask_type as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n    where idtask_type is not null\n),\n\nparent as (\n    select idtask_type as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_type`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.965608Z", "completed_at": "2025-10-20T12:24:09.984117Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.990842Z", "completed_at": "2025-10-20T12:24:09.990858Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.06397247314453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__task_type_idtask_type.6a67987299", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_type as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_type`\n  where idtask_type is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:09.972421Z", "completed_at": "2025-10-20T12:24:09.988204Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:09.996199Z", "completed_at": "2025-10-20T12:24:09.996214Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06274580955505371, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__clients_client_id.f44f6dd39f", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select client_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients`\n  where client_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.012145Z", "completed_at": "2025-10-20T12:24:10.037337Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.058468Z", "completed_at": "2025-10-20T12:24:10.058489Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07101988792419434, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__materials_material_id.ebfe5a9c25", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect material_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`\nwhere material_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.017337Z", "completed_at": "2025-10-20T12:24:10.043173Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.059122Z", "completed_at": "2025-10-20T12:24:10.059133Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07231688499450684, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__materials_site_id.e77c7f24c2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect site_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`\nwhere site_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.026132Z", "completed_at": "2025-10-20T12:24:10.051543Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.066254Z", "completed_at": "2025-10-20T12:24:10.066268Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07237529754638672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__materials_material_id.0de6595c40", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select material_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`\n  where material_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.038088Z", "completed_at": "2025-10-20T12:24:10.065434Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.073461Z", "completed_at": "2025-10-20T12:24:10.073480Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07129859924316406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__materials_category_id__category_id__ref_stg_yuman__materials_categories_.14b0abe07f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select category_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`\n    where category_id is not null\n),\n\nparent as (\n    select category_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials_categories`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.033389Z", "completed_at": "2025-10-20T12:24:10.059846Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.072740Z", "completed_at": "2025-10-20T12:24:10.072756Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07387518882751465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_yuman__materials", "compiled": true, "compiled_code": "\n\nSELECT \n-- Informations Machine\nym.material_id,\nym.site_id,\nym.material_description,\nym.material_name,\nym.material_brand,\nym.material_serial_number,\nycat.category_name,\nym.material_in_service_date,\nym.created_at,\nym.updated_at\nFROM `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials` ym\nleft join `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials_categories` ycat on ycat.category_id = ym.category_id", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_yuman__materials`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.053604Z", "completed_at": "2025-10-20T12:24:10.067256Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.076938Z", "completed_at": "2025-10-20T12:24:10.076949Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.061821937561035156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__products_product_id.da6f1079d3", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select product_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__products`\n  where product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.046255Z", "completed_at": "2025-10-20T12:24:10.067989Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.077550Z", "completed_at": "2025-10-20T12:24:10.077561Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07655715942382812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__products_product_id.4e68e010db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__products`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.060577Z", "completed_at": "2025-10-20T12:24:10.074260Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.083617Z", "completed_at": "2025-10-20T12:24:10.083628Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06202054023742676, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__purchase_orders_purchase_order_id.668459bb5c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect purchase_order_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__purchase_orders`\nwhere purchase_order_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.101023Z", "completed_at": "2025-10-20T12:24:10.131395Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.144756Z", "completed_at": "2025-10-20T12:24:10.144771Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07053041458129883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__purchase_orders_purchase_order_line_id.d6eed878cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect purchase_order_line_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__purchase_orders`\nwhere purchase_order_line_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.106399Z", "completed_at": "2025-10-20T12:24:10.132145Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.145567Z", "completed_at": "2025-10-20T12:24:10.145580Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07190322875976562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__purchase_orders_product_id__product_id__ref_stg_yuman__products_.ff6ab86020", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__purchase_orders`\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__products`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.115025Z", "completed_at": "2025-10-20T12:24:10.143832Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.155837Z", "completed_at": "2025-10-20T12:24:10.155849Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07181954383850098, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__purchase_orders_purchase_order_line_id.6a52ee22dc", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select purchase_order_line_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__purchase_orders`\n  where purchase_order_line_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.127757Z", "completed_at": "2025-10-20T12:24:10.146159Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.162239Z", "completed_at": "2025-10-20T12:24:10.162255Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0725247859954834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_yuman__sites", "compiled": true, "compiled_code": "\n\nSELECT \n-- Informations Client \nsite_id,\nclient_id,\nagency_id,\nsite_code,\nsite_name,\nsite_address,\nsite_postal_code,\ncreated_at,\nupdated_at\n\nFROM `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites` ym", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.123134Z", "completed_at": "2025-10-20T12:24:10.155003Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.162974Z", "completed_at": "2025-10-20T12:24:10.162987Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07589244842529297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.dim_yuman__materials_clients", "compiled": true, "compiled_code": "\n\nSELECT \n-- Informations Machine\nym.material_id,\nym.material_description,\nym.material_name,\nym.material_brand,\nym.material_serial_number,\nycat.category_name,\nym.material_in_service_date,\n-- Informations Client \nyc.client_id,\nyc.client_code,\nyc.client_address,\nyc.client_name,\nyc.partner_name,\n-- Informations Site\nys.site_id,\nys.site_address,\nys.site_name, \nys.site_postal_code\nFROM `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials` ym\nleft join `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites` ys on ym.site_id=ys.site_id\nleft join `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients` yc on ys.client_id= yc.client_id\nleft join `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials_categories` ycat on ycat.category_id = ym.category_id", "relation_name": "`evs-datastack-prod`.`prod_marts`.`dim_yuman__materials_clients`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.133582Z", "completed_at": "2025-10-20T12:24:10.156615Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.166496Z", "completed_at": "2025-10-20T12:24:10.166508Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07602596282958984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__sites_client_id.a2a87aa602", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect client_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\nwhere client_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.138618Z", "completed_at": "2025-10-20T12:24:10.157238Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.167147Z", "completed_at": "2025-10-20T12:24:10.167159Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07734251022338867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__sites_site_id.7b80b04fc4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect site_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\nwhere site_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.146806Z", "completed_at": "2025-10-20T12:24:10.163839Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.171274Z", "completed_at": "2025-10-20T12:24:10.171290Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06767964363098145, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__materials_site_id__site_id__ref_stg_yuman__sites_.074fc55183", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select site_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`\n    where site_id is not null\n),\n\nparent as (\n    select site_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.191101Z", "completed_at": "2025-10-20T12:24:10.217422Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.238492Z", "completed_at": "2025-10-20T12:24:10.238510Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07183241844177246, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__sites_client_id__client_id__ref_stg_yuman__clients_.ab91ca52c3", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select client_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\n    where client_id is not null\n),\n\nparent as (\n    select client_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.198233Z", "completed_at": "2025-10-20T12:24:10.218762Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.244513Z", "completed_at": "2025-10-20T12:24:10.244529Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07429027557373047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__sites_site_id.c2fdd1abc3", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select site_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\n  where site_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.205495Z", "completed_at": "2025-10-20T12:24:10.237667Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.246404Z", "completed_at": "2025-10-20T12:24:10.246417Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07230091094970703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__users_user_id.9881abfe99", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__users`\nwhere user_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.212434Z", "completed_at": "2025-10-20T12:24:10.245106Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.254228Z", "completed_at": "2025-10-20T12:24:10.254240Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07495689392089844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__users_user_id.e4b2c79cf4", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select user_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__users`\n  where user_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.219413Z", "completed_at": "2025-10-20T12:24:10.247044Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.257028Z", "completed_at": "2025-10-20T12:24:10.257039Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07657384872436523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorder_demands_categories_demand_category_id.5e8aa9b42e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect demand_category_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands_categories`\nwhere demand_category_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.232223Z", "completed_at": "2025-10-20T12:24:10.248282Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.258315Z", "completed_at": "2025-10-20T12:24:10.258326Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07758283615112305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorder_products_product_id.92e35e7cb0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.239217Z", "completed_at": "2025-10-20T12:24:10.251698Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.259670Z", "completed_at": "2025-10-20T12:24:10.259682Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06608772277832031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorder_products_product_quantity.9f9bbee75c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_quantity\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`\nwhere product_quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.224603Z", "completed_at": "2025-10-20T12:24:10.247664Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.257667Z", "completed_at": "2025-10-20T12:24:10.257683Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.08225679397583008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__workorder_demands_categories_demand_category_id.36d7a5e24e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select demand_category_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands_categories`\n  where demand_category_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.281212Z", "completed_at": "2025-10-20T12:24:10.305382Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.332924Z", "completed_at": "2025-10-20T12:24:10.332953Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07973861694335938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorder_products_workorder_id.a954e8ba15", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect workorder_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`\nwhere workorder_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.290975Z", "completed_at": "2025-10-20T12:24:10.317155Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.341453Z", "completed_at": "2025-10-20T12:24:10.341472Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07680702209472656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorder_products_workorder_product_id.f12c8d1634", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect workorder_product_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`\nwhere workorder_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.296963Z", "completed_at": "2025-10-20T12:24:10.323981Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.342395Z", "completed_at": "2025-10-20T12:24:10.342409Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07872843742370605, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorder_products_product_id__product_id__ref_stg_yuman__products_.ed6480bad9", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__products`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.306668Z", "completed_at": "2025-10-20T12:24:10.340777Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.347074Z", "completed_at": "2025-10-20T12:24:10.347086Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07758235931396484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__workorder_products_workorder_product_id.1591ef7ef7", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select workorder_product_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`\n  where workorder_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.312037Z", "completed_at": "2025-10-20T12:24:10.343018Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.351363Z", "completed_at": "2025-10-20T12:24:10.351375Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.08027529716491699, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorder_demands_demand_id.12776f5dd4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect demand_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\nwhere demand_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.317910Z", "completed_at": "2025-10-20T12:24:10.343656Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.353930Z", "completed_at": "2025-10-20T12:24:10.353942Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07529973983764648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorder_demands_client_id__client_id__ref_stg_yuman__clients_.71d22ac8fd", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select client_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\n    where client_id is not null\n),\n\nparent as (\n    select client_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.324655Z", "completed_at": "2025-10-20T12:24:10.347768Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.357532Z", "completed_at": "2025-10-20T12:24:10.357543Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07741618156433105, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorder_demands_demand_category_id__demand_category_id__ref_stg_yuman__workorder_demands_categories_.871194aaa2", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select demand_category_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\n    where demand_category_id is not null\n),\n\nparent as (\n    select demand_category_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands_categories`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.333776Z", "completed_at": "2025-10-20T12:24:10.350538Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.358862Z", "completed_at": "2025-10-20T12:24:10.358873Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.08014535903930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorder_demands_material_id__material_id__ref_stg_yuman__materials_.0624c21af4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select material_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\n    where material_id is not null\n),\n\nparent as (\n    select material_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.377568Z", "completed_at": "2025-10-20T12:24:10.415809Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.431195Z", "completed_at": "2025-10-20T12:24:10.431214Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.09250926971435547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorder_demands_site_id__site_id__ref_stg_yuman__sites_.207aca79ff", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select site_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\n    where site_id is not null\n),\n\nparent as (\n    select site_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.389725Z", "completed_at": "2025-10-20T12:24:10.423754Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.450531Z", "completed_at": "2025-10-20T12:24:10.450553Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.09139513969421387, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorder_demands_user_id__user_id__ref_stg_yuman__users_.605074afbf", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select user_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\n    where user_id is not null\n),\n\nparent as (\n    select user_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__users`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.409550Z", "completed_at": "2025-10-20T12:24:10.430409Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.452201Z", "completed_at": "2025-10-20T12:24:10.452213Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.09061336517333984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_cp_metropole_Code_Postal.a098167f83", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Code_Postal\nfrom `evs-datastack-prod`.`prod_reference`.`cp_metropole`\nwhere Code_Postal is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.398762Z", "completed_at": "2025-10-20T12:24:10.431881Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.456072Z", "completed_at": "2025-10-20T12:24:10.456089Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.09569549560546875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__workorder_demands_demand_id.adbb788cb2", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select demand_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\n  where demand_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.417327Z", "completed_at": "2025-10-20T12:24:10.451289Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.460735Z", "completed_at": "2025-10-20T12:24:10.460750Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.09558868408203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorders_created_at.0aad14f863", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.424674Z", "completed_at": "2025-10-20T12:24:10.456712Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.464790Z", "completed_at": "2025-10-20T12:24:10.464805Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.0890042781829834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_yuman__workorders_workorder_id.7745d31fcf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect workorder_id\nfrom `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\nwhere workorder_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.432541Z", "completed_at": "2025-10-20T12:24:10.460085Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.468593Z", "completed_at": "2025-10-20T12:24:10.468610Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.09168219566345215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorder_products_workorder_id__workorder_id__ref_stg_yuman__workorders_.c56a733e8f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select workorder_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_products`\n    where workorder_id is not null\n),\n\nparent as (\n    select workorder_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.442487Z", "completed_at": "2025-10-20T12:24:10.461332Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.471722Z", "completed_at": "2025-10-20T12:24:10.471734Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.08600115776062012, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorders_client_id__client_id__ref_stg_yuman__clients_.2696f7708f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select client_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\n    where client_id is not null\n),\n\nparent as (\n    select client_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.489515Z", "completed_at": "2025-10-20T12:24:10.511583Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.526576Z", "completed_at": "2025-10-20T12:24:10.526591Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07502222061157227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorders_site_id__site_id__ref_stg_yuman__sites_.966845c1c7", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select site_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\n    where site_id is not null\n),\n\nparent as (\n    select site_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.499070Z", "completed_at": "2025-10-20T12:24:10.525322Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.539072Z", "completed_at": "2025-10-20T12:24:10.539093Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0747072696685791, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_yuman__workorders_workorder_id.38a2d26084", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select workorder_id as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\n  where workorder_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.506501Z", "completed_at": "2025-10-20T12:24:10.532675Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.548329Z", "completed_at": "2025-10-20T12:24:10.548342Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07119369506835938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_cps_tech_cp_depart_int.0f6e103b70", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cp_depart_int\nfrom `evs-datastack-prod`.`prod_reference`.`cps_tech`\nwhere cp_depart_int is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.512263Z", "completed_at": "2025-10-20T12:24:10.538391Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.549182Z", "completed_at": "2025-10-20T12:24:10.549195Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07363080978393555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_cps_tech_cp_depart_texte.26dec0b408", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cp_depart_texte\nfrom `evs-datastack-prod`.`prod_reference`.`cps_tech`\nwhere cp_depart_texte is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.518187Z", "completed_at": "2025-10-20T12:24:10.539712Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.553150Z", "completed_at": "2025-10-20T12:24:10.553161Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.0752565860748291, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_cps_tech_cp_final_int.c6665bc5a0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cp_final_int\nfrom `evs-datastack-prod`.`prod_reference`.`cps_tech`\nwhere cp_final_int is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.527473Z", "completed_at": "2025-10-20T12:24:10.549828Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.557554Z", "completed_at": "2025-10-20T12:24:10.557566Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06818270683288574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_cps_tech_cp_final_texte.6d08af0e28", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cp_final_texte\nfrom `evs-datastack-prod`.`prod_reference`.`cps_tech`\nwhere cp_final_texte is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.533376Z", "completed_at": "2025-10-20T12:24:10.550555Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.560040Z", "completed_at": "2025-10-20T12:24:10.560055Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06436681747436523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_cps_tech_libelle_cp.08a4b5acae", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect libelle_cp\nfrom `evs-datastack-prod`.`prod_reference`.`cps_tech`\nwhere libelle_cp is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.540801Z", "completed_at": "2025-10-20T12:24:10.556954Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.564716Z", "completed_at": "2025-10-20T12:24:10.564729Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.0689387321472168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_cps_tech_nom_departement.37af19b1e1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nom_departement\nfrom `evs-datastack-prod`.`prod_reference`.`cps_tech`\nwhere nom_departement is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.577576Z", "completed_at": "2025-10-20T12:24:10.827245Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.846497Z", "completed_at": "2025-10-20T12:24:10.846514Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.3014357089996338, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_cps_tech_num_departement_texte.11ca48fdf7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect num_departement_texte\nfrom `evs-datastack-prod`.`prod_reference`.`cps_tech`\nwhere num_departement_texte is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.821513Z", "completed_at": "2025-10-20T12:24:10.845777Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.855428Z", "completed_at": "2025-10-20T12:24:10.855444Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2956099510192871, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_cps_tech_cp_depart_int.cbed7e63d9", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select cp_depart_int as unique_field\n  from `evs-datastack-prod`.`prod_reference`.`cps_tech`\n  where cp_depart_int is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.588754Z", "completed_at": "2025-10-20T12:24:10.847811Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.864575Z", "completed_at": "2025-10-20T12:24:10.864591Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.3023035526275635, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_cps_tech_region_tech.9237701bce", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect region_tech\nfrom `evs-datastack-prod`.`prod_reference`.`cps_tech`\nwhere region_tech is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.828739Z", "completed_at": "2025-10-20T12:24:10.854503Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.865290Z", "completed_at": "2025-10-20T12:24:10.865322Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.2987864017486572, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_cps_tech_cp_depart_texte.eef859cc87", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select cp_depart_texte as unique_field\n  from `evs-datastack-prod`.`prod_reference`.`cps_tech`\n  where cp_depart_texte is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.834623Z", "completed_at": "2025-10-20T12:24:10.856132Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.868566Z", "completed_at": "2025-10-20T12:24:10.868578Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.2950930595397949, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_yuman__workorders_category_id__category_id__ref_stg_yuman__workorders_categories_.c014c83acd", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select category_id as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\n    where category_id is not null\n),\n\nparent as (\n    select category_id as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders_categories`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.840894Z", "completed_at": "2025-10-20T12:24:10.856823Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.869161Z", "completed_at": "2025-10-20T12:24:10.869173Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.2961692810058594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dpt_metropole_Departement.2478f9c919", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Departement\nfrom `evs-datastack-prod`.`prod_reference`.`dpt_metropole`\nwhere Departement is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.848532Z", "completed_at": "2025-10-20T12:24:10.866072Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.875157Z", "completed_at": "2025-10-20T12:24:10.875173Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.2981112003326416, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_machines_clean_Machine_Brut.9276e8a97e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Machine_Brut\nfrom `evs-datastack-prod`.`prod_reference`.`machines_clean`\nwhere Machine_Brut is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.857465Z", "completed_at": "2025-10-20T12:24:10.870681Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.881285Z", "completed_at": "2025-10-20T12:24:10.881320Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.061617374420166016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_tarification_ref_clean_KEY.967dd5c502", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect KEY\nfrom `evs-datastack-prod`.`prod_reference`.`tarification_ref_clean`\nwhere KEY is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.892957Z", "completed_at": "2025-10-20T12:24:10.916738Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.934930Z", "completed_at": "2025-10-20T12:24:10.934944Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07176399230957031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_tarification_ref_clean_Montant.a0344161c1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect Montant\nfrom `evs-datastack-prod`.`prod_reference`.`tarification_ref_clean`\nwhere Montant is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.901595Z", "completed_at": "2025-10-20T12:24:10.934185Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.947931Z", "completed_at": "2025-10-20T12:24:10.947947Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07171940803527832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_yuman__demands_workorders_enriched", "compiled": true, "compiled_code": "\n\n-- =====================================================================\n-- Model: int_yuman__demands_workorders_enriched\n-- Description:\n--   Vue unifi\u00e9e des demandes d'intervention et des interventions\n--   enrichie avec les informations clients, sites, mat\u00e9riels et utilisateurs.\n--   Ce mod\u00e8le sert de base interm\u00e9diaire (int) entre les donn\u00e9es staging\n--   et les mod\u00e8les marts m\u00e9tier.\n-- =====================================================================\n\n-- =======================\n-- CTE 1 : Demandes d'intervention\n-- =======================\nwith workorder_demands as (\n    select\n        demand_id,\n        workorder_id,\n        material_id,\n        site_id,\n        client_id,\n        user_id,\n        demand_description,\n        demand_status,\n        demand_reject_comment,\n        created_at as demand_created_at,\n        updated_at as demand_updated_at,\n        demand_category_id\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands`\n),\n\n-- =======================\n-- CTE 2 : Cat\u00e9gories de demandes\n-- =======================\nworkorder_demands_categories as (\n    select\n        demand_category_id,\n        demand_category_name\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands_categories`\n),\n\n-- =======================\n-- CTE 3 : Interventions (workorders)\n-- =======================\nworkorders as (\n    select\n        workorder_id,\n        technician_id,\n        workorder_number,\n        workorder_category,\n        workorder_type,\n        workorder_status,\n        workorder_title,\n        workorder_description,\n        workorder_report,\n        workorder_technician_name,\n        workorder_date_creation,\n        workorder_motif_non_intervention,\n        workorder_detail_non_intervention,\n        workorder_raison_mise_en_pause,\n        workorder_explication_mise_en_pause,\n        workorder_necessite_intervenir,\n        workorder_si_non_pourquoi,\n        date_planned,\n        date_started,\n        date_done\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders`\n),\n\n-- =======================\n-- CTE 4 : Clients\n-- =======================\nclients as (\n    select\n        client_id,\n        partner_name,\n        client_code,\n        client_name,\n        client_category,\n        is_active as client_is_active\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients`\n),\n\n-- =======================\n-- CTE 5 : Sites\n-- =======================\nsites as (\n    select\n        site_id,\n        site_code,\n        site_name,\n        site_address,\n        site_postal_code\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites`\n),\n\n-- =======================\n-- CTE 6 : Mat\u00e9riels\n-- =======================\nmaterials as (\n    select\n        material_id,\n        material_name,\n        material_serial_number,\n        material_brand,\n        material_description,\n        material_in_service_date,\n        category_id\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials`\n),\n\n-- =======================\n-- CTE 7 : Cat\u00e9gories de mat\u00e9riels\n-- =======================\nmaterials_categories as (\n    select\n        category_id,\n        category_name as material_category\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials_categories`\n),\n\n-- =======================\n-- CTE 8 : Utilisateurs\n-- =======================\nusers as (\n    select\n        user_id,\n        manager_id,\n        user_name,\n        user_type,\n        is_manager_as_technician\n    from `evs-datastack-prod`.`prod_staging`.`stg_yuman__users`\n),\n\n-- =======================\n-- CTE 9 : Mapping techniciens - agences\n-- =======================\ntech_agence_mapping as (\n    select\n        nom,\n        prenom,\n        agence,\n        equipe\n    from `evs-datastack-prod`.`prod_reference`.`tech_piece_agence_mapping`\n)\n\n-- =======================\n-- FINAL SELECT : Assemblage des donn\u00e9es\n-- =======================\nselect\n    -- === Demandes d'intervention ===\n    wd.demand_id,\n    wd.workorder_id,\n    wd.material_id,\n    wd.site_id,\n    wd.client_id,\n    wd.user_id,\n    wd.demand_description,\n    wd.demand_status,\n    wd.demand_reject_comment,\n    wd.demand_created_at,\n    wd.demand_updated_at,\n\n    -- === Cat\u00e9gorie demande ===\n    wdc.demand_category_name,\n\n    -- === Interventions ===\n    wo.technician_id,\n    wo.workorder_number,\n    wo.workorder_category,\n    wo.workorder_type,\n    wo.workorder_status,\n    wo.workorder_title,\n    wo.workorder_description,\n    wo.workorder_report,\n    wo.workorder_technician_name,\n    wo.workorder_date_creation,\n    wo.workorder_motif_non_intervention,\n    wo.workorder_detail_non_intervention,\n    wo.workorder_raison_mise_en_pause,\n    wo.workorder_explication_mise_en_pause,\n    wo.workorder_necessite_intervenir,\n    wo.workorder_si_non_pourquoi,\n    wo.date_planned,\n    wo.date_started,\n    wo.date_done,\n\n    -- === Clients ===\n    cl.partner_name,\n    cl.client_code,\n    cl.client_name,\n    cl.client_category,\n    cl.client_is_active,\n\n    -- === Sites ===\n    s.site_code,\n    s.site_name,\n    s.site_address,\n    s.site_postal_code,\n\n    -- === Mat\u00e9riels ===\n    m.material_name,\n    m.material_serial_number,\n    m.material_brand,\n    m.material_description,\n    m.material_in_service_date,\n\n    -- === Cat\u00e9gories de mat\u00e9riels ===\n    mc.material_category,\n\n    -- === Utilisateurs ===\n    u.manager_id,\n    u.user_name,\n    u.user_type,\n    u.is_manager_as_technician,\n\n    -- === Agence du technicien (via mapping) ===\n    tam.agence as technician_agency_stock,\n    tam.equipe as technician_equipe\n\nfrom workorder_demands wd\nleft join workorder_demands_categories wdc\n    on wd.demand_category_id = wdc.demand_category_id\n\nfull join workorders wo\n    on wd.workorder_id = wo.workorder_id\n\nleft join clients cl\n    on wd.client_id = cl.client_id\n\nleft join sites s\n    on wd.site_id = s.site_id\n\nleft join materials m\n    on wd.material_id = m.material_id\n\nleft join materials_categories mc\n    on m.category_id = mc.category_id\n\nleft join users u\n    on wd.user_id = u.user_id\n\nleft join tech_agence_mapping tam\n    on UPPER(TRIM(REGEXP_REPLACE(wo.workorder_technician_name, r'\\[INACTIF\\]\\s*', ''))) = \n       UPPER(TRIM(tam.nom || ' ' || tam.prenom))", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_yuman__demands_workorders_enriched`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.910059Z", "completed_at": "2025-10-20T12:24:10.935603Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.951376Z", "completed_at": "2025-10-20T12:24:10.951387Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07309603691101074, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_tech_piece_agence_mapping_agence.bdf757feb6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect agence\nfrom `evs-datastack-prod`.`prod_reference`.`tech_piece_agence_mapping`\nwhere agence is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.917441Z", "completed_at": "2025-10-20T12:24:10.941608Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.952137Z", "completed_at": "2025-10-20T12:24:10.952152Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07248592376708984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_tech_piece_agence_mapping_equipe.1e972b6e33", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect equipe\nfrom `evs-datastack-prod`.`prod_reference`.`tech_piece_agence_mapping`\nwhere equipe is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.923131Z", "completed_at": "2025-10-20T12:24:10.942387Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.953406Z", "completed_at": "2025-10-20T12:24:10.953422Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07377076148986816, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_tech_piece_agence_mapping_nom.bf00f207d7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect nom\nfrom `evs-datastack-prod`.`prod_reference`.`tech_piece_agence_mapping`\nwhere nom is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.928109Z", "completed_at": "2025-10-20T12:24:10.948563Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.957730Z", "completed_at": "2025-10-20T12:24:10.957741Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07075858116149902, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_tech_piece_agence_mapping_prenom.4042de33dc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect prenom\nfrom `evs-datastack-prod`.`prod_reference`.`tech_piece_agence_mapping`\nwhere prenom is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.936322Z", "completed_at": "2025-10-20T12:24:10.952825Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.963643Z", "completed_at": "2025-10-20T12:24:10.963655Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07196807861328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_techniciens_clean_EQUIPE.722aa9e22a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect EQUIPE\nfrom `evs-datastack-prod`.`prod_reference`.`techniciens_clean`\nwhere EQUIPE is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.942985Z", "completed_at": "2025-10-20T12:24:10.958279Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:10.967143Z", "completed_at": "2025-10-20T12:24:10.967159Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.06106758117675781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_techniciens_clean_TECHNICIEN.5de96efc7e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect TECHNICIEN\nfrom `evs-datastack-prod`.`prod_reference`.`techniciens_clean`\nwhere TECHNICIEN is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.982948Z", "completed_at": "2025-10-20T12:24:11.003354Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.022629Z", "completed_at": "2025-10-20T12:24:11.022655Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06981253623962402, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__valo_parc_machine", "compiled": true, "compiled_code": "\n\nwith machine_infos as (\n\n  select\n    d.iddevice,\n    d.idcompany_customer,\n    p.name as product_name\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device` d\n  left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p\n    on d.idmodel = p.idproduct\n  left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location` l\n    on d.idlocation = l.idlocation\n  where d.iddevice_type = 1\n\n),\n\ncompanies as (\n\n  select\n    idcompany,\n    code as company_code,\n    name as company_name\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n\n),\n\nfiltered_machines as (\n\n  select\n    lower(trim(mi.product_name)) as machine_modele\n  from machine_infos mi\n  left join companies c\n    on mi.idcompany_customer = c.idcompany\n  where c.company_name not in (\n    '06 - ATELIER RUNGIS DEPOT',\n    '07 - ATELIER LYON DEPOT',\n    '08 - ATELIER BORDEAUX DEPOT',\n    '10 - REBUS DEPOT',\n    '11 - REMISE EN ETAT - RUNGIS',\n    '12 - REMISE EN ETAT - LYON'\n  )\n\n),\n\ncounts as (\n\n  select\n    machine_modele,\n    count(*) as count_machine\n  from filtered_machines\n  group by machine_modele\n\n),\n\nref_valo as (\n\n  select\n    lower(trim(machine_modele)) as machine_modele,\n    montant_inv as montant_unitaire\n  from `evs-datastack-prod`.`prod_reference`.`valo_parc_machine`\n\n),\n\n-- Changement principal : utiliser FULL OUTER JOIN\njoined as (\n\n  select\n    coalesce(c.machine_modele, v.machine_modele) as machine_modele,\n    v.montant_unitaire,\n    coalesce(c.count_machine, 0) as count_machine,\n    case\n      when v.montant_unitaire is null then null\n      else v.montant_unitaire * coalesce(c.count_machine, 0)\n    end as montant_inv_total\n  from counts c\n  full outer join ref_valo v  -- Changement ici\n    on c.machine_modele = v.machine_modele\n\n)\n\nselect\n  machine_modele,\n  montant_unitaire,\n  count_machine,\n  montant_inv_total\nfrom joined", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__valo_parc_machine`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.990264Z", "completed_at": "2025-10-20T12:24:11.016919Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.035208Z", "completed_at": "2025-10-20T12:24:11.035224Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07003378868103027, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_unique_combination_of_columns_dim_oracle_neshu__contract_company_id.73a6310d39", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        company_id\n    from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__contract`\n    group by company_id\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:10.998188Z", "completed_at": "2025-10-20T12:24:11.023501Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.036923Z", "completed_at": "2025-10-20T12:24:11.036937Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06849527359008789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__contract_contract_id.28d4af45b3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect contract_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__contract`\nwhere contract_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.004112Z", "completed_at": "2025-10-20T12:24:11.034491Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.040556Z", "completed_at": "2025-10-20T12:24:11.040568Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07139992713928223, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__contract_created_at.5dc61f7cd8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__contract`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.010038Z", "completed_at": "2025-10-20T12:24:11.035838Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.044537Z", "completed_at": "2025-10-20T12:24:11.044549Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07288408279418945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__contract_is_active.9600c93d58", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect is_active\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__contract`\nwhere is_active is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.017605Z", "completed_at": "2025-10-20T12:24:11.037516Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.045234Z", "completed_at": "2025-10-20T12:24:11.045246Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07354331016540527, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__contract_updated_at.f826ba71d3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__contract`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.029247Z", "completed_at": "2025-10-20T12:24:11.041269Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.048608Z", "completed_at": "2025-10-20T12:24:11.048620Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.06302309036254883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__machines_yuman_maintenance_base", "compiled": true, "compiled_code": "-- int_oracle_neshu__machines_yuman_maintenance_base.sql\n\n\n\n-- LISTE MACHINE DLOG filtr\u00e9 & clean\nWITH liste_machine_oracle AS (\n    SELECT\n      d.device_id,\n      CONCAT('NESH_', d.device_code) AS device_code,\n      d.device_name,\n      CONCAT('NESH_', company_code) AS company_code,\n      d.company_name,\n      d.last_installation_date,\n      d.created_at as device_created_at,\n      d.updated_at as device_updated_at\n    FROM `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device` d\n    WHERE is_active\n      AND device_type_id IN (1, 2)\n      AND REGEXP_CONTAINS(company_code, r'^CN[0-9]{4}$')\n      AND device_name in ('MOMENTO 100', 'GEMINI 200', 'MOMENTO 200', 'MINITOWER GEMINI', 'MINITOWER MOMENTO',\n        'SBS MOMENTO 100', 'TOWER GEMINI', 'TOWER MOMENTO', 'MILANO LYO FTS120',\n        'MILANO GRAIN FTS60E', 'MILANO GRAIN FTS60E + MODULO', 'BLUSODA', 'BLUSODA GAZ',\n        'TOWER BLUSODA', 'TOWER BLUSODA GAZ', 'MILANO LYO FTS120 + MODULO',\n        'BLUSODA', 'TOWER ONE GAZ', 'OPTIBEANX12 + MODULO', 'OPTIBEAN X 12', 'OPTIBEAN X 12 TS','OPTIBEANX12TS + MODULO','OPTIBEANX12TS + MODULO','OPTIBEAN 12')\n),\n-- LISTE MACHINE YUMAN ENRICHI CLIENT / SITE filtr\u00e9 & clean\nyuman_materials_clean  AS (\n    SELECT \n        ym.material_id,\n        ym.material_description,\n        ym.material_name,\n        ym.material_brand,\n        ym.material_serial_number,\n        ycat.category_name,\n        ym.material_in_service_date,\n        ym.created_at,\n        ym.updated_at,\n        yc.client_id,\n        yc.client_code,\n        yc.client_name,\n        yc.client_category,\n        yc.partner_name,\n        ys.site_id,\n        ys.site_code,\n        ys.site_postal_code\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials` ym\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_yuman__sites` ys \n        ON ym.site_id = ys.site_id\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_yuman__clients` yc \n        ON ys.client_id = yc.client_id\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_yuman__materials_categories` ycat \n        ON ycat.category_id = ym.category_id\n    WHERE partner_name = 'NESHU'\n      AND site_code NOT IN (\n            \"NESH_DEPOTATELIERBORDEAUX\", \"NESH_DEPOTATELIERLYON\", \"NESH_DEPOTATELIERMARSEILLE\",\n            \"NESH_DEPOTATELIERRUNGIS\", \"NESH_DEPOTATELIERSTRASBOURG\", \"NESH_DEPOTBORDEAUX\",\n            \"NESH_DEPOTLYON\", \"NESH_DEPOTMARSEILLE\", \"NESH_DEPOTPERIMES\", \"NESH_DEPOTREBUS\",\n            \"NESH_DEPOTRUNGIS\", \"NESH_DEPOTSTRASBOURG\", \"NESH_RELYON\", \"NESH_RERUNGIS\", \"NESH_STOCKNUNSHEN\"\n        )\n      AND material_name NOT LIKE '%GENERIQUE NESHU%'\n      AND material_serial_number not in \n      ('NESH_MA00226', 'NESH_MA00227', 'NESH_MA00247', 'NESH_MA00248', 'NESH_MA00249',\n      'NESH_MA00250', 'NESH_MA00251', 'NESH_MA00252', 'NESH_MA00253', 'NESH_MA00254',\n      'NESH_MA00193', 'NESH_MA00194', 'NESH_MA00195', 'NESH_MA00196', 'NESH_MA00197',\n      'NESH_MA00198', 'NESH_MA00199', 'NESH_MA00200', 'NESH_MA00201', 'NESH_MA00202',\n      'NESH_MA00203', 'NESH_MA00204', 'NESH_MA00205', 'NESH_MA00206', 'NESH_MA00207',\n      'NESH_MA00208', 'NESH_MA00209', 'NESH_MA00210', 'NESH_MA00211', 'NESH_MA00212',\n      'NESH_MA00213', 'NESH_MA00214', 'NESH_MA00215', 'NESH_MA00228', 'NESH_MA00229',\n      'NESH_MA00230', 'NESH_MA00231', 'NESH_MA00232', 'NESH_MA00233', 'NESH_MA00234',\n      'NESH_MA00235', 'NESH_MA00236', 'NESH_MA00237', 'NESH_MA00238', 'NESH_MA00239',\n      'NESH_MA00240', 'NESH_MA00241', 'NESH_MA00242', 'NESH_MA00244', 'NESH_MA00245',\n      'NESH_MA00246', 'NESH_MA00256', 'NESH_MA00257', 'NESH_MA00258', 'NESH_MA00259',\n      'NESH_MA00260', 'NESH_MA00261', 'NESH_MA00262', 'NESH_MA00263', 'NESH_MA00264',\n      'NESH_MA00265', 'NESH_MA00266', 'NESH_MA00270', 'NESH_MA00216', 'NESH_MA00217',\n      'NESH_MA00220', 'NESH_MA00221', 'NESH_MA00222', 'NESH_MA00223', 'NESH_MA00181',\n      'NESH_MA00182', 'NESH_MA00184', 'NESH_MA00185', 'NESH_MA00183', 'NESH_MA00186',\n      'NESH_MA00187', 'NESH_AS00401', 'NESH_AS00403', 'NESH_AS00393', 'NESH_AS00557',\n      'NESH_AS00558', 'NESH_AS00242', 'NESH_AS00241', 'NESH_AS00562', 'NESH_AS00559',\n      'NESH_AS00070', 'NESH_AS00568', 'NESH_AS00563', 'NESH_AS00561', 'NESH_AS00560',\n      'NESH_AS00317', 'NESH_AS00314', 'NESH_MA00136', 'NESH_AS00011', 'NESH_AS00012',\n      'NESH_MA00170', 'NESH_AS00004')\n),\n-- JOINTURE ENTRE LA LISTE MACHINE DLOG avec les donn\u00e9es YUMAN\nmerged_materials_dlog_yuman AS (\n    SELECT \n        lo.device_id,\n        lo.device_code,\n        lo.device_name,\n        lo.company_code,\n        lo.company_name,\n        lo.last_installation_date,\n        lo.device_created_at,\n        lo.device_updated_at,\n        ym.material_id,\n        ym.material_serial_number,\n        ym.material_name,\n        ym.client_id,\n        ym.client_code,\n        ym.client_name,\n        ym.client_category,\n        ym.site_id,\n        ym.site_code,\n        ym.site_postal_code,\n        ym.created_at AS material_created_at,\n        ym.updated_at AS material_updated_at\n    FROM liste_machine_oracle lo\n    LEFT JOIN yuman_materials_clean ym\n        ON lo.device_code = ym.material_serial_number and lo.company_code = ym.client_code\n)\nSELECT * from merged_materials_dlog_yuman", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__machines_yuman_maintenance_base`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.024145Z", "completed_at": "2025-10-20T12:24:11.042026Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.051268Z", "completed_at": "2025-10-20T12:24:11.051279Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.0722494125366211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_oracle_neshu__contract_contract_id.2498b48ad2", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select contract_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__contract`\n  where contract_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.070696Z", "completed_at": "2025-10-20T12:24:11.097097Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.117229Z", "completed_at": "2025-10-20T12:24:11.117247Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0723869800567627, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__device_company_id.e17a3c2fb4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`\nwhere company_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.078277Z", "completed_at": "2025-10-20T12:24:11.109466Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.123908Z", "completed_at": "2025-10-20T12:24:11.123927Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0699925422668457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__device_device_id.51db00e9ef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`\nwhere device_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.086306Z", "completed_at": "2025-10-20T12:24:11.115498Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.125220Z", "completed_at": "2025-10-20T12:24:11.125238Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07045555114746094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_oracle_neshu__device_device_id.cbb3e59fc9", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select device_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`\n  where device_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.091053Z", "completed_at": "2025-10-20T12:24:11.117900Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.126921Z", "completed_at": "2025-10-20T12:24:11.126935Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07312917709350586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__company_company_id.2286b3d824", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company`\nwhere company_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.098346Z", "completed_at": "2025-10-20T12:24:11.124537Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.133411Z", "completed_at": "2025-10-20T12:24:11.133424Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07380151748657227, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_dim_oracle_neshu__device_company_id__company_id__ref_dim_oracle_neshu__company_.72b98eee1b", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select company_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`\n    where company_id is not null\n),\n\nparent as (\n    select company_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.110418Z", "completed_at": "2025-10-20T12:24:11.127513Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.136738Z", "completed_at": "2025-10-20T12:24:11.136754Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.06847214698791504, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_oracle_neshu__product_product_id.d69a3b14d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.104477Z", "completed_at": "2025-10-20T12:24:11.125822Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.135980Z", "completed_at": "2025-10-20T12:24:11.135996Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07805156707763672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_oracle_neshu__company_company_id.d6aabe0e95", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select company_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company`\n  where company_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.118541Z", "completed_at": "2025-10-20T12:24:11.130914Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.140080Z", "completed_at": "2025-10-20T12:24:11.140097Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07387065887451172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_oracle_neshu__product_product_id.ba747134a3", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select product_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product`\n  where product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.168468Z", "completed_at": "2025-10-20T12:24:11.204082Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.221075Z", "completed_at": "2025-10-20T12:24:11.221091Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07779550552368164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__ecart_inventaire_tasks", "compiled": true, "compiled_code": "\n\nwith ecart_inventaire_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_source as product_source_id,\n        t.type_product_source as product_source_type,\n\n        -- Codes\n        case \n            when t.type_product_source = 'COMPANY' then cs.code\n            when t.type_product_source = 'RESOURCES' then r.code\n        end as source_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * thp.net_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts on t.idtask_status = ts.idtask_status\n\n    -- jointure company pour la source si COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` cs \n        on t.idproduct_source = cs.idcompany \n       and t.type_product_source = 'COMPANY'\n\n    -- jointure resources pour la source si RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` r \n        on t.idproduct_source = r.idresources\n       and t.type_product_source = 'RESOURCES'\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 163 -- ECART INVENTAIRE\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source,\n        thp.idproduct, thp.net_price,\n        cs.code, r.code, p.code, ts.code,\n        t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_source_id,\n    product_source_type,\n\n    -- Codes\n    source_code,\n    product_code,\n    task_status_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom ecart_inventaire_base\nwhere source_code is not null", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.160054Z", "completed_at": "2025-10-20T12:24:11.203199Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.220245Z", "completed_at": "2025-10-20T12:24:11.220268Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0821082592010498, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__commande_interne", "compiled": true, "compiled_code": "\n\nwith commande_interne_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_source as product_source_id,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_source as product_source_type,\n        t.type_product_destination as product_destination_type,\n\n        -- Codes (source et destination)\n        case \n            when t.type_product_source = 'COMPANY' then cs.code\n            when t.type_product_source = 'RESOURCES' then rs.code\n        end as source_code,\n        case \n            when t.type_product_destination = 'COMPANY' then cd.code\n            when t.type_product_destination = 'RESOURCES' then rd.code\n        end as destination_code,\n\n        p.code as product_code,\n        ts.code as task_status_code,\n        la.code as label_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * thp.net_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp \n        on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p \n        on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts \n        on t.idtask_status = ts.idtask_status\n\n    -- Source = COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` cs \n        on t.idproduct_source = cs.idcompany \n       and t.type_product_source = 'COMPANY'\n\n    -- Source = RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` rs \n        on t.idproduct_source = rs.idresources\n       and t.type_product_source = 'RESOURCES'\n\n    -- Destination = COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` cd \n        on t.idproduct_destination = cd.idcompany \n       and t.type_product_destination = 'COMPANY'\n\n    -- Destination = RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` rd \n        on t.idproduct_destination = rd.idresources\n       and t.type_product_destination = 'RESOURCES'\n\n    -- Jointures pour le filtrage sur labels t\u00e9l\u00e9m\u00e9trie\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task` lht\n        on t.idtask = lht.idtask   \n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` la\n        on lht.idlabel = la.idlabel  \n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf\n        on la.idlabel_family = lf.idlabel_family\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 132  -- LIVRAISON INTERNE\n        and lf.code = 'STATUT_LIVRAISON'\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, \n        t.idtask, \n        t.idcompany_peer,\n        thp.idproduct, \n        thp.net_price,\n        t.idproduct_source, \n        t.type_product_source,\n        t.idproduct_destination, \n        t.type_product_destination,\n        cs.code, rs.code, cd.code, rd.code,\n        p.code, ts.code, la.code,\n        t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n),\n\ndedup as (\n    select\n        *,\n        row_number() over (\n            partition by task_product_id\n            order by \n                case when label_code = 'LIVRE' then 1 else 2 end\n        ) as rn\n    from commande_interne_base\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_source_id,\n    product_source_type,\n    product_destination_id,\n    product_destination_type,\n\n    -- Codes\n    source_code,\n    destination_code,\n    product_code,\n    task_status_code,\n    label_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom dedup\nwhere rn = 1\n  and source_code is not null\n  and destination_code is not null", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.175804Z", "completed_at": "2025-10-20T12:24:11.218399Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.223184Z", "completed_at": "2025-10-20T12:24:11.223196Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.08003449440002441, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__inter_techinique_tasks", "compiled": true, "compiled_code": "\n\nwith inter_base as (\n\n    select\n        -- Identifiants\n        t.idtask as task_id,\n        t.iddevice as device_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n\n        -- Codes\n        c.code as company_code,\n        d.code as device_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n        la.code as label_code,\n        lf.code as label_family_code,\n\n        -- Informations m\u00e9tier\n        t.real_start_date as task_start_date,\n        t.real_end_date as task_end_date,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` c on c.idcompany = t.idcompany_peer\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device` d on d.iddevice = t.iddevice\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task` lht on t.idtask = lht.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` la on lht.idlabel = la.idlabel\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf on la.idlabel_family = lf.idlabel_family\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts on t.idtask_status = ts.idtask_status\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 131 -- INTERVENTION TECHNIQUE\n        and t.real_start_date is not null\n)\n\nselect\n    -- Identifiants\n    task_id,\n    device_id,\n    company_id,\n    product_id,\n\n    -- Codes\n    company_code,\n    device_code,\n    product_code,\n    task_status_code,\n\n    -- Pivot des labels\n    max(case when label_family_code = 'Statut inter' then label_code end) as statut_inter,\n    max(case when label_family_code = 'DC04' then label_code end) as dc04,\n    max(case when label_family_code = 'MISSION_TYPE' then label_code end) as mission_type,\n    max(case when label_family_code = 'Objet intervent' then label_code end) as objet_intervent,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n    task_end_date,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom inter_base\ngroup by\n    task_id, device_id, company_id, product_id,\n    company_code, device_code, product_code, task_status_code,\n    task_start_date, task_end_date, updated_at, created_at, extracted_at\nHAVING MAX(CASE WHEN label_family_code = 'Objet intervent' THEN label_code END) = 'OC04'", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.183580Z", "completed_at": "2025-10-20T12:24:11.219499Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.224508Z", "completed_at": "2025-10-20T12:24:11.224523Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.08071732521057129, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__inventaire_tasks", "compiled": true, "compiled_code": "\n\nwith inventaire_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_source as product_source_id,\n        t.type_product_source as product_source_type,\n\n        -- Codes\n        case \n            when t.type_product_source = 'COMPANY' then cs.code\n            when t.type_product_source = 'RESOURCES' then r.code\n        end as source_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * thp.net_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts on t.idtask_status = ts.idtask_status\n\n    -- jointure company pour la source si COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` cs \n        on t.idproduct_source = cs.idcompany \n       and t.type_product_source = 'COMPANY'\n\n    -- jointure resources pour la source si RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` r \n        on t.idproduct_source = r.idresources\n       and t.type_product_source = 'RESOURCES'\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 162 -- INVENTAIRE\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source,\n        thp.idproduct, thp.net_price,\n        cs.code, r.code, p.code, ts.code,\n        t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_source_id,\n    product_source_type,\n\n    -- Codes\n    source_code,\n    product_code,\n    task_status_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom inventaire_base\nwhere source_code is not null", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.198125Z", "completed_at": "2025-10-20T12:24:11.221706Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.228425Z", "completed_at": "2025-10-20T12:24:11.228437Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.08252716064453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__livraison_tasks", "compiled": true, "compiled_code": "\n\nwith livraison_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_source as product_source_id,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_source as product_source_type,\n        t.type_product_destination as product_destination_type,\n\n        -- Codes\n        c.code as company_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * thp.net_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` c on c.idcompany = t.idcompany_peer\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts on t.idtask_status = ts.idtask_status\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 101 -- BON LIVRAISON\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source,\n        t.idproduct_destination, t.type_product_destination,\n        thp.idproduct, thp.net_price,\n        c.code, p.code,\n        ts.code, t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_source_id,\n    product_destination_id,\n    product_source_type,\n    product_destination_type,\n\n    -- Codes\n    company_code,\n    product_code,\n    task_status_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom livraison_base", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.191882Z", "completed_at": "2025-10-20T12:24:11.222287Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.231164Z", "completed_at": "2025-10-20T12:24:11.231175Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.08719587326049805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__livraison_interne_tasks", "compiled": true, "compiled_code": "\n\nwith mouvement_interne_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_source as product_source_id,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_source as product_source_type,\n        t.type_product_destination as product_destination_type,\n\n        -- Codes (source et destination)\n        case \n            when t.type_product_source = 'COMPANY' then cs.code\n            when t.type_product_source = 'RESOURCES' then rs.code\n        end as source_code,\n\n        case \n            when t.type_product_destination = 'COMPANY' then cd.code\n            when t.type_product_destination = 'RESOURCES' then rd.code\n        end as destination_code,\n\n        p.code as product_code,\n        ts.code as task_status_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * thp.net_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp \n        on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p \n        on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts \n        on t.idtask_status = ts.idtask_status\n\n    -- Source = COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` cs \n        on t.idproduct_source = cs.idcompany \n       and t.type_product_source = 'COMPANY'\n\n    -- Source = RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` rs \n        on t.idproduct_source = rs.idresources\n       and t.type_product_source = 'RESOURCES'\n\n    -- Destination = COMPANY\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` cd \n        on t.idproduct_destination = cd.idcompany \n       and t.type_product_destination = 'COMPANY'\n\n    -- Destination = RESOURCES\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` rd \n        on t.idproduct_destination = rd.idresources\n       and t.type_product_destination = 'RESOURCES'\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 161 -- LIVRAISONS INTERNE\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source,\n        t.idproduct_destination, t.type_product_destination,\n        thp.idproduct, thp.net_price,\n        cs.code, rs.code, cd.code, rd.code,\n        p.code, ts.code,\n        t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_source_id,\n    product_source_type,\n    product_destination_id,\n    product_destination_type,\n\n    -- Codes\n    source_code,\n    destination_code,\n    product_code,\n    task_status_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom mouvement_interne_base\nwhere source_code is not null\n  and destination_code is not null", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.204899Z", "completed_at": "2025-10-20T12:24:11.223909Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.233856Z", "completed_at": "2025-10-20T12:24:11.233868Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.08838963508605957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__reception_tasks", "compiled": true, "compiled_code": "\n\nwith reception_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_destination as product_destination_type,\n\n        -- Codes\n        cd.code as destination_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n\n        -- Informations date\n        t.real_start_date as task_start_date,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div * thp.net_price) as valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp \n        on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p \n        on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts \n        on t.idtask_status = ts.idtask_status\n\n    -- Destination = COMPANY uniquement\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` cd\n        on t.idproduct_destination = cd.idcompany \n       and t.type_product_destination = 'COMPANY'\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 121 -- BON RECEPTION\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.idcompany_peer,\n        t.idproduct_destination, t.type_product_destination,\n        thp.idproduct, thp.net_price,\n        cd.code,\n        p.code, ts.code,\n        t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    company_id,\n    product_id,\n    product_destination_id,\n    product_destination_type,\n\n    -- Codes\n    destination_code,\n    product_code,\n    task_status_code,\n\n    -- Infos m\u00e9tier\n    task_start_date,\n\n    -- M\u00e9triques\n    quantity,\n    valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom reception_base", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.210130Z", "completed_at": "2025-10-20T12:24:11.225118Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.234606Z", "completed_at": "2025-10-20T12:24:11.234618Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07704758644104004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__telemetry_tasks", "compiled": true, "compiled_code": "\n\nwith telemetry_tasks as (\n    select\n        -- PK naturelle de task_has_product\n        thp.idtask_has_product as task_product_id,\n        \n        -- IDs business\n        t.idtask as task_id,\n        t.iddevice as device_id,\n        t.idcompany_peer as company_id,\n        thp.idproduct as product_id,\n        t.idlocation as location_id,\n        \n        -- Codes m\u00e9tier pour les jointures futures\n        d.code as device_code,\n        thp.code as product_code,\n        c.code as company_code,\n        \n        -- Donn\u00e9es m\u00e9tier\n        c.name as company_name,\n        l.access_info as task_location_info,\n        \n        -- Dates business\n        t.real_start_date as task_start_date,\n        \n        -- M\u00e9trique business\n        CAST(1 AS INT64) AS telemetry_quantity,  -- 1 T\u00e2che = 1 unit\u00e9 de t\u00e9l\u00e9m\u00e9trie\n        \n        -- Timestamps techniques pour l'incr\u00e9ment\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n        \n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    \n    -- Jointure obligatoire pour r\u00e9cup\u00e9rer les produits\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp\n        on thp.idtask = t.idtask\n    \n    -- Jointures pour enrichissement\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` c\n        on c.idcompany = t.idcompany_peer\n        \n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device` d\n        on d.iddevice = t.iddevice\n        \n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location` l\n        on l.idlocation = t.idlocation\n    \n    -- Jointures pour le filtrage sur labels t\u00e9l\u00e9m\u00e9trie\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task` lht\n        on t.idtask = lht.idtask\n        \n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` la\n        on lht.idlabel = la.idlabel\n        \n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_family` lf\n        on la.idlabel_family = lf.idlabel_family\n    \n    where 1=1\n        -- Filtres business critiques\n        and t.idtask_status in (1, 4)  -- FAIT et VALIDE uniquement\n        and t.code_status_record = '1'   -- Enregistrement actif (string)\n        and t.idtask_type = 3           -- Type t\u00e9l\u00e9m\u00e9trie\n        and lf.code = 'TELEM_SOURCE'    -- Label famille t\u00e9l\u00e9m\u00e9trie source\n        \n        -- Filtre qualit\u00e9 donn\u00e9es\n        and t.real_start_date is not null  -- \u00c9viter les t\u00e2ches sans date de d\u00e9but\n)\n\nselect * from telemetry_tasks\n\n\n    where updated_at >= (\n        select max(updated_at) - interval 1 day\n        from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\n    )\n", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.267371Z", "completed_at": "2025-10-20T12:24:11.306579Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.322603Z", "completed_at": "2025-10-20T12:24:11.322624Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07619690895080566, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__task_has_product_idtask_has_product.d3f98a1a05", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask_has_product\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product`\nwhere idtask_has_product is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.273824Z", "completed_at": "2025-10-20T12:24:11.310992Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.324703Z", "completed_at": "2025-10-20T12:24:11.324715Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07667326927185059, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_has_product_idcompany_peer__idcompany__ref_stg_oracle_neshu__company_.9958fec509", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idcompany_peer as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product`\n    where idcompany_peer is not null\n),\n\nparent as (\n    select idcompany as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.280561Z", "completed_at": "2025-10-20T12:24:11.316505Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.326139Z", "completed_at": "2025-10-20T12:24:11.326151Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07853841781616211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_has_product_idproduct__idproduct__ref_stg_oracle_neshu__product_.0304257578", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idproduct as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product`\n    where idproduct is not null\n),\n\nparent as (\n    select idproduct as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.287484Z", "completed_at": "2025-10-20T12:24:11.323276Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.330596Z", "completed_at": "2025-10-20T12:24:11.330612Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07969355583190918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_has_product_idtask__idtask__ref_stg_oracle_neshu__task_.e57798c3a4", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idtask as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product`\n    where idtask is not null\n),\n\nparent as (\n    select idtask as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.301501Z", "completed_at": "2025-10-20T12:24:11.325409Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.333985Z", "completed_at": "2025-10-20T12:24:11.333996Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.0787506103515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_oracle_neshu__chargement_tasks", "compiled": true, "compiled_code": "\n\nwith chargement_base as (\n\n    select\n        -- Identifiants\n        thp.idtask_has_product as task_product_id,\n        t.idtask as task_id,\n        t.iddevice as device_id,\n        t.idcompany_peer as company_id,\n        t.idlocation as location_id,\n        t.idproduct_source as product_source_id,\n        t.type_product_source as product_source_type,\n        t.idproduct_destination as product_destination_id,\n        t.type_product_destination as product_destination_type,\n        thp.idproduct as product_id,\n\n        -- Codes\n        c.code as company_code,\n        d.code as device_code,\n        p.code as product_code,\n        ts.code as task_status_code,\n        la.code as load_type_code,\n\n        -- Informations m\u00e9tier\n        l.access_info as task_location_info,\n        t.real_start_date as task_start_date,\n\n        -- M\u00e9triques\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) as load_quantity,\n        sum(thp.real_quantity * thp.unit_coeff_multi / thp.unit_coeff_div) * thp.net_price as load_valuation,\n\n        -- Timestamps techniques\n        t.updated_at,\n        t.created_at,\n        t.extracted_at\n\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task` t\n    inner join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product` thp on thp.idtask = t.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__company` c on c.idcompany = t.idcompany_peer\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__device` d on d.iddevice = t.iddevice\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__product` p on p.idproduct = thp.idproduct\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__location` l on l.idlocation = t.idlocation\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label_has_task` lht on t.idtask = lht.idtask\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__label` la on lht.idlabel = la.idlabel\n    left join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_status` ts on t.idtask_status = ts.idtask_status\n\n    where 1=1\n        and t.idtask_status in (1, 4, 3)  -- FAIT, VALIDE, ANNULE\n        and t.code_status_record = '1'\n        and t.idtask_type = 13 -- CHARGEMENT MACHINE\n        and t.real_start_date is not null\n\n    group by\n        thp.idtask_has_product, t.idtask, t.iddevice, t.idcompany_peer,\n        t.idproduct_source, t.type_product_source, t.idlocation,\n        t.idproduct_destination, t.type_product_destination,\n        thp.idproduct, thp.net_price,\n        c.code, d.code, p.code,\n        ts.code, la.code,\n        l.access_info, t.real_start_date,\n        t.updated_at, t.created_at, t.extracted_at\n),\n\nressources_roadman as (\n    select \n        thr.idtask, \n        min(r.idresources) as roadman_id,\n        min(r.code) as roadman_code\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources` thr\n    join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` r on r.idresources = thr.idresources\n    where r.idresources_type = 2\n    group by thr.idtask\n),\n\nressources_vehicle as (\n    select \n        thr.idtask, \n        min(r.idresources) as vehicle_id,\n        min(r.code) as vehicle_code\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources` thr\n    join `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources` r on r.idresources = thr.idresources\n    where r.idresources_type = 3\n    group by thr.idtask\n),\n\nchargement_enrichi as (\n    select \n        cb.*,\n        rr.roadman_id,\n        rr.roadman_code,\n        rv.vehicle_id,\n        rv.vehicle_code\n    from chargement_base cb\n    left join ressources_roadman rr on cb.task_id = rr.idtask\n    left join ressources_vehicle rv on cb.task_id = rv.idtask\n)\n\nselect\n    -- Identifiants\n    task_product_id,\n    task_id,\n    device_id,\n    company_id,\n    product_id,\n    location_id,\n    product_source_id,\n    product_destination_id,\n    roadman_id,\n    vehicle_id,\n\n    -- Codes\n    company_code,\n    device_code,\n    product_code,\n    roadman_code,\n    vehicle_code,\n    task_status_code,\n    load_type_code,\n\n    -- Infos m\u00e9tier\n    product_source_type,\n    product_destination_type,\n    task_location_info,\n    task_start_date,\n\n    -- M\u00e9triques\n    load_quantity,\n    load_valuation,\n\n    -- Timestamps techniques\n    updated_at,\n    created_at,\n    extracted_at\n\nfrom chargement_enrichi\n\n\n  where updated_at >= (\n      select max(updated_at) - interval 1 day\n      from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\n  )\n", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.294838Z", "completed_at": "2025-10-20T12:24:11.324046Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.331214Z", "completed_at": "2025-10-20T12:24:11.331226Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.08204770088195801, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_stg_oracle_neshu__task_has_product_idtask_has_product.3f7428b52a", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select idtask_has_product as unique_field\n  from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_product`\n  where idtask_has_product is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.311632Z", "completed_at": "2025-10-20T12:24:11.326940Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.334749Z", "completed_at": "2025-10-20T12:24:11.334763Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.0814518928527832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__task_has_resources_idresources.5afdfd82d8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idresources\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources`\nwhere idresources is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.317127Z", "completed_at": "2025-10-20T12:24:11.329954Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.338028Z", "completed_at": "2025-10-20T12:24:11.338039Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.08370280265808105, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_stg_oracle_neshu__task_has_resources_idtask.c853c7eb7b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect idtask\nfrom `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources`\nwhere idtask is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.360011Z", "completed_at": "2025-10-20T12:24:11.383605Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.412313Z", "completed_at": "2025-10-20T12:24:11.412335Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07236695289611816, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_has_resources_idresources__idresources__ref_stg_oracle_neshu__resources_.27237e11eb", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idresources as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources`\n    where idresources is not null\n),\n\nparent as (\n    select idresources as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__resources`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.369987Z", "completed_at": "2025-10-20T12:24:11.400847Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.414153Z", "completed_at": "2025-10-20T12:24:11.414171Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07081413269042969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_stg_oracle_neshu__task_has_resources_idtask__idtask__ref_stg_oracle_neshu__task_.50dbc0d63f", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select idtask as from_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task_has_resources`\n    where idtask is not null\n),\n\nparent as (\n    select idtask as to_field\n    from `evs-datastack-prod`.`prod_staging`.`stg_oracle_neshu__task`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.378194Z", "completed_at": "2025-10-20T12:24:11.411532Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.417331Z", "completed_at": "2025-10-20T12:24:11.417343Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07106614112854004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_oracle_neshu__pa_business_review", "compiled": true, "compiled_code": "\n\nSELECT\n    -- Identifiants\n    pa.task_id,\n    pa.company_id,\n    pa.device_id,\n    pa.company_code,\n\n    -- Company\n    c.company_name,\n    CONCAT(c.company_name, ' - ', pa.company_code) AS company_info,\n\n    -- Device\n    d.device_brand,\n    d.device_code,\n    CONCAT(d.device_brand, ' - ', d.device_code) AS device_info,\n\n    -- Contexte temporel\n    pa.task_start_date,\n    DATE(pa.task_start_date) AS task_start_date_day,\n    pa.task_end_date,\n\n    -- Statut\n    pa.task_status_code,\n    CASE WHEN pa.task_status_code = 'FAIT' THEN 1 ELSE 0 END AS mission_faite,\n    CASE WHEN pa.task_status_code IN ('PREVU', 'FAIT', 'ENCOURS') THEN 1 ELSE 0 END AS mission_prevue,\n\n    -- M\u00e9tadonn\u00e9es dbt\n    CURRENT_TIMESTAMP() as dbt_updated_at,\n    'd3de9015-62df-4f1d-842a-4581ffa711ee' as dbt_invocation_id\n\nFROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks` pa\nJOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device` d \n    ON pa.device_id = d.device_id\nJOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company` c \n    ON pa.company_id = c.company_id\nWHERE DATE(pa.task_start_date) >= '2025-01-01'\n    AND pa.task_status_code != 'ANNULE'", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.384286Z", "completed_at": "2025-10-20T12:24:11.413247Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.420894Z", "completed_at": "2025-10-20T12:24:11.420909Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07309484481811523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__appro_tasks_created_at.2224651e8c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.389170Z", "completed_at": "2025-10-20T12:24:11.414823Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.423501Z", "completed_at": "2025-10-20T12:24:11.423513Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07468867301940918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__appro_tasks_extracted_at.11b43558e3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.401495Z", "completed_at": "2025-10-20T12:24:11.416698Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.424715Z", "completed_at": "2025-10-20T12:24:11.424726Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07557296752929688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__appro_tasks_task_start_date.8e28b8d3b2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.394476Z", "completed_at": "2025-10-20T12:24:11.416060Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.424088Z", "completed_at": "2025-10-20T12:24:11.424103Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07878327369689941, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__appro_tasks_task_id.afbab212ea", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.406469Z", "completed_at": "2025-10-20T12:24:11.417954Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.427458Z", "completed_at": "2025-10-20T12:24:11.427469Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07126116752624512, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__appro_tasks_updated_at.297f723da2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.450898Z", "completed_at": "2025-10-20T12:24:11.486571Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.501912Z", "completed_at": "2025-10-20T12:24:11.501929Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0686337947845459, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__appro_tasks_task_id.27c5ab3d17", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__appro_tasks`\n  where task_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.463492Z", "completed_at": "2025-10-20T12:24:11.499560Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.504278Z", "completed_at": "2025-10-20T12:24:11.504316Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06850123405456543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_yuman__clients_client_id.12116495a3", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select client_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_yuman__clients`\n  where client_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.456943Z", "completed_at": "2025-10-20T12:24:11.500374Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.506054Z", "completed_at": "2025-10-20T12:24:11.506066Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07308030128479004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__clients_client_id.bb975d2fa4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect client_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__clients`\nwhere client_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.471070Z", "completed_at": "2025-10-20T12:24:11.501278Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.506668Z", "completed_at": "2025-10-20T12:24:11.506683Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07054352760314941, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__materials_material_id.8e2898dbe5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect material_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials`\nwhere material_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.476147Z", "completed_at": "2025-10-20T12:24:11.502519Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.507398Z", "completed_at": "2025-10-20T12:24:11.507414Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07203030586242676, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__materials_site_id.614d463e6e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect site_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials`\nwhere site_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.493139Z", "completed_at": "2025-10-20T12:24:11.504872Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.510875Z", "completed_at": "2025-10-20T12:24:11.510890Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07184028625488281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__sites_site_id.d284592881", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect site_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`\nwhere site_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.481511Z", "completed_at": "2025-10-20T12:24:11.503645Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.510160Z", "completed_at": "2025-10-20T12:24:11.510175Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07545995712280273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_yuman__materials_material_id.a2c990b4a9", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select material_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials`\n  where material_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.487961Z", "completed_at": "2025-10-20T12:24:11.505466Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.513365Z", "completed_at": "2025-10-20T12:24:11.513376Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07692193984985352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__sites_client_id.cd8fb92b93", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect client_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`\nwhere client_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.539192Z", "completed_at": "2025-10-20T12:24:11.581154Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.592798Z", "completed_at": "2025-10-20T12:24:11.592818Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0711972713470459, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_dim_yuman__materials_site_id__site_id__ref_dim_yuman__sites_.73849dcc87", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select site_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials`\n    where site_id is not null\n),\n\nparent as (\n    select site_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.559665Z", "completed_at": "2025-10-20T12:24:11.590502Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.595461Z", "completed_at": "2025-10-20T12:24:11.595477Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06990504264831543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__materials_clients_client_id.307466ae21", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect client_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials_clients`\nwhere client_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.547768Z", "completed_at": "2025-10-20T12:24:11.589120Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.594733Z", "completed_at": "2025-10-20T12:24:11.594745Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07405757904052734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_dim_yuman__sites_client_id__client_id__ref_dim_yuman__clients_.3c8b8aee42", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select client_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`\n    where client_id is not null\n),\n\nparent as (\n    select client_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_yuman__clients`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.554733Z", "completed_at": "2025-10-20T12:24:11.591492Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.596676Z", "completed_at": "2025-10-20T12:24:11.596688Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07471585273742676, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_yuman__sites_site_id.97c9826437", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select site_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_yuman__sites`\n  where site_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.576408Z", "completed_at": "2025-10-20T12:24:11.593434Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.597992Z", "completed_at": "2025-10-20T12:24:11.598003Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.0736701488494873, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_dim_yuman__materials_clients_material_id.3293b73ed8", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select material_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials_clients`\n  where material_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.564909Z", "completed_at": "2025-10-20T12:24:11.592095Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.597267Z", "completed_at": "2025-10-20T12:24:11.597278Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07744669914245605, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__materials_clients_material_id.65161533d1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect material_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials_clients`\nwhere material_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.582080Z", "completed_at": "2025-10-20T12:24:11.596046Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.601688Z", "completed_at": "2025-10-20T12:24:11.601700Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07805180549621582, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.int_yuman__workorder_pricing", "compiled": true, "compiled_code": "\n\n-- ============================================================================\n-- MODEL: int_yuman__workorder_pricing\n-- PURPOSE: Determine automatic pricing for technical interventions from Yuman\n-- AUTHOR: Cebrail AKSOY\n-- UPDATED: 2025-10-20 12:24:03.774653+00:00\n-- ============================================================================\n\nWITH \n-- ============================================================================\n-- 1. BASE DATA EXTRACTION\n-- ============================================================================\nbase_workorders AS (\n  SELECT\n    demand_id,\n    workorder_id,\n    material_id,\n    site_id,\n    client_id,\n    technician_id,\n    manager_id,\n    demand_description,\n    demand_status,\n    demand_created_at,\n    demand_updated_at,\n    demand_category_name,\n    workorder_number,\n    workorder_category,\n    workorder_status,\n    workorder_technician_name,\n    workorder_date_creation,\n    workorder_motif_non_intervention,\n    workorder_detail_non_intervention,\n    date_planned,\n    date_started,\n    date_done,\n    partner_name,\n    client_code,\n    client_name,\n    client_category,\n    client_is_active,\n    site_code,\n    site_name,\n    site_address,\n    site_postal_code,\n    material_serial_number,\n    technician_equipe,\n\n    -- Normalize workorder type\n    LOWER(COALESCE(\n      workorder_category,\n      CASE\n        WHEN workorder_type = 'Reactive' THEN 'curatif'\n        WHEN workorder_type = 'Preventive' THEN 'pr\u00e9ventif'\n        WHEN workorder_type = 'Installation' THEN 'installation'\n        ELSE workorder_type\n      END\n    )) AS workorder_type_raw,\n\n    -- Normalize machine category\n    LOWER(TRIM(CASE\n      WHEN material_category IS NOT NULL THEN material_category\n      WHEN LOWER(client_name) LIKE '%generique%' THEN CONCAT(partner_name, '_GENERIQUE')\n      WHEN partner_name = 'AUUM' THEN 'MGZ'\n      WHEN partner_name = 'TWYD' THEN 'FONTAINE TWYD'\n      WHEN partner_name = 'EXPRESSO' THEN 'MILANO'\n      WHEN partner_name = 'NESHU' THEN 'MILANO'\n      WHEN partner_name = 'BRITA' THEN 'viv t 85 c2-tg-i-cu ce'\n      WHEN partner_name = 'DAAN' THEN 'lave-vaisselle'\n      WHEN partner_name = 'NU' THEN 'frigo nu'\n      ELSE NULL  \n    END)) AS machine_raw,\n\n    -- Postal code correction\n    CASE\n      WHEN site_postal_code IS NULL OR site_postal_code = '00000' THEN (\n        SELECT code_postal\n        FROM UNNEST(REGEXP_EXTRACT_ALL(demand_description, r'\\b\\d{5}\\b')) AS code_postal\n        WHERE NOT REGEXP_CONTAINS(\n          LEFT(demand_description, STRPOS(demand_description, code_postal)-1),\n          r'(?i)N\u00b0\\s*$|interventions?\\s*$'\n        )\n        LIMIT 1\n      )\n      ELSE REGEXP_EXTRACT(site_address, r'\\b(\\d{5})\\b')\n    END AS postal_code_site,\n\n    -- Billing indicator\n    CASE\n      WHEN workorder_status = 'Closed'\n        AND workorder_motif_non_intervention IS NULL\n        AND workorder_detail_non_intervention IS NULL\n      THEN TRUE\n      ELSE FALSE\n    END AS a_facturer\n\n  FROM `evs-datastack-prod`.`prod_intermediate`.`int_yuman__demands_workorders_enriched`\n),\n\n-- ============================================================================\n-- 2. REFERENCE TABLES\n-- ============================================================================\nref_type_inter AS (\n  SELECT \n    LOWER(Type_intervention_Brut) AS workorder_type_raw,\n    LOWER(TYPE_INTER) AS workorder_type_clean\n  FROM `evs-datastack-prod`.`prod_reference`.`type_inter_clean`\n),\n\nref_machine AS (\n  SELECT machine_raw, machine_clean\n  FROM (\n    SELECT \n      LOWER(TRIM(Machine_Brut)) AS machine_raw,\n      LOWER(TRIM(MACHINE)) AS machine_clean,\n      ROW_NUMBER() OVER(PARTITION BY LOWER(TRIM(Machine_Brut)) ORDER BY MACHINE) AS rn\n    FROM `evs-datastack-prod`.`prod_reference`.`machines_clean`\n  )\n  WHERE rn = 1\n),\n\nref_cp_metropole AS (\n  SELECT Code_Postal, Metropole\n  FROM `evs-datastack-prod`.`prod_reference`.`cp_metropole`\n),\n\nref_dpt_metropole AS (\n  SELECT Departement, Metropole\n  FROM `evs-datastack-prod`.`prod_reference`.`dpt_metropole`\n),\n\nref_tarification AS (\n  SELECT\n    LOWER(CONCAT(\n      TYPE_INTER, '_',\n      MACHINE, '_',\n      MARQUE, '_',\n      Type_tarif, '_',\n      CAST(METROPOLE AS STRING)\n    )) AS key_tarif,\n    Montant,\n    PROD\n  FROM `evs-datastack-prod`.`prod_reference`.`tarification_ref_clean`\n),\n\n-- ============================================================================\n-- 3. ENRICHMENT & NORMALIZATION\n-- ============================================================================\nworkorders_enriched AS (\n  SELECT\n    w.*,\n    COALESCE(ti.workorder_type_clean, w.workorder_type_raw) AS workorder_type_clean,\n    COALESCE(m.machine_clean, w.machine_raw) AS machine_clean,\n    COALESCE(cp.Metropole, dp.Metropole) AS metropole_city,\n    CASE\n      WHEN w.postal_code_site IS NULL THEN 1\n      WHEN cp.Code_Postal IS NOT NULL THEN 1\n      WHEN dp.Departement IS NOT NULL THEN 1\n      ELSE 0\n    END AS metropole,\n    ROW_NUMBER() OVER(PARTITION BY w.workorder_id ORDER BY w.date_done) AS rn\n  FROM base_workorders w\n  LEFT JOIN ref_type_inter ti ON w.workorder_type_raw = ti.workorder_type_raw\n  LEFT JOIN ref_machine m ON w.machine_raw = m.machine_raw\n  LEFT JOIN ref_cp_metropole cp ON w.postal_code_site = cp.Code_Postal\n  LEFT JOIN ref_dpt_metropole dp ON LEFT(w.postal_code_site, 2) = dp.Departement\n),\n\n-- ============================================================================\n-- 4. DEDUPLICATION & RECURRENCE CALCULATION\n-- ============================================================================\nworkorders_dedup AS (\n  SELECT\n    *,\n    CASE\n      WHEN postal_code_site IS NULL THEN 1\n      ELSE COUNT(*) OVER (PARTITION BY client_id, DATE(date_done))\n    END AS reccurence\n  FROM workorders_enriched\n),\n\n-- ============================================================================\n-- 5. PRICING TYPE DETERMINATION\n-- ============================================================================\nworkorders_with_tarif AS (\n  SELECT\n    *,\n    CASE\n      WHEN postal_code_site IS NULL THEN 'Tarif normal'\n      WHEN partner_name IN ('AUUM', 'FONTAINCO', 'TWYD', 'NESHU', 'NU', 'DAANTECH', 'EXPRESSO', 'DAAN') THEN\n        CASE\n          WHEN reccurence < 5 THEN 'Tarif normal'\n          WHEN reccurence BETWEEN 5 AND 20 THEN 'Remise niv1'\n          ELSE 'Remise niv2'\n        END\n      WHEN partner_name IN ('BRITA', 'FONTAINCO') THEN\n        CASE\n          WHEN reccurence < 2 THEN 'Tarif normal'\n          WHEN reccurence BETWEEN 2 AND 5 THEN 'Remise niv1'\n          ELSE 'Remise niv2'\n        END\n      ELSE 'Tarif normal'\n    END AS type_tarif\n  FROM workorders_dedup\n),\n\n-- ============================================================================\n-- 6. FINAL JOIN WITH TARIFF TABLE\n-- ============================================================================\nfinal_result AS (\n  SELECT\n    w.*,\n    t.Montant,\n    t.PROD,\n    LOWER(CONCAT(\n      w.workorder_type_clean, '_',\n      w.machine_clean, '_',\n      w.partner_name, '_',\n      w.type_tarif, '_',\n      CAST(w.metropole AS STRING)\n    )) AS key_tarif_used\n  FROM workorders_with_tarif w\n  LEFT JOIN ref_tarification t\n    ON LOWER(CONCAT(\n      w.workorder_type_clean, '_',\n      w.machine_clean, '_',\n      w.partner_name, '_',\n      w.type_tarif, '_',\n      CAST(w.metropole AS STRING)\n    )) = t.key_tarif\n)\n\n-- ============================================================================\n-- 7. FINAL SELECT (CLEAN OUTPUT)\n-- ============================================================================\nSELECT\n  demand_id,\n  workorder_id,\n  material_id,\n  site_id,\n  client_id,\n  technician_id,\n  manager_id,\n  demand_description,\n  demand_status,\n  demand_created_at,\n  demand_updated_at,\n  demand_category_name,\n  workorder_number,\n  workorder_category,\n  workorder_status,\n  workorder_technician_name,\n  workorder_date_creation,\n  workorder_motif_non_intervention,\n  workorder_detail_non_intervention,\n  date_planned,\n  date_started,\n  date_done,\n  partner_name,\n  client_code,\n  client_name,\n  client_category,\n  client_is_active,\n  site_code,\n  site_name,\n  site_address,\n  postal_code_site as site_postal_code,\n  material_serial_number,\n  workorder_type_raw,\n  machine_raw,\n\n  -- Renamed metrics and keys\n  workorder_type_clean,\n  machine_clean,\n  metropole             AS metropolitan,\n  metropole_city,\n  technician_equipe,\n  reccurence            AS recurrence_count,\n  type_tarif            AS pricing_type,\n  key_tarif_used        AS pricing_key_used,\n  a_facturer            AS to_invoice,\n  Montant               AS amount,\n  PROD                  AS prod_number,\n  CASE\n    WHEN Montant IS NOT NULL AND a_facturer = TRUE THEN 'VALIDATED'\n    WHEN Montant IS NULL AND a_facturer = TRUE THEN 'MISSING_TARIF'\n    ELSE 'NOT_BILLABLE'\n  END as billing_validation_status\n\nFROM final_result", "relation_name": "`evs-datastack-prod`.`prod_intermediate`.`int_yuman__workorder_pricing`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.571537Z", "completed_at": "2025-10-20T12:24:11.594000Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.600846Z", "completed_at": "2025-10-20T12:24:11.600857Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.08204984664916992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_dim_yuman__materials_clients_site_id.00254a1aa0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect site_id\nfrom `evs-datastack-prod`.`prod_marts`.`dim_yuman__materials_clients`\nwhere site_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.630687Z", "completed_at": "2025-10-20T12:24:11.671020Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.682107Z", "completed_at": "2025-10-20T12:24:11.682124Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06925106048583984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__machines_yuman_maintenance_base_device_code.a8d1d80e51", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_code\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__machines_yuman_maintenance_base`\nwhere device_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.645698Z", "completed_at": "2025-10-20T12:24:11.679145Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.684323Z", "completed_at": "2025-10-20T12:24:11.684337Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06855511665344238, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__ecart_inventaire_tasks_created_at.7d0fcea0cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.639132Z", "completed_at": "2025-10-20T12:24:11.679878Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.684936Z", "completed_at": "2025-10-20T12:24:11.684947Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0732266902923584, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__machines_yuman_maintenance_base_device_id.eb5ccd792d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__machines_yuman_maintenance_base`\nwhere device_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.655708Z", "completed_at": "2025-10-20T12:24:11.680834Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.686168Z", "completed_at": "2025-10-20T12:24:11.686179Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07192206382751465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__ecart_inventaire_tasks_product_id.7f8ffacb68", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.660939Z", "completed_at": "2025-10-20T12:24:11.682883Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.687490Z", "completed_at": "2025-10-20T12:24:11.687501Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07280635833740234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__ecart_inventaire_tasks_task_id.a45f2ce08b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.650601Z", "completed_at": "2025-10-20T12:24:11.681489Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.686779Z", "completed_at": "2025-10-20T12:24:11.686789Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07750487327575684, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__ecart_inventaire_tasks_extracted_at.3521403fea", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.665940Z", "completed_at": "2025-10-20T12:24:11.683692Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.690331Z", "completed_at": "2025-10-20T12:24:11.690343Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07622694969177246, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__ecart_inventaire_tasks_task_product_id.e6945505d5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.673372Z", "completed_at": "2025-10-20T12:24:11.685591Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.693057Z", "completed_at": "2025-10-20T12:24:11.693076Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07826089859008789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__ecart_inventaire_tasks_task_start_date.6192042d8e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.719436Z", "completed_at": "2025-10-20T12:24:11.764662Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.769003Z", "completed_at": "2025-10-20T12:24:11.769020Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06623435020446777, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__ecart_inventaire_tasks_updated_at.a93b91f4db", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.726686Z", "completed_at": "2025-10-20T12:24:11.766313Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.771667Z", "completed_at": "2025-10-20T12:24:11.771679Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06792545318603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__ecart_inventaire_tasks_task_product_id.0895448e86", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__ecart_inventaire_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.748528Z", "completed_at": "2025-10-20T12:24:11.768117Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.773480Z", "completed_at": "2025-10-20T12:24:11.773490Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06673407554626465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_product_id.422706e73d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.732185Z", "completed_at": "2025-10-20T12:24:11.767099Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.772872Z", "completed_at": "2025-10-20T12:24:11.772883Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07112431526184082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_created_at.49335f4f3a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.738567Z", "completed_at": "2025-10-20T12:24:11.769709Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.776260Z", "completed_at": "2025-10-20T12:24:11.776276Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07335019111633301, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_destination_code.60865e1142", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect destination_code\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere destination_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.753678Z", "completed_at": "2025-10-20T12:24:11.771027Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.777491Z", "completed_at": "2025-10-20T12:24:11.777503Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07320642471313477, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_source_code.806024b65d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect source_code\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere source_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.743380Z", "completed_at": "2025-10-20T12:24:11.770268Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.776880Z", "completed_at": "2025-10-20T12:24:11.776890Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07761740684509277, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_extracted_at.9d5f1d0c81", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.758917Z", "completed_at": "2025-10-20T12:24:11.772269Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.780036Z", "completed_at": "2025-10-20T12:24:11.780052Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07791256904602051, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_task_id.feb7a19392", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.805960Z", "completed_at": "2025-10-20T12:24:11.836797Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.855046Z", "completed_at": "2025-10-20T12:24:11.855061Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0662393569946289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_task_product_id.acafb99a38", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.817903Z", "completed_at": "2025-10-20T12:24:11.852851Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.857535Z", "completed_at": "2025-10-20T12:24:11.857548Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06623101234436035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_updated_at.bfec986bee", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.812260Z", "completed_at": "2025-10-20T12:24:11.853648Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.858815Z", "completed_at": "2025-10-20T12:24:11.858831Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07004284858703613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__commande_interne_task_start_date.863ef2a87e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.822760Z", "completed_at": "2025-10-20T12:24:11.854404Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.860017Z", "completed_at": "2025-10-20T12:24:11.860028Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07066154479980469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__commande_interne_task_product_id.b43ba28698", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__commande_interne`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.837408Z", "completed_at": "2025-10-20T12:24:11.856119Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.862941Z", "completed_at": "2025-10-20T12:24:11.862952Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07092761993408203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inter_techinique_tasks_company_id.963bf0b41a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\nwhere company_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.828753Z", "completed_at": "2025-10-20T12:24:11.856746Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.863556Z", "completed_at": "2025-10-20T12:24:11.863567Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.0741276741027832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_oracle_neshu__machines_maintenance_tracking", "compiled": true, "compiled_code": "-- fct_oracle_neshu__machines_maintenance_tracking.sql\n\n\nWITH machines_base AS (\n    SELECT * FROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__machines_yuman_maintenance_base`\n),\n\n-- INTERVENTIONS YUMAN (toutes, pas de filtre ici)\nall_workorders AS (\n    SELECT \n        wd.demand_id, \n        wd.workorder_id,\n        wd.material_id, \n        wd.demand_status,\n        wdc.demand_category_name, \n        wo.date_planned,\n        wo.date_done, \n        wo.workorder_type, \n        wo.workorder_status\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands` wd\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands_categories` wdc\n        ON wd.demand_category_id = wdc.demand_category_id\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders` wo\n        ON wd.workorder_id = wo.workorder_id\n),\n\n-- ENRICHISSEMENT : Ajouter les interventions AUX machines (LEFT JOIN)\nworkorder_enrichi AS (\n    SELECT \n        mb.*,\n        wo.demand_id,\n        wo.workorder_id,\n        wo.demand_status,\n        wo.demand_category_name,\n        wo.date_planned,\n        wo.date_done,\n        wo.workorder_type,\n        wo.workorder_status\n    FROM machines_base mb\n    LEFT JOIN all_workorders wo\n        ON mb.material_id = wo.material_id\n),\n\n-- LISTE INTERVENTION PREV DLOG\nintervention_prev_dlog AS (\n    SELECT \n        CONCAT('NESH_', device_code) AS device_code, \n        MAX(task_end_date) AS last_preventive_date\n    FROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\n    WHERE dc04 = 'DC0402'\n        AND task_status_code = 'FAIT'\n    GROUP BY device_code\n),\n\n-- AJOUT PREV DLOG DANS LA LISTE DES INTERVENTION YUMAN\nmaterial_enrichi AS (\n    SELECT \n        we.*, \n        ipd.last_preventive_date \n    FROM workorder_enrichi we\n    LEFT JOIN intervention_prev_dlog ipd\n        ON we.material_serial_number = ipd.device_code\n),\n\n-- CALCUL DU RETARD PAR MACHINE\ncalcul_retard AS (\n    SELECT\n        device_id,\n        material_id,\n        device_code,\n        material_serial_number,\n        last_installation_date,\n        device_name,\n        company_code,\n        company_name,\n        client_code,\n        client_name,\n        client_category,\n        site_postal_code,\n        demand_status,\n        date_planned,\n        material_created_at,\n        \n        -- D\u00e9terminer la derni\u00e8re pr\u00e9ventive de la source 1 (Yuman)\n        MAX(CASE \n            WHEN (workorder_type = 'Preventive' OR demand_category_name = 'PREVENTIVE PROG - NESHU') \n                AND workorder_status = 'Closed' \n            THEN date_done \n            ELSE NULL \n        END) OVER (PARTITION BY material_id) AS derniere_preventive_source1,\n        \n        -- R\u00e9cup\u00e9rer la pr\u00e9ventive externe (source 2 - DLOG)\n        MAX(last_preventive_date) OVER (PARTITION BY material_id) AS derniere_preventive_source2,\n        \n        -- Date du jour\n        CURRENT_TIMESTAMP() AS today\n        \n    FROM material_enrichi\n),\n\n-- LOGIQUE PRINCIPALE DE CALCUL\nretard_final AS (\n    SELECT DISTINCT\n        device_id,\n        material_id,\n        device_code,\n        material_serial_number,\n        last_installation_date,\n        device_name,\n        company_code,\n        company_name,\n        client_code,\n        client_name,\n        client_category,\n        site_postal_code,\n        demand_status,\n        date_planned,\n        material_created_at,\n        \n        -- CAS 1: Machine install\u00e9e depuis moins de 13 mois\n        CASE\n            WHEN last_installation_date > TIMESTAMP_SUB(today, INTERVAL 395 DAY) THEN\n                FALSE\n            \n            -- CAS 2: Machine ancienne sans aucune pr\u00e9ventive\n            WHEN derniere_preventive_source1 IS NULL AND derniere_preventive_source2 IS NULL THEN\n                TRUE\n            \n            -- CAS 3: Machine avec pr\u00e9ventives - v\u00e9rifier si retard > 365 jours\n            ELSE\n                CASE\n                    WHEN GREATEST(\n                        COALESCE(derniere_preventive_source1, TIMESTAMP('1900-01-01')),\n                        COALESCE(derniere_preventive_source2, TIMESTAMP('1900-01-01'))\n                    ) < TIMESTAMP_SUB(today, INTERVAL 365 DAY)\n                    THEN TRUE\n                    ELSE FALSE\n                END\n        END AS retard_bol,\n        \n        -- CALCUL DU D\u00c9LAI\n        CASE\n            -- CAS 1: Machine r\u00e9cente (< 13 mois)\n            WHEN last_installation_date > TIMESTAMP_SUB(today, INTERVAL 395 DAY) THEN\n                TIMESTAMP_DIFF(TIMESTAMP_ADD(last_installation_date, INTERVAL 395 DAY), today, DAY)\n            \n            -- CAS 2: Aucune pr\u00e9ventive\n            WHEN derniere_preventive_source1 IS NULL AND derniere_preventive_source2 IS NULL THEN\n                -TIMESTAMP_DIFF(today, TIMESTAMP_ADD(last_installation_date, INTERVAL 365 DAY), DAY)\n            \n            -- CAS 3: Avec pr\u00e9ventives\n            ELSE\n                CASE\n                    WHEN TIMESTAMP_DIFF(today, GREATEST(\n                        COALESCE(derniere_preventive_source1, TIMESTAMP('1900-01-01')),\n                        COALESCE(derniere_preventive_source2, TIMESTAMP('1900-01-01'))\n                    ), DAY) > 365\n                    THEN -(TIMESTAMP_DIFF(today, GREATEST(\n                        COALESCE(derniere_preventive_source1, TIMESTAMP('1900-01-01')),\n                        COALESCE(derniere_preventive_source2, TIMESTAMP('1900-01-01'))\n                    ), DAY) - 365)\n                    ELSE 365 - TIMESTAMP_DIFF(today, GREATEST(\n                        COALESCE(derniere_preventive_source1, TIMESTAMP('1900-01-01')),\n                        COALESCE(derniere_preventive_source2, TIMESTAMP('1900-01-01'))\n                    ), DAY)\n                END\n        END AS retard_delai,\n        \n        -- SOURCE DE LA DERNI\u00c8RE PR\u00c9VENTIVE\n        CASE\n            WHEN last_installation_date > TIMESTAMP_SUB(today, INTERVAL 395 DAY) THEN\n                'aucune'\n            WHEN derniere_preventive_source1 IS NULL AND derniere_preventive_source2 IS NULL THEN\n                'aucune'\n            WHEN derniere_preventive_source2 IS NULL OR \n                (derniere_preventive_source1 IS NOT NULL AND derniere_preventive_source1 > derniere_preventive_source2) THEN\n                'yuman'\n            ELSE\n                'dlog'\n        END AS source_last_preventive,\n        \n        today\n        \n    FROM calcul_retard\n),\n\n-- D\u00c9DUPLICATION: Garder une seule ligne par machine\ndeduplique AS (\n    SELECT\n        * EXCEPT(today),\n        ROW_NUMBER() OVER (\n            PARTITION BY material_serial_number \n            ORDER BY \n                retard_bol ASC,                -- Les machines non en retard d'abord (FALSE avant TRUE)\n                material_created_at DESC,      -- Si les 2 non en retard : la plus r\u00e9cente\n                retard_delai ASC               -- Si les 2 en retard : le plus grand d\u00e9lai (n\u00e9gatif donc ASC)\n        ) AS rn\n    FROM retard_final\n),\n\n-- R\u00c9SULTAT RETARD DEDUPLIQU\u00c9\nresultat_retard AS (\n    SELECT\n        device_id,\n        material_id,\n        device_code,\n        material_serial_number,\n        last_installation_date,\n        device_name,\n        company_code,\n        company_name,\n        client_code,\n        client_name,\n        client_category,\n        site_postal_code,\n        retard_bol,\n        retard_delai,\n        source_last_preventive,\n        material_created_at\n    FROM deduplique\n    WHERE rn = 1\n),\n\n-- DEMANDES D'INTERVENTION YUMAN OUVERTES & PLANIFI\u00c9ES\ndi_data AS (\n    SELECT \n        wd.material_id,\n        wo.date_planned,\n        CASE\n            WHEN wd.demand_status = 'Open' THEN 'Ouvert'\n            WHEN wo.workorder_status = 'Scheduled' THEN 'Planifie'\n            ELSE 'Aucune'\n        END AS status_inter\n    FROM `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands` wd\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorder_demands_categories` wdc\n        ON wd.demand_category_id = wdc.demand_category_id\n    LEFT JOIN `evs-datastack-prod`.`prod_staging`.`stg_yuman__workorders` wo\n        ON wd.workorder_id = wo.workorder_id\n    WHERE wdc.demand_category_name = 'PREVENTIVE PROG - NESHU' \n        AND (wd.demand_status = 'Open' OR wo.workorder_status = 'Scheduled')\n),\n\n-- ENRICHISSEMENT FINAL AVEC STATUT DES INTERVENTIONS\nfinal AS (\n    SELECT\n        rr.device_id,\n        rr.device_code,\n        rr.device_name,\n        rr.company_code,\n        rr.company_name,\n        rr.last_installation_date AS device_last_installation_date,\n        rr.material_id,\n        rr.material_serial_number,\n        rr.client_code,\n        rr.client_name,\n        rr.client_category,\n        rr.site_postal_code,\n        rr.retard_bol,\n        rr.retard_delai,\n        rr.source_last_preventive,\n        COALESCE(di.status_inter, 'Aucune') AS status_inter,\n        di.date_planned,\n        rr.material_created_at,\n\n        -- M\u00e9tadonn\u00e9es dbt\n        CURRENT_TIMESTAMP() as dbt_updated_at,\n        'd3de9015-62df-4f1d-842a-4581ffa711ee' as dbt_invocation_id\n\n    FROM resultat_retard rr\n    LEFT JOIN di_data di\n        ON rr.material_id = di.material_id\n)\n\nSELECT * FROM final", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.842644Z", "completed_at": "2025-10-20T12:24:11.858145Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.866148Z", "completed_at": "2025-10-20T12:24:11.866164Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07512831687927246, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inter_techinique_tasks_created_at.23cf274781", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.848106Z", "completed_at": "2025-10-20T12:24:11.859409Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.868721Z", "completed_at": "2025-10-20T12:24:11.868732Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07602119445800781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inter_techinique_tasks_device_id.a4926002cf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\nwhere device_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.892867Z", "completed_at": "2025-10-20T12:24:11.922243Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.941502Z", "completed_at": "2025-10-20T12:24:11.941519Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0670311450958252, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inter_techinique_tasks_extracted_at.ebb7615afa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.900077Z", "completed_at": "2025-10-20T12:24:11.933140Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.942899Z", "completed_at": "2025-10-20T12:24:11.942911Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0677042007446289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inter_techinique_tasks_task_id.2ab30c87a3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.911452Z", "completed_at": "2025-10-20T12:24:11.940708Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.945155Z", "completed_at": "2025-10-20T12:24:11.945169Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06858229637145996, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inter_techinique_tasks_updated_at.75a6fbc88b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.905529Z", "completed_at": "2025-10-20T12:24:11.942087Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.947162Z", "completed_at": "2025-10-20T12:24:11.947173Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07291007041931152, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inter_techinique_tasks_task_start_date.4d976b328e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.923070Z", "completed_at": "2025-10-20T12:24:11.944466Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.952703Z", "completed_at": "2025-10-20T12:24:11.952719Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07149195671081543, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inventaire_tasks_created_at.e03cda86f7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.917102Z", "completed_at": "2025-10-20T12:24:11.943590Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.952075Z", "completed_at": "2025-10-20T12:24:11.952086Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.0746603012084961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__inter_techinique_tasks_task_id.e6fbe5979b", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inter_techinique_tasks`\n  where task_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.928071Z", "completed_at": "2025-10-20T12:24:11.945880Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.953434Z", "completed_at": "2025-10-20T12:24:11.953450Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07515525817871094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inventaire_tasks_extracted_at.ce6508aabf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.935488Z", "completed_at": "2025-10-20T12:24:11.946497Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:11.955954Z", "completed_at": "2025-10-20T12:24:11.955970Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07662177085876465, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inventaire_tasks_product_id.315d649f9b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.985418Z", "completed_at": "2025-10-20T12:24:12.010322Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.028118Z", "completed_at": "2025-10-20T12:24:12.028137Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06516194343566895, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inventaire_tasks_task_product_id.40c0d72097", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.980209Z", "completed_at": "2025-10-20T12:24:12.020689Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.029762Z", "completed_at": "2025-10-20T12:24:12.029774Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06794333457946777, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inventaire_tasks_task_id.12d8825475", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.992280Z", "completed_at": "2025-10-20T12:24:12.021729Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.031586Z", "completed_at": "2025-10-20T12:24:12.031597Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06993532180786133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inventaire_tasks_task_start_date.6ab0a21e68", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:11.999395Z", "completed_at": "2025-10-20T12:24:12.027349Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.032270Z", "completed_at": "2025-10-20T12:24:12.032285Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07057619094848633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__inventaire_tasks_updated_at.ed499f687b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.005409Z", "completed_at": "2025-10-20T12:24:12.028903Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.033658Z", "completed_at": "2025-10-20T12:24:12.033669Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07140302658081055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__inventaire_tasks_task_product_id.6de7c4abb7", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__inventaire_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.015802Z", "completed_at": "2025-10-20T12:24:12.030357Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.038403Z", "completed_at": "2025-10-20T12:24:12.038418Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07228922843933105, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_tasks_extracted_at.175de36255", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.010935Z", "completed_at": "2025-10-20T12:24:12.030971Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.038994Z", "completed_at": "2025-10-20T12:24:12.039005Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07620477676391602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_tasks_created_at.d2d3de44aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.022395Z", "completed_at": "2025-10-20T12:24:12.032965Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.045217Z", "completed_at": "2025-10-20T12:24:12.045236Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07696938514709473, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_tasks_product_id.8522aad15d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.066738Z", "completed_at": "2025-10-20T12:24:12.097280Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.115141Z", "completed_at": "2025-10-20T12:24:12.115161Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06734466552734375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_tasks_task_id.aed5d7619e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.079416Z", "completed_at": "2025-10-20T12:24:12.113592Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.117554Z", "completed_at": "2025-10-20T12:24:12.117566Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06544733047485352, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_tasks_task_start_date.341a694abf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.073685Z", "completed_at": "2025-10-20T12:24:12.102898Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.116513Z", "completed_at": "2025-10-20T12:24:12.116528Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06865501403808594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_tasks_task_product_id.e3b9b08f8d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.085139Z", "completed_at": "2025-10-20T12:24:12.114387Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.119496Z", "completed_at": "2025-10-20T12:24:12.119508Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06934237480163574, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_tasks_updated_at.4ae155633f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.090842Z", "completed_at": "2025-10-20T12:24:12.115817Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.122936Z", "completed_at": "2025-10-20T12:24:12.122946Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07069516181945801, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__livraison_tasks_task_product_id.011a4e9629", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.103755Z", "completed_at": "2025-10-20T12:24:12.118132Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.127551Z", "completed_at": "2025-10-20T12:24:12.127563Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.0713646411895752, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_interne_tasks_extracted_at.931738aaac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.098022Z", "completed_at": "2025-10-20T12:24:12.118828Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.128146Z", "completed_at": "2025-10-20T12:24:12.128158Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07471299171447754, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_interne_tasks_created_at.c6d4b559be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.108837Z", "completed_at": "2025-10-20T12:24:12.120068Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.130907Z", "completed_at": "2025-10-20T12:24:12.130918Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06946539878845215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_interne_tasks_product_id.84345d9252", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.152569Z", "completed_at": "2025-10-20T12:24:12.182931Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.202001Z", "completed_at": "2025-10-20T12:24:12.202021Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.067138671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_interne_tasks_task_id.3d326d6d80", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.163616Z", "completed_at": "2025-10-20T12:24:12.188545Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.203841Z", "completed_at": "2025-10-20T12:24:12.203853Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06775975227355957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_interne_tasks_task_start_date.a2d90a847c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.158436Z", "completed_at": "2025-10-20T12:24:12.195623Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.205347Z", "completed_at": "2025-10-20T12:24:12.205359Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07093501091003418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_interne_tasks_task_product_id.4515c1033a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.171810Z", "completed_at": "2025-10-20T12:24:12.201368Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.206625Z", "completed_at": "2025-10-20T12:24:12.206637Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0709543228149414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__livraison_interne_tasks_updated_at.40f144213d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.177436Z", "completed_at": "2025-10-20T12:24:12.202740Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.210134Z", "completed_at": "2025-10-20T12:24:12.210149Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.0725564956665039, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__livraison_interne_tasks_task_product_id.cca996b12e", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_interne_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.183646Z", "completed_at": "2025-10-20T12:24:12.204697Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.212721Z", "completed_at": "2025-10-20T12:24:12.212732Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.0734562873840332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__reception_tasks_created_at.8083bcc7e8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.189349Z", "completed_at": "2025-10-20T12:24:12.205885Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.215228Z", "completed_at": "2025-10-20T12:24:12.215245Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07551860809326172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__reception_tasks_extracted_at.ec88db7302", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.196318Z", "completed_at": "2025-10-20T12:24:12.207344Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.217886Z", "completed_at": "2025-10-20T12:24:12.217897Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07806825637817383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__reception_tasks_product_id.aa8ad941b0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.239077Z", "completed_at": "2025-10-20T12:24:12.274523Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.288587Z", "completed_at": "2025-10-20T12:24:12.288614Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06767463684082031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__reception_tasks_task_id.73ba57ad4f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.245836Z", "completed_at": "2025-10-20T12:24:12.280322Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.289460Z", "completed_at": "2025-10-20T12:24:12.289472Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06714296340942383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__reception_tasks_task_product_id.af91258a78", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.251557Z", "completed_at": "2025-10-20T12:24:12.281213Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.291318Z", "completed_at": "2025-10-20T12:24:12.291330Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.06840038299560547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__reception_tasks_task_start_date.eb50f49146", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.257193Z", "completed_at": "2025-10-20T12:24:12.287024Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.292012Z", "completed_at": "2025-10-20T12:24:12.292022Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06893539428710938, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__reception_tasks_updated_at.2d211b0f61", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.263676Z", "completed_at": "2025-10-20T12:24:12.287920Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.292700Z", "completed_at": "2025-10-20T12:24:12.292712Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06967997550964355, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__reception_tasks_task_product_id.bf4c38de57", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__reception_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.269745Z", "completed_at": "2025-10-20T12:24:12.290049Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.296167Z", "completed_at": "2025-10-20T12:24:12.296180Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07254862785339355, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__telemetry_tasks_created_at.ef85effe50", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.275540Z", "completed_at": "2025-10-20T12:24:12.290720Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.298716Z", "completed_at": "2025-10-20T12:24:12.298730Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07465791702270508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__telemetry_tasks_extracted_at.5c3a5f7ac5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.282097Z", "completed_at": "2025-10-20T12:24:12.293246Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.305142Z", "completed_at": "2025-10-20T12:24:12.305153Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07083892822265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__telemetry_tasks_product_id.04e1d8477d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.327046Z", "completed_at": "2025-10-20T12:24:12.368780Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.377734Z", "completed_at": "2025-10-20T12:24:12.377752Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06732869148254395, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__telemetry_tasks_task_id.2a5854e826", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.333072Z", "completed_at": "2025-10-20T12:24:12.369568Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.379283Z", "completed_at": "2025-10-20T12:24:12.379315Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06877613067626953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__telemetry_tasks_task_product_id.3c6e38ed4d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.343885Z", "completed_at": "2025-10-20T12:24:12.370692Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.380538Z", "completed_at": "2025-10-20T12:24:12.380549Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.06996560096740723, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__telemetry_tasks_updated_at.8d8d17e88a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.348763Z", "completed_at": "2025-10-20T12:24:12.371331Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.381122Z", "completed_at": "2025-10-20T12:24:12.381133Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07132267951965332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__telemetry_tasks_task_product_id.4d229c656f", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.337998Z", "completed_at": "2025-10-20T12:24:12.371954Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.381837Z", "completed_at": "2025-10-20T12:24:12.381848Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07533860206604004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__telemetry_tasks_task_start_date.66646fa50e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.355858Z", "completed_at": "2025-10-20T12:24:12.378604Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.384937Z", "completed_at": "2025-10-20T12:24:12.384953Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07417678833007812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_warehouse.fct_oracle_neshu__conso_business_review", "compiled": true, "compiled_code": "\n\nWITH telemetry_data AS (\n  SELECT \n    -- IDs\n    t.company_id,\n    t.device_id,\n    t.location_id,\n    t.product_id,\n    \n    -- Company\n    c.company_code,\n    c.company_name,\n\n    -- Localisation\n    COALESCE(NULLIF(t.task_location_info, ''), d.device_location) AS location,\n\n    -- Machine\n    d.device_code AS device_serial_number,\n    d.device_name,\n    d.device_brand,\n    d.device_economic_model,\n\n    -- Produit\n    p.product_name,\n    p.product_brand,\n    p.product_family,\n    p.product_group,\n    p.product_type,\n\n    -- Contexte\n    DATE(t.task_start_date) AS consumption_date,\n    'TELEMETRIE' AS data_source,\n\n    -- Mesure\n    SUM(t.telemetry_quantity) AS quantity\n    \n  FROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__telemetry_tasks` t\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device` d \n    ON t.device_id = d.device_id\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product` p \n    ON t.product_id = p.product_id\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company` c\n    ON t.company_id = c.company_id\n  GROUP BY \n    t.company_id, t.device_id, t.location_id, t.product_id,\n    c.company_code, c.company_name,\n    COALESCE(NULLIF(t.task_location_info, ''), d.device_location),\n    d.device_code, d.device_name, d.device_brand, d.device_economic_model,\n    p.product_name, p.product_brand, p.product_family, p.product_group, p.product_type,\n    DATE(t.task_start_date)\n),\nchargement_data AS (\n  SELECT \n    -- IDs\n    l.company_id,\n    l.device_id,\n    l.location_id,\n    l.product_id,\n    \n    -- Company\n    c.company_code,\n    c.company_name,\n\n    -- Localisation\n    COALESCE(NULLIF(l.task_location_info, ''), d.device_location) AS location,\n\n    -- Machine\n    d.device_code AS device_serial_number,\n    d.device_name,\n    d.device_brand,\n    d.device_economic_model,\n\n    -- Produit\n    p.product_name,\n    p.product_brand,\n    p.product_family,\n    p.product_group,\n    p.product_type,\n\n    -- Contexte\n    DATE(l.task_start_date) AS consumption_date,\n    'CHARGEMENT' AS data_source,\n\n    -- Quantit\u00e9 (ajust\u00e9e selon le produit)\n    SUM(\n      CASE\n        WHEN p.product_name LIKE '%GOBELET%RAME 50%' THEN l.load_quantity * 50\n        WHEN p.product_name LIKE '%GOBELET%RAME DE 30%' THEN l.load_quantity * 30\n        WHEN p.product_name LIKE '%GOBELET%RAME 35%' THEN l.load_quantity * 35\n        WHEN p.product_name LIKE '%MELANG%BTE 200%' THEN l.load_quantity * 200\n        WHEN p.product_name LIKE '%MELANGEUR%BTE 200%' THEN l.load_quantity * 200\n        WHEN p.product_name LIKE '%MELANGEUR%BTE 100%' THEN l.load_quantity * 100\n        WHEN p.product_name LIKE '%BEGHIN SAY 300%' THEN l.load_quantity * 300\n        WHEN p.product_name LIKE '%CARTON DE 500%' THEN l.load_quantity * 500\n        WHEN p.product_name LIKE '%DISTRIBUTEUR 300 SUCRES%' THEN l.load_quantity * 300\n        WHEN p.product_name LIKE '%SUCRE BATONNET 100%' THEN l.load_quantity * 100\n        WHEN p.product_name LIKE '%SUCRE BTE 300%' THEN l.load_quantity * 300\n        WHEN p.product_name LIKE '%NESPRESSO MELANGEURS EN BAMBOU INDI%' THEN l.load_quantity * 100\n        ELSE l.load_quantity\n      END\n    ) AS quantity\n\n  FROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks` l\n  INNER JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device` d \n    ON l.device_id = d.device_id\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product` p \n    ON l.product_id = p.product_id\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company` c\n    ON l.company_id = c.company_id\n  WHERE l.task_status_code in ('FAIT','VALIDE')\n  GROUP BY \n    l.company_id, l.device_id, l.location_id, l.product_id,\n    COALESCE(NULLIF(l.task_location_info, ''), d.device_location), c.company_code, c.company_name,\n    d.device_code, d.device_name, d.device_brand, d.device_economic_model,\n    p.product_name, p.product_brand, p.product_family, p.product_group, p.product_type,\n    DATE(l.task_start_date)\n),\nlivraison_data AS (\n  SELECT\n    -- IDs\n    lt.company_id,\n    NULL AS device_id,\n    NULL AS location_id,\n    lt.product_id,\n\n    -- Company\n    c.company_code,\n    c.company_name,\n\n    -- Localisation (fixe)\n    'LIVRAISON' AS location,\n\n    -- Machine (fixe)\n    'LIVRAISON' AS device_serial_number,\n    'LIVRAISON' AS device_name,\n    'LIVRAISON' AS device_brand,\n    'LIVRAISON' AS device_economic_model,\n\n    -- Produit\n    p.product_name,\n    p.product_brand,\n    p.product_family,\n    p.product_group,\n    p.product_type,\n\n    -- Contexte\n    DATE(lt.task_start_date) AS consumption_date,\n    'LIVRAISON' AS data_source,\n\n    -- Quantit\u00e9 (ajust\u00e9e selon le produit)\n    SUM(\n      CASE\n        WHEN p.product_name LIKE '%GOBELET%RAME 50%' THEN lt.quantity * 50\n        WHEN p.product_name LIKE '%GOBELET%RAME DE 30%' THEN lt.quantity * 30\n        WHEN p.product_name LIKE '%GOBELET%RAME 35%' THEN lt.quantity * 35\n        WHEN p.product_name LIKE '%MELANG%BTE 200%' THEN lt.quantity * 200\n        WHEN p.product_name LIKE '%MELANGEUR%BTE 200%' THEN lt.quantity * 200\n        WHEN p.product_name LIKE '%MELANGEUR%BTE 100%' THEN lt.quantity * 100\n        WHEN p.product_name LIKE '%BEGHIN SAY 300%' THEN lt.quantity * 300\n        WHEN p.product_name LIKE '%CARTON DE 500%' THEN lt.quantity * 500\n        WHEN p.product_name LIKE '%DISTRIBUTEUR 300 SUCRES%' THEN lt.quantity * 300\n        WHEN p.product_name LIKE '%SUCRE BATONNET 100%' THEN lt.quantity * 100\n        WHEN p.product_name LIKE '%SUCRE BTE 300%' THEN lt.quantity * 300\n        WHEN p.product_name LIKE '%NESPRESSO MELANGEURS EN BAMBOU INDI%' THEN lt.quantity * 100\n        ELSE lt.quantity\n      END\n    ) AS quantity\n\n  FROM `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__livraison_tasks` lt\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product` p \n    ON lt.product_id = p.product_id\n  LEFT JOIN `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company` c\n    ON lt.company_id = c.company_id\n  WHERE lt.task_status_code in ('FAIT','VALIDE')\n  AND p.product_type in ('THE','CAFE CAPS','CHOCOLATS VAN HOUTEN','BOISSONS GOURMANDES','ACCESSOIRES')\n  GROUP BY \n    lt.company_id, lt.product_id,\n    p.product_name, p.product_brand, p.product_family, p.product_group, p.product_type, c.company_code, c.company_name,\n    DATE(lt.task_start_date)\n),\n-- Version optimis\u00e9e : remplace combined_data + donnees_filtrees\ncombined_and_filtered_data AS (\n\n  -- Cas particulier : machine AS00446 chez CN1046\n  SELECT *\n  FROM chargement_data\n  WHERE device_serial_number = 'AS00446'\n    AND company_code = 'CN1046'\n    AND consumption_date < '2025-08-28'\n    AND product_type IN ('THE','CAFE CAPS','CHOCOLATS VAN HOUTEN')\n\n  UNION ALL\n\n  SELECT *\n  FROM telemetry_data\n  WHERE device_serial_number = 'AS00446'\n    AND company_code = 'CN1046'\n    AND consumption_date >= '2025-08-28'\n\n  UNION ALL\n\n  -- TELEMETRIE avec filtres\n  SELECT *\n  FROM telemetry_data\n  WHERE product_type IN ('BOISSONS GOURMANDES', 'CAFE CAPS', 'CAFENOIR', 'INDEFINI', 'THE', 'SNACKING', 'BOISSONS FRAICHES', 'CHOCOLATS VAN HOUTEN')\n    AND NOT (\n      device_brand IN ('NESTLE','ANIMO')\n      AND (device_economic_model NOT IN ('Participatif valeurs','Participatif unit\u00e9s','Payant') OR device_economic_model IS NULL)\n      AND product_type = 'THE'\n    )\n    AND NOT (company_code = 'CN1071' AND product_type = 'THE')\n    AND NOT (device_serial_number = 'AS00446' AND company_code = 'CN1046') \n\n\n  UNION ALL\n\n  -- CHARGEMENT avec tous les filtres consolid\u00e9s\n  SELECT *\n  FROM chargement_data\n  WHERE (\n    (device_brand = 'NESPRESSO'\n     AND (device_economic_model NOT IN ('Participatif valeurs','Participatif unit\u00e9s','Payant') OR device_economic_model IS NULL)\n     AND product_type IN ('THE','CAFE CAPS')\n     AND (company_code <> 'CN1070' OR consumption_date >= '2025-03-01'))\n    OR (device_brand IN ('NESTLE','ANIMO')\n        AND (device_economic_model NOT IN ('Participatif valeurs','Participatif unit\u00e9s','Payant') OR device_economic_model IS NULL)\n        AND product_type = 'THE')\n    OR (device_brand IN ('NESPRESSO','NESTLE','ANIMO')\n        AND product_type = 'CHOCOLATS VAN HOUTEN')\n    OR (product_type = 'ACCESSOIRES')\n    OR (company_code = 'CN1071' AND product_type = 'THE')\n    AND NOT (device_serial_number = 'AS00446' AND company_code = 'CN1046') \n  )\n\n  UNION ALL\n\n  -- LIVRAISON (tous les enregistrements)\n  SELECT *\n  FROM livraison_data\n)\n\n\nSELECT \n  -- Identifiants\n  company_id,\n  device_id,\n  location_id,\n  product_id,\n  \n  -- Company\n  company_code,\n  company_name,\n\n  -- Localisation\n  location,\n\n  -- Machine\n  device_serial_number,\n  device_name,\n  device_brand,\n  device_economic_model,\n\n  -- Produit\n  product_name,\n  product_brand,\n  product_family,\n  product_group,\n  product_type,\n\n  -- Contexte\n  consumption_date,\n  data_source,\n\n  -- Mesure\n  quantity,\n\n  -- M\u00e9tadonn\u00e9es d'ex\u00e9cution\n  CURRENT_TIMESTAMP() as dbt_updated_at,\n  'd3de9015-62df-4f1d-842a-4581ffa711ee' as dbt_invocation_id\n\nFROM combined_and_filtered_data", "relation_name": "`evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.363832Z", "completed_at": "2025-10-20T12:24:12.379888Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.388167Z", "completed_at": "2025-10-20T12:24:12.388178Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07571196556091309, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__chargement_tasks_created_at.099654dbc5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\nwhere created_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.372547Z", "completed_at": "2025-10-20T12:24:12.387560Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.398423Z", "completed_at": "2025-10-20T12:24:12.398440Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.08036279678344727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__chargement_tasks_extracted_at.7247f9f7e5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect extracted_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\nwhere extracted_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.415412Z", "completed_at": "2025-10-20T12:24:12.450200Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.460035Z", "completed_at": "2025-10-20T12:24:12.460051Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06792521476745605, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__chargement_tasks_product_id.97e92b8f9e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.421719Z", "completed_at": "2025-10-20T12:24:12.456817Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.467537Z", "completed_at": "2025-10-20T12:24:12.467550Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0706634521484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__chargement_tasks_task_id.dbf995a952", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.434665Z", "completed_at": "2025-10-20T12:24:12.459259Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.468280Z", "completed_at": "2025-10-20T12:24:12.468307Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06827926635742188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__chargement_tasks_task_start_date.18b12689c3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.445078Z", "completed_at": "2025-10-20T12:24:12.460669Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.471873Z", "completed_at": "2025-10-20T12:24:12.471885Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.0702054500579834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_int_oracle_neshu__chargement_tasks_task_product_id.f02aff9a5d", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_product_id as unique_field\n  from `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\n  where task_product_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.429800Z", "completed_at": "2025-10-20T12:24:12.461273Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.472633Z", "completed_at": "2025-10-20T12:24:12.472649Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0752720832824707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__chargement_tasks_task_product_id.22016f77c7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_product_id\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\nwhere task_product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.439880Z", "completed_at": "2025-10-20T12:24:12.466888Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.473378Z", "completed_at": "2025-10-20T12:24:12.473389Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07579278945922852, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_int_oracle_neshu__chargement_tasks_updated_at.cfb1806175", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom `evs-datastack-prod`.`prod_intermediate`.`int_oracle_neshu__chargement_tasks`\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.451699Z", "completed_at": "2025-10-20T12:24:12.469040Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.478162Z", "completed_at": "2025-10-20T12:24:12.478178Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07665348052978516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_company_code.4dd651bc02", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_code\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere company_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.461931Z", "completed_at": "2025-10-20T12:24:12.479448Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.490352Z", "completed_at": "2025-10-20T12:24:12.490364Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06827092170715332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_company_info.8eeabe00a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_info\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere company_info is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.500556Z", "completed_at": "2025-10-20T12:24:12.520923Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.544577Z", "completed_at": "2025-10-20T12:24:12.544597Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06951069831848145, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_device_id.cb546c4a7e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere device_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.514324Z", "completed_at": "2025-10-20T12:24:12.545749Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.559494Z", "completed_at": "2025-10-20T12:24:12.559506Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07179546356201172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_mission_faite.4c914d3f47", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mission_faite\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere mission_faite is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.509239Z", "completed_at": "2025-10-20T12:24:12.545182Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.558864Z", "completed_at": "2025-10-20T12:24:12.558877Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07429361343383789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_device_info.08be705635", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_info\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere device_info is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.528220Z", "completed_at": "2025-10-20T12:24:12.546812Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.560116Z", "completed_at": "2025-10-20T12:24:12.560126Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07117152214050293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_task_id.b47f804afa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere task_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.521538Z", "completed_at": "2025-10-20T12:24:12.547446Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.560719Z", "completed_at": "2025-10-20T12:24:12.560730Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07373571395874023, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_mission_prevue.79cb0b2a32", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect mission_prevue\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere mission_prevue is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.533185Z", "completed_at": "2025-10-20T12:24:12.555332Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.561443Z", "completed_at": "2025-10-20T12:24:12.561454Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0769803524017334, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_task_start_date.8dceb0b3e4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_start_date\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere task_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.538650Z", "completed_at": "2025-10-20T12:24:12.558111Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.562808Z", "completed_at": "2025-10-20T12:24:12.562819Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07202315330505371, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__pa_business_review_task_status_code.b0aa10d1d0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect task_status_code\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\nwhere task_status_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.548201Z", "completed_at": "2025-10-20T12:24:12.563436Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.578507Z", "completed_at": "2025-10-20T12:24:12.578520Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.06549787521362305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_oracle_neshu__pa_business_review_device_id__device_id__ref_dim_oracle_neshu__device_.94d4d49600", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select device_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\n    where device_id is not null\n),\n\nparent as (\n    select device_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.588482Z", "completed_at": "2025-10-20T12:24:12.604613Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.641077Z", "completed_at": "2025-10-20T12:24:12.641092Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0754086971282959, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_fct_oracle_neshu__pa_business_review_task_id.e6a4a507a2", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select task_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__pa_business_review`\n  where task_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.599521Z", "completed_at": "2025-10-20T12:24:12.642787Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.655186Z", "completed_at": "2025-10-20T12:24:12.655200Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.07727670669555664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.accepted_values_fct_oracle_neshu__machines_maintenance_tracking_source_last_preventive__yuman__dlog__aucune.ac417d2f59", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        source_last_preventive as value_field,\n        count(*) as n_records\n\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\n    group by source_last_preventive\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'yuman','dlog','aucune'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.616958Z", "completed_at": "2025-10-20T12:24:12.643671Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.655859Z", "completed_at": "2025-10-20T12:24:12.655875Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07669663429260254, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_company_code.0cdf0f5a6b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_code\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere company_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.611781Z", "completed_at": "2025-10-20T12:24:12.644798Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.656492Z", "completed_at": "2025-10-20T12:24:12.656503Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07941985130310059, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.accepted_values_fct_oracle_neshu__machines_maintenance_tracking_status_inter__Ouvert__Planifie__Aucune.808c90cc4e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status_inter as value_field,\n        count(*) as n_records\n\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\n    group by status_inter\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Ouvert','Planifie','Aucune'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.629272Z", "completed_at": "2025-10-20T12:24:12.645441Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.657090Z", "completed_at": "2025-10-20T12:24:12.657106Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07439661026000977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_device_code.21e30b32f5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_code\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere device_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.624099Z", "completed_at": "2025-10-20T12:24:12.648316Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.658493Z", "completed_at": "2025-10-20T12:24:12.658510Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.0827796459197998, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_company_name.3bf8fed65d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_name\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere company_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.635975Z", "completed_at": "2025-10-20T12:24:12.654472Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.659215Z", "completed_at": "2025-10-20T12:24:12.659230Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07969355583190918, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_device_id.980098d686", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere device_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.649089Z", "completed_at": "2025-10-20T12:24:12.661966Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.672187Z", "completed_at": "2025-10-20T12:24:12.672204Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.0699925422668457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_device_last_installation_date.2fb83a6c11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_last_installation_date\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere device_last_installation_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.683209Z", "completed_at": "2025-10-20T12:24:12.698995Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.723641Z", "completed_at": "2025-10-20T12:24:12.723665Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07059240341186523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_device_name.27263a7181", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect device_name\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere device_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.702825Z", "completed_at": "2025-10-20T12:24:12.735094Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.752057Z", "completed_at": "2025-10-20T12:24:12.752073Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07636833190917969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_retard_delai.90bc56ccbd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect retard_delai\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere retard_delai is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.693905Z", "completed_at": "2025-10-20T12:24:12.733481Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.750487Z", "completed_at": "2025-10-20T12:24:12.750503Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.08226394653320312, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_retard_bol.1a01596ee3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect retard_bol\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere retard_bol is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.713043Z", "completed_at": "2025-10-20T12:24:12.736350Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.753325Z", "completed_at": "2025-10-20T12:24:12.753337Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.07993125915527344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_status_inter.169cfdb158", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect status_inter\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere status_inter is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.707973Z", "completed_at": "2025-10-20T12:24:12.735774Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.752704Z", "completed_at": "2025-10-20T12:24:12.752715Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0825960636138916, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__machines_maintenance_tracking_source_last_preventive.00eb8f212a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect source_last_preventive\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\nwhere source_last_preventive is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.718366Z", "completed_at": "2025-10-20T12:24:12.737238Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.753935Z", "completed_at": "2025-10-20T12:24:12.753946Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07809329032897949, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_fct_oracle_neshu__machines_maintenance_tracking_device_id.259a568a16", "compiled": true, "compiled_code": "\n    \n    \n\nwith dbt_test__target as (\n\n  select device_id as unique_field\n  from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__machines_maintenance_tracking`\n  where device_id is not null\n\n)\n\nselect\n    unique_field,\n    count(*) as n_records\n\nfrom dbt_test__target\ngroup by unique_field\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.724560Z", "completed_at": "2025-10-20T12:24:12.751405Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.755516Z", "completed_at": "2025-10-20T12:24:12.755529Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07931804656982422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.accepted_values_fct_oracle_neshu__conso_business_review_data_source__TELEMETRIE__CHARGEMENT__LIVRAISON.5ec7a388a7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        data_source as value_field,\n        count(*) as n_records\n\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n    group by data_source\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'TELEMETRIE','CHARGEMENT','LIVRAISON'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.740033Z", "completed_at": "2025-10-20T12:24:12.758513Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.770663Z", "completed_at": "2025-10-20T12:24:12.770675Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07498431205749512, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.accepted_values_fct_oracle_neshu__conso_business_review_product_type__THE__CAFE_CAPS__CHOCOLATS_VAN_HOUTEN__BOISSONS_GOURMANDES__ACCESSOIRES__CAFENOIR__INDEFINI__SNACKING__BOISSONS_FRAICHES.09a104a84b", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        product_type as value_field,\n        count(*) as n_records\n\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n    group by product_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'THE','CAFE CAPS','CHOCOLATS VAN HOUTEN','BOISSONS GOURMANDES','ACCESSOIRES','CAFENOIR','INDEFINI','SNACKING','BOISSONS FRAICHES'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.780437Z", "completed_at": "2025-10-20T12:24:12.802090Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.834495Z", "completed_at": "2025-10-20T12:24:12.834519Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.0748438835144043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.dbt_utils_accepted_range_fct_oracle_neshu__conso_business_review_consumption_date__current_date____2020_01_01_.5aa992f77c", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not consumption_date >= '2020-01-01'\n    -- records with a value <= max_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not consumption_date <= current_date()\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.797018Z", "completed_at": "2025-10-20T12:24:12.836155Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.848188Z", "completed_at": "2025-10-20T12:24:12.848203Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07886433601379395, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.device_id_required_except_livraison.acb84a4429", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n\nwhere not((device_id IS NOT NULL) OR (data_source = 'LIVRAISON'))\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.807862Z", "completed_at": "2025-10-20T12:24:12.836966Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.848901Z", "completed_at": "2025-10-20T12:24:12.848913Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.08006405830383301, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_company_code.5a6eede86e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_code\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere company_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.819329Z", "completed_at": "2025-10-20T12:24:12.838012Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.849539Z", "completed_at": "2025-10-20T12:24:12.849549Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.08100318908691406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_company_name.6beef2cb38", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_name\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere company_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.824246Z", "completed_at": "2025-10-20T12:24:12.839607Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.850777Z", "completed_at": "2025-10-20T12:24:12.850788Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.08311057090759277, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_consumption_date.a8716670d9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect consumption_date\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere consumption_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.829437Z", "completed_at": "2025-10-20T12:24:12.840274Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.851382Z", "completed_at": "2025-10-20T12:24:12.851392Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07316207885742188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_data_source.af5248f6f7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect data_source\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere data_source is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.814496Z", "completed_at": "2025-10-20T12:24:12.838979Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.850127Z", "completed_at": "2025-10-20T12:24:12.850138Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.08924150466918945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_company_id.ce47b5568c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect company_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere company_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.843014Z", "completed_at": "2025-10-20T12:24:12.860967Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.870608Z", "completed_at": "2025-10-20T12:24:12.870621Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.07056736946105957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_dbt_invocation_id.50b356c305", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dbt_invocation_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere dbt_invocation_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.879188Z", "completed_at": "2025-10-20T12:24:12.889642Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.923108Z", "completed_at": "2025-10-20T12:24:12.923126Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.06430530548095703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_dbt_updated_at.15c85805ca", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dbt_updated_at\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere dbt_updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.895242Z", "completed_at": "2025-10-20T12:24:12.925965Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.937888Z", "completed_at": "2025-10-20T12:24:12.937901Z"}], "thread_id": "Thread-8 (worker)", "execution_time": 0.06926822662353516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_product_name.08b08915c7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_name\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere product_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.900149Z", "completed_at": "2025-10-20T12:24:12.926616Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.939116Z", "completed_at": "2025-10-20T12:24:12.939132Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07194876670837402, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_product_type.e47220660c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_type\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere product_type is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.905079Z", "completed_at": "2025-10-20T12:24:12.928176Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.940390Z", "completed_at": "2025-10-20T12:24:12.940401Z"}], "thread_id": "Thread-6 (worker)", "execution_time": 0.07367610931396484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_quantity.b59694399a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect quantity\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.890227Z", "completed_at": "2025-10-20T12:24:12.927360Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.939778Z", "completed_at": "2025-10-20T12:24:12.939789Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.07759499549865723, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.not_null_fct_oracle_neshu__conso_business_review_product_id.8da405d6c4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.911982Z", "completed_at": "2025-10-20T12:24:12.931123Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.941725Z", "completed_at": "2025-10-20T12:24:12.941736Z"}], "thread_id": "Thread-7 (worker)", "execution_time": 0.07572746276855469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_oracle_neshu__conso_business_review_company_id__company_id__ref_dim_oracle_neshu__company_.f366f159ac", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select company_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n    where company_id is not null\n),\n\nparent as (\n    select company_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__company`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.917158Z", "completed_at": "2025-10-20T12:24:12.938489Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.945323Z", "completed_at": "2025-10-20T12:24:12.945335Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0727531909942627, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_oracle_neshu__conso_business_review_device_id__device_id__ref_dim_oracle_neshu__device_.28a6562f85", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select device_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n    where device_id is not null\n),\n\nparent as (\n    select device_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__device`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.931817Z", "completed_at": "2025-10-20T12:24:12.944604Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.955142Z", "completed_at": "2025-10-20T12:24:12.955156Z"}], "thread_id": "Thread-5 (worker)", "execution_time": 0.04997682571411133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.relationships_fct_oracle_neshu__conso_business_review_product_id__product_id__ref_dim_oracle_neshu__product_.8d74866c2a", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_id as from_field\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n    where product_id is not null\n),\n\nparent as (\n    select product_id as to_field\n    from `evs-datastack-prod`.`prod_marts`.`dim_oracle_neshu__product`\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-10-20T12:24:12.961108Z", "completed_at": "2025-10-20T12:24:12.968956Z"}, {"name": "execute", "started_at": "2025-10-20T12:24:12.969586Z", "completed_at": "2025-10-20T12:24:12.969597Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.019103288650512695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_warehouse.unique_consumption_record.1740417b5a", "compiled": true, "compiled_code": "\n\n\n\n\n\nwith validation_errors as (\n\n    select\n        company_id, device_id, product_id, location_id, location, consumption_date, data_source\n    from `evs-datastack-prod`.`prod_marts`.`fct_oracle_neshu__conso_business_review`\n    group by company_id, device_id, product_id, location_id, location, consumption_date, data_source\n    having count(*) > 1\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 5.824362754821777, "args": {"write_json": true, "which": "generate", "populate_cache": true, "macro_debugging": false, "defer": false, "require_nested_cumulative_type_params": false, "require_explicit_package_overrides_for_builtin_materializations": true, "log_level": "info", "partial_parse_file_diff": true, "log_level_file": "debug", "strict_mode": false, "require_resource_names_without_spaces": true, "require_batched_execution_for_custom_microbatch_strategy": false, "log_file_max_bytes": 10485760, "state_modified_compare_vars": false, "static": false, "validate_macro_args": false, "log_format": "default", "version_check": true, "printer_width": 80, "compile": true, "partial_parse": true, "upload_to_artifacts_ingest_api": false, "send_anonymous_usage_stats": false, "invocation_command": "dbt docs generate --target prod", "use_fast_test_edges": false, "state_modified_compare_more_unrendered_values": false, "favor_state": false, "introspect": true, "quiet": false, "vars": {}, "select": [], "project_dir": "/home/runner/work/dbt_transform/dbt_transform", "require_yaml_configuration_for_mf_time_spines": false, "profiles_dir": "/home/runner/work/dbt_transform/dbt_transform", "require_all_warnings_handled_by_warn_error": false, "show_resource_report": false, "show_all_deprecations": false, "use_colors": true, "log_format_file": "debug", "warn_error_options": {"error": [], "warn": [], "silence": []}, "indirect_selection": "eager", "print": true, "cache_selected_only": false, "source_freshness_run_project_hooks": true, "exclude": [], "static_parser": true, "require_generic_test_arguments_property": true, "target": "prod", "empty_catalog": false, "skip_nodes_if_on_run_start_fails": false, "log_path": "/home/runner/work/dbt_transform/dbt_transform/logs", "use_colors_file": true}}